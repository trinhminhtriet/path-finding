var iP=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var Ux=(t,e,n)=>(iP(t,e,"read from private field"),n?n.call(t):e.get(t)),sP=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},oP=(t,e,n,r)=>(iP(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);function lk(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var HF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Am(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ck={exports:{}},__={},uk={exports:{}},jn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Im=Symbol.for("react.element"),qF=Symbol.for("react.portal"),ZF=Symbol.for("react.fragment"),XF=Symbol.for("react.strict_mode"),YF=Symbol.for("react.profiler"),KF=Symbol.for("react.provider"),JF=Symbol.for("react.context"),QF=Symbol.for("react.forward_ref"),e4=Symbol.for("react.suspense"),t4=Symbol.for("react.memo"),n4=Symbol.for("react.lazy"),aP=Symbol.iterator;function r4(t){return t===null||typeof t!="object"?null:(t=aP&&t[aP]||t["@@iterator"],typeof t=="function"?t:null)}var hk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dk=Object.assign,fk={};function Bd(t,e,n){this.props=t,this.context=e,this.refs=fk,this.updater=n||hk}Bd.prototype.isReactComponent={};Bd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Bd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function pk(){}pk.prototype=Bd.prototype;function sE(t,e,n){this.props=t,this.context=e,this.refs=fk,this.updater=n||hk}var oE=sE.prototype=new pk;oE.constructor=sE;dk(oE,Bd.prototype);oE.isPureReactComponent=!0;var lP=Array.isArray,mk=Object.prototype.hasOwnProperty,aE={current:null},gk={key:!0,ref:!0,__self:!0,__source:!0};function yk(t,e,n){var r,i={},o=null,h=null;if(e!=null)for(r in e.ref!==void 0&&(h=e.ref),e.key!==void 0&&(o=""+e.key),e)mk.call(e,r)&&!gk.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var m=Array(l),_=0;_<l;_++)m[_]=arguments[_+2];i.children=m}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Im,type:t,key:o,ref:h,props:i,_owner:aE.current}}function i4(t,e){return{$$typeof:Im,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function lE(t){return typeof t=="object"&&t!==null&&t.$$typeof===Im}function s4(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var cP=/\/+/g;function Vx(t,e){return typeof t=="object"&&t!==null&&t.key!=null?s4(""+t.key):e.toString(36)}function Xy(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var h=!1;if(t===null)h=!0;else switch(o){case"string":case"number":h=!0;break;case"object":switch(t.$$typeof){case Im:case qF:h=!0}}if(h)return h=t,i=i(h),t=r===""?"."+Vx(h,0):r,lP(i)?(n="",t!=null&&(n=t.replace(cP,"$&/")+"/"),Xy(i,e,n,"",function(_){return _})):i!=null&&(lE(i)&&(i=i4(i,n+(!i.key||h&&h.key===i.key?"":(""+i.key).replace(cP,"$&/")+"/")+t)),e.push(i)),1;if(h=0,r=r===""?".":r+":",lP(t))for(var l=0;l<t.length;l++){o=t[l];var m=r+Vx(o,l);h+=Xy(o,e,n,m,i)}else if(m=r4(t),typeof m=="function")for(t=m.call(t),l=0;!(o=t.next()).done;)o=o.value,m=r+Vx(o,l++),h+=Xy(o,e,n,m,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return h}function ey(t,e,n){if(t==null)return t;var r=[],i=0;return Xy(t,r,"","",function(o){return e.call(n,o,i++)}),r}function o4(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ts={current:null},Yy={transition:null},a4={ReactCurrentDispatcher:Ts,ReactCurrentBatchConfig:Yy,ReactCurrentOwner:aE};jn.Children={map:ey,forEach:function(t,e,n){ey(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ey(t,function(){e++}),e},toArray:function(t){return ey(t,function(e){return e})||[]},only:function(t){if(!lE(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};jn.Component=Bd;jn.Fragment=ZF;jn.Profiler=YF;jn.PureComponent=sE;jn.StrictMode=XF;jn.Suspense=e4;jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=a4;jn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=dk({},t.props),i=t.key,o=t.ref,h=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,h=aE.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(m in e)mk.call(e,m)&&!gk.hasOwnProperty(m)&&(r[m]=e[m]===void 0&&l!==void 0?l[m]:e[m])}var m=arguments.length-2;if(m===1)r.children=n;else if(1<m){l=Array(m);for(var _=0;_<m;_++)l[_]=arguments[_+2];r.children=l}return{$$typeof:Im,type:t.type,key:i,ref:o,props:r,_owner:h}};jn.createContext=function(t){return t={$$typeof:JF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:KF,_context:t},t.Consumer=t};jn.createElement=yk;jn.createFactory=function(t){var e=yk.bind(null,t);return e.type=t,e};jn.createRef=function(){return{current:null}};jn.forwardRef=function(t){return{$$typeof:QF,render:t}};jn.isValidElement=lE;jn.lazy=function(t){return{$$typeof:n4,_payload:{_status:-1,_result:t},_init:o4}};jn.memo=function(t,e){return{$$typeof:t4,type:t,compare:e===void 0?null:e}};jn.startTransition=function(t){var e=Yy.transition;Yy.transition={};try{t()}finally{Yy.transition=e}};jn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};jn.useCallback=function(t,e){return Ts.current.useCallback(t,e)};jn.useContext=function(t){return Ts.current.useContext(t)};jn.useDebugValue=function(){};jn.useDeferredValue=function(t){return Ts.current.useDeferredValue(t)};jn.useEffect=function(t,e){return Ts.current.useEffect(t,e)};jn.useId=function(){return Ts.current.useId()};jn.useImperativeHandle=function(t,e,n){return Ts.current.useImperativeHandle(t,e,n)};jn.useInsertionEffect=function(t,e){return Ts.current.useInsertionEffect(t,e)};jn.useLayoutEffect=function(t,e){return Ts.current.useLayoutEffect(t,e)};jn.useMemo=function(t,e){return Ts.current.useMemo(t,e)};jn.useReducer=function(t,e,n){return Ts.current.useReducer(t,e,n)};jn.useRef=function(t){return Ts.current.useRef(t)};jn.useState=function(t){return Ts.current.useState(t)};jn.useSyncExternalStore=function(t,e,n){return Ts.current.useSyncExternalStore(t,e,n)};jn.useTransition=function(){return Ts.current.useTransition()};jn.version="18.2.0";uk.exports=jn;var q=uk.exports;const cr=Am(q),fb=lk({__proto__:null,default:cr},[q]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l4=q,c4=Symbol.for("react.element"),u4=Symbol.for("react.fragment"),h4=Object.prototype.hasOwnProperty,d4=l4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f4={key:!0,ref:!0,__self:!0,__source:!0};function _k(t,e,n){var r,i={},o=null,h=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(h=e.ref);for(r in e)h4.call(e,r)&&!f4.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:c4,type:t,key:o,ref:h,props:i,_owner:d4.current}}__.Fragment=u4;__.jsx=_k;__.jsxs=_k;ck.exports=__;var Q=ck.exports,pb={},vk={exports:{}},co={},xk={exports:{}},bk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ke,Ge){var nt=ke.length;ke.push(Ge);e:for(;0<nt;){var Dt=nt-1>>>1,ht=ke[Dt];if(0<i(ht,Ge))ke[Dt]=Ge,ke[nt]=ht,nt=Dt;else break e}}function n(ke){return ke.length===0?null:ke[0]}function r(ke){if(ke.length===0)return null;var Ge=ke[0],nt=ke.pop();if(nt!==Ge){ke[0]=nt;e:for(var Dt=0,ht=ke.length,ot=ht>>>1;Dt<ot;){var ct=2*(Dt+1)-1,xt=ke[ct],bt=ct+1,Jt=ke[bt];if(0>i(xt,nt))bt<ht&&0>i(Jt,xt)?(ke[Dt]=Jt,ke[bt]=nt,Dt=bt):(ke[Dt]=xt,ke[ct]=nt,Dt=ct);else if(bt<ht&&0>i(Jt,nt))ke[Dt]=Jt,ke[bt]=nt,Dt=bt;else break e}}return Ge}function i(ke,Ge){var nt=ke.sortIndex-Ge.sortIndex;return nt!==0?nt:ke.id-Ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var h=Date,l=h.now();t.unstable_now=function(){return h.now()-l}}var m=[],_=[],E=1,T=null,A=3,L=!1,R=!1,D=!1,W=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(ke){for(var Ge=n(_);Ge!==null;){if(Ge.callback===null)r(_);else if(Ge.startTime<=ke)r(_),Ge.sortIndex=Ge.expirationTime,e(m,Ge);else break;Ge=n(_)}}function $(ke){if(D=!1,F(ke),!R)if(n(m)!==null)R=!0,je(K);else{var Ge=n(_);Ge!==null&&tt($,Ge.startTime-ke)}}function K(ke,Ge){R=!1,D&&(D=!1,z(be),be=-1),L=!0;var nt=A;try{for(F(Ge),T=n(m);T!==null&&(!(T.expirationTime>Ge)||ke&&!Re());){var Dt=T.callback;if(typeof Dt=="function"){T.callback=null,A=T.priorityLevel;var ht=Dt(T.expirationTime<=Ge);Ge=t.unstable_now(),typeof ht=="function"?T.callback=ht:T===n(m)&&r(m),F(Ge)}else r(m);T=n(m)}if(T!==null)var ot=!0;else{var ct=n(_);ct!==null&&tt($,ct.startTime-Ge),ot=!1}return ot}finally{T=null,A=nt,L=!1}}var ne=!1,re=null,be=-1,xe=5,fe=-1;function Re(){return!(t.unstable_now()-fe<xe)}function Ve(){if(re!==null){var ke=t.unstable_now();fe=ke;var Ge=!0;try{Ge=re(!0,ke)}finally{Ge?Fe():(ne=!1,re=null)}}else ne=!1}var Fe;if(typeof N=="function")Fe=function(){N(Ve)};else if(typeof MessageChannel<"u"){var ze=new MessageChannel,Ye=ze.port2;ze.port1.onmessage=Ve,Fe=function(){Ye.postMessage(null)}}else Fe=function(){W(Ve,0)};function je(ke){re=ke,ne||(ne=!0,Fe())}function tt(ke,Ge){be=W(function(){ke(t.unstable_now())},Ge)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ke){ke.callback=null},t.unstable_continueExecution=function(){R||L||(R=!0,je(K))},t.unstable_forceFrameRate=function(ke){0>ke||125<ke?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xe=0<ke?Math.floor(1e3/ke):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return n(m)},t.unstable_next=function(ke){switch(A){case 1:case 2:case 3:var Ge=3;break;default:Ge=A}var nt=A;A=Ge;try{return ke()}finally{A=nt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ke,Ge){switch(ke){case 1:case 2:case 3:case 4:case 5:break;default:ke=3}var nt=A;A=ke;try{return Ge()}finally{A=nt}},t.unstable_scheduleCallback=function(ke,Ge,nt){var Dt=t.unstable_now();switch(typeof nt=="object"&&nt!==null?(nt=nt.delay,nt=typeof nt=="number"&&0<nt?Dt+nt:Dt):nt=Dt,ke){case 1:var ht=-1;break;case 2:ht=250;break;case 5:ht=1073741823;break;case 4:ht=1e4;break;default:ht=5e3}return ht=nt+ht,ke={id:E++,callback:Ge,priorityLevel:ke,startTime:nt,expirationTime:ht,sortIndex:-1},nt>Dt?(ke.sortIndex=nt,e(_,ke),n(m)===null&&ke===n(_)&&(D?(z(be),be=-1):D=!0,tt($,nt-Dt))):(ke.sortIndex=ht,e(m,ke),R||L||(R=!0,je(K))),ke},t.unstable_shouldYield=Re,t.unstable_wrapCallback=function(ke){var Ge=A;return function(){var nt=A;A=Ge;try{return ke.apply(this,arguments)}finally{A=nt}}}})(bk);xk.exports=bk;var p4=xk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wk=q,ao=p4;function ut(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ek=new Set,Wp={};function Iu(t,e){fd(t,e),fd(t+"Capture",e)}function fd(t,e){for(Wp[t]=e,t=0;t<e.length;t++)Ek.add(e[t])}var cl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mb=Object.prototype.hasOwnProperty,m4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uP={},hP={};function g4(t){return mb.call(hP,t)?!0:mb.call(uP,t)?!1:m4.test(t)?hP[t]=!0:(uP[t]=!0,!1)}function y4(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function _4(t,e,n,r){if(e===null||typeof e>"u"||y4(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ss(t,e,n,r,i,o,h){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=h}var $i={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$i[t]=new Ss(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$i[e]=new Ss(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$i[t]=new Ss(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$i[t]=new Ss(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$i[t]=new Ss(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$i[t]=new Ss(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$i[t]=new Ss(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$i[t]=new Ss(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$i[t]=new Ss(t,5,!1,t.toLowerCase(),null,!1,!1)});var cE=/[\-:]([a-z])/g;function uE(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cE,uE);$i[e]=new Ss(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cE,uE);$i[e]=new Ss(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cE,uE);$i[e]=new Ss(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$i[t]=new Ss(t,1,!1,t.toLowerCase(),null,!1,!1)});$i.xlinkHref=new Ss("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$i[t]=new Ss(t,1,!1,t.toLowerCase(),null,!0,!0)});function hE(t,e,n,r){var i=$i.hasOwnProperty(e)?$i[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_4(e,n,i,r)&&(n=null),r||i===null?g4(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var vl=wk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ty=Symbol.for("react.element"),Bh=Symbol.for("react.portal"),Uh=Symbol.for("react.fragment"),dE=Symbol.for("react.strict_mode"),gb=Symbol.for("react.profiler"),Tk=Symbol.for("react.provider"),Sk=Symbol.for("react.context"),fE=Symbol.for("react.forward_ref"),yb=Symbol.for("react.suspense"),_b=Symbol.for("react.suspense_list"),pE=Symbol.for("react.memo"),Kl=Symbol.for("react.lazy"),Pk=Symbol.for("react.offscreen"),dP=Symbol.iterator;function qf(t){return t===null||typeof t!="object"?null:(t=dP&&t[dP]||t["@@iterator"],typeof t=="function"?t:null)}var Vr=Object.assign,jx;function _p(t){if(jx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);jx=e&&e[1]||""}return`
`+jx+t}var $x=!1;function Gx(t,e){if(!t||$x)return"";$x=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(_){var r=_}Reflect.construct(t,[],e)}else{try{e.call()}catch(_){r=_}t.call(e.prototype)}else{try{throw Error()}catch(_){r=_}t()}}catch(_){if(_&&r&&typeof _.stack=="string"){for(var i=_.stack.split(`
`),o=r.stack.split(`
`),h=i.length-1,l=o.length-1;1<=h&&0<=l&&i[h]!==o[l];)l--;for(;1<=h&&0<=l;h--,l--)if(i[h]!==o[l]){if(h!==1||l!==1)do if(h--,l--,0>l||i[h]!==o[l]){var m=`
`+i[h].replace(" at new "," at ");return t.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",t.displayName)),m}while(1<=h&&0<=l);break}}}finally{$x=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?_p(t):""}function v4(t){switch(t.tag){case 5:return _p(t.type);case 16:return _p("Lazy");case 13:return _p("Suspense");case 19:return _p("SuspenseList");case 0:case 2:case 15:return t=Gx(t.type,!1),t;case 11:return t=Gx(t.type.render,!1),t;case 1:return t=Gx(t.type,!0),t;default:return""}}function vb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Uh:return"Fragment";case Bh:return"Portal";case gb:return"Profiler";case dE:return"StrictMode";case yb:return"Suspense";case _b:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Sk:return(t.displayName||"Context")+".Consumer";case Tk:return(t._context.displayName||"Context")+".Provider";case fE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pE:return e=t.displayName||null,e!==null?e:vb(t.type)||"Memo";case Kl:e=t._payload,t=t._init;try{return vb(t(e))}catch{}}return null}function x4(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vb(e);case 8:return e===dE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function xc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ck(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function b4(t){var e=Ck(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(h){r=""+h,o.call(this,h)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(h){r=""+h},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ny(t){t._valueTracker||(t._valueTracker=b4(t))}function Ak(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Ck(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function b0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function xb(t,e){var n=e.checked;return Vr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function fP(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=xc(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ik(t,e){e=e.checked,e!=null&&hE(t,"checked",e,!1)}function bb(t,e){Ik(t,e);var n=xc(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?wb(t,e.type,n):e.hasOwnProperty("defaultValue")&&wb(t,e.type,xc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function pP(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function wb(t,e,n){(e!=="number"||b0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var vp=Array.isArray;function td(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+xc(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Eb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ut(91));return Vr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function mP(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ut(92));if(vp(n)){if(1<n.length)throw Error(ut(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:xc(n)}}function Mk(t,e){var n=xc(e.value),r=xc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function gP(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function kk(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?kk(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ry,Lk=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ry=ry||document.createElement("div"),ry.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ry.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Hp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Cp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w4=["Webkit","ms","Moz","O"];Object.keys(Cp).forEach(function(t){w4.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Cp[e]=Cp[t]})});function Rk(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Cp.hasOwnProperty(t)&&Cp[t]?(""+e).trim():e+"px"}function Ok(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Rk(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var E4=Vr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sb(t,e){if(e){if(E4[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ut(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ut(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ut(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ut(62))}}function Pb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cb=null;function mE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ab=null,nd=null,rd=null;function yP(t){if(t=Lm(t)){if(typeof Ab!="function")throw Error(ut(280));var e=t.stateNode;e&&(e=E_(e),Ab(t.stateNode,t.type,e))}}function zk(t){nd?rd?rd.push(t):rd=[t]:nd=t}function Dk(){if(nd){var t=nd,e=rd;if(rd=nd=null,yP(t),e)for(t=0;t<e.length;t++)yP(e[t])}}function Fk(t,e){return t(e)}function Nk(){}var Wx=!1;function Bk(t,e,n){if(Wx)return t(e,n);Wx=!0;try{return Fk(t,e,n)}finally{Wx=!1,(nd!==null||rd!==null)&&(Nk(),Dk())}}function qp(t,e){var n=t.stateNode;if(n===null)return null;var r=E_(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ut(231,e,typeof n));return n}var Ib=!1;if(cl)try{var Zf={};Object.defineProperty(Zf,"passive",{get:function(){Ib=!0}}),window.addEventListener("test",Zf,Zf),window.removeEventListener("test",Zf,Zf)}catch{Ib=!1}function T4(t,e,n,r,i,o,h,l,m){var _=Array.prototype.slice.call(arguments,3);try{e.apply(n,_)}catch(E){this.onError(E)}}var Ap=!1,w0=null,E0=!1,Mb=null,S4={onError:function(t){Ap=!0,w0=t}};function P4(t,e,n,r,i,o,h,l,m){Ap=!1,w0=null,T4.apply(S4,arguments)}function C4(t,e,n,r,i,o,h,l,m){if(P4.apply(this,arguments),Ap){if(Ap){var _=w0;Ap=!1,w0=null}else throw Error(ut(198));E0||(E0=!0,Mb=_)}}function Mu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Uk(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _P(t){if(Mu(t)!==t)throw Error(ut(188))}function A4(t){var e=t.alternate;if(!e){if(e=Mu(t),e===null)throw Error(ut(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return _P(i),t;if(o===r)return _P(i),e;o=o.sibling}throw Error(ut(188))}if(n.return!==r.return)n=i,r=o;else{for(var h=!1,l=i.child;l;){if(l===n){h=!0,n=i,r=o;break}if(l===r){h=!0,r=i,n=o;break}l=l.sibling}if(!h){for(l=o.child;l;){if(l===n){h=!0,n=o,r=i;break}if(l===r){h=!0,r=o,n=i;break}l=l.sibling}if(!h)throw Error(ut(189))}}if(n.alternate!==r)throw Error(ut(190))}if(n.tag!==3)throw Error(ut(188));return n.stateNode.current===n?t:e}function Vk(t){return t=A4(t),t!==null?jk(t):null}function jk(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=jk(t);if(e!==null)return e;t=t.sibling}return null}var $k=ao.unstable_scheduleCallback,vP=ao.unstable_cancelCallback,I4=ao.unstable_shouldYield,M4=ao.unstable_requestPaint,ai=ao.unstable_now,k4=ao.unstable_getCurrentPriorityLevel,gE=ao.unstable_ImmediatePriority,Gk=ao.unstable_UserBlockingPriority,T0=ao.unstable_NormalPriority,L4=ao.unstable_LowPriority,Wk=ao.unstable_IdlePriority,v_=null,ka=null;function R4(t){if(ka&&typeof ka.onCommitFiberRoot=="function")try{ka.onCommitFiberRoot(v_,t,void 0,(t.current.flags&128)===128)}catch{}}var ia=Math.clz32?Math.clz32:D4,O4=Math.log,z4=Math.LN2;function D4(t){return t>>>=0,t===0?32:31-(O4(t)/z4|0)|0}var iy=64,sy=4194304;function xp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function S0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,h=n&268435455;if(h!==0){var l=h&~i;l!==0?r=xp(l):(o&=h,o!==0&&(r=xp(o)))}else h=n&~i,h!==0?r=xp(h):o!==0&&(r=xp(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ia(e),i=1<<n,r|=t[n],e&=~i;return r}function F4(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function N4(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var h=31-ia(o),l=1<<h,m=i[h];m===-1?(!(l&n)||l&r)&&(i[h]=F4(l,e)):m<=e&&(t.expiredLanes|=l),o&=~l}}function kb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Hk(){var t=iy;return iy<<=1,!(iy&4194240)&&(iy=64),t}function Hx(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Mm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ia(e),t[e]=n}function B4(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-ia(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function yE(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ia(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var nr=0;function qk(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Zk,_E,Xk,Yk,Kk,Lb=!1,oy=[],cc=null,uc=null,hc=null,Zp=new Map,Xp=new Map,Ql=[],U4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xP(t,e){switch(t){case"focusin":case"focusout":cc=null;break;case"dragenter":case"dragleave":uc=null;break;case"mouseover":case"mouseout":hc=null;break;case"pointerover":case"pointerout":Zp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xp.delete(e.pointerId)}}function Xf(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Lm(e),e!==null&&_E(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function V4(t,e,n,r,i){switch(e){case"focusin":return cc=Xf(cc,t,e,n,r,i),!0;case"dragenter":return uc=Xf(uc,t,e,n,r,i),!0;case"mouseover":return hc=Xf(hc,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Zp.set(o,Xf(Zp.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Xp.set(o,Xf(Xp.get(o)||null,t,e,n,r,i)),!0}return!1}function Jk(t){var e=au(t.target);if(e!==null){var n=Mu(e);if(n!==null){if(e=n.tag,e===13){if(e=Uk(n),e!==null){t.blockedOn=e,Kk(t.priority,function(){Xk(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ky(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Rb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Cb=r,n.target.dispatchEvent(r),Cb=null}else return e=Lm(n),e!==null&&_E(e),t.blockedOn=n,!1;e.shift()}return!0}function bP(t,e,n){Ky(t)&&n.delete(e)}function j4(){Lb=!1,cc!==null&&Ky(cc)&&(cc=null),uc!==null&&Ky(uc)&&(uc=null),hc!==null&&Ky(hc)&&(hc=null),Zp.forEach(bP),Xp.forEach(bP)}function Yf(t,e){t.blockedOn===e&&(t.blockedOn=null,Lb||(Lb=!0,ao.unstable_scheduleCallback(ao.unstable_NormalPriority,j4)))}function Yp(t){function e(i){return Yf(i,t)}if(0<oy.length){Yf(oy[0],t);for(var n=1;n<oy.length;n++){var r=oy[n];r.blockedOn===t&&(r.blockedOn=null)}}for(cc!==null&&Yf(cc,t),uc!==null&&Yf(uc,t),hc!==null&&Yf(hc,t),Zp.forEach(e),Xp.forEach(e),n=0;n<Ql.length;n++)r=Ql[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ql.length&&(n=Ql[0],n.blockedOn===null);)Jk(n),n.blockedOn===null&&Ql.shift()}var id=vl.ReactCurrentBatchConfig,P0=!0;function $4(t,e,n,r){var i=nr,o=id.transition;id.transition=null;try{nr=1,vE(t,e,n,r)}finally{nr=i,id.transition=o}}function G4(t,e,n,r){var i=nr,o=id.transition;id.transition=null;try{nr=4,vE(t,e,n,r)}finally{nr=i,id.transition=o}}function vE(t,e,n,r){if(P0){var i=Rb(t,e,n,r);if(i===null)n1(t,e,r,C0,n),xP(t,r);else if(V4(i,t,e,n,r))r.stopPropagation();else if(xP(t,r),e&4&&-1<U4.indexOf(t)){for(;i!==null;){var o=Lm(i);if(o!==null&&Zk(o),o=Rb(t,e,n,r),o===null&&n1(t,e,r,C0,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else n1(t,e,r,null,n)}}var C0=null;function Rb(t,e,n,r){if(C0=null,t=mE(r),t=au(t),t!==null)if(e=Mu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Uk(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return C0=t,null}function Qk(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(k4()){case gE:return 1;case Gk:return 4;case T0:case L4:return 16;case Wk:return 536870912;default:return 16}default:return 16}}var tc=null,xE=null,Jy=null;function eL(){if(Jy)return Jy;var t,e=xE,n=e.length,r,i="value"in tc?tc.value:tc.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var h=n-t;for(r=1;r<=h&&e[n-r]===i[o-r];r++);return Jy=i.slice(t,1<r?1-r:void 0)}function Qy(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ay(){return!0}function wP(){return!1}function uo(t){function e(n,r,i,o,h){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=h,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?ay:wP,this.isPropagationStopped=wP,this}return Vr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ay)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ay)},persist:function(){},isPersistent:ay}),e}var Ud={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bE=uo(Ud),km=Vr({},Ud,{view:0,detail:0}),W4=uo(km),qx,Zx,Kf,x_=Vr({},km,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wE,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Kf&&(Kf&&t.type==="mousemove"?(qx=t.screenX-Kf.screenX,Zx=t.screenY-Kf.screenY):Zx=qx=0,Kf=t),qx)},movementY:function(t){return"movementY"in t?t.movementY:Zx}}),EP=uo(x_),H4=Vr({},x_,{dataTransfer:0}),q4=uo(H4),Z4=Vr({},km,{relatedTarget:0}),Xx=uo(Z4),X4=Vr({},Ud,{animationName:0,elapsedTime:0,pseudoElement:0}),Y4=uo(X4),K4=Vr({},Ud,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),J4=uo(K4),Q4=Vr({},Ud,{data:0}),TP=uo(Q4),e5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},t5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},n5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function r5(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=n5[t])?!!e[t]:!1}function wE(){return r5}var i5=Vr({},km,{key:function(t){if(t.key){var e=e5[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Qy(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?t5[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wE,charCode:function(t){return t.type==="keypress"?Qy(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Qy(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),s5=uo(i5),o5=Vr({},x_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),SP=uo(o5),a5=Vr({},km,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wE}),l5=uo(a5),c5=Vr({},Ud,{propertyName:0,elapsedTime:0,pseudoElement:0}),u5=uo(c5),h5=Vr({},x_,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),d5=uo(h5),f5=[9,13,27,32],EE=cl&&"CompositionEvent"in window,Ip=null;cl&&"documentMode"in document&&(Ip=document.documentMode);var p5=cl&&"TextEvent"in window&&!Ip,tL=cl&&(!EE||Ip&&8<Ip&&11>=Ip),PP=String.fromCharCode(32),CP=!1;function nL(t,e){switch(t){case"keyup":return f5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rL(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vh=!1;function m5(t,e){switch(t){case"compositionend":return rL(e);case"keypress":return e.which!==32?null:(CP=!0,PP);case"textInput":return t=e.data,t===PP&&CP?null:t;default:return null}}function g5(t,e){if(Vh)return t==="compositionend"||!EE&&nL(t,e)?(t=eL(),Jy=xE=tc=null,Vh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return tL&&e.locale!=="ko"?null:e.data;default:return null}}var y5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function AP(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!y5[t.type]:e==="textarea"}function iL(t,e,n,r){zk(r),e=A0(e,"onChange"),0<e.length&&(n=new bE("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Mp=null,Kp=null;function _5(t){mL(t,0)}function b_(t){var e=Gh(t);if(Ak(e))return t}function v5(t,e){if(t==="change")return e}var sL=!1;if(cl){var Yx;if(cl){var Kx="oninput"in document;if(!Kx){var IP=document.createElement("div");IP.setAttribute("oninput","return;"),Kx=typeof IP.oninput=="function"}Yx=Kx}else Yx=!1;sL=Yx&&(!document.documentMode||9<document.documentMode)}function MP(){Mp&&(Mp.detachEvent("onpropertychange",oL),Kp=Mp=null)}function oL(t){if(t.propertyName==="value"&&b_(Kp)){var e=[];iL(e,Kp,t,mE(t)),Bk(_5,e)}}function x5(t,e,n){t==="focusin"?(MP(),Mp=e,Kp=n,Mp.attachEvent("onpropertychange",oL)):t==="focusout"&&MP()}function b5(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return b_(Kp)}function w5(t,e){if(t==="click")return b_(e)}function E5(t,e){if(t==="input"||t==="change")return b_(e)}function T5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var aa=typeof Object.is=="function"?Object.is:T5;function Jp(t,e){if(aa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!mb.call(e,i)||!aa(t[i],e[i]))return!1}return!0}function kP(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function LP(t,e){var n=kP(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=kP(n)}}function aL(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?aL(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function lL(){for(var t=window,e=b0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=b0(t.document)}return e}function TE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function S5(t){var e=lL(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&aL(n.ownerDocument.documentElement,n)){if(r!==null&&TE(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=LP(n,o);var h=LP(n,r);i&&h&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==h.node||t.focusOffset!==h.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(h.node,h.offset)):(e.setEnd(h.node,h.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var P5=cl&&"documentMode"in document&&11>=document.documentMode,jh=null,Ob=null,kp=null,zb=!1;function RP(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;zb||jh==null||jh!==b0(r)||(r=jh,"selectionStart"in r&&TE(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),kp&&Jp(kp,r)||(kp=r,r=A0(Ob,"onSelect"),0<r.length&&(e=new bE("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=jh)))}function ly(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var $h={animationend:ly("Animation","AnimationEnd"),animationiteration:ly("Animation","AnimationIteration"),animationstart:ly("Animation","AnimationStart"),transitionend:ly("Transition","TransitionEnd")},Jx={},cL={};cl&&(cL=document.createElement("div").style,"AnimationEvent"in window||(delete $h.animationend.animation,delete $h.animationiteration.animation,delete $h.animationstart.animation),"TransitionEvent"in window||delete $h.transitionend.transition);function w_(t){if(Jx[t])return Jx[t];if(!$h[t])return t;var e=$h[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in cL)return Jx[t]=e[n];return t}var uL=w_("animationend"),hL=w_("animationiteration"),dL=w_("animationstart"),fL=w_("transitionend"),pL=new Map,OP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tc(t,e){pL.set(t,e),Iu(e,[t])}for(var Qx=0;Qx<OP.length;Qx++){var e1=OP[Qx],C5=e1.toLowerCase(),A5=e1[0].toUpperCase()+e1.slice(1);Tc(C5,"on"+A5)}Tc(uL,"onAnimationEnd");Tc(hL,"onAnimationIteration");Tc(dL,"onAnimationStart");Tc("dblclick","onDoubleClick");Tc("focusin","onFocus");Tc("focusout","onBlur");Tc(fL,"onTransitionEnd");fd("onMouseEnter",["mouseout","mouseover"]);fd("onMouseLeave",["mouseout","mouseover"]);fd("onPointerEnter",["pointerout","pointerover"]);fd("onPointerLeave",["pointerout","pointerover"]);Iu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Iu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Iu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Iu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Iu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Iu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I5=new Set("cancel close invalid load scroll toggle".split(" ").concat(bp));function zP(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,C4(r,e,void 0,t),t.currentTarget=null}function mL(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var h=r.length-1;0<=h;h--){var l=r[h],m=l.instance,_=l.currentTarget;if(l=l.listener,m!==o&&i.isPropagationStopped())break e;zP(i,l,_),o=m}else for(h=0;h<r.length;h++){if(l=r[h],m=l.instance,_=l.currentTarget,l=l.listener,m!==o&&i.isPropagationStopped())break e;zP(i,l,_),o=m}}}if(E0)throw t=Mb,E0=!1,Mb=null,t}function Tr(t,e){var n=e[Ub];n===void 0&&(n=e[Ub]=new Set);var r=t+"__bubble";n.has(r)||(gL(e,t,2,!1),n.add(r))}function t1(t,e,n){var r=0;e&&(r|=4),gL(n,t,r,e)}var cy="_reactListening"+Math.random().toString(36).slice(2);function Qp(t){if(!t[cy]){t[cy]=!0,Ek.forEach(function(n){n!=="selectionchange"&&(I5.has(n)||t1(n,!1,t),t1(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[cy]||(e[cy]=!0,t1("selectionchange",!1,e))}}function gL(t,e,n,r){switch(Qk(e)){case 1:var i=$4;break;case 4:i=G4;break;default:i=vE}n=i.bind(null,e,n,t),i=void 0,!Ib||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function n1(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var h=r.tag;if(h===3||h===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(h===4)for(h=r.return;h!==null;){var m=h.tag;if((m===3||m===4)&&(m=h.stateNode.containerInfo,m===i||m.nodeType===8&&m.parentNode===i))return;h=h.return}for(;l!==null;){if(h=au(l),h===null)return;if(m=h.tag,m===5||m===6){r=o=h;continue e}l=l.parentNode}}r=r.return}Bk(function(){var _=o,E=mE(n),T=[];e:{var A=pL.get(t);if(A!==void 0){var L=bE,R=t;switch(t){case"keypress":if(Qy(n)===0)break e;case"keydown":case"keyup":L=s5;break;case"focusin":R="focus",L=Xx;break;case"focusout":R="blur",L=Xx;break;case"beforeblur":case"afterblur":L=Xx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":L=EP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":L=q4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":L=l5;break;case uL:case hL:case dL:L=Y4;break;case fL:L=u5;break;case"scroll":L=W4;break;case"wheel":L=d5;break;case"copy":case"cut":case"paste":L=J4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":L=SP}var D=(e&4)!==0,W=!D&&t==="scroll",z=D?A!==null?A+"Capture":null:A;D=[];for(var N=_,F;N!==null;){F=N;var $=F.stateNode;if(F.tag===5&&$!==null&&(F=$,z!==null&&($=qp(N,z),$!=null&&D.push(em(N,$,F)))),W)break;N=N.return}0<D.length&&(A=new L(A,R,null,n,E),T.push({event:A,listeners:D}))}}if(!(e&7)){e:{if(A=t==="mouseover"||t==="pointerover",L=t==="mouseout"||t==="pointerout",A&&n!==Cb&&(R=n.relatedTarget||n.fromElement)&&(au(R)||R[ul]))break e;if((L||A)&&(A=E.window===E?E:(A=E.ownerDocument)?A.defaultView||A.parentWindow:window,L?(R=n.relatedTarget||n.toElement,L=_,R=R?au(R):null,R!==null&&(W=Mu(R),R!==W||R.tag!==5&&R.tag!==6)&&(R=null)):(L=null,R=_),L!==R)){if(D=EP,$="onMouseLeave",z="onMouseEnter",N="mouse",(t==="pointerout"||t==="pointerover")&&(D=SP,$="onPointerLeave",z="onPointerEnter",N="pointer"),W=L==null?A:Gh(L),F=R==null?A:Gh(R),A=new D($,N+"leave",L,n,E),A.target=W,A.relatedTarget=F,$=null,au(E)===_&&(D=new D(z,N+"enter",R,n,E),D.target=F,D.relatedTarget=W,$=D),W=$,L&&R)t:{for(D=L,z=R,N=0,F=D;F;F=_h(F))N++;for(F=0,$=z;$;$=_h($))F++;for(;0<N-F;)D=_h(D),N--;for(;0<F-N;)z=_h(z),F--;for(;N--;){if(D===z||z!==null&&D===z.alternate)break t;D=_h(D),z=_h(z)}D=null}else D=null;L!==null&&DP(T,A,L,D,!1),R!==null&&W!==null&&DP(T,W,R,D,!0)}}e:{if(A=_?Gh(_):window,L=A.nodeName&&A.nodeName.toLowerCase(),L==="select"||L==="input"&&A.type==="file")var K=v5;else if(AP(A))if(sL)K=E5;else{K=b5;var ne=x5}else(L=A.nodeName)&&L.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(K=w5);if(K&&(K=K(t,_))){iL(T,K,n,E);break e}ne&&ne(t,A,_),t==="focusout"&&(ne=A._wrapperState)&&ne.controlled&&A.type==="number"&&wb(A,"number",A.value)}switch(ne=_?Gh(_):window,t){case"focusin":(AP(ne)||ne.contentEditable==="true")&&(jh=ne,Ob=_,kp=null);break;case"focusout":kp=Ob=jh=null;break;case"mousedown":zb=!0;break;case"contextmenu":case"mouseup":case"dragend":zb=!1,RP(T,n,E);break;case"selectionchange":if(P5)break;case"keydown":case"keyup":RP(T,n,E)}var re;if(EE)e:{switch(t){case"compositionstart":var be="onCompositionStart";break e;case"compositionend":be="onCompositionEnd";break e;case"compositionupdate":be="onCompositionUpdate";break e}be=void 0}else Vh?nL(t,n)&&(be="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(be="onCompositionStart");be&&(tL&&n.locale!=="ko"&&(Vh||be!=="onCompositionStart"?be==="onCompositionEnd"&&Vh&&(re=eL()):(tc=E,xE="value"in tc?tc.value:tc.textContent,Vh=!0)),ne=A0(_,be),0<ne.length&&(be=new TP(be,t,null,n,E),T.push({event:be,listeners:ne}),re?be.data=re:(re=rL(n),re!==null&&(be.data=re)))),(re=p5?m5(t,n):g5(t,n))&&(_=A0(_,"onBeforeInput"),0<_.length&&(E=new TP("onBeforeInput","beforeinput",null,n,E),T.push({event:E,listeners:_}),E.data=re))}mL(T,e)})}function em(t,e,n){return{instance:t,listener:e,currentTarget:n}}function A0(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=qp(t,n),o!=null&&r.unshift(em(t,o,i)),o=qp(t,e),o!=null&&r.push(em(t,o,i))),t=t.return}return r}function _h(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function DP(t,e,n,r,i){for(var o=e._reactName,h=[];n!==null&&n!==r;){var l=n,m=l.alternate,_=l.stateNode;if(m!==null&&m===r)break;l.tag===5&&_!==null&&(l=_,i?(m=qp(n,o),m!=null&&h.unshift(em(n,m,l))):i||(m=qp(n,o),m!=null&&h.push(em(n,m,l)))),n=n.return}h.length!==0&&t.push({event:e,listeners:h})}var M5=/\r\n?/g,k5=/\u0000|\uFFFD/g;function FP(t){return(typeof t=="string"?t:""+t).replace(M5,`
`).replace(k5,"")}function uy(t,e,n){if(e=FP(e),FP(t)!==e&&n)throw Error(ut(425))}function I0(){}var Db=null,Fb=null;function Nb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Bb=typeof setTimeout=="function"?setTimeout:void 0,L5=typeof clearTimeout=="function"?clearTimeout:void 0,NP=typeof Promise=="function"?Promise:void 0,R5=typeof queueMicrotask=="function"?queueMicrotask:typeof NP<"u"?function(t){return NP.resolve(null).then(t).catch(O5)}:Bb;function O5(t){setTimeout(function(){throw t})}function r1(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Yp(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Yp(e)}function dc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function BP(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Vd=Math.random().toString(36).slice(2),Pa="__reactFiber$"+Vd,tm="__reactProps$"+Vd,ul="__reactContainer$"+Vd,Ub="__reactEvents$"+Vd,z5="__reactListeners$"+Vd,D5="__reactHandles$"+Vd;function au(t){var e=t[Pa];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ul]||n[Pa]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=BP(t);t!==null;){if(n=t[Pa])return n;t=BP(t)}return e}t=n,n=t.parentNode}return null}function Lm(t){return t=t[Pa]||t[ul],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Gh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ut(33))}function E_(t){return t[tm]||null}var Vb=[],Wh=-1;function Sc(t){return{current:t}}function Pr(t){0>Wh||(t.current=Vb[Wh],Vb[Wh]=null,Wh--)}function vr(t,e){Wh++,Vb[Wh]=t.current,t.current=e}var bc={},as=Sc(bc),Os=Sc(!1),_u=bc;function pd(t,e){var n=t.type.contextTypes;if(!n)return bc;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function zs(t){return t=t.childContextTypes,t!=null}function M0(){Pr(Os),Pr(as)}function UP(t,e,n){if(as.current!==bc)throw Error(ut(168));vr(as,e),vr(Os,n)}function yL(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ut(108,x4(t)||"Unknown",i));return Vr({},n,r)}function k0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||bc,_u=as.current,vr(as,t),vr(Os,Os.current),!0}function VP(t,e,n){var r=t.stateNode;if(!r)throw Error(ut(169));n?(t=yL(t,e,_u),r.__reactInternalMemoizedMergedChildContext=t,Pr(Os),Pr(as),vr(as,t)):Pr(Os),vr(Os,n)}var nl=null,T_=!1,i1=!1;function _L(t){nl===null?nl=[t]:nl.push(t)}function F5(t){T_=!0,_L(t)}function Pc(){if(!i1&&nl!==null){i1=!0;var t=0,e=nr;try{var n=nl;for(nr=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}nl=null,T_=!1}catch(i){throw nl!==null&&(nl=nl.slice(t+1)),$k(gE,Pc),i}finally{nr=e,i1=!1}}return null}var Hh=[],qh=0,L0=null,R0=0,Co=[],Ao=0,vu=null,ol=1,al="";function tu(t,e){Hh[qh++]=R0,Hh[qh++]=L0,L0=t,R0=e}function vL(t,e,n){Co[Ao++]=ol,Co[Ao++]=al,Co[Ao++]=vu,vu=t;var r=ol;t=al;var i=32-ia(r)-1;r&=~(1<<i),n+=1;var o=32-ia(e)+i;if(30<o){var h=i-i%5;o=(r&(1<<h)-1).toString(32),r>>=h,i-=h,ol=1<<32-ia(e)+i|n<<i|r,al=o+t}else ol=1<<o|n<<i|r,al=t}function SE(t){t.return!==null&&(tu(t,1),vL(t,1,0))}function PE(t){for(;t===L0;)L0=Hh[--qh],Hh[qh]=null,R0=Hh[--qh],Hh[qh]=null;for(;t===vu;)vu=Co[--Ao],Co[Ao]=null,al=Co[--Ao],Co[Ao]=null,ol=Co[--Ao],Co[Ao]=null}var io=null,to=null,Or=!1,ea=null;function xL(t,e){var n=Io(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function jP(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,io=t,to=dc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,io=t,to=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=vu!==null?{id:ol,overflow:al}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Io(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,io=t,to=null,!0):!1;default:return!1}}function jb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function $b(t){if(Or){var e=to;if(e){var n=e;if(!jP(t,e)){if(jb(t))throw Error(ut(418));e=dc(n.nextSibling);var r=io;e&&jP(t,e)?xL(r,n):(t.flags=t.flags&-4097|2,Or=!1,io=t)}}else{if(jb(t))throw Error(ut(418));t.flags=t.flags&-4097|2,Or=!1,io=t}}}function $P(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;io=t}function hy(t){if(t!==io)return!1;if(!Or)return $P(t),Or=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Nb(t.type,t.memoizedProps)),e&&(e=to)){if(jb(t))throw bL(),Error(ut(418));for(;e;)xL(t,e),e=dc(e.nextSibling)}if($P(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ut(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){to=dc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}to=null}}else to=io?dc(t.stateNode.nextSibling):null;return!0}function bL(){for(var t=to;t;)t=dc(t.nextSibling)}function md(){to=io=null,Or=!1}function CE(t){ea===null?ea=[t]:ea.push(t)}var N5=vl.ReactCurrentBatchConfig;function Jo(t,e){if(t&&t.defaultProps){e=Vr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var O0=Sc(null),z0=null,Zh=null,AE=null;function IE(){AE=Zh=z0=null}function ME(t){var e=O0.current;Pr(O0),t._currentValue=e}function Gb(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function sd(t,e){z0=t,AE=Zh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Rs=!0),t.firstContext=null)}function Ro(t){var e=t._currentValue;if(AE!==t)if(t={context:t,memoizedValue:e,next:null},Zh===null){if(z0===null)throw Error(ut(308));Zh=t,z0.dependencies={lanes:0,firstContext:t}}else Zh=Zh.next=t;return e}var lu=null;function kE(t){lu===null?lu=[t]:lu.push(t)}function wL(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,kE(e)):(n.next=i.next,i.next=n),e.interleaved=n,hl(t,r)}function hl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Jl=!1;function LE(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function EL(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ll(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function fc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Wn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,hl(t,n)}return i=r.interleaved,i===null?(e.next=e,kE(r)):(e.next=i.next,i.next=e),r.interleaved=e,hl(t,n)}function e0(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yE(t,n)}}function GP(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var h={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=h:o=o.next=h,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function D0(t,e,n,r){var i=t.updateQueue;Jl=!1;var o=i.firstBaseUpdate,h=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var m=l,_=m.next;m.next=null,h===null?o=_:h.next=_,h=m;var E=t.alternate;E!==null&&(E=E.updateQueue,l=E.lastBaseUpdate,l!==h&&(l===null?E.firstBaseUpdate=_:l.next=_,E.lastBaseUpdate=m))}if(o!==null){var T=i.baseState;h=0,E=_=m=null,l=o;do{var A=l.lane,L=l.eventTime;if((r&A)===A){E!==null&&(E=E.next={eventTime:L,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,D=l;switch(A=e,L=n,D.tag){case 1:if(R=D.payload,typeof R=="function"){T=R.call(L,T,A);break e}T=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=D.payload,A=typeof R=="function"?R.call(L,T,A):R,A==null)break e;T=Vr({},T,A);break e;case 2:Jl=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,A=i.effects,A===null?i.effects=[l]:A.push(l))}else L={eventTime:L,lane:A,tag:l.tag,payload:l.payload,callback:l.callback,next:null},E===null?(_=E=L,m=T):E=E.next=L,h|=A;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;A=l,l=A.next,A.next=null,i.lastBaseUpdate=A,i.shared.pending=null}}while(1);if(E===null&&(m=T),i.baseState=m,i.firstBaseUpdate=_,i.lastBaseUpdate=E,e=i.shared.interleaved,e!==null){i=e;do h|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);bu|=h,t.lanes=h,t.memoizedState=T}}function WP(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ut(191,i));i.call(r)}}}var TL=new wk.Component().refs;function Wb(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Vr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var S_={isMounted:function(t){return(t=t._reactInternals)?Mu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Es(),i=mc(t),o=ll(r,i);o.payload=e,n!=null&&(o.callback=n),e=fc(t,o,i),e!==null&&(sa(e,t,i,r),e0(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Es(),i=mc(t),o=ll(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=fc(t,o,i),e!==null&&(sa(e,t,i,r),e0(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Es(),r=mc(t),i=ll(n,r);i.tag=2,e!=null&&(i.callback=e),e=fc(t,i,r),e!==null&&(sa(e,t,r,n),e0(e,t,r))}};function HP(t,e,n,r,i,o,h){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,h):e.prototype&&e.prototype.isPureReactComponent?!Jp(n,r)||!Jp(i,o):!0}function SL(t,e,n){var r=!1,i=bc,o=e.contextType;return typeof o=="object"&&o!==null?o=Ro(o):(i=zs(e)?_u:as.current,r=e.contextTypes,o=(r=r!=null)?pd(t,i):bc),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=S_,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function qP(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&S_.enqueueReplaceState(e,e.state,null)}function Hb(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=TL,LE(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Ro(o):(o=zs(e)?_u:as.current,i.context=pd(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Wb(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&S_.enqueueReplaceState(i,i.state,null),D0(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Jf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ut(309));var r=n.stateNode}if(!r)throw Error(ut(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(h){var l=i.refs;l===TL&&(l=i.refs={}),h===null?delete l[o]:l[o]=h},e._stringRef=o,e)}if(typeof t!="string")throw Error(ut(284));if(!n._owner)throw Error(ut(290,t))}return t}function dy(t,e){throw t=Object.prototype.toString.call(e),Error(ut(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ZP(t){var e=t._init;return e(t._payload)}function PL(t){function e(z,N){if(t){var F=z.deletions;F===null?(z.deletions=[N],z.flags|=16):F.push(N)}}function n(z,N){if(!t)return null;for(;N!==null;)e(z,N),N=N.sibling;return null}function r(z,N){for(z=new Map;N!==null;)N.key!==null?z.set(N.key,N):z.set(N.index,N),N=N.sibling;return z}function i(z,N){return z=gc(z,N),z.index=0,z.sibling=null,z}function o(z,N,F){return z.index=F,t?(F=z.alternate,F!==null?(F=F.index,F<N?(z.flags|=2,N):F):(z.flags|=2,N)):(z.flags|=1048576,N)}function h(z){return t&&z.alternate===null&&(z.flags|=2),z}function l(z,N,F,$){return N===null||N.tag!==6?(N=h1(F,z.mode,$),N.return=z,N):(N=i(N,F),N.return=z,N)}function m(z,N,F,$){var K=F.type;return K===Uh?E(z,N,F.props.children,$,F.key):N!==null&&(N.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Kl&&ZP(K)===N.type)?($=i(N,F.props),$.ref=Jf(z,N,F),$.return=z,$):($=o0(F.type,F.key,F.props,null,z.mode,$),$.ref=Jf(z,N,F),$.return=z,$)}function _(z,N,F,$){return N===null||N.tag!==4||N.stateNode.containerInfo!==F.containerInfo||N.stateNode.implementation!==F.implementation?(N=d1(F,z.mode,$),N.return=z,N):(N=i(N,F.children||[]),N.return=z,N)}function E(z,N,F,$,K){return N===null||N.tag!==7?(N=pu(F,z.mode,$,K),N.return=z,N):(N=i(N,F),N.return=z,N)}function T(z,N,F){if(typeof N=="string"&&N!==""||typeof N=="number")return N=h1(""+N,z.mode,F),N.return=z,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case ty:return F=o0(N.type,N.key,N.props,null,z.mode,F),F.ref=Jf(z,null,N),F.return=z,F;case Bh:return N=d1(N,z.mode,F),N.return=z,N;case Kl:var $=N._init;return T(z,$(N._payload),F)}if(vp(N)||qf(N))return N=pu(N,z.mode,F,null),N.return=z,N;dy(z,N)}return null}function A(z,N,F,$){var K=N!==null?N.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return K!==null?null:l(z,N,""+F,$);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case ty:return F.key===K?m(z,N,F,$):null;case Bh:return F.key===K?_(z,N,F,$):null;case Kl:return K=F._init,A(z,N,K(F._payload),$)}if(vp(F)||qf(F))return K!==null?null:E(z,N,F,$,null);dy(z,F)}return null}function L(z,N,F,$,K){if(typeof $=="string"&&$!==""||typeof $=="number")return z=z.get(F)||null,l(N,z,""+$,K);if(typeof $=="object"&&$!==null){switch($.$$typeof){case ty:return z=z.get($.key===null?F:$.key)||null,m(N,z,$,K);case Bh:return z=z.get($.key===null?F:$.key)||null,_(N,z,$,K);case Kl:var ne=$._init;return L(z,N,F,ne($._payload),K)}if(vp($)||qf($))return z=z.get(F)||null,E(N,z,$,K,null);dy(N,$)}return null}function R(z,N,F,$){for(var K=null,ne=null,re=N,be=N=0,xe=null;re!==null&&be<F.length;be++){re.index>be?(xe=re,re=null):xe=re.sibling;var fe=A(z,re,F[be],$);if(fe===null){re===null&&(re=xe);break}t&&re&&fe.alternate===null&&e(z,re),N=o(fe,N,be),ne===null?K=fe:ne.sibling=fe,ne=fe,re=xe}if(be===F.length)return n(z,re),Or&&tu(z,be),K;if(re===null){for(;be<F.length;be++)re=T(z,F[be],$),re!==null&&(N=o(re,N,be),ne===null?K=re:ne.sibling=re,ne=re);return Or&&tu(z,be),K}for(re=r(z,re);be<F.length;be++)xe=L(re,z,be,F[be],$),xe!==null&&(t&&xe.alternate!==null&&re.delete(xe.key===null?be:xe.key),N=o(xe,N,be),ne===null?K=xe:ne.sibling=xe,ne=xe);return t&&re.forEach(function(Re){return e(z,Re)}),Or&&tu(z,be),K}function D(z,N,F,$){var K=qf(F);if(typeof K!="function")throw Error(ut(150));if(F=K.call(F),F==null)throw Error(ut(151));for(var ne=K=null,re=N,be=N=0,xe=null,fe=F.next();re!==null&&!fe.done;be++,fe=F.next()){re.index>be?(xe=re,re=null):xe=re.sibling;var Re=A(z,re,fe.value,$);if(Re===null){re===null&&(re=xe);break}t&&re&&Re.alternate===null&&e(z,re),N=o(Re,N,be),ne===null?K=Re:ne.sibling=Re,ne=Re,re=xe}if(fe.done)return n(z,re),Or&&tu(z,be),K;if(re===null){for(;!fe.done;be++,fe=F.next())fe=T(z,fe.value,$),fe!==null&&(N=o(fe,N,be),ne===null?K=fe:ne.sibling=fe,ne=fe);return Or&&tu(z,be),K}for(re=r(z,re);!fe.done;be++,fe=F.next())fe=L(re,z,be,fe.value,$),fe!==null&&(t&&fe.alternate!==null&&re.delete(fe.key===null?be:fe.key),N=o(fe,N,be),ne===null?K=fe:ne.sibling=fe,ne=fe);return t&&re.forEach(function(Ve){return e(z,Ve)}),Or&&tu(z,be),K}function W(z,N,F,$){if(typeof F=="object"&&F!==null&&F.type===Uh&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case ty:e:{for(var K=F.key,ne=N;ne!==null;){if(ne.key===K){if(K=F.type,K===Uh){if(ne.tag===7){n(z,ne.sibling),N=i(ne,F.props.children),N.return=z,z=N;break e}}else if(ne.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Kl&&ZP(K)===ne.type){n(z,ne.sibling),N=i(ne,F.props),N.ref=Jf(z,ne,F),N.return=z,z=N;break e}n(z,ne);break}else e(z,ne);ne=ne.sibling}F.type===Uh?(N=pu(F.props.children,z.mode,$,F.key),N.return=z,z=N):($=o0(F.type,F.key,F.props,null,z.mode,$),$.ref=Jf(z,N,F),$.return=z,z=$)}return h(z);case Bh:e:{for(ne=F.key;N!==null;){if(N.key===ne)if(N.tag===4&&N.stateNode.containerInfo===F.containerInfo&&N.stateNode.implementation===F.implementation){n(z,N.sibling),N=i(N,F.children||[]),N.return=z,z=N;break e}else{n(z,N);break}else e(z,N);N=N.sibling}N=d1(F,z.mode,$),N.return=z,z=N}return h(z);case Kl:return ne=F._init,W(z,N,ne(F._payload),$)}if(vp(F))return R(z,N,F,$);if(qf(F))return D(z,N,F,$);dy(z,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,N!==null&&N.tag===6?(n(z,N.sibling),N=i(N,F),N.return=z,z=N):(n(z,N),N=h1(F,z.mode,$),N.return=z,z=N),h(z)):n(z,N)}return W}var gd=PL(!0),CL=PL(!1),Rm={},La=Sc(Rm),nm=Sc(Rm),rm=Sc(Rm);function cu(t){if(t===Rm)throw Error(ut(174));return t}function RE(t,e){switch(vr(rm,e),vr(nm,t),vr(La,Rm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Tb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Tb(e,t)}Pr(La),vr(La,e)}function yd(){Pr(La),Pr(nm),Pr(rm)}function AL(t){cu(rm.current);var e=cu(La.current),n=Tb(e,t.type);e!==n&&(vr(nm,t),vr(La,n))}function OE(t){nm.current===t&&(Pr(La),Pr(nm))}var Nr=Sc(0);function F0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var s1=[];function zE(){for(var t=0;t<s1.length;t++)s1[t]._workInProgressVersionPrimary=null;s1.length=0}var t0=vl.ReactCurrentDispatcher,o1=vl.ReactCurrentBatchConfig,xu=0,Ur=null,yi=null,Pi=null,N0=!1,Lp=!1,im=0,B5=0;function es(){throw Error(ut(321))}function DE(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!aa(t[n],e[n]))return!1;return!0}function FE(t,e,n,r,i,o){if(xu=o,Ur=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,t0.current=t===null||t.memoizedState===null?$5:G5,t=n(r,i),Lp){o=0;do{if(Lp=!1,im=0,25<=o)throw Error(ut(301));o+=1,Pi=yi=null,e.updateQueue=null,t0.current=W5,t=n(r,i)}while(Lp)}if(t0.current=B0,e=yi!==null&&yi.next!==null,xu=0,Pi=yi=Ur=null,N0=!1,e)throw Error(ut(300));return t}function NE(){var t=im!==0;return im=0,t}function Ea(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pi===null?Ur.memoizedState=Pi=t:Pi=Pi.next=t,Pi}function Oo(){if(yi===null){var t=Ur.alternate;t=t!==null?t.memoizedState:null}else t=yi.next;var e=Pi===null?Ur.memoizedState:Pi.next;if(e!==null)Pi=e,yi=t;else{if(t===null)throw Error(ut(310));yi=t,t={memoizedState:yi.memoizedState,baseState:yi.baseState,baseQueue:yi.baseQueue,queue:yi.queue,next:null},Pi===null?Ur.memoizedState=Pi=t:Pi=Pi.next=t}return Pi}function sm(t,e){return typeof e=="function"?e(t):e}function a1(t){var e=Oo(),n=e.queue;if(n===null)throw Error(ut(311));n.lastRenderedReducer=t;var r=yi,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var h=i.next;i.next=o.next,o.next=h}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var l=h=null,m=null,_=o;do{var E=_.lane;if((xu&E)===E)m!==null&&(m=m.next={lane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),r=_.hasEagerState?_.eagerState:t(r,_.action);else{var T={lane:E,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null};m===null?(l=m=T,h=r):m=m.next=T,Ur.lanes|=E,bu|=E}_=_.next}while(_!==null&&_!==o);m===null?h=r:m.next=l,aa(r,e.memoizedState)||(Rs=!0),e.memoizedState=r,e.baseState=h,e.baseQueue=m,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Ur.lanes|=o,bu|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function l1(t){var e=Oo(),n=e.queue;if(n===null)throw Error(ut(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var h=i=i.next;do o=t(o,h.action),h=h.next;while(h!==i);aa(o,e.memoizedState)||(Rs=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function IL(){}function ML(t,e){var n=Ur,r=Oo(),i=e(),o=!aa(r.memoizedState,i);if(o&&(r.memoizedState=i,Rs=!0),r=r.queue,BE(RL.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Pi!==null&&Pi.memoizedState.tag&1){if(n.flags|=2048,om(9,LL.bind(null,n,r,i,e),void 0,null),Ii===null)throw Error(ut(349));xu&30||kL(n,e,i)}return i}function kL(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ur.updateQueue,e===null?(e={lastEffect:null,stores:null},Ur.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function LL(t,e,n,r){e.value=n,e.getSnapshot=r,OL(e)&&zL(t)}function RL(t,e,n){return n(function(){OL(e)&&zL(t)})}function OL(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!aa(t,n)}catch{return!0}}function zL(t){var e=hl(t,1);e!==null&&sa(e,t,1,-1)}function XP(t){var e=Ea();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sm,lastRenderedState:t},e.queue=t,t=t.dispatch=j5.bind(null,Ur,t),[e.memoizedState,t]}function om(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ur.updateQueue,e===null?(e={lastEffect:null,stores:null},Ur.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function DL(){return Oo().memoizedState}function n0(t,e,n,r){var i=Ea();Ur.flags|=t,i.memoizedState=om(1|e,n,void 0,r===void 0?null:r)}function P_(t,e,n,r){var i=Oo();r=r===void 0?null:r;var o=void 0;if(yi!==null){var h=yi.memoizedState;if(o=h.destroy,r!==null&&DE(r,h.deps)){i.memoizedState=om(e,n,o,r);return}}Ur.flags|=t,i.memoizedState=om(1|e,n,o,r)}function YP(t,e){return n0(8390656,8,t,e)}function BE(t,e){return P_(2048,8,t,e)}function FL(t,e){return P_(4,2,t,e)}function NL(t,e){return P_(4,4,t,e)}function BL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function UL(t,e,n){return n=n!=null?n.concat([t]):null,P_(4,4,BL.bind(null,e,t),n)}function UE(){}function VL(t,e){var n=Oo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&DE(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function jL(t,e){var n=Oo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&DE(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function $L(t,e,n){return xu&21?(aa(n,e)||(n=Hk(),Ur.lanes|=n,bu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Rs=!0),t.memoizedState=n)}function U5(t,e){var n=nr;nr=n!==0&&4>n?n:4,t(!0);var r=o1.transition;o1.transition={};try{t(!1),e()}finally{nr=n,o1.transition=r}}function GL(){return Oo().memoizedState}function V5(t,e,n){var r=mc(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},WL(t))HL(e,n);else if(n=wL(t,e,n,r),n!==null){var i=Es();sa(n,t,r,i),qL(n,e,r)}}function j5(t,e,n){var r=mc(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(WL(t))HL(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var h=e.lastRenderedState,l=o(h,n);if(i.hasEagerState=!0,i.eagerState=l,aa(l,h)){var m=e.interleaved;m===null?(i.next=i,kE(e)):(i.next=m.next,m.next=i),e.interleaved=i;return}}catch{}finally{}n=wL(t,e,i,r),n!==null&&(i=Es(),sa(n,t,r,i),qL(n,e,r))}}function WL(t){var e=t.alternate;return t===Ur||e!==null&&e===Ur}function HL(t,e){Lp=N0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function qL(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yE(t,n)}}var B0={readContext:Ro,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},$5={readContext:Ro,useCallback:function(t,e){return Ea().memoizedState=[t,e===void 0?null:e],t},useContext:Ro,useEffect:YP,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,n0(4194308,4,BL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return n0(4194308,4,t,e)},useInsertionEffect:function(t,e){return n0(4,2,t,e)},useMemo:function(t,e){var n=Ea();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ea();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=V5.bind(null,Ur,t),[r.memoizedState,t]},useRef:function(t){var e=Ea();return t={current:t},e.memoizedState=t},useState:XP,useDebugValue:UE,useDeferredValue:function(t){return Ea().memoizedState=t},useTransition:function(){var t=XP(!1),e=t[0];return t=U5.bind(null,t[1]),Ea().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ur,i=Ea();if(Or){if(n===void 0)throw Error(ut(407));n=n()}else{if(n=e(),Ii===null)throw Error(ut(349));xu&30||kL(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,YP(RL.bind(null,r,o,t),[t]),r.flags|=2048,om(9,LL.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Ea(),e=Ii.identifierPrefix;if(Or){var n=al,r=ol;n=(r&~(1<<32-ia(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=im++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=B5++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},G5={readContext:Ro,useCallback:VL,useContext:Ro,useEffect:BE,useImperativeHandle:UL,useInsertionEffect:FL,useLayoutEffect:NL,useMemo:jL,useReducer:a1,useRef:DL,useState:function(){return a1(sm)},useDebugValue:UE,useDeferredValue:function(t){var e=Oo();return $L(e,yi.memoizedState,t)},useTransition:function(){var t=a1(sm)[0],e=Oo().memoizedState;return[t,e]},useMutableSource:IL,useSyncExternalStore:ML,useId:GL,unstable_isNewReconciler:!1},W5={readContext:Ro,useCallback:VL,useContext:Ro,useEffect:BE,useImperativeHandle:UL,useInsertionEffect:FL,useLayoutEffect:NL,useMemo:jL,useReducer:l1,useRef:DL,useState:function(){return l1(sm)},useDebugValue:UE,useDeferredValue:function(t){var e=Oo();return yi===null?e.memoizedState=t:$L(e,yi.memoizedState,t)},useTransition:function(){var t=l1(sm)[0],e=Oo().memoizedState;return[t,e]},useMutableSource:IL,useSyncExternalStore:ML,useId:GL,unstable_isNewReconciler:!1};function _d(t,e){try{var n="",r=e;do n+=v4(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function c1(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function qb(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var H5=typeof WeakMap=="function"?WeakMap:Map;function ZL(t,e,n){n=ll(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){V0||(V0=!0,rw=r),qb(t,e)},n}function XL(t,e,n){n=ll(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){qb(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){qb(t,e),typeof r!="function"&&(pc===null?pc=new Set([this]):pc.add(this));var h=e.stack;this.componentDidCatch(e.value,{componentStack:h!==null?h:""})}),n}function KP(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new H5;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=oN.bind(null,t,e,n),e.then(t,t))}function JP(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function QP(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ll(-1,1),e.tag=2,fc(n,e,1))),n.lanes|=1),t)}var q5=vl.ReactCurrentOwner,Rs=!1;function xs(t,e,n,r){e.child=t===null?CL(e,null,n,r):gd(e,t.child,n,r)}function eC(t,e,n,r,i){n=n.render;var o=e.ref;return sd(e,i),r=FE(t,e,n,r,o,i),n=NE(),t!==null&&!Rs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,dl(t,e,i)):(Or&&n&&SE(e),e.flags|=1,xs(t,e,r,i),e.child)}function tC(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!ZE(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,YL(t,e,o,r,i)):(t=o0(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var h=o.memoizedProps;if(n=n.compare,n=n!==null?n:Jp,n(h,r)&&t.ref===e.ref)return dl(t,e,i)}return e.flags|=1,t=gc(o,r),t.ref=e.ref,t.return=e,e.child=t}function YL(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Jp(o,r)&&t.ref===e.ref)if(Rs=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Rs=!0);else return e.lanes=t.lanes,dl(t,e,i)}return Zb(t,e,n,r,i)}function KL(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},vr(Yh,Ks),Ks|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,vr(Yh,Ks),Ks|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,vr(Yh,Ks),Ks|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,vr(Yh,Ks),Ks|=r;return xs(t,e,i,n),e.child}function JL(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Zb(t,e,n,r,i){var o=zs(n)?_u:as.current;return o=pd(e,o),sd(e,i),n=FE(t,e,n,r,o,i),r=NE(),t!==null&&!Rs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,dl(t,e,i)):(Or&&r&&SE(e),e.flags|=1,xs(t,e,n,i),e.child)}function nC(t,e,n,r,i){if(zs(n)){var o=!0;k0(e)}else o=!1;if(sd(e,i),e.stateNode===null)r0(t,e),SL(e,n,r),Hb(e,n,r,i),r=!0;else if(t===null){var h=e.stateNode,l=e.memoizedProps;h.props=l;var m=h.context,_=n.contextType;typeof _=="object"&&_!==null?_=Ro(_):(_=zs(n)?_u:as.current,_=pd(e,_));var E=n.getDerivedStateFromProps,T=typeof E=="function"||typeof h.getSnapshotBeforeUpdate=="function";T||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(l!==r||m!==_)&&qP(e,h,r,_),Jl=!1;var A=e.memoizedState;h.state=A,D0(e,r,h,i),m=e.memoizedState,l!==r||A!==m||Os.current||Jl?(typeof E=="function"&&(Wb(e,n,E,r),m=e.memoizedState),(l=Jl||HP(e,n,l,r,A,m,_))?(T||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(e.flags|=4194308)):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=m),h.props=r,h.state=m,h.context=_,r=l):(typeof h.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{h=e.stateNode,EL(t,e),l=e.memoizedProps,_=e.type===e.elementType?l:Jo(e.type,l),h.props=_,T=e.pendingProps,A=h.context,m=n.contextType,typeof m=="object"&&m!==null?m=Ro(m):(m=zs(n)?_u:as.current,m=pd(e,m));var L=n.getDerivedStateFromProps;(E=typeof L=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(l!==T||A!==m)&&qP(e,h,r,m),Jl=!1,A=e.memoizedState,h.state=A,D0(e,r,h,i);var R=e.memoizedState;l!==T||A!==R||Os.current||Jl?(typeof L=="function"&&(Wb(e,n,L,r),R=e.memoizedState),(_=Jl||HP(e,n,_,r,A,R,m)||!1)?(E||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(r,R,m),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(r,R,m)),typeof h.componentDidUpdate=="function"&&(e.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof h.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),h.props=r,h.state=R,h.context=m,r=_):(typeof h.componentDidUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),r=!1)}return Xb(t,e,n,r,o,i)}function Xb(t,e,n,r,i,o){JL(t,e);var h=(e.flags&128)!==0;if(!r&&!h)return i&&VP(e,n,!1),dl(t,e,o);r=e.stateNode,q5.current=e;var l=h&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&h?(e.child=gd(e,t.child,null,o),e.child=gd(e,null,l,o)):xs(t,e,l,o),e.memoizedState=r.state,i&&VP(e,n,!0),e.child}function QL(t){var e=t.stateNode;e.pendingContext?UP(t,e.pendingContext,e.pendingContext!==e.context):e.context&&UP(t,e.context,!1),RE(t,e.containerInfo)}function rC(t,e,n,r,i){return md(),CE(i),e.flags|=256,xs(t,e,n,r),e.child}var Yb={dehydrated:null,treeContext:null,retryLane:0};function Kb(t){return{baseLanes:t,cachePool:null,transitions:null}}function eR(t,e,n){var r=e.pendingProps,i=Nr.current,o=!1,h=(e.flags&128)!==0,l;if((l=h)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),vr(Nr,i&1),t===null)return $b(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(h=r.children,t=r.fallback,o?(r=e.mode,o=e.child,h={mode:"hidden",children:h},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=h):o=I_(h,r,0,null),t=pu(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Kb(n),e.memoizedState=Yb,t):VE(e,h));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return Z5(t,e,h,r,l,i,n);if(o){o=r.fallback,h=e.mode,i=t.child,l=i.sibling;var m={mode:"hidden",children:r.children};return!(h&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=m,e.deletions=null):(r=gc(i,m),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?o=gc(l,o):(o=pu(o,h,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,h=t.child.memoizedState,h=h===null?Kb(n):{baseLanes:h.baseLanes|n,cachePool:null,transitions:h.transitions},o.memoizedState=h,o.childLanes=t.childLanes&~n,e.memoizedState=Yb,r}return o=t.child,t=o.sibling,r=gc(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function VE(t,e){return e=I_({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function fy(t,e,n,r){return r!==null&&CE(r),gd(e,t.child,null,n),t=VE(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Z5(t,e,n,r,i,o,h){if(n)return e.flags&256?(e.flags&=-257,r=c1(Error(ut(422))),fy(t,e,h,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=I_({mode:"visible",children:r.children},i,0,null),o=pu(o,i,h,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&gd(e,t.child,null,h),e.child.memoizedState=Kb(h),e.memoizedState=Yb,o);if(!(e.mode&1))return fy(t,e,h,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(ut(419)),r=c1(o,r,void 0),fy(t,e,h,r)}if(l=(h&t.childLanes)!==0,Rs||l){if(r=Ii,r!==null){switch(h&-h){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|h)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,hl(t,i),sa(r,t,i,-1))}return qE(),r=c1(Error(ut(421))),fy(t,e,h,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=aN.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,to=dc(i.nextSibling),io=e,Or=!0,ea=null,t!==null&&(Co[Ao++]=ol,Co[Ao++]=al,Co[Ao++]=vu,ol=t.id,al=t.overflow,vu=e),e=VE(e,r.children),e.flags|=4096,e)}function iC(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Gb(t.return,e,n)}function u1(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function tR(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(xs(t,e,r.children,n),r=Nr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&iC(t,n,e);else if(t.tag===19)iC(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(vr(Nr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&F0(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),u1(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&F0(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}u1(e,!0,n,null,o);break;case"together":u1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function r0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function dl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),bu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ut(153));if(e.child!==null){for(t=e.child,n=gc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=gc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function X5(t,e,n){switch(e.tag){case 3:QL(e),md();break;case 5:AL(e);break;case 1:zs(e.type)&&k0(e);break;case 4:RE(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;vr(O0,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(vr(Nr,Nr.current&1),e.flags|=128,null):n&e.child.childLanes?eR(t,e,n):(vr(Nr,Nr.current&1),t=dl(t,e,n),t!==null?t.sibling:null);vr(Nr,Nr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return tR(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),vr(Nr,Nr.current),r)break;return null;case 22:case 23:return e.lanes=0,KL(t,e,n)}return dl(t,e,n)}var nR,Jb,rR,iR;nR=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Jb=function(){};rR=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,cu(La.current);var o=null;switch(n){case"input":i=xb(t,i),r=xb(t,r),o=[];break;case"select":i=Vr({},i,{value:void 0}),r=Vr({},r,{value:void 0}),o=[];break;case"textarea":i=Eb(t,i),r=Eb(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=I0)}Sb(n,r);var h;n=null;for(_ in i)if(!r.hasOwnProperty(_)&&i.hasOwnProperty(_)&&i[_]!=null)if(_==="style"){var l=i[_];for(h in l)l.hasOwnProperty(h)&&(n||(n={}),n[h]="")}else _!=="dangerouslySetInnerHTML"&&_!=="children"&&_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(Wp.hasOwnProperty(_)?o||(o=[]):(o=o||[]).push(_,null));for(_ in r){var m=r[_];if(l=i!=null?i[_]:void 0,r.hasOwnProperty(_)&&m!==l&&(m!=null||l!=null))if(_==="style")if(l){for(h in l)!l.hasOwnProperty(h)||m&&m.hasOwnProperty(h)||(n||(n={}),n[h]="");for(h in m)m.hasOwnProperty(h)&&l[h]!==m[h]&&(n||(n={}),n[h]=m[h])}else n||(o||(o=[]),o.push(_,n)),n=m;else _==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,l=l?l.__html:void 0,m!=null&&l!==m&&(o=o||[]).push(_,m)):_==="children"?typeof m!="string"&&typeof m!="number"||(o=o||[]).push(_,""+m):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&(Wp.hasOwnProperty(_)?(m!=null&&_==="onScroll"&&Tr("scroll",t),o||l===m||(o=[])):(o=o||[]).push(_,m))}n&&(o=o||[]).push("style",n);var _=o;(e.updateQueue=_)&&(e.flags|=4)}};iR=function(t,e,n,r){n!==r&&(e.flags|=4)};function Qf(t,e){if(!Or)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ts(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Y5(t,e,n){var r=e.pendingProps;switch(PE(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(e),null;case 1:return zs(e.type)&&M0(),ts(e),null;case 3:return r=e.stateNode,yd(),Pr(Os),Pr(as),zE(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(hy(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ea!==null&&(ow(ea),ea=null))),Jb(t,e),ts(e),null;case 5:OE(e);var i=cu(rm.current);if(n=e.type,t!==null&&e.stateNode!=null)rR(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ut(166));return ts(e),null}if(t=cu(La.current),hy(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Pa]=e,r[tm]=o,t=(e.mode&1)!==0,n){case"dialog":Tr("cancel",r),Tr("close",r);break;case"iframe":case"object":case"embed":Tr("load",r);break;case"video":case"audio":for(i=0;i<bp.length;i++)Tr(bp[i],r);break;case"source":Tr("error",r);break;case"img":case"image":case"link":Tr("error",r),Tr("load",r);break;case"details":Tr("toggle",r);break;case"input":fP(r,o),Tr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Tr("invalid",r);break;case"textarea":mP(r,o),Tr("invalid",r)}Sb(n,o),i=null;for(var h in o)if(o.hasOwnProperty(h)){var l=o[h];h==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&uy(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&uy(r.textContent,l,t),i=["children",""+l]):Wp.hasOwnProperty(h)&&l!=null&&h==="onScroll"&&Tr("scroll",r)}switch(n){case"input":ny(r),pP(r,o,!0);break;case"textarea":ny(r),gP(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=I0)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{h=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=kk(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=h.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=h.createElement(n,{is:r.is}):(t=h.createElement(n),n==="select"&&(h=t,r.multiple?h.multiple=!0:r.size&&(h.size=r.size))):t=h.createElementNS(t,n),t[Pa]=e,t[tm]=r,nR(t,e,!1,!1),e.stateNode=t;e:{switch(h=Pb(n,r),n){case"dialog":Tr("cancel",t),Tr("close",t),i=r;break;case"iframe":case"object":case"embed":Tr("load",t),i=r;break;case"video":case"audio":for(i=0;i<bp.length;i++)Tr(bp[i],t);i=r;break;case"source":Tr("error",t),i=r;break;case"img":case"image":case"link":Tr("error",t),Tr("load",t),i=r;break;case"details":Tr("toggle",t),i=r;break;case"input":fP(t,r),i=xb(t,r),Tr("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Vr({},r,{value:void 0}),Tr("invalid",t);break;case"textarea":mP(t,r),i=Eb(t,r),Tr("invalid",t);break;default:i=r}Sb(n,i),l=i;for(o in l)if(l.hasOwnProperty(o)){var m=l[o];o==="style"?Ok(t,m):o==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&Lk(t,m)):o==="children"?typeof m=="string"?(n!=="textarea"||m!=="")&&Hp(t,m):typeof m=="number"&&Hp(t,""+m):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Wp.hasOwnProperty(o)?m!=null&&o==="onScroll"&&Tr("scroll",t):m!=null&&hE(t,o,m,h))}switch(n){case"input":ny(t),pP(t,r,!1);break;case"textarea":ny(t),gP(t);break;case"option":r.value!=null&&t.setAttribute("value",""+xc(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?td(t,!!r.multiple,o,!1):r.defaultValue!=null&&td(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=I0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ts(e),null;case 6:if(t&&e.stateNode!=null)iR(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ut(166));if(n=cu(rm.current),cu(La.current),hy(e)){if(r=e.stateNode,n=e.memoizedProps,r[Pa]=e,(o=r.nodeValue!==n)&&(t=io,t!==null))switch(t.tag){case 3:uy(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&uy(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Pa]=e,e.stateNode=r}return ts(e),null;case 13:if(Pr(Nr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Or&&to!==null&&e.mode&1&&!(e.flags&128))bL(),md(),e.flags|=98560,o=!1;else if(o=hy(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ut(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ut(317));o[Pa]=e}else md(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ts(e),o=!1}else ea!==null&&(ow(ea),ea=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Nr.current&1?_i===0&&(_i=3):qE())),e.updateQueue!==null&&(e.flags|=4),ts(e),null);case 4:return yd(),Jb(t,e),t===null&&Qp(e.stateNode.containerInfo),ts(e),null;case 10:return ME(e.type._context),ts(e),null;case 17:return zs(e.type)&&M0(),ts(e),null;case 19:if(Pr(Nr),o=e.memoizedState,o===null)return ts(e),null;if(r=(e.flags&128)!==0,h=o.rendering,h===null)if(r)Qf(o,!1);else{if(_i!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(h=F0(t),h!==null){for(e.flags|=128,Qf(o,!1),r=h.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,h=o.alternate,h===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,t=h.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return vr(Nr,Nr.current&1|2),e.child}t=t.sibling}o.tail!==null&&ai()>vd&&(e.flags|=128,r=!0,Qf(o,!1),e.lanes=4194304)}else{if(!r)if(t=F0(h),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Qf(o,!0),o.tail===null&&o.tailMode==="hidden"&&!h.alternate&&!Or)return ts(e),null}else 2*ai()-o.renderingStartTime>vd&&n!==1073741824&&(e.flags|=128,r=!0,Qf(o,!1),e.lanes=4194304);o.isBackwards?(h.sibling=e.child,e.child=h):(n=o.last,n!==null?n.sibling=h:e.child=h,o.last=h)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=ai(),e.sibling=null,n=Nr.current,vr(Nr,r?n&1|2:n&1),e):(ts(e),null);case 22:case 23:return HE(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ks&1073741824&&(ts(e),e.subtreeFlags&6&&(e.flags|=8192)):ts(e),null;case 24:return null;case 25:return null}throw Error(ut(156,e.tag))}function K5(t,e){switch(PE(e),e.tag){case 1:return zs(e.type)&&M0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return yd(),Pr(Os),Pr(as),zE(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return OE(e),null;case 13:if(Pr(Nr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ut(340));md()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pr(Nr),null;case 4:return yd(),null;case 10:return ME(e.type._context),null;case 22:case 23:return HE(),null;case 24:return null;default:return null}}var py=!1,os=!1,J5=typeof WeakSet=="function"?WeakSet:Set,Kt=null;function Xh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Zr(t,e,r)}else n.current=null}function Qb(t,e,n){try{n()}catch(r){Zr(t,e,r)}}var sC=!1;function Q5(t,e){if(Db=P0,t=lL(),TE(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var h=0,l=-1,m=-1,_=0,E=0,T=t,A=null;t:for(;;){for(var L;T!==n||i!==0&&T.nodeType!==3||(l=h+i),T!==o||r!==0&&T.nodeType!==3||(m=h+r),T.nodeType===3&&(h+=T.nodeValue.length),(L=T.firstChild)!==null;)A=T,T=L;for(;;){if(T===t)break t;if(A===n&&++_===i&&(l=h),A===o&&++E===r&&(m=h),(L=T.nextSibling)!==null)break;T=A,A=T.parentNode}T=L}n=l===-1||m===-1?null:{start:l,end:m}}else n=null}n=n||{start:0,end:0}}else n=null;for(Fb={focusedElem:t,selectionRange:n},P0=!1,Kt=e;Kt!==null;)if(e=Kt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Kt=t;else for(;Kt!==null;){e=Kt;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var D=R.memoizedProps,W=R.memoizedState,z=e.stateNode,N=z.getSnapshotBeforeUpdate(e.elementType===e.type?D:Jo(e.type,D),W);z.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var F=e.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ut(163))}}catch($){Zr(e,e.return,$)}if(t=e.sibling,t!==null){t.return=e.return,Kt=t;break}Kt=e.return}return R=sC,sC=!1,R}function Rp(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Qb(e,n,o)}i=i.next}while(i!==r)}}function C_(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ew(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function sR(t){var e=t.alternate;e!==null&&(t.alternate=null,sR(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Pa],delete e[tm],delete e[Ub],delete e[z5],delete e[D5])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function oR(t){return t.tag===5||t.tag===3||t.tag===4}function oC(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||oR(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function tw(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=I0));else if(r!==4&&(t=t.child,t!==null))for(tw(t,e,n),t=t.sibling;t!==null;)tw(t,e,n),t=t.sibling}function nw(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(nw(t,e,n),t=t.sibling;t!==null;)nw(t,e,n),t=t.sibling}var Bi=null,Qo=!1;function jl(t,e,n){for(n=n.child;n!==null;)aR(t,e,n),n=n.sibling}function aR(t,e,n){if(ka&&typeof ka.onCommitFiberUnmount=="function")try{ka.onCommitFiberUnmount(v_,n)}catch{}switch(n.tag){case 5:os||Xh(n,e);case 6:var r=Bi,i=Qo;Bi=null,jl(t,e,n),Bi=r,Qo=i,Bi!==null&&(Qo?(t=Bi,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Bi.removeChild(n.stateNode));break;case 18:Bi!==null&&(Qo?(t=Bi,n=n.stateNode,t.nodeType===8?r1(t.parentNode,n):t.nodeType===1&&r1(t,n),Yp(t)):r1(Bi,n.stateNode));break;case 4:r=Bi,i=Qo,Bi=n.stateNode.containerInfo,Qo=!0,jl(t,e,n),Bi=r,Qo=i;break;case 0:case 11:case 14:case 15:if(!os&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,h=o.destroy;o=o.tag,h!==void 0&&(o&2||o&4)&&Qb(n,e,h),i=i.next}while(i!==r)}jl(t,e,n);break;case 1:if(!os&&(Xh(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Zr(n,e,l)}jl(t,e,n);break;case 21:jl(t,e,n);break;case 22:n.mode&1?(os=(r=os)||n.memoizedState!==null,jl(t,e,n),os=r):jl(t,e,n);break;default:jl(t,e,n)}}function aC(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new J5),e.forEach(function(r){var i=lN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Yo(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,h=e,l=h;e:for(;l!==null;){switch(l.tag){case 5:Bi=l.stateNode,Qo=!1;break e;case 3:Bi=l.stateNode.containerInfo,Qo=!0;break e;case 4:Bi=l.stateNode.containerInfo,Qo=!0;break e}l=l.return}if(Bi===null)throw Error(ut(160));aR(o,h,i),Bi=null,Qo=!1;var m=i.alternate;m!==null&&(m.return=null),i.return=null}catch(_){Zr(i,e,_)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)lR(e,t),e=e.sibling}function lR(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Yo(e,t),_a(t),r&4){try{Rp(3,t,t.return),C_(3,t)}catch(D){Zr(t,t.return,D)}try{Rp(5,t,t.return)}catch(D){Zr(t,t.return,D)}}break;case 1:Yo(e,t),_a(t),r&512&&n!==null&&Xh(n,n.return);break;case 5:if(Yo(e,t),_a(t),r&512&&n!==null&&Xh(n,n.return),t.flags&32){var i=t.stateNode;try{Hp(i,"")}catch(D){Zr(t,t.return,D)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,h=n!==null?n.memoizedProps:o,l=t.type,m=t.updateQueue;if(t.updateQueue=null,m!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Ik(i,o),Pb(l,h);var _=Pb(l,o);for(h=0;h<m.length;h+=2){var E=m[h],T=m[h+1];E==="style"?Ok(i,T):E==="dangerouslySetInnerHTML"?Lk(i,T):E==="children"?Hp(i,T):hE(i,E,T,_)}switch(l){case"input":bb(i,o);break;case"textarea":Mk(i,o);break;case"select":var A=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var L=o.value;L!=null?td(i,!!o.multiple,L,!1):A!==!!o.multiple&&(o.defaultValue!=null?td(i,!!o.multiple,o.defaultValue,!0):td(i,!!o.multiple,o.multiple?[]:"",!1))}i[tm]=o}catch(D){Zr(t,t.return,D)}}break;case 6:if(Yo(e,t),_a(t),r&4){if(t.stateNode===null)throw Error(ut(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(D){Zr(t,t.return,D)}}break;case 3:if(Yo(e,t),_a(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Yp(e.containerInfo)}catch(D){Zr(t,t.return,D)}break;case 4:Yo(e,t),_a(t);break;case 13:Yo(e,t),_a(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(GE=ai())),r&4&&aC(t);break;case 22:if(E=n!==null&&n.memoizedState!==null,t.mode&1?(os=(_=os)||E,Yo(e,t),os=_):Yo(e,t),_a(t),r&8192){if(_=t.memoizedState!==null,(t.stateNode.isHidden=_)&&!E&&t.mode&1)for(Kt=t,E=t.child;E!==null;){for(T=Kt=E;Kt!==null;){switch(A=Kt,L=A.child,A.tag){case 0:case 11:case 14:case 15:Rp(4,A,A.return);break;case 1:Xh(A,A.return);var R=A.stateNode;if(typeof R.componentWillUnmount=="function"){r=A,n=A.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(D){Zr(r,n,D)}}break;case 5:Xh(A,A.return);break;case 22:if(A.memoizedState!==null){cC(T);continue}}L!==null?(L.return=A,Kt=L):cC(T)}E=E.sibling}e:for(E=null,T=t;;){if(T.tag===5){if(E===null){E=T;try{i=T.stateNode,_?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=T.stateNode,m=T.memoizedProps.style,h=m!=null&&m.hasOwnProperty("display")?m.display:null,l.style.display=Rk("display",h))}catch(D){Zr(t,t.return,D)}}}else if(T.tag===6){if(E===null)try{T.stateNode.nodeValue=_?"":T.memoizedProps}catch(D){Zr(t,t.return,D)}}else if((T.tag!==22&&T.tag!==23||T.memoizedState===null||T===t)&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===t)break e;for(;T.sibling===null;){if(T.return===null||T.return===t)break e;E===T&&(E=null),T=T.return}E===T&&(E=null),T.sibling.return=T.return,T=T.sibling}}break;case 19:Yo(e,t),_a(t),r&4&&aC(t);break;case 21:break;default:Yo(e,t),_a(t)}}function _a(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(oR(n)){var r=n;break e}n=n.return}throw Error(ut(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Hp(i,""),r.flags&=-33);var o=oC(t);nw(t,o,i);break;case 3:case 4:var h=r.stateNode.containerInfo,l=oC(t);tw(t,l,h);break;default:throw Error(ut(161))}}catch(m){Zr(t,t.return,m)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function eN(t,e,n){Kt=t,cR(t)}function cR(t,e,n){for(var r=(t.mode&1)!==0;Kt!==null;){var i=Kt,o=i.child;if(i.tag===22&&r){var h=i.memoizedState!==null||py;if(!h){var l=i.alternate,m=l!==null&&l.memoizedState!==null||os;l=py;var _=os;if(py=h,(os=m)&&!_)for(Kt=i;Kt!==null;)h=Kt,m=h.child,h.tag===22&&h.memoizedState!==null?uC(i):m!==null?(m.return=h,Kt=m):uC(i);for(;o!==null;)Kt=o,cR(o),o=o.sibling;Kt=i,py=l,os=_}lC(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Kt=o):lC(t)}}function lC(t){for(;Kt!==null;){var e=Kt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:os||C_(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!os)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Jo(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&WP(e,o,r);break;case 3:var h=e.updateQueue;if(h!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}WP(e,h,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var m=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&n.focus();break;case"img":m.src&&(n.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var _=e.alternate;if(_!==null){var E=_.memoizedState;if(E!==null){var T=E.dehydrated;T!==null&&Yp(T)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ut(163))}os||e.flags&512&&ew(e)}catch(A){Zr(e,e.return,A)}}if(e===t){Kt=null;break}if(n=e.sibling,n!==null){n.return=e.return,Kt=n;break}Kt=e.return}}function cC(t){for(;Kt!==null;){var e=Kt;if(e===t){Kt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Kt=n;break}Kt=e.return}}function uC(t){for(;Kt!==null;){var e=Kt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{C_(4,e)}catch(m){Zr(e,n,m)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(m){Zr(e,i,m)}}var o=e.return;try{ew(e)}catch(m){Zr(e,o,m)}break;case 5:var h=e.return;try{ew(e)}catch(m){Zr(e,h,m)}}}catch(m){Zr(e,e.return,m)}if(e===t){Kt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Kt=l;break}Kt=e.return}}var tN=Math.ceil,U0=vl.ReactCurrentDispatcher,jE=vl.ReactCurrentOwner,Mo=vl.ReactCurrentBatchConfig,Wn=0,Ii=null,ui=null,Vi=0,Ks=0,Yh=Sc(0),_i=0,am=null,bu=0,A_=0,$E=0,Op=null,Ls=null,GE=0,vd=1/0,tl=null,V0=!1,rw=null,pc=null,my=!1,nc=null,j0=0,zp=0,iw=null,i0=-1,s0=0;function Es(){return Wn&6?ai():i0!==-1?i0:i0=ai()}function mc(t){return t.mode&1?Wn&2&&Vi!==0?Vi&-Vi:N5.transition!==null?(s0===0&&(s0=Hk()),s0):(t=nr,t!==0||(t=window.event,t=t===void 0?16:Qk(t.type)),t):1}function sa(t,e,n,r){if(50<zp)throw zp=0,iw=null,Error(ut(185));Mm(t,n,r),(!(Wn&2)||t!==Ii)&&(t===Ii&&(!(Wn&2)&&(A_|=n),_i===4&&ec(t,Vi)),Ds(t,r),n===1&&Wn===0&&!(e.mode&1)&&(vd=ai()+500,T_&&Pc()))}function Ds(t,e){var n=t.callbackNode;N4(t,e);var r=S0(t,t===Ii?Vi:0);if(r===0)n!==null&&vP(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&vP(n),e===1)t.tag===0?F5(hC.bind(null,t)):_L(hC.bind(null,t)),R5(function(){!(Wn&6)&&Pc()}),n=null;else{switch(qk(r)){case 1:n=gE;break;case 4:n=Gk;break;case 16:n=T0;break;case 536870912:n=Wk;break;default:n=T0}n=yR(n,uR.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function uR(t,e){if(i0=-1,s0=0,Wn&6)throw Error(ut(327));var n=t.callbackNode;if(od()&&t.callbackNode!==n)return null;var r=S0(t,t===Ii?Vi:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=$0(t,r);else{e=r;var i=Wn;Wn|=2;var o=dR();(Ii!==t||Vi!==e)&&(tl=null,vd=ai()+500,fu(t,e));do try{iN();break}catch(l){hR(t,l)}while(1);IE(),U0.current=o,Wn=i,ui!==null?e=0:(Ii=null,Vi=0,e=_i)}if(e!==0){if(e===2&&(i=kb(t),i!==0&&(r=i,e=sw(t,i))),e===1)throw n=am,fu(t,0),ec(t,r),Ds(t,ai()),n;if(e===6)ec(t,r);else{if(i=t.current.alternate,!(r&30)&&!nN(i)&&(e=$0(t,r),e===2&&(o=kb(t),o!==0&&(r=o,e=sw(t,o))),e===1))throw n=am,fu(t,0),ec(t,r),Ds(t,ai()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ut(345));case 2:nu(t,Ls,tl);break;case 3:if(ec(t,r),(r&130023424)===r&&(e=GE+500-ai(),10<e)){if(S0(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Es(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Bb(nu.bind(null,t,Ls,tl),e);break}nu(t,Ls,tl);break;case 4:if(ec(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var h=31-ia(r);o=1<<h,h=e[h],h>i&&(i=h),r&=~o}if(r=i,r=ai()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*tN(r/1960))-r,10<r){t.timeoutHandle=Bb(nu.bind(null,t,Ls,tl),r);break}nu(t,Ls,tl);break;case 5:nu(t,Ls,tl);break;default:throw Error(ut(329))}}}return Ds(t,ai()),t.callbackNode===n?uR.bind(null,t):null}function sw(t,e){var n=Op;return t.current.memoizedState.isDehydrated&&(fu(t,e).flags|=256),t=$0(t,e),t!==2&&(e=Ls,Ls=n,e!==null&&ow(e)),t}function ow(t){Ls===null?Ls=t:Ls.push.apply(Ls,t)}function nN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!aa(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ec(t,e){for(e&=~$E,e&=~A_,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ia(e),r=1<<n;t[n]=-1,e&=~r}}function hC(t){if(Wn&6)throw Error(ut(327));od();var e=S0(t,0);if(!(e&1))return Ds(t,ai()),null;var n=$0(t,e);if(t.tag!==0&&n===2){var r=kb(t);r!==0&&(e=r,n=sw(t,r))}if(n===1)throw n=am,fu(t,0),ec(t,e),Ds(t,ai()),n;if(n===6)throw Error(ut(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,nu(t,Ls,tl),Ds(t,ai()),null}function WE(t,e){var n=Wn;Wn|=1;try{return t(e)}finally{Wn=n,Wn===0&&(vd=ai()+500,T_&&Pc())}}function wu(t){nc!==null&&nc.tag===0&&!(Wn&6)&&od();var e=Wn;Wn|=1;var n=Mo.transition,r=nr;try{if(Mo.transition=null,nr=1,t)return t()}finally{nr=r,Mo.transition=n,Wn=e,!(Wn&6)&&Pc()}}function HE(){Ks=Yh.current,Pr(Yh)}function fu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,L5(n)),ui!==null)for(n=ui.return;n!==null;){var r=n;switch(PE(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&M0();break;case 3:yd(),Pr(Os),Pr(as),zE();break;case 5:OE(r);break;case 4:yd();break;case 13:Pr(Nr);break;case 19:Pr(Nr);break;case 10:ME(r.type._context);break;case 22:case 23:HE()}n=n.return}if(Ii=t,ui=t=gc(t.current,null),Vi=Ks=e,_i=0,am=null,$E=A_=bu=0,Ls=Op=null,lu!==null){for(e=0;e<lu.length;e++)if(n=lu[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var h=o.next;o.next=i,r.next=h}n.pending=r}lu=null}return t}function hR(t,e){do{var n=ui;try{if(IE(),t0.current=B0,N0){for(var r=Ur.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}N0=!1}if(xu=0,Pi=yi=Ur=null,Lp=!1,im=0,jE.current=null,n===null||n.return===null){_i=1,am=e,ui=null;break}e:{var o=t,h=n.return,l=n,m=e;if(e=Vi,l.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var _=m,E=l,T=E.tag;if(!(E.mode&1)&&(T===0||T===11||T===15)){var A=E.alternate;A?(E.updateQueue=A.updateQueue,E.memoizedState=A.memoizedState,E.lanes=A.lanes):(E.updateQueue=null,E.memoizedState=null)}var L=JP(h);if(L!==null){L.flags&=-257,QP(L,h,l,o,e),L.mode&1&&KP(o,_,e),e=L,m=_;var R=e.updateQueue;if(R===null){var D=new Set;D.add(m),e.updateQueue=D}else R.add(m);break e}else{if(!(e&1)){KP(o,_,e),qE();break e}m=Error(ut(426))}}else if(Or&&l.mode&1){var W=JP(h);if(W!==null){!(W.flags&65536)&&(W.flags|=256),QP(W,h,l,o,e),CE(_d(m,l));break e}}o=m=_d(m,l),_i!==4&&(_i=2),Op===null?Op=[o]:Op.push(o),o=h;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var z=ZL(o,m,e);GP(o,z);break e;case 1:l=m;var N=o.type,F=o.stateNode;if(!(o.flags&128)&&(typeof N.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(pc===null||!pc.has(F)))){o.flags|=65536,e&=-e,o.lanes|=e;var $=XL(o,l,e);GP(o,$);break e}}o=o.return}while(o!==null)}pR(n)}catch(K){e=K,ui===n&&n!==null&&(ui=n=n.return);continue}break}while(1)}function dR(){var t=U0.current;return U0.current=B0,t===null?B0:t}function qE(){(_i===0||_i===3||_i===2)&&(_i=4),Ii===null||!(bu&268435455)&&!(A_&268435455)||ec(Ii,Vi)}function $0(t,e){var n=Wn;Wn|=2;var r=dR();(Ii!==t||Vi!==e)&&(tl=null,fu(t,e));do try{rN();break}catch(i){hR(t,i)}while(1);if(IE(),Wn=n,U0.current=r,ui!==null)throw Error(ut(261));return Ii=null,Vi=0,_i}function rN(){for(;ui!==null;)fR(ui)}function iN(){for(;ui!==null&&!I4();)fR(ui)}function fR(t){var e=gR(t.alternate,t,Ks);t.memoizedProps=t.pendingProps,e===null?pR(t):ui=e,jE.current=null}function pR(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=K5(n,e),n!==null){n.flags&=32767,ui=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{_i=6,ui=null;return}}else if(n=Y5(n,e,Ks),n!==null){ui=n;return}if(e=e.sibling,e!==null){ui=e;return}ui=e=t}while(e!==null);_i===0&&(_i=5)}function nu(t,e,n){var r=nr,i=Mo.transition;try{Mo.transition=null,nr=1,sN(t,e,n,r)}finally{Mo.transition=i,nr=r}return null}function sN(t,e,n,r){do od();while(nc!==null);if(Wn&6)throw Error(ut(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ut(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(B4(t,o),t===Ii&&(ui=Ii=null,Vi=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||my||(my=!0,yR(T0,function(){return od(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Mo.transition,Mo.transition=null;var h=nr;nr=1;var l=Wn;Wn|=4,jE.current=null,Q5(t,n),lR(n,t),S5(Fb),P0=!!Db,Fb=Db=null,t.current=n,eN(n),M4(),Wn=l,nr=h,Mo.transition=o}else t.current=n;if(my&&(my=!1,nc=t,j0=i),o=t.pendingLanes,o===0&&(pc=null),R4(n.stateNode),Ds(t,ai()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(V0)throw V0=!1,t=rw,rw=null,t;return j0&1&&t.tag!==0&&od(),o=t.pendingLanes,o&1?t===iw?zp++:(zp=0,iw=t):zp=0,Pc(),null}function od(){if(nc!==null){var t=qk(j0),e=Mo.transition,n=nr;try{if(Mo.transition=null,nr=16>t?16:t,nc===null)var r=!1;else{if(t=nc,nc=null,j0=0,Wn&6)throw Error(ut(331));var i=Wn;for(Wn|=4,Kt=t.current;Kt!==null;){var o=Kt,h=o.child;if(Kt.flags&16){var l=o.deletions;if(l!==null){for(var m=0;m<l.length;m++){var _=l[m];for(Kt=_;Kt!==null;){var E=Kt;switch(E.tag){case 0:case 11:case 15:Rp(8,E,o)}var T=E.child;if(T!==null)T.return=E,Kt=T;else for(;Kt!==null;){E=Kt;var A=E.sibling,L=E.return;if(sR(E),E===_){Kt=null;break}if(A!==null){A.return=L,Kt=A;break}Kt=L}}}var R=o.alternate;if(R!==null){var D=R.child;if(D!==null){R.child=null;do{var W=D.sibling;D.sibling=null,D=W}while(D!==null)}}Kt=o}}if(o.subtreeFlags&2064&&h!==null)h.return=o,Kt=h;else e:for(;Kt!==null;){if(o=Kt,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Rp(9,o,o.return)}var z=o.sibling;if(z!==null){z.return=o.return,Kt=z;break e}Kt=o.return}}var N=t.current;for(Kt=N;Kt!==null;){h=Kt;var F=h.child;if(h.subtreeFlags&2064&&F!==null)F.return=h,Kt=F;else e:for(h=N;Kt!==null;){if(l=Kt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:C_(9,l)}}catch(K){Zr(l,l.return,K)}if(l===h){Kt=null;break e}var $=l.sibling;if($!==null){$.return=l.return,Kt=$;break e}Kt=l.return}}if(Wn=i,Pc(),ka&&typeof ka.onPostCommitFiberRoot=="function")try{ka.onPostCommitFiberRoot(v_,t)}catch{}r=!0}return r}finally{nr=n,Mo.transition=e}}return!1}function dC(t,e,n){e=_d(n,e),e=ZL(t,e,1),t=fc(t,e,1),e=Es(),t!==null&&(Mm(t,1,e),Ds(t,e))}function Zr(t,e,n){if(t.tag===3)dC(t,t,n);else for(;e!==null;){if(e.tag===3){dC(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(pc===null||!pc.has(r))){t=_d(n,t),t=XL(e,t,1),e=fc(e,t,1),t=Es(),e!==null&&(Mm(e,1,t),Ds(e,t));break}}e=e.return}}function oN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Es(),t.pingedLanes|=t.suspendedLanes&n,Ii===t&&(Vi&n)===n&&(_i===4||_i===3&&(Vi&130023424)===Vi&&500>ai()-GE?fu(t,0):$E|=n),Ds(t,e)}function mR(t,e){e===0&&(t.mode&1?(e=sy,sy<<=1,!(sy&130023424)&&(sy=4194304)):e=1);var n=Es();t=hl(t,e),t!==null&&(Mm(t,e,n),Ds(t,n))}function aN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),mR(t,n)}function lN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ut(314))}r!==null&&r.delete(e),mR(t,n)}var gR;gR=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Os.current)Rs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Rs=!1,X5(t,e,n);Rs=!!(t.flags&131072)}else Rs=!1,Or&&e.flags&1048576&&vL(e,R0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;r0(t,e),t=e.pendingProps;var i=pd(e,as.current);sd(e,n),i=FE(null,e,r,t,i,n);var o=NE();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,zs(r)?(o=!0,k0(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,LE(e),i.updater=S_,e.stateNode=i,i._reactInternals=e,Hb(e,r,t,n),e=Xb(null,e,r,!0,o,n)):(e.tag=0,Or&&o&&SE(e),xs(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(r0(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=uN(r),t=Jo(r,t),i){case 0:e=Zb(null,e,r,t,n);break e;case 1:e=nC(null,e,r,t,n);break e;case 11:e=eC(null,e,r,t,n);break e;case 14:e=tC(null,e,r,Jo(r.type,t),n);break e}throw Error(ut(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Jo(r,i),Zb(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Jo(r,i),nC(t,e,r,i,n);case 3:e:{if(QL(e),t===null)throw Error(ut(387));r=e.pendingProps,o=e.memoizedState,i=o.element,EL(t,e),D0(e,r,null,n);var h=e.memoizedState;if(r=h.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=_d(Error(ut(423)),e),e=rC(t,e,r,n,i);break e}else if(r!==i){i=_d(Error(ut(424)),e),e=rC(t,e,r,n,i);break e}else for(to=dc(e.stateNode.containerInfo.firstChild),io=e,Or=!0,ea=null,n=CL(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(md(),r===i){e=dl(t,e,n);break e}xs(t,e,r,n)}e=e.child}return e;case 5:return AL(e),t===null&&$b(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,h=i.children,Nb(r,i)?h=null:o!==null&&Nb(r,o)&&(e.flags|=32),JL(t,e),xs(t,e,h,n),e.child;case 6:return t===null&&$b(e),null;case 13:return eR(t,e,n);case 4:return RE(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=gd(e,null,r,n):xs(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Jo(r,i),eC(t,e,r,i,n);case 7:return xs(t,e,e.pendingProps,n),e.child;case 8:return xs(t,e,e.pendingProps.children,n),e.child;case 12:return xs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,h=i.value,vr(O0,r._currentValue),r._currentValue=h,o!==null)if(aa(o.value,h)){if(o.children===i.children&&!Os.current){e=dl(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){h=o.child;for(var m=l.firstContext;m!==null;){if(m.context===r){if(o.tag===1){m=ll(-1,n&-n),m.tag=2;var _=o.updateQueue;if(_!==null){_=_.shared;var E=_.pending;E===null?m.next=m:(m.next=E.next,E.next=m),_.pending=m}}o.lanes|=n,m=o.alternate,m!==null&&(m.lanes|=n),Gb(o.return,n,e),l.lanes|=n;break}m=m.next}}else if(o.tag===10)h=o.type===e.type?null:o.child;else if(o.tag===18){if(h=o.return,h===null)throw Error(ut(341));h.lanes|=n,l=h.alternate,l!==null&&(l.lanes|=n),Gb(h,n,e),h=o.sibling}else h=o.child;if(h!==null)h.return=o;else for(h=o;h!==null;){if(h===e){h=null;break}if(o=h.sibling,o!==null){o.return=h.return,h=o;break}h=h.return}o=h}xs(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,sd(e,n),i=Ro(i),r=r(i),e.flags|=1,xs(t,e,r,n),e.child;case 14:return r=e.type,i=Jo(r,e.pendingProps),i=Jo(r.type,i),tC(t,e,r,i,n);case 15:return YL(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Jo(r,i),r0(t,e),e.tag=1,zs(r)?(t=!0,k0(e)):t=!1,sd(e,n),SL(e,r,i),Hb(e,r,i,n),Xb(null,e,r,!0,t,n);case 19:return tR(t,e,n);case 22:return KL(t,e,n)}throw Error(ut(156,e.tag))};function yR(t,e){return $k(t,e)}function cN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Io(t,e,n,r){return new cN(t,e,n,r)}function ZE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function uN(t){if(typeof t=="function")return ZE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===fE)return 11;if(t===pE)return 14}return 2}function gc(t,e){var n=t.alternate;return n===null?(n=Io(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function o0(t,e,n,r,i,o){var h=2;if(r=t,typeof t=="function")ZE(t)&&(h=1);else if(typeof t=="string")h=5;else e:switch(t){case Uh:return pu(n.children,i,o,e);case dE:h=8,i|=8;break;case gb:return t=Io(12,n,e,i|2),t.elementType=gb,t.lanes=o,t;case yb:return t=Io(13,n,e,i),t.elementType=yb,t.lanes=o,t;case _b:return t=Io(19,n,e,i),t.elementType=_b,t.lanes=o,t;case Pk:return I_(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Tk:h=10;break e;case Sk:h=9;break e;case fE:h=11;break e;case pE:h=14;break e;case Kl:h=16,r=null;break e}throw Error(ut(130,t==null?t:typeof t,""))}return e=Io(h,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function pu(t,e,n,r){return t=Io(7,t,r,e),t.lanes=n,t}function I_(t,e,n,r){return t=Io(22,t,r,e),t.elementType=Pk,t.lanes=n,t.stateNode={isHidden:!1},t}function h1(t,e,n){return t=Io(6,t,null,e),t.lanes=n,t}function d1(t,e,n){return e=Io(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function hN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hx(0),this.expirationTimes=Hx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hx(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function XE(t,e,n,r,i,o,h,l,m){return t=new hN(t,e,n,l,m),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Io(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},LE(o),t}function dN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bh,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function _R(t){if(!t)return bc;t=t._reactInternals;e:{if(Mu(t)!==t||t.tag!==1)throw Error(ut(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(zs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ut(171))}if(t.tag===1){var n=t.type;if(zs(n))return yL(t,n,e)}return e}function vR(t,e,n,r,i,o,h,l,m){return t=XE(n,r,!0,t,i,o,h,l,m),t.context=_R(null),n=t.current,r=Es(),i=mc(n),o=ll(r,i),o.callback=e??null,fc(n,o,i),t.current.lanes=i,Mm(t,i,r),Ds(t,r),t}function M_(t,e,n,r){var i=e.current,o=Es(),h=mc(i);return n=_R(n),e.context===null?e.context=n:e.pendingContext=n,e=ll(o,h),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=fc(i,e,h),t!==null&&(sa(t,i,h,o),e0(t,i,h)),h}function G0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fC(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function YE(t,e){fC(t,e),(t=t.alternate)&&fC(t,e)}function fN(){return null}var xR=typeof reportError=="function"?reportError:function(t){console.error(t)};function KE(t){this._internalRoot=t}k_.prototype.render=KE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ut(409));M_(t,e,null,null)};k_.prototype.unmount=KE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wu(function(){M_(null,t,null,null)}),e[ul]=null}};function k_(t){this._internalRoot=t}k_.prototype.unstable_scheduleHydration=function(t){if(t){var e=Yk();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ql.length&&e!==0&&e<Ql[n].priority;n++);Ql.splice(n,0,t),n===0&&Jk(t)}};function JE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function L_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pC(){}function pN(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var _=G0(h);o.call(_)}}var h=vR(e,r,t,0,null,!1,!1,"",pC);return t._reactRootContainer=h,t[ul]=h.current,Qp(t.nodeType===8?t.parentNode:t),wu(),h}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var _=G0(m);l.call(_)}}var m=XE(t,0,!1,null,null,!1,!1,"",pC);return t._reactRootContainer=m,t[ul]=m.current,Qp(t.nodeType===8?t.parentNode:t),wu(function(){M_(e,m,n,r)}),m}function R_(t,e,n,r,i){var o=n._reactRootContainer;if(o){var h=o;if(typeof i=="function"){var l=i;i=function(){var m=G0(h);l.call(m)}}M_(e,h,t,i)}else h=pN(n,e,t,i,r);return G0(h)}Zk=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=xp(e.pendingLanes);n!==0&&(yE(e,n|1),Ds(e,ai()),!(Wn&6)&&(vd=ai()+500,Pc()))}break;case 13:wu(function(){var r=hl(t,1);if(r!==null){var i=Es();sa(r,t,1,i)}}),YE(t,1)}};_E=function(t){if(t.tag===13){var e=hl(t,134217728);if(e!==null){var n=Es();sa(e,t,134217728,n)}YE(t,134217728)}};Xk=function(t){if(t.tag===13){var e=mc(t),n=hl(t,e);if(n!==null){var r=Es();sa(n,t,e,r)}YE(t,e)}};Yk=function(){return nr};Kk=function(t,e){var n=nr;try{return nr=t,e()}finally{nr=n}};Ab=function(t,e,n){switch(e){case"input":if(bb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=E_(r);if(!i)throw Error(ut(90));Ak(r),bb(r,i)}}}break;case"textarea":Mk(t,n);break;case"select":e=n.value,e!=null&&td(t,!!n.multiple,e,!1)}};Fk=WE;Nk=wu;var mN={usingClientEntryPoint:!1,Events:[Lm,Gh,E_,zk,Dk,WE]},ep={findFiberByHostInstance:au,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},gN={bundleType:ep.bundleType,version:ep.version,rendererPackageName:ep.rendererPackageName,rendererConfig:ep.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Vk(t),t===null?null:t.stateNode},findFiberByHostInstance:ep.findFiberByHostInstance||fN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gy.isDisabled&&gy.supportsFiber)try{v_=gy.inject(gN),ka=gy}catch{}}co.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mN;co.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!JE(e))throw Error(ut(200));return dN(t,e,null,n)};co.createRoot=function(t,e){if(!JE(t))throw Error(ut(299));var n=!1,r="",i=xR;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=XE(t,1,!1,null,null,n,!1,r,i),t[ul]=e.current,Qp(t.nodeType===8?t.parentNode:t),new KE(e)};co.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ut(188)):(t=Object.keys(t).join(","),Error(ut(268,t)));return t=Vk(e),t=t===null?null:t.stateNode,t};co.flushSync=function(t){return wu(t)};co.hydrate=function(t,e,n){if(!L_(e))throw Error(ut(200));return R_(null,t,e,!0,n)};co.hydrateRoot=function(t,e,n){if(!JE(t))throw Error(ut(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",h=xR;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(h=n.onRecoverableError)),e=vR(e,null,t,1,n??null,i,!1,o,h),t[ul]=e.current,Qp(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new k_(e)};co.render=function(t,e,n){if(!L_(e))throw Error(ut(200));return R_(null,t,e,!1,n)};co.unmountComponentAtNode=function(t){if(!L_(t))throw Error(ut(40));return t._reactRootContainer?(wu(function(){R_(null,null,t,!1,function(){t._reactRootContainer=null,t[ul]=null})}),!0):!1};co.unstable_batchedUpdates=WE;co.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!L_(n))throw Error(ut(200));if(t==null||t._reactInternals===void 0)throw Error(ut(38));return R_(t,e,n,!1,r)};co.version="18.2.0-next-9e3b772b8-20220608";function bR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bR)}catch(t){console.error(t)}}bR(),vk.exports=co;var jd=vk.exports;const yy=Am(jd);var mC=jd;pb.createRoot=mC.createRoot,pb.hydrateRoot=mC.hydrateRoot;function W0(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const QE=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),gC=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);gC&&parseFloat(gC[1]);const yN="3.4.14";function fl(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const a0=typeof process!="object"||String(process)!=="[object process]"||process.browser,_N=typeof window<"u"&&typeof window.orientation<"u",yC=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);yC&&parseFloat(yC[1]);function lm(t){"@babel/helpers - typeof";return lm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lm(t)}function vN(t,e){if(lm(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(lm(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xN(t){var e=vN(t,"string");return lm(e)==="symbol"?e:String(e)}function J(t,e,n){return e=xN(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class bN{constructor(e,n){J(this,"name",void 0),J(this,"workerThread",void 0),J(this,"isRunning",!0),J(this,"result",void 0),J(this,"_resolve",()=>{}),J(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){fl(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){fl(this.isRunning),this.isRunning=!1,this._reject(e)}}let f1=class{terminate(){}};const p1=new Map;function wN(t){fl(t.source&&!t.url||!t.source&&t.url);let e=p1.get(t.source||t.url);return e||(t.url&&(e=EN(t.url),p1.set(t.url,e)),t.source&&(e=wR(t.source),p1.set(t.source,e))),fl(e),e}function EN(t){if(!t.startsWith("http"))return t;const e=TN(t);return wR(e)}function wR(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function TN(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function ER(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(_C(t))r.add(t);else if(_C(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)ER(t[i],e,r)}}return n===void 0?Array.from(r):[]}function _C(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const m1=()=>{};class aw{static isSupported(){return typeof Worker<"u"&&a0||typeof f1<"u"&&!a0}constructor(e){J(this,"name",void 0),J(this,"source",void 0),J(this,"url",void 0),J(this,"terminated",!1),J(this,"worker",void 0),J(this,"onMessage",void 0),J(this,"onError",void 0),J(this,"_loadableURL","");const{name:n,source:r,url:i}=e;fl(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=m1,this.onError=o=>console.log(o),this.worker=a0?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=m1,this.onError=m1,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||ER(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=wN({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new f1(r,{eval:!1})}else if(this.source)e=new f1(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class SN{static isSupported(){return aw.isSupported()}constructor(e){J(this,"name","unnamed"),J(this,"source",void 0),J(this,"url",void 0),J(this,"maxConcurrency",1),J(this,"maxMobileConcurrency",1),J(this,"onDebug",()=>{}),J(this,"reuseWorkers",!0),J(this,"props",{}),J(this,"jobQueue",[]),J(this,"idleQueue",[]),J(this,"count",0),J(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(o,h,l)=>o.done(l),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(o,h)=>o.error(h);const i=new Promise(o=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:o}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new bN(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new aw({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return _N?this.maxMobileConcurrency:this.maxConcurrency}}const PN={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class rl{static isSupported(){return aw.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return rl._workerFarm=rl._workerFarm||new rl({}),rl._workerFarm.setProps(e),rl._workerFarm}constructor(e){J(this,"props",void 0),J(this,"workerPools",new Map),this.props={...PN},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let o=this.workerPools.get(n);return o||(o=new SN({name:n,source:r,url:i}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}J(rl,"_workerFarm",void 0);const CN="latest";function AN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let o=t.version;o==="latest"&&(o=CN);const h=o?"@".concat(o):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(h,"/dist/").concat(r)}return fl(i),i}function IN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yN;fl(t,"no worker provided");const n=t.version;return!(!e||!n)}function MN(t,e){return!rl.isSupported()||!a0&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function kN(t,e,n,r,i){const o=t.id,h=AN(t,n),m=rl.getWorkerFarm(n).getWorkerPool({name:o,url:h});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const _=await m.startJob("process-on-worker",LN.bind(null,i));return _.postMessage("process",{input:e,options:n,context:r}),await(await _.result).result}async function LN(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:o,options:h}=r;try{const l=await t(o,h);e.postMessage("done",{id:i,result:l})}catch(l){const m=l instanceof Error?l.message:"unknown error";e.postMessage("error",{id:i,error:m})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function RN(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}function ON(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(l=>l instanceof ArrayBuffer?new Uint8Array(l):l),i=r.reduce((l,m)=>l+m.byteLength,0),o=new Uint8Array(i);let h=0;for(const l of r)o.set(l,h),h+=l.byteLength;return o.buffer}async function zN(t){const e=[];for await(const n of t)e.push(n);return ON(...e)}let DN="";const vC={};function FN(t){for(const e in vC)if(t.startsWith(e)){const n=vC[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(DN).concat(t)),t}function NN(t){return t&&typeof t=="object"&&t.isBuffer}function TR(t){if(NN(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function SR(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function BN(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const UN=t=>typeof t=="boolean",Dp=t=>typeof t=="function",Om=t=>t!==null&&typeof t=="object",xC=t=>Om(t)&&t.constructor==={}.constructor,VN=t=>t&&typeof t[Symbol.iterator]=="function",jN=t=>t&&typeof t[Symbol.asyncIterator]=="function",ku=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Lu=t=>typeof Blob<"u"&&t instanceof Blob,$N=t=>t&&typeof t=="object"&&t.isBuffer,GN=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Om(t)&&Dp(t.tee)&&Dp(t.cancel)&&Dp(t.getReader),WN=t=>Om(t)&&Dp(t.read)&&Dp(t.pipe)&&UN(t.readable),PR=t=>GN(t)||WN(t),HN=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,qN=/^([-\w.]+\/[-\w.+]+)/;function ZN(t){const e=qN.exec(t);return e?e[1]:t}function bC(t){const e=HN.exec(t);return e?e[1]:""}const CR=/\?.*/;function XN(t){const e=t.match(CR);return e&&e[0]}function eT(t){return t.replace(CR,"")}function O_(t){return ku(t)?t.url:Lu(t)?t.name||"":typeof t=="string"?t:""}function tT(t){if(ku(t)){const e=t,n=e.headers.get("content-type")||"",r=eT(e.url);return ZN(n)||bC(r)}return Lu(t)?t.type||"":typeof t=="string"?bC(t):""}function YN(t){return ku(t)?t.headers["content-length"]||-1:Lu(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function AR(t){if(ku(t))return t;const e={},n=YN(t);n>=0&&(e["content-length"]=String(n));const r=O_(t),i=tT(t);i&&(e["content-type"]=i);const o=await QN(t);o&&(e["x-first-bytes"]=o),typeof t=="string"&&(t=new TextEncoder().encode(t));const h=new Response(t,{headers:e});return Object.defineProperty(h,"url",{value:r}),h}async function KN(t){if(!t.ok){const e=await JN(t);throw new Error(e)}}async function JN(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function QN(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=o=>{var h;return r(o==null||(h=o.target)===null||h===void 0?void 0:h.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=eB(n);return"data:base64,".concat(r)}return null}function eB(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function wC(t,e){if(typeof t=="string"){t=FN(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await AR(t)}function tB(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function zm(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||tB()}const _y=globalThis.window||globalThis.self||globalThis.global,tp=globalThis.process||{},IR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";zm();function nB(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let rB=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=nB(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function iB(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function sB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function g1(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const o=t.width*n,h=t.height*n,l=["font-size:1px;","padding:".concat(Math.floor(h/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(h,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(h,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),l]}let H0;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(H0||(H0={}));const oB=10;function EC(t){return typeof t!="string"?t:(t=t.toUpperCase(),H0[t]||H0.WHITE)}function aB(t,e,n){if(!zm&&typeof t=="string"){if(e){const r=EC(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=EC(n);t="\x1B[".concat(r+oB,"m").concat(t,"\x1B[49m")}}return t}function lB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const o of r){const h=i[o];typeof h=="function"&&(e.find(l=>o===l)||(i[o]=h.bind(t)))}}function q0(t,e){if(!t)throw new Error(e||"Assertion failed")}function vh(){let t;if(zm()&&_y.performance){var e,n;t=_y==null||(e=_y.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in tp){var r;const i=tp==null||(r=tp.hrtime)===null||r===void 0?void 0:r.call(tp);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const xh={debug:zm()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},cB={enabled:!0,level:0};function To(){}const TC={},SC={once:!0};let nT=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=IR,this._startTs=vh(),this._deltaTs=vh(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new rB("__probe-".concat(this.id,"__"),cB),this.timeStamp("".concat(this.id," started")),lB(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((vh()-this._startTs).toPrecision(10))}getDelta(){return Number((vh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){q0(e,n)}warn(e){return this._getLogFunction(0,e,xh.warn,arguments,SC)}error(e){return this._getLogFunction(0,e,xh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,xh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,xh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,xh.debug||xh.info,arguments,SC)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||To,r&&[r],{tag:fB(n)}):To}image(e){let{logLevel:n,priority:r,image:i,message:o="",scale:h=1}=e;return this._shouldLog(n||r)?zm()?dB({image:i,message:o,scale:h}):hB():To}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||To)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=PC({logLevel:e,message:n,opts:r}),{collapsed:o}=r;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||To)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=MR(e)}_getLogFunction(e,n,r,i,o){if(this._shouldLog(e)){o=PC({logLevel:e,message:n,args:i,opts:o}),r=r||o.method,q0(r),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=vh();const h=o.tag||o.message;if(o.once&&h)if(!TC[h])TC[h]=vh();else return To;return n=uB(this.id,o.message,o),r.bind(console,n,...o.args)}return To}};nT.VERSION=IR;function MR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return q0(Number.isFinite(e)&&e>=0),e}function PC(t){const{logLevel:e,message:n}=t;t.logLevel=MR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return q0(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function uB(t,e,n){if(typeof e=="string"){const r=n.time?sB(iB(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=aB(e,n.color,n.background)}return e}function hB(t){return console.warn("removed"),To}function dB(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const o=new Image;return o.onload=()=>{const h=g1(o,n,r);console.log(...h)},o.src=e,To}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...g1(e,n,r)),To;if(i.toLowerCase()==="canvas"){const o=new Image;return o.onload=()=>console.log(...g1(o,n,r)),o.src=e.toDataURL(),To}return To}function fB(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const CC=new nT({id:"loaders.gl"});class pB{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class mB{constructor(){J(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const kR={fetch:null,mimeType:void 0,nothrow:!1,log:new mB,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:QE,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},gB={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function LR(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const RR=()=>{const t=LR();return t.globalOptions=t.globalOptions||{...kR},t.globalOptions};function yB(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],_B(t,n),xB(e,t,r)}function _B(t,e){AC(t,null,kR,gB,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};AC(r,n.id,i,o,e)}}function AC(t,e,n,r,i){const o=e||"Top level",h=e?"".concat(e,"."):"";for(const l in t){const m=!e&&Om(t[l]),_=l==="baseUri"&&!e,E=l==="workerUrl"&&e;if(!(l in n)&&!_&&!E){if(l in r)CC.warn("".concat(o," loader option '").concat(h).concat(l,"' no longer supported, use '").concat(r[l],"'"))();else if(!m){const T=vB(l,i);CC.warn("".concat(o," loader option '").concat(h).concat(l,"' not recognized. ").concat(T))()}}}}function vB(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const o in i.options){if(t===o)return"Did you mean '".concat(i.id,".").concat(o,"'?");const h=o.toLowerCase();(n.startsWith(h)||h.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(o,"'?"))}return r}function xB(t,e,n){const i={...t.options||{}};return bB(i,n),i.log===null&&(i.log=new pB),IC(i,RR()),IC(i,e),i}function IC(t,e){for(const n in e)if(n in e){const r=e[n];xC(r)&&xC(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function bB(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function rT(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function iT(t){var e,n;W0(t,"null loader"),W0(rT(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const OR=()=>{const t=LR();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function wB(t){const e=OR();t=Array.isArray(t)?t:[t];for(const n of t){const r=iT(n);e.find(i=>r===i)||e.unshift(r)}}function EB(){return OR()}const TB=new nT({id:"loaders.gl"}),SB=/\.([^.]+)$/;async function PB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!zR(t))return null;let i=MC(t,e,{...n,nothrow:!0},r);if(i)return i;if(Lu(t)&&(t=await t.slice(0,10).arrayBuffer(),i=MC(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(DR(t));return i}function MC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!zR(t))return null;if(e&&!Array.isArray(e))return iT(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...EB()),AB(i);const o=CB(t,i,n,r);if(!o&&!(n!=null&&n.nothrow))throw new Error(DR(t));return o}function CB(t,e,n,r){const i=O_(t),o=tT(t),h=eT(i)||(r==null?void 0:r.url);let l=null,m="";if(n!=null&&n.mimeType&&(l=y1(e,n==null?void 0:n.mimeType),m="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),l=l||IB(e,h),m=m||(l?"matched url ".concat(h):""),l=l||y1(e,o),m=m||(l?"matched MIME type ".concat(o):""),l=l||kB(e,t),m=m||(l?"matched initial data ".concat(FR(t)):""),l=l||y1(e,n==null?void 0:n.fallbackMimeType),m=m||(l?"matched fallback MIME type ".concat(o):""),m){var _;TB.log(1,"selectLoader selected ".concat((_=l)===null||_===void 0?void 0:_.name,": ").concat(m,"."))}return l}function zR(t){return!(t instanceof Response&&t.status===204)}function DR(t){const e=O_(t),n=tT(t);let r="No valid loader found (";r+=e?"".concat(SR(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?FR(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function AB(t){for(const e of t)iT(e)}function IB(t,e){const n=e&&SB.exec(e),r=n&&n[1];return r?MB(t,r):null}function MB(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function y1(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function kB(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(LB(e,n))return n}else if(ArrayBuffer.isView(e)){if(kC(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&kC(e,0,n))return n;return null}function LB(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function kC(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>RB(t,e,n,i))}function RB(t,e,n,r){if(r instanceof ArrayBuffer)return RN(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=lw(t,e,r.length);return r===i;default:return!1}}function FR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?lw(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?lw(t,0,e):""}function lw(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}const OB=256*1024;function*zB(t,e){const n=(e==null?void 0:e.chunkSize)||OB;let r=0;const i=new TextEncoder;for(;r<t.length;){const o=Math.min(t.length-r,n),h=t.slice(r,r+o);r+=o,yield i.encode(h)}}const DB=256*1024;function FB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=DB}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),o=new ArrayBuffer(i),h=new Uint8Array(t,r,i);new Uint8Array(o).set(h),r+=i,yield o}}()}const NB=1024*1024;async function*BB(t,e){const n=(e==null?void 0:e.chunkSize)||NB;let r=0;for(;r<t.size;){const i=r+n,o=await t.slice(r,i).arrayBuffer();r=i,yield o}}function LC(t,e){return QE?UB(t,e):VB(t)}async function*UB(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:o,value:h}=await i;if(o)return;yield TR(h)}}catch{n.releaseLock()}}async function*VB(t,e){for await(const n of t)yield TR(n)}function jB(t,e){if(typeof t=="string")return zB(t,e);if(t instanceof ArrayBuffer)return FB(t,e);if(Lu(t))return BB(t,e);if(PR(t))return LC(t,e);if(ku(t))return LC(t.body,e);throw new Error("makeIterator")}const NR="Cannot convert supplied data type";function $B(t,e,n){if(e.text&&typeof t=="string")return t;if($N(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(NR)}async function GB(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return $B(t,e);if(Lu(t)&&(t=await AR(t)),ku(t)){const i=t;return await KN(i),e.binary?await i.arrayBuffer():await i.text()}if(PR(t)&&(t=jB(t,n)),VN(t)||jN(t))return zN(t);throw new Error(NR)}function BR(t,e){const n=RR(),r=t||n;return typeof r.fetch=="function"?r.fetch:Om(r.fetch)?i=>wC(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:wC}function WB(t,e,n){if(n)return n;const r={fetch:BR(e,t),...t};if(r.url){const i=eT(r.url);r.baseUrl=i,r.queryString=XN(r.url),r.filename=SR(i),r.baseUrl=BN(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function HB(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function sT(t,e,n,r){fl(!r||typeof r=="object"),e&&!Array.isArray(e)&&!rT(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=O_(t),h=HB(e,r),l=await PB(t,h,n);return l?(n=yB(n,l,h,i),r=WB({url:i,parse:sT,loaders:h},n,r||null),await qB(l,t,n,r)):null}async function qB(t,e,n,r){if(IN(t),ku(e)){const i=e,{ok:o,redirected:h,status:l,statusText:m,type:_,url:E}=i,T=Object.fromEntries(i.headers.entries());r.response={headers:T,ok:o,redirected:h,status:l,statusText:m,type:_,url:E}}if(e=await GB(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(MN(t,n))return await kN(t,e,n,r,sT);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw fl(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function cw(t,e,n,r){!Array.isArray(e)&&!rT(e)&&(n=e,e=void 0);const i=BR(n);let o=t;return typeof t=="string"&&(o=await i(t)),Lu(t)&&(o=await i(t)),await sT(o,e,n)}const ZB="3.4.14",{_parseImageNode:XB}=globalThis,uw=typeof Image<"u",hw=typeof ImageBitmap<"u",YB=!!XB,dw=QE?!0:YB;function KB(t){switch(t){case"auto":return hw||uw||dw;case"imagebitmap":return hw;case"image":return uw;case"data":return dw;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function JB(){if(hw)return"imagebitmap";if(uw)return"image";if(dw)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function QB(t){const e=t6(t);if(!e)throw new Error("Not an image");return e}function e6(t){switch(QB(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function t6(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const n6=/^data:image\/svg\+xml/,r6=/\.svg((\?|#).*)?$/;function oT(t){return t&&(n6.test(t)||r6.test(t))}function i6(t,e){if(oT(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(o){throw new Error(o.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return UR(t,e)}function UR(t,e){if(oT(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function VR(t,e,n){const r=i6(t,n),i=self.URL||self.webkitURL,o=typeof r!="string"&&i.createObjectURL(r);try{return await s6(o||r,e)}finally{o&&i.revokeObjectURL(o)}}async function s6(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=o=>i(new Error("Could not load image ".concat(t,": ").concat(o)))}catch(o){i(o)}})}const o6={};let RC=!0;async function a6(t,e,n){let r;oT(n)?r=await VR(t,e,n):r=UR(t,n);const i=e&&e.imagebitmap;return await l6(r,i)}async function l6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((c6(e)||!RC)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),RC=!1}return await createImageBitmap(t)}function c6(t){for(const e in t||o6)return!1;return!0}function u6(t){return!p6(t,"ftyp",4)||!(t[8]&96)?null:h6(t)}function h6(t){switch(d6(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function d6(t,e,n){return String.fromCharCode(...t.slice(e,n))}function f6(t){return[...t].map(e=>e.charCodeAt(0))}function p6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=f6(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const Ca=!1,Fp=!0;function jR(t){const e=Dm(t);return g6(e)||v6(e)||y6(e)||_6(e)||m6(e)}function m6(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=u6(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function g6(t){const e=Dm(t);return e.byteLength>=24&&e.getUint32(0,Ca)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Ca),height:e.getUint32(20,Ca)}:null}function y6(t){const e=Dm(t);return e.byteLength>=10&&e.getUint32(0,Ca)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Fp),height:e.getUint16(8,Fp)}:null}function _6(t){const e=Dm(t);return e.byteLength>=14&&e.getUint16(0,Ca)===16973&&e.getUint32(2,Fp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Fp),height:e.getUint32(22,Fp)}:null}function v6(t){const e=Dm(t);if(!(e.byteLength>=3&&e.getUint16(0,Ca)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=x6();let o=2;for(;o+9<e.byteLength;){const h=e.getUint16(o,Ca);if(i.has(h))return{mimeType:"image/jpeg",height:e.getUint16(o+5,Ca),width:e.getUint16(o+7,Ca)};if(!r.has(h))return null;o+=2,o+=e.getUint16(o,Ca)}return null}function x6(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Dm(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function b6(t,e){const{mimeType:n}=jR(t)||{},r=globalThis._parseImageNode;return W0(r),await r(t,n)}async function w6(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:o}=n||{},h=E6(i);let l;switch(h){case"imagebitmap":l=await a6(t,e,o);break;case"image":l=await VR(t,e,o);break;case"data":l=await b6(t);break;default:W0(!1)}return i==="data"&&(l=e6(l)),l}function E6(t){switch(t){case"auto":case"data":return JB();default:return KB(t),t}}const T6=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],S6=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],P6={image:{type:"auto",decode:!0}},C6={id:"image",module:"images",name:"Images",version:ZB,mimeTypes:S6,extensions:T6,parse:w6,tests:[t=>!!jR(new DataView(t))],options:P6};function $R(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function xl(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||$R()}const l0={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},vy=l0.window||l0.self||l0.global,np=l0.process||{},GR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";xl();const _1=globalThis;function WR(t){if(!t&&!xl())return"Node";if($R(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":_1.chrome?"Chrome":_1.safari?"Safari":_1.mozInnerScreenX?"Firefox":"Unknown"}function A6(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class I6{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";J(this,"storage",void 0),J(this,"id",void 0),J(this,"config",void 0),this.storage=A6(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function M6(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function k6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function v1(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const o=t.width*n,h=t.height*n,l=["font-size:1px;","padding:".concat(Math.floor(h/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(h,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(h,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),l]}let Z0;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Z0||(Z0={}));function OC(t){return typeof t=="string"?Z0[t.toUpperCase()]||Z0.WHITE:t}function L6(t,e,n){return!xl&&typeof t=="string"&&(e&&(e=OC(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=OC(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function R6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(o=>i===o)||(t[i]=t[i].bind(t)))}function X0(t,e){if(!t)throw new Error(e||"Assertion failed")}function bh(){let t;if(xl&&"performance"in vy){var e,n;t=vy==null||(e=vy.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in np){var r;const i=np==null||(r=np.hrtime)===null||r===void 0?void 0:r.call(np);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const wh={debug:xl&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},O6={enabled:!0,level:0};function So(){}const zC={},DC={once:!0};class aT{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};J(this,"id",void 0),J(this,"VERSION",GR),J(this,"_startTs",bh()),J(this,"_deltaTs",bh()),J(this,"_storage",void 0),J(this,"userData",{}),J(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new I6("__probe-".concat(this.id,"__"),O6),this.timeStamp("".concat(this.id," started")),R6(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((bh()-this._startTs).toPrecision(10))}getDelta(){return Number((bh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){X0(e,n)}warn(e){return this._getLogFunction(0,e,wh.warn,arguments,DC)}error(e){return this._getLogFunction(0,e,wh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,wh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,wh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return this._getLogFunction(e,n,wh.debug||wh.info,arguments,DC)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||So,r&&[r],{tag:N6(n)}):So}image(e){let{logLevel:n,priority:r,image:i,message:o="",scale:h=1}=e;return this._shouldLog(n||r)?xl?F6({image:i,message:o,scale:h}):D6():So}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||So)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=FC({logLevel:e,message:n,opts:r}),{collapsed:o}=r;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||So)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=HR(e)}_getLogFunction(e,n,r,i,o){if(this._shouldLog(e)){o=FC({logLevel:e,message:n,args:i,opts:o}),r=r||o.method,X0(r),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=bh();const h=o.tag||o.message;if(o.once)if(!zC[h])zC[h]=bh();else return So;return n=z6(this.id,o.message,o),r.bind(console,n,...o.args)}return So}}J(aT,"VERSION",GR);function HR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return X0(Number.isFinite(e)&&e>=0),e}function FC(t){const{logLevel:e,message:n}=t;t.logLevel=HR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return X0(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function z6(t,e,n){if(typeof e=="string"){const r=n.time?k6(M6(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=L6(e,n.color,n.background)}return e}function D6(t){return console.warn("removed"),So}function F6(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const o=new Image;return o.onload=()=>{const h=v1(o,n,r);console.log(...h)},o.src=e,So}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...v1(e,n,r)),So;if(i.toLowerCase()==="canvas"){const o=new Image;return o.onload=()=>console.log(...v1(o,n,r)),o.src=e.toDataURL(),So}return So}function N6(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const hr=new aT({id:"deck"});let fw={};function B6(t){fw=t}function ss(t,e,n,r){hr.level>0&&fw[t]&&fw[t].call(null,e,n,r)}function U6(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const V6={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:U6,parseTextSync:JSON.parse};function j6(){const t="8.9.31",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(hr.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:hr,_registerLoggers:B6},wB([V6,[C6,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const $6=j6(),qn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(qn,"IDENTITY",{get:()=>(hr.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Ia={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},cm={common:0,meters:1,pixels:2},NC={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},un=new aT({id:"luma.gl"});function bs(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const G6="Invalid WebGLRenderingContext",W6="Requires WebGL2";function z_(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function Vn(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function H6(t){return Vn(t)?t:null}function D_(t){return bs(z_(t),G6),t}function ws(t){return bs(Vn(t),W6),t}const wp={};function q6(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function Z6(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function X6(t,e){wp[t]=!0,e!==void 0&&q6(e)}function Y6(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(wp[r]=!0);while(r!==0);for(r in wp)if(wp[r])return delete wp[r],parseInt(r,10);return 0}}const Fm=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Fm.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Fm.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Ru=function(e){const n=this;this.gl=e,Y6(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(o){return o===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(o){const h=n.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,o);const l=h.attribs[o];return l.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(o){const h=n.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,o);const l=h.attribs[o];return l.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(o,h){switch(o){case 34962:n.currentArrayBuffer=h;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=h;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(o,h){const m=n.currentVertexArrayObject.attribs[o];switch(h){case 34975:return m.buffer;case 34338:return m.enabled;case 34339:return m.size;case 34340:return m.stride;case 34341:return m.type;case 34922:return m.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(o,h,l,m,_,E){const T=n.currentVertexArrayObject;T.maxAttrib=Math.max(T.maxAttrib,o);const A=T.attribs[o];return A.buffer=n.currentArrayBuffer,A.size=h,A.type=l,A.normalized=m,A.stride=_,A.offset=E,A.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{Z6("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Ru.prototype.VERTEX_ARRAY_BINDING_OES=34229;Ru.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Fm(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Ru.prototype.createVertexArrayOES=function(){const e=new Fm(this);return this.vertexArrayObjects.push(e),e};Ru.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Ru.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Fm&&e.hasBeenBound&&e.ext===this)};Ru.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){X6(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const o=this.currentVertexArrayObject;if(i===o)return;(!i||o.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,o.elementArrayBuffer);let h=this.currentArrayBuffer;const l=Math.max(i?i.maxAttrib:0,o.maxAttrib);for(let m=0;m<=l;m++){const _=o.attribs[m],E=i?i.attribs[m]:null;if((!i||_.enabled!==E.enabled)&&(_.enabled?r.enableVertexAttribArray.call(n,m):r.disableVertexAttribArray.call(n,m)),_.enabled){let T=!1;(!i||_.buffer!==E.buffer)&&(h!==_.buffer&&(r.bindBuffer.call(n,34962,_.buffer),h=_.buffer),T=!0),(T||_.cached!==E.cached)&&r.vertexAttribPointer.call(n,m,_.size,_.type,_.normalized,_.stride,_.offset)}}this.currentArrayBuffer!==h&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function K6(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const o=n.call(this,i);return o||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Ru(this)),this.__OESVertexArrayObject))}}const BC="OES_element_index",UC="WEBGL_draw_buffers",J6="EXT_disjoint_timer_query",Q6="EXT_disjoint_timer_query_webgl2",eU="EXT_texture_filter_anisotropic",VC="WEBGL_debug_renderer_info",tU=35723,nU=4352,rU=36795,iU=34047,sU=37445,oU=37446,_r=t=>Vn(t)?void 0:0,aU={3074:t=>Vn(t)?void 0:36064,[tU]:t=>Vn(t)?void 0:nU,35977:_r,32937:_r,[rU]:(t,e)=>{const n=Vn(t)?t.getExtension(Q6):t.getExtension(J6);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[sU]:(t,e)=>{const n=t.getExtension(VC);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[oU]:(t,e)=>{const n=t.getExtension(VC);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[iU]:(t,e)=>{const n=t.luma.extensions[eU];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:_r,35071:_r,37447:_r,36063:(t,e)=>{if(!Vn(t)){const n=t.getExtension(UC);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:_r,35374:_r,35377:_r,34852:t=>{if(!Vn(t)){const e=t.getExtension(UC);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(BC)?2147483647:65535,33001:t=>t.getExtension(BC)?16777216:65535,33e3:t=>16777216,37157:_r,35373:_r,35657:_r,36183:_r,37137:_r,34045:_r,35978:_r,35979:_r,35968:_r,35376:_r,35375:_r,35659:_r,37154:_r,35371:_r,35658:_r,35076:_r,35077:_r,35380:_r};function lU(t,e,n){const r=aU[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const cU="OES_vertex_array_object",qR="ANGLE_instanced_arrays",uU="WEBGL_draw_buffers",hU="EXT_disjoint_timer_query",dU="EXT_texture_filter_anisotropic",fU="VertexArray requires WebGL2 or OES_vertex_array_object extension";function pU(t,e){return{webgl2:Vn(t),ext:t.getExtension(e)}}const ZR={[cU]:{meta:{suffix:"OES"},createVertexArray:()=>{bs(!1,fU)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[qR]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){bs(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[uU]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{bs(!1)}},[hU]:{meta:{suffix:"EXT"},createQuery:()=>{bs(!1)},deleteQuery:()=>{bs(!1)},beginQuery:()=>{bs(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},x1={readBuffer:(t,e,n)=>{Vn(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:o}=pU(t,qR);let h;switch(r){case 35069:h=i?void 0:!1;break;case 35070:h=!i&&!o?0:void 0;break}return h!==void 0?h:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!Vn(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!Vn(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,o=i[dU];r=o&&o.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:lU,hint(t,e,n,r){return e(n,r)}};function mU(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(K6(t),gU(t),_U(t,ZR),yU(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=mU;function gU(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function yU(t,e){let{target:n,target2:r}=e;Object.keys(x1).forEach(i=>{if(typeof x1[i]=="function"){const o=t[i]?t[i].bind(t):()=>{},h=x1[i].bind(null,t,o);n[i]=h,r[i]=h}})}function _U(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&vU(t,{extension:n,target:t.luma,target2:t})}function vU(t,e){let{extension:n,target:r,target2:i}=e;const o=ZR[n];bs(o);const{meta:h={}}=o,{suffix:l=""}=h,m=t.getExtension(n);for(const _ of Object.keys(o)){const E="".concat(_).concat(l);let T=null;_==="meta"||typeof t[_]=="function"||(m&&typeof m[E]=="function"?T=function(){return m[E](...arguments)}:typeof o[_]=="function"&&(T=o[_].bind(r))),T&&(r[_]=T,i[_]=T)}}const lT={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},$l=(t,e,n)=>e?t.enable(n):t.disable(n),jC=(t,e,n)=>t.hint(n,e),qs=(t,e,n)=>t.pixelStorei(n,e),xU=(t,e)=>{const n=Vn(t)?36009:36160;return t.bindFramebuffer(n,e)},bU=(t,e)=>t.bindFramebuffer(36008,e);function rp(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const wU={3042:$l,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:$l,2885:(t,e)=>t.cullFace(e),2929:$l,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:$l,35723:jC,36006:xU,2886:(t,e)=>t.frontFace(e),33170:jC,2849:(t,e)=>t.lineWidth(e),32823:$l,32824:"polygonOffset",10752:"polygonOffset",35977:$l,32938:"sampleCoverage",32939:"sampleCoverage",3089:$l,3088:(t,e)=>t.scissor(...e),2960:$l,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:qs,3317:qs,37440:qs,37441:qs,37443:qs,3330:qs,3332:qs,3331:qs,36010:bU,3314:qs,32878:qs,3316:qs,3315:qs,32877:qs,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=rp(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=rp(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=rp(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=rp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,o,h,l]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,o,h,l)},stencilOp:(t,e)=>{e=rp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,o,h,l]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,o,h,l)},viewport:(t,e)=>t.viewport(...e)};function Wr(t,e,n){return e[t]!==void 0?e[t]:n[t]}const EU={blendEquation:(t,e,n)=>t.blendEquationSeparate(Wr(32777,e,n),Wr(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Wr(32969,e,n),Wr(32968,e,n),Wr(32971,e,n),Wr(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Wr(32824,e,n),Wr(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Wr(32938,e,n),Wr(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Wr(2962,e,n),Wr(2967,e,n),Wr(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Wr(34816,e,n),Wr(36003,e,n),Wr(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Wr(2964,e,n),Wr(2965,e,n),Wr(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Wr(34817,e,n),Wr(34818,e,n),Wr(34819,e,n))},$C={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},va=(t,e)=>t.isEnabled(e),GC={3042:va,2884:va,2929:va,3024:va,32823:va,32926:va,32928:va,3089:va,2960:va,35977:va};function XR(t){for(const e in t)return!1;return!0}function TU(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function WC(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function SU(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var o=arguments.length,h=new Array(o),l=0;l<o;l++)h[l]=arguments[l];const{valueChanged:m,oldValue:_}=n(t.state._updateCache,...h);return m&&r(...h),_},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function PU(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class CU{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?IU(e):Object.assign({},lT),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){bs(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];pl(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const o in e){bs(o!==void 0);const h=e[o],l=this.cache[o];TU(h,l)||(n=!0,r=l,i&&!(o in i)&&(i[o]=l),this.cache[o]=h)}return{valueChanged:n,oldValue:r}}}function YR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(bs(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new CU(t,{copyState:r}),PU(t);for(const o in $C){const h=$C[o];SU(t,o,h)}WC(t,"getParameter"),WC(t,"isEnabled")}return t.state.enable=n,t}function AU(t){t.state||YR(t,{copyState:!1}),t.state.push()}function HC(t){bs(t.state),t.state.pop()}function pl(t,e){if(bs(z_(t),"setParameters requires a WebGL context"),XR(e))return;const n={};for(const i in e){const o=Number(i),h=wU[i];h&&(typeof h=="string"?n[h]=!0:h(t,e[i],o))}const r=t.state&&t.state.cache;if(r)for(const i in n){const o=EU[i];o(t,e,r)}}function IU(t,e){if(e=e||lT,typeof e=="number"){const i=e,o=GC[i];return o?o(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const o=GC[i];r[i]=o?o(t,Number(i)):t.getParameter(Number(i))}return r}function MU(t){pl(t,lT)}function oa(t,e,n){if(XR(e))return n(t);const{nocatch:r=!0}=e;AU(t),pl(t,e);let i;if(r)i=n(t),HC(t);else try{i=n(t)}finally{HC(t)}return i}function xd(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function b1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=xd(t),i=t.drawingBufferWidth,o=t.drawingBufferHeight;return LU(e,r,i,o,n)}function kU(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function LU(t,e,n,r,i){const o=qC(t[0],e,n);let h=ZC(t[1],e,r,i),l=qC(t[0]+1,e,n);const m=l===n-1?l:l-1;l=ZC(t[1]+1,e,r,i);let _;return i?(l=l===0?l:l+1,_=h,h=l):_=l===r-1?l:l-1,{x:o,y:h,width:Math.max(m-o+1,1),height:Math.max(_-h+1,1)}}function qC(t,e,n){return Math.min(Math.round(t*e),n-1)}function ZC(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const cT=xl(),RU=cT&&typeof document<"u",KR={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function JR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bs(cT,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},KR,t);const{width:e,height:n}=t;function r(l){if(t.throwOnError)throw new Error(l);return console.error(l),null}t.onError=r;let i;const{canvas:o}=t,h=FU({canvas:o,width:e,height:n,onError:r});return i=DU(h,t),i?(i=uT(i,t),NU(i),i):null}function uT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||BU(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},KR,e);const{manageState:n,debug:r}=e;return n&&YR(t,{copyState:!1,log:function(){for(var i=arguments.length,o=new Array(i),h=0;h<i;h++)o[h]=arguments[h];return un.log(1,...o)()}}),cT&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),un.level=Math.max(un.level,1)):un.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function OU(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),o=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:o||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function zU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=kU(e.useDevicePixels);UU(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function DU(t,e){const{onError:n}=e;let r=null;const i=m=>r=m.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:o=!0,webgl2:h=!0}=e;let l=null;return h&&(l=l||t.getContext("webgl2",e),l=l||t.getContext("experimental-webgl2",e)),o&&(l=l||t.getContext("webgl",e),l=l||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),l?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),l):n("Failed to create ".concat(h&&!o?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function FU(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,o;return typeof e=="string"?(RU&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),o=document.getElementById(e)):e?o=e:(o=document.createElement("canvas"),o.id="lumagl-canvas",o.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",o.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(o,document.body.firstChild)),o}function NU(t){const e=Vn(t)?"WebGL2":"WebGL1",n=OU(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";un.info(1,"".concat(e).concat(i," context ").concat(r))()}function BU(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function UU(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(un.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const o=t.luma.canvasSizeInfo;if(o.clientWidth!==r||o.clientHeight!==i||o.devicePixelRatio!==e){let h=e;const l=Math.floor(r*h),m=Math.floor(i*h);t.canvas.width=l,t.canvas.height=m,(t.drawingBufferWidth!==l||t.drawingBufferHeight!==m)&&(un.warn("Device pixel ratio clamped")(),h=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*h),t.canvas.height=Math.floor(i*h)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}function XC(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class YC{constructor(e,n){J(this,"name",void 0),J(this,"type",void 0),J(this,"sampleSize",1),J(this,"time",void 0),J(this,"count",void 0),J(this,"samples",void 0),J(this,"lastTiming",void 0),J(this,"lastSampleTime",void 0),J(this,"lastSampleCount",void 0),J(this,"_count",0),J(this,"_time",0),J(this,"_samples",0),J(this,"_startTime",0),J(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=XC(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(XC()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class hT{constructor(e){J(this,"id",void 0),J(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof YC?this.stats[n]=e:this.stats[n]=new YC(n,r)),this.stats[n]}}const Np="8.5.21",VU="set luma.log.level=1 (or higher) to trace rendering";class jU{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new hT({id:e})),this.stats.get(e)}}const uu=new jU;if(globalThis.luma&&globalThis.luma.VERSION!==Np)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Np));globalThis.luma||(xl()&&un.log(1,"luma.gl ".concat(Np," - ").concat(VU))(),globalThis.luma=globalThis.luma||{VERSION:Np,version:Np,log:un,stats:uu,globals:{modules:{},nodeIO:{}}});function $U(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function GU(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function Wt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function w1(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return Wt(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function yc(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const E1={};function wc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";E1[t]=E1[t]||1;const e=E1[t]++;return"".concat(t,"-").concat(e)}function KC(t){return Wt(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function bd(t){let e=!0;for(const n in t){e=!1;break}return e}function QR(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),o=Object.getPrototypeOf(t);r.forEach(h=>{o.methodName||(o[h]=()=>{throw un.removed("Calling removed method ".concat(e,".").concat(h,": "),i)(),new Error(h)})})}const Eh="Resource subclass must define virtual methods";let bl=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};D_(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||wc(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=w1(this.gl,e),Wt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const o=Vn(this.gl);if(!((!("webgl2"in i)||o)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const l=i.webgl1,m="webgl2"in i?i.webgl2:i.webgl1;return o?m:l}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},o=Vn(this.gl),h={},l=n||Object.keys(i);for(const m of l){const _=i[m];if(_&&(!("webgl2"in _)||o)&&(!("extension"in _)||this.gl.getExtension(_.extension))){const T=r?yc(this.gl,m):m;h[T]=this.getParameter(m,e),r&&_.type==="GLenum"&&(h[T]=yc(this.gl,h[T]))}}return h}setParameter(e,n){e=w1(this.gl,e),Wt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const o=Vn(this.gl);if(!((!("webgl2"in i)||o)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=w1(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return QR(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(Eh)}_deleteHandle(){throw new Error(Eh)}_bindHandle(e){throw new Error(Eh)}_getOptsFromHandle(){throw new Error(Eh)}_getParameter(e,n){throw new Error(Eh)}_setParameter(e,n){throw new Error(Eh)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=uu.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];uu.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=uu.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=uu.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const WU="Failed to deduce GL constant from typed array";function pw(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(WU)}}function um(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function HU(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:o}=t;const h=n*i;o=o||new Uint8Array(h);for(let l=0;l<r/2;++l){const m=l*h,_=(r-l-1)*h;o.set(e.subarray(m,m+h)),e.copyWithin(m,_,_+h),e.set(o,_)}}function qU(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),o=Math.round(r/2),h=new Uint8Array(i*o*4);for(let l=0;l<o;l++)for(let m=0;m<i;m++)for(let _=0;_<4;_++)h[(l*i+m)*4+_]=e[(l*2*n+m*2)*4+_];return{data:h,width:i,height:o}}function mw(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:o={}}=n;for(const l in r)if(l in e){const _=r[l]?"".concat(t,".").concat(r[l]):"N/A";un.removed("".concat(t,".").concat(l),_)()}for(const l in i)if(l in e){const m=i[l];un.deprecated("".concat(t,".").concat(l),"".concat(t,".").concat(m))()}let h=null;for(const l in o)if(l in e){const m=o[l];un.deprecated("".concat(t,".").concat(l),"".concat(t,".").concat(m))(),h=h||Object.assign({},e),h[m]=e[l],delete h[l]}return h||e}const ZU={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},XU={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Qs{static getBytesPerElement(e){return um(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Wt(e.size),um(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Qs(ZU,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Qs.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Qs.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=mw("Accessor",e,XU),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const JC=10,e3={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},YU={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:e3},KU={removedProps:e3};class ur extends bl{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Qs.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Qs.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=mw("Buffer",e,YU),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=mw("Buffer",e,KU),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Qs(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,o=e.byteLength||e.length;Wt(n);const h=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(h,this.handle),i!==0||o!==void 0?(ws(this.gl),this.gl.bufferSubData(this.target,r,n,i,o)):this.gl.bufferSubData(h,r,n),this.gl.bindBuffer(h,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:o}=e;const{gl:h}=this;return ws(h),h.bindBuffer(36662,n.handle),h.bindBuffer(36663,this.handle),h.copyBufferSubData(36662,36663,r,i,o),h.bindBuffer(36662,null),h.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ws(this.gl);const o=um(this.accessor.type||5126,{clamped:!1}),h=this._getAvailableElementCount(n),l=r;let m,_;e?(_=e.length,m=_-l):(m=Math.min(h,i||h),_=l+m);const E=Math.min(h,m);return i=i||E,Wt(i<=E),e=e||new o(_),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(Wt(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(JC,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Wt(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,JC),this.bytesUsed=r,this._trackAllocatedMemory(r);const o=pw(e);return Wt(o),this.setAccessor(new Qs(this.accessor,{type:o})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Wt(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=um(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Qs(this.accessor,{type:pw(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return un.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return un.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return un.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return un.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Qs(this.accessor,e),this}}const dT={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},t3={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},n3={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function JU(t,e){const n=dT[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=Vn(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function QU(t,e){const n=dT[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const eV=[9729,9728],QC=globalThis.WebGLBuffer||function(){};class wd extends bl{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let o=!0;return r&&(o=o&&JU(e,r),o=o&&(!i||QU(e,r))),o}constructor(e,n){const{id:r=wc("texture"),handle:i,target:o}=n;super(e,{id:r,handle:i}),this.target=o,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(N=>this.initialize(Object.assign({},e,{pixels:N,data:N}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:o=6408,border:h=0,recreate:l=!1,parameters:m={},pixelStore:_={},textureUnit:E=void 0}=e;n||(n=i);let{width:T,height:A,dataFormat:L,type:R,compressed:D=!1,mipmaps:W=!0}=e;const{depth:z=0}=e;return{width:T,height:A,compressed:D,dataFormat:L,type:R}=this._deduceParameters({format:o,type:R,dataFormat:L,compressed:D,data:n,width:T,height:A}),this.width=T,this.height=A,this.depth=z,this.format=o,this.type=R,this.dataFormat=L,this.border=h,this.textureUnit=E,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),W&&this._isNPOT()&&(un.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),W=!1,this._updateForNPOT(m)),this.mipmaps=W,this.setImageData({data:n,width:T,height:A,depth:z,format:o,type:R,dataFormat:L,border:h,mipmaps:W,parameters:_,compressed:D}),W&&this.generateMipmap(),this.setParameters(m),l&&(this.data=n),r&&(this._video={video:n,parameters:m,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(un.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),oa(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:o=this.format,border:h=this.border,offset:l=0,parameters:m={}}=e;let{data:_=null,type:E=this.type,width:T=this.width,height:A=this.height,dataFormat:L=this.dataFormat,compressed:R=!1}=e;_||(_=r),{type:E,dataFormat:L,compressed:R,width:T,height:A}=this._deduceParameters({format:o,type:E,dataFormat:L,compressed:R,data:_,width:T,height:A});const{gl:D}=this;D.bindTexture(this.target,this.handle);let W=null;({data:_,dataType:W}=this._getDataType({data:_,compressed:R}));let z,N=0;if(oa(this.gl,m,()=>{switch(W){case"null":D.texImage2D(n,i,o,T,A,h,L,E,_);break;case"typed-array":D.texImage2D(n,i,o,T,A,h,L,E,_,l);break;case"buffer":z=ws(D),z.bindBuffer(35052,_.handle||_),z.texImage2D(n,i,o,T,A,h,L,E,l),z.bindBuffer(35052,null);break;case"browser-object":Vn(D)?D.texImage2D(n,i,o,T,A,h,L,E,_):D.texImage2D(n,i,o,L,E,_);break;case"compressed":for(const[F,$]of _.entries())D.compressedTexImage2D(n,F,$.format,$.width,$.height,h,$.data),N+=$.levelSize;break;default:Wt(!1,"Unknown image data type")}}),W==="compressed")this._trackAllocatedMemory(N,"Texture");else if(_&&_.byteLength)this._trackAllocatedMemory(_.byteLength,"Texture");else{const F=t3[this.dataFormat]||4,$=n3[this.type]||1;this._trackAllocatedMemory(this.width*this.height*F*$,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:o=0,y:h=0,width:l=this.width,height:m=this.height,level:_=0,format:E=this.format,type:T=this.type,dataFormat:A=this.dataFormat,compressed:L=!1,offset:R=0,border:D=this.border,parameters:W={}}=e;if({type:T,dataFormat:A,compressed:L,width:l,height:m}=this._deduceParameters({format:E,type:T,dataFormat:A,compressed:L,data:i,width:l,height:m}),Wt(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const z=i;i=z.data,l=z.shape[0],m=z.shape[1]}i instanceof ur&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),oa(this.gl,W,()=>{if(L)this.gl.compressedTexSubImage2D(n,_,o,h,l,m,E,i);else if(i===null)this.gl.texSubImage2D(n,_,o,h,l,m,A,T,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,_,o,h,l,m,A,T,i,R);else if(i instanceof QC){const z=ws(this.gl);z.bindBuffer(35052,i),z.texSubImage2D(n,_,o,h,l,m,A,T,R),z.bindBuffer(35052,null)}else Vn(this.gl)?ws(this.gl).texSubImage2D(n,_,o,h,l,m,A,T,i):this.gl.texSubImage2D(n,_,o,h,A,T,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return un.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof ur?{data:n.handle,dataType:"buffer"}:n instanceof QC?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:o,dataFormat:h,type:l,compressed:m}=e;const _=dT[n];return h=h||_&&_.dataFormat,l=l||_&&_.types[0],m=m||_&&_.compressed,{width:i,height:o}=this._deduceImageSize(r,i,o),{dataFormat:h,type:l,compressed:m,width:i,height:o,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},Wt(i,"Could not deduced texture size"),Wt(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),Wt(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Wt(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Vn(this.gl)||!this.width||!this.height?!1:!KC(this.width)||!KC(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:eV.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let tV="";function nV(t,e){return Wt(typeof t=="string"),t=tV+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class la extends wd{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return wd.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};D_(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:nV(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const gw=[34069,34070,34071,34072,34073,34074];class r3 extends wd{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};D_(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:o=0,mipmapLevel:h=0}=e;return this._subImage({target:n,data:r,x:i,y:o,mipmapLevel:h})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:o,border:h=0,format:l=6408,type:m=5121}=e;const{gl:_}=this,E=i||o,T=await Promise.all(gw.map(A=>{const L=E[A];return Promise.all(Array.isArray(L)?L:[L])}));this.bind(),gw.forEach((A,L)=>{T[L].length>1&&this.opts.mipmaps!==!1&&un.warn("".concat(this.id," has mipmap and multiple LODs."))(),T[L].forEach((R,D)=>{n&&r?_.texImage2D(A,D,l,n,r,h,l,m,R):_.texImage2D(A,D,l,l,m,R)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:o,data:h,border:l=0,format:m=6408,type:_=5121}=e,{gl:E}=this,T=o||h;return this.bind(),T instanceof Promise?T.then(A=>this.setImageDataForFace(Object.assign({},e,{face:n,data:A,pixels:A}))):this.width||this.height?E.texImage2D(n,0,m,r,i,l,m,_,T):E.texImage2D(n,0,m,m,_,T),this}}r3.FACES=gw;class rV extends wd{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Vn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ws(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:o,depth:h=1,border:l=0,format:m,type:_=5121,offset:E=0,data:T,parameters:A={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),oa(this.gl,A,()=>{ArrayBuffer.isView(T)&&this.gl.texImage3D(this.target,n,r,i,o,h,l,m,_,T),T instanceof ur&&(this.gl.bindBuffer(35052,T.handle),this.gl.texImage3D(this.target,n,r,i,o,h,l,m,_,E))}),T&&T.byteLength)this._trackAllocatedMemory(T.byteLength,"Texture");else{const L=t3[this.dataFormat]||4,R=n3[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*L*R,"Texture")}return this.loaded=!0,this}}const Kc="EXT_color_buffer_float",eA={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Kc,bpp:2},33327:{gl2:Kc,bpp:4},34842:{gl2:Kc,bpp:8},33326:{gl2:Kc,bpp:4},33328:{gl2:Kc,bpp:8},34836:{gl2:Kc,bpp:16},35898:{gl2:Kc,bpp:4}};function iV(t,e,n){const r=n[e];if(!r)return!1;const i=Vn(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class Kh extends bl{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||iV(e,n,eA)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:o=0}=e;return Wt(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),o!==0&&Vn(this.gl)?this.gl.renderbufferStorageMultisample(36161,o,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=o,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*eA[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const sV=256,oV=1024,aV=16384,tA=6144,nA=6145,rA=6146,iA=34041,i3="clear: bad arguments";function fT(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o={};e&&(o.framebuffer=e);let h=0;n&&(h|=aV,n!==!0&&(o.clearColor=n)),r&&(h|=sV,r!==!0&&(o.clearDepth=r)),i&&(h|=oV,r!==!0&&(o.clearStencil=r)),Wt(h!==0,i3),oa(t,o,()=>{t.clear(h)})}function lV(t){let{framebuffer:e=null,buffer:n=tA,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ws(t),oa(t,{framebuffer:e},()=>{switch(n){case tA:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case nA:t.clearBufferfv(nA,0,[i]);break;case rA:t.clearBufferiv(rA,0,[i]);break;case iA:const[o,h]=i;t.clearBufferfi(iA,0,o,h);break;default:Wt(!1,i3)}})}function cV(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Wt(!1),0}}function F_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:o=36064,target:h=null,sourceWidth:l,sourceHeight:m,sourceType:_}=e;const{framebuffer:E,deleteFramebuffer:T}=uV(t);Wt(E);const{gl:A,handle:L,attachments:R}=E;l=l||E.width,m=m||E.height,o===36064&&L===null&&(o=1028),Wt(R[o]),_=_||R[o].type,h=hV(h,_,i,l,m),_=_||pw(h);const D=A.bindFramebuffer(36160,L);return A.readPixels(n,r,l,m,i,_,h),A.bindFramebuffer(36160,D||null),T&&E.delete(),h}function sA(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=F_(t,{sourceAttachment:e}),{width:i,height:o}=t;for(;o>n;)({data:r,width:i,height:o}=qU({data:r,width:i,height:o}));HU({data:r,width:i,height:o});const h=document.createElement("canvas");h.width=i,h.height=o;const l=h.getContext("2d"),m=l.createImageData(i,o);return m.data.set(r),l.putImageData(m,0,0),h.toDataURL()}function uV(t){return t instanceof vi?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:bV(t),deleteFramebuffer:!0}}function hV(t,e,n,r,i){if(t)return t;e=e||5121;const o=um(e,{clamped:!1}),h=cV(n);return new o(r*i*h)}const Sr={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function dV(t){const e=new la(t,{format:6408,type:5126,dataFormat:6408}),n=new vi(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const s3={[Sr.WEBGL2]:[!1,!0],[Sr.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Sr.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Sr.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Sr.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Sr.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Sr.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Sr.FLOAT_BLEND]:["EXT_float_blend"],[Sr.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Sr.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Sr.TEXTURE_FLOAT]:["OES_texture_float",!0],[Sr.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Sr.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Sr.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Sr.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Sr.COLOR_ATTACHMENT_RGBA32F]:[dV,"EXT_color_buffer_float"],[Sr.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Sr.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Sr.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Sr.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Sr.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Sr.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},fV=2;function pV(t,e){return pT(t,e)}function pT(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>o3(t,n))}function mV(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in s3)t.luma.caps[e]===void 0&&(t.luma.caps[e]=o3(t,e));return t.luma.caps}function o3(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=gV(t,e)),t.luma.caps[e]||un.log(fV,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function gV(t,e){const n=s3[e];Wt(n,e);let r;const i=Vn(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const o of i)r=r&&!!t.getExtension(o)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:Wt(!1);return r}const oA="Multiple render targets not supported";class vi extends bl{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let o=!0;return r&&(o=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(o=o&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),o}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new vi(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=ws(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=ws(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:o=!0,depth:h=!0,stencil:l=!1,check:m=!0,readBuffer:_=void 0,drawBuffers:E=void 0}=e;if(Wt(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const T in i){const A=i[T];(Array.isArray(A)?A[0]:A).resize({width:n,height:r})}else i=this._createDefaultAttachments(o,h,l,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:_,drawBuffers:E}),i&&m&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:o=!1,resizeAttachments:h=!0}=e;this.attach(n,{clearAttachments:o,resizeAttachments:h});const{gl:l}=this,m=l.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),l.bindFramebuffer(36160,m||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return Wt(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&un.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(h=>{i[h]=null}),Object.assign(i,e);const o=this.gl.bindFramebuffer(36160,this.handle);for(const h in i){Wt(h!==void 0,"Misspelled framebuffer binding point?");const l=Number(h),m=i[l];let _=m;if(!_)this._unattach(l);else if(_ instanceof Kh)this._attachRenderbuffer({attachment:l,renderbuffer:_});else if(Array.isArray(m)){const[E,T=0,A=0]=m;_=E,this._attachTexture({attachment:l,texture:E,layer:T,level:A})}else this._attachTexture({attachment:l,texture:_,layer:0,level:0});r&&_&&_.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,o||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(h=>!this.attachments[h]).forEach(h=>{delete this.attachments[h]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(_V(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:o=[]}=e,h=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&fT(this.gl,{color:n,depth:r,stencil:i}),o.forEach((l,m)=>{lV(this.gl,{drawBuffer:m,value:l})}),this.gl.bindFramebuffer(36160,h||null),this}readPixels(){return un.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return un.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return un.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return un.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return un.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return un.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:o,height:h}=e;const l=ws(this.gl),m=l.bindFramebuffer(36008,this.handle);return r===0&&i===0&&o===void 0&&h===void 0?l.invalidateFramebuffer(36008,n):l.invalidateFramebuffer(36008,n,r,i,o,h),l.bindFramebuffer(36008,m),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=yc(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const o of r){const h=n?yc(this.gl,o):o;i[h]=this.getAttachmentParameter(e,o,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const o=Number(i),h=e?yc(this.gl,o):o;r[h]=this.getAttachmentParameters(o,e)}return r}show(){return typeof window<"u"&&window.open(sA(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>un.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=sA(this,{targetMaxHeight:100});return un.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,o){let h=null;return e&&(h=h||{},h[36064]=new la(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:o,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(h[36064])),n&&r?(h=h||{},h[33306]=new Kh(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(h[33306])):n?(h=h||{},h[36096]=new Kh(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:o}),this.ownResources.push(h[36096])):r&&Wt(!1),h}_unattach(e){const n=this.attachments[e];n&&(n instanceof Kh?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:o}=e;const{gl:h}=this;switch(h.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:ws(h).framebufferTextureLayer(36160,n,r.target,o,i);break;case 34067:const m=yV(i);h.framebufferTexture2D(36160,n,m,r.handle,o);break;case 3553:h.framebufferTexture2D(36160,n,3553,r.handle,o);break;default:Wt(!1,"Illegal texture type")}h.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=H6(this.gl);n?n.readBuffer(e):Wt(e===36064||e===1029,oA),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=ws(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):Wt(e.length===1&&(e[0]===36064||e[0]===1029),oA)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=mV(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function yV(t){return t<34069?t+34069:t}function _V(t){return(vi.STATUS||{})[t]||"Framebuffer error ".concat(t)}const vV=[36049,36048,33296,33298,33299,33300,33301,33302,33303];vi.ATTACHMENT_PARAMETERS=vV;function xV(t,e){Wt(t instanceof la||t instanceof r3||t instanceof rV);const n=t.constructor,{gl:r,width:i,height:o,format:h,type:l,dataFormat:m,border:_,mipmaps:E}=t,T=Object.assign({width:i,height:o,format:h,type:l,dataFormat:m,border:_,mipmaps:E},e);return new n(r,T)}function bV(t,e){const{gl:n,width:r,height:i,id:o}=t;return new vi(n,Object.assign({},e,{id:"framebuffer-for-".concat(o),width:r,height:i,attachments:{36064:t}}))}function c0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const wV=35632,EV=35633;function TV(t){switch(t){case wV:return"fragment";case EV:return"vertex";default:return"unknown type"}}function SV(t,e,n,r){const i=t.split(/\r?\n/),o={},h={},l=r||c0(e)||"(unnamed)",m="".concat(TV(n)," shader ").concat(l);for(let E=0;E<i.length;E++){const T=i[E];if(T.length<=1)continue;const A=T.split(":"),L=A[0],R=parseInt(A[2],10);if(isNaN(R))throw new Error("GLSL compilation error in ".concat(m,": ").concat(t));L!=="WARNING"?o[R]=T:h[R]=T}const _=PV(e);return{shaderName:m,errors:aA(o,_),warnings:aA(h,_)}}function aA(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const o=t[r+1],h=o.split(":",3),l=h[0],m=parseInt(h[1],10)||0,_=o.substring(h.join(":").length+1).trim();n+=a3("^^^ ".concat(l,": ").concat(_,`

`),m)}}return n}function PV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((o,h)=>{const l=String(h+e),m=l.length;return a3(l,i-m)+n+o})}function a3(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function l3(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const CV="Shader: GLSL source code must be a JavaScript string";class hm extends bl{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Wt(!1),"unknown"}}constructor(e,n){D_(e),Wt(typeof n.source=="string",CV);const r=c0(n.source,null)||n.id||wc("unnamed ".concat(hm.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=c0(n,null);r&&(this.id=wc(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(hm.getTypeName(this.shaderType),":").concat(this.id)}getName(){return c0(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:o,warnings:h}=SV(r,this.source,this.shaderType,this.id);throw un.error("GLSL compilation errors in ".concat(i,`
`).concat(o))(),un.warn("GLSL compilation warnings in ".concat(i,`
`).concat(h))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class T1 extends hm{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class S1 extends hm{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const AV={5126:Er.bind(null,"uniform1fv",Zs,1,ns),35664:Er.bind(null,"uniform2fv",Zs,2,ns),35665:Er.bind(null,"uniform3fv",Zs,3,ns),35666:Er.bind(null,"uniform4fv",Zs,4,ns),5124:Er.bind(null,"uniform1iv",Gl,1,ns),35667:Er.bind(null,"uniform2iv",Gl,2,ns),35668:Er.bind(null,"uniform3iv",Gl,3,ns),35669:Er.bind(null,"uniform4iv",Gl,4,ns),35670:Er.bind(null,"uniform1iv",Gl,1,ns),35671:Er.bind(null,"uniform2iv",Gl,2,ns),35672:Er.bind(null,"uniform3iv",Gl,3,ns),35673:Er.bind(null,"uniform4iv",Gl,4,ns),35674:Er.bind(null,"uniformMatrix2fv",Zs,4,Qa),35675:Er.bind(null,"uniformMatrix3fv",Zs,9,Qa),35676:Er.bind(null,"uniformMatrix4fv",Zs,16,Qa),35678:Ni,35680:Ni,5125:Er.bind(null,"uniform1uiv",xy,1,ns),36294:Er.bind(null,"uniform2uiv",xy,2,ns),36295:Er.bind(null,"uniform3uiv",xy,3,ns),36296:Er.bind(null,"uniform4uiv",xy,4,ns),35685:Er.bind(null,"uniformMatrix2x3fv",Zs,6,Qa),35686:Er.bind(null,"uniformMatrix2x4fv",Zs,8,Qa),35687:Er.bind(null,"uniformMatrix3x2fv",Zs,6,Qa),35688:Er.bind(null,"uniformMatrix3x4fv",Zs,12,Qa),35689:Er.bind(null,"uniformMatrix4x2fv",Zs,8,Qa),35690:Er.bind(null,"uniformMatrix4x3fv",Zs,12,Qa),35678:Ni,35680:Ni,35679:Ni,35682:Ni,36289:Ni,36292:Ni,36293:Ni,36298:Ni,36299:Ni,36300:Ni,36303:Ni,36306:Ni,36307:Ni,36308:Ni,36311:Ni},IV={},MV={},kV={},lA=[0];function mT(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(lA[0]=t,t=lA);const i=t.length;if(i%e&&un.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let o=r[i];o||(o=new n(i),r[i]=o);for(let h=0;h<i;h++)o[h]=t[h];return o}function Zs(t,e){return mT(t,e,Float32Array,IV)}function Gl(t,e){return mT(t,e,Int32Array,MV)}function xy(t,e){return mT(t,e,Uint32Array,kV)}function cA(t,e,n){const r=AV[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function LV(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function RV(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!OV(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function OV(t){return Array.isArray(t)||ArrayBuffer.isView(t)?DV(t):isFinite(t)||t===!0||t===!1||t instanceof wd||t instanceof Kh?!0:t instanceof vi?!!t.texture:!1}function zV(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,o=n.length;i<o;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function DV(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ni(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Er(t,e,n,r){let i=null,o=null;return(h,l,m)=>{const _=e(m,n),E=_.length;let T=!1;if(i===null)i=new Float32Array(E),o=E,T=!0;else{Wt(o===E,"Uniform length cannot change.");for(let A=0;A<E;++A)if(_[A]!==i[A]){T=!0;break}}return T&&(r(h,t,l,_),i.set(_)),T}}function ns(t,e,n,r){t[e](n,r)}function Qa(t,e,n,r){t[e](n,!1,r)}const FV=5120,NV=5121,BV=5122,UV=5123,uA=0,by=1,VV=2,jV=3,wy=4,$V=5,GV=6,gi=5126,WV=35664,HV=35665,qV=35666,ip=5124,ZV=35667,XV=35668,YV=35669,sp=5125,KV=36294,JV=36295,QV=36296,ej=35670,tj=35671,nj=35672,rj=35673,ij=35674,sj=35675,oj=35676,aj=35685,lj=35686,cj=35687,uj=35688,hj=35689,dj=35690,yw={[gi]:[gi,1,"float"],[WV]:[gi,2,"vec2"],[HV]:[gi,3,"vec3"],[qV]:[gi,4,"vec4"],[ip]:[ip,1,"int"],[ZV]:[ip,2,"ivec2"],[XV]:[ip,3,"ivec3"],[YV]:[ip,4,"ivec4"],[sp]:[sp,1,"uint"],[KV]:[sp,2,"uvec2"],[JV]:[sp,3,"uvec3"],[QV]:[sp,4,"uvec4"],[ej]:[gi,1,"bool"],[tj]:[gi,2,"bvec2"],[nj]:[gi,3,"bvec3"],[rj]:[gi,4,"bvec4"],[ij]:[gi,8,"mat2"],[aj]:[gi,8,"mat2x3"],[lj]:[gi,8,"mat2x4"],[sj]:[gi,12,"mat3"],[cj]:[gi,12,"mat3x2"],[uj]:[gi,12,"mat3x4"],[oj]:[gi,16,"mat4"],[hj]:[gi,16,"mat4x2"],[dj]:[gi,16,"mat4x3"]};function fj(t){switch(t){case uA:return uA;case by:return by;case jV:return by;case VV:return by;case wy:return wy;case $V:return wy;case GV:return wy;default:return Wt(!1),0}}function hA(t){const e=yw[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function c3(t,e){switch(t){case FV:case NV:case BV:case UV:t=gi;break}for(const n in yw){const[r,i,o]=yw[n];if(r===t&&i===e)return{glType:n,name:o}}return null}class pj{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:o,type:h,size:l}=n.getActiveAttrib(e.handle,i),m=n.getAttribLocation(e.handle,o);m>=0&&this._addAttribute(m,o,h,l)}this.attributeInfos.sort((i,o)=>i.location-o.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Vn(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:o,type:h,size:l}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,o,h,l)}this.varyingInfos.sort((i,o)=>i.location-o.location)}_addAttribute(e,n,r,i){const{type:o,components:h}=hA(r),l={type:o,size:i*h};this._inferProperties(e,n,l);const m={location:e,name:n,accessor:new Qs(l)};this.attributeInfos.push(m),this.attributeInfosByLocation[e]=m,this.attributeInfosByName[m.name]=m}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:o,components:h}=hA(r),l=new Qs({type:o,size:i*h}),m={location:e,name:n,accessor:l};this.varyingInfos.push(m),this.varyingInfosByName[m.name]=m}}const dA=4,mj=35981,gj=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class u3 extends bl{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",gj),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:o,bufferMode:h=mj}=e;return this.hash=n||"",this.vs=typeof r=="string"?new T1(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new S1(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,Wt(this.vs instanceof T1),Wt(this.fs instanceof S1),this.uniforms={},this._textureUniforms={},o&&o.length>0&&(ws(this.gl),this.varyings=o,this.gl2.transformFeedbackVaryings(this.handle,o,h)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new pj(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:o=0,start:h,end:l,isIndexed:m=!1,indexType:_=5123,instanceCount:E=0,isInstanced:T=E>0,vertexArray:A=null,transformFeedback:L,framebuffer:R,parameters:D={},uniforms:W,samplers:z}=e;if((W||z)&&(un.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(W||{})),un.priority>=n){const N=R?R.id:"default",F="mode=".concat(yc(this.gl,r)," verts=").concat(i," ")+"instances=".concat(E," indexType=").concat(yc(this.gl,_)," ")+"isInstanced=".concat(T," isIndexed=").concat(m," ")+"Framebuffer=".concat(N);un.log(n,F)()}return Wt(A),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||T&&E===0?!1:(A.bindForDraw(i,E,()=>{if(R!==void 0&&(D=Object.assign({},D,{framebuffer:R})),L){const N=fj(r);L.begin(N)}this._bindTextures(),oa(this.gl,D,()=>{m&&T?this.gl2.drawElementsInstanced(r,i,_,o,E):m&&Vn(this.gl)&&!isNaN(h)&&!isNaN(l)?this.gl2.drawRangeElements(r,h,l,i,_,o):m?this.gl.drawElements(r,i,_,o):T?this.gl2.drawArraysInstanced(r,o,i,E):this.gl.drawArrays(r,o,i)}),L&&L.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};un.priority>=2&&RV(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let o=r,h=!1;if(o instanceof vi&&(o=o.texture),o instanceof wd)if(h=this.uniforms[n]!==r,h){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const l=o,{textureIndex:m}=i;l.bind(m),o=m,this._textureUniforms[n]=l}else o=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(o)||h)&&zV(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new T1({handle:i});break;case 35632:r.fs=new S1({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=wc(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),un.time(dA,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),un.timeEnd(dA,"linkProgram for ".concat(this._getName()))(),e.debug||un.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=LV(r.name);let o=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=cA(e,o,r),r.size>1)for(let h=0;h<r.size;h++)o=e.getUniformLocation(this.handle,"".concat(i,"[").concat(h,"]")),this._uniformSetters["".concat(i,"[").concat(h,"]")]=cA(e,o,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const yj=34918,_j=34919,vj=35007,xj=36795,bj=35976,wj=35887,Ej=36202;class Y0 extends bl{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=Vn(e),i=pT(e,Sr.TIMER_QUERY);let o=r||i;for(const h of n)switch(h){case"queries":o=o&&r;break;case"timers":o=o&&i;break;default:Wt(!1)}return o}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(vj)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?Ej:wj)}beginTransformFeedbackQuery(){return this.begin(bj)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,_j);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(xj)}getResult(){return this.gl2.getQueryParameter(this.handle,yj)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const o=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}_createHandle(){return Y0.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class h3 extends bl{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Vn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ws(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,bd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:o,byteOffset:h}=this._getBufferParams(n);return r<0?(this.unused[e]=i,un.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,h,o),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof ur?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const o=n&&n.handle;return!o||i===void 0?this.gl.bindBufferBase(35982,e,o):this.gl.bindBufferRange(35982,e,o,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let Ey=null;function Tj(t){return(!Ey||Ey.byteLength<t)&&(Ey=new ArrayBuffer(t)),Ey}function Sj(t,e){const n=Tj(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function Pj(t){let{target:e,source:n,start:r=0,count:i=1}=t;const o=n.length,h=i*o;let l=0;for(let m=r;l<o;l++)e[m++]=n[l];for(;l<h;)l<h-l?(e.copyWithin(r+l,r,r+l),l*=2):(e.copyWithin(r+l,r,r+h-l),l=h);return e}const Cj="elements must be GL.ELEMENT_ARRAY_BUFFER";class Ys extends bl{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Vn(e)||WR()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Ys(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Ys.MAX_ATTRIBUTES=Ys.MAX_ATTRIBUTES||e.getParameter(34921),Ys.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Ys._setConstantFloatArray(e,n,r);break;case Int32Array:Ys._setConstantIntArray(e,n,r);break;case Uint32Array:Ys._setConstantUintArray(e,n,r);break;default:Wt(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Ys.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Wt(!e||e.target===34963,Cj),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:o,stride:h,offset:l,normalized:m,integer:_,divisor:E}=r,{gl:T,gl2:A}=this;return e=Number(e),this.bind(()=>{T.bindBuffer(34962,n.handle),_?(Wt(Vn(T)),A.vertexAttribIPointer(e,i,o,h,l)):T.vertexAttribPointer(e,i,o,m,h,l),T.enableVertexAttribArray(e),A.vertexAttribDivisor(e,E||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Ys.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,o=r.length*e;let h=!this.buffer;if(this.buffer=this.buffer||new ur(this.gl,i),h=h||this.buffer.reallocate(i),h=h||!this._compareConstantArrayValues(r,this.bufferValue),h){const l=Sj(n.constructor,o);Pj({target:l,source:r,start:0,count:o}),this.buffer.subData(l),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:Wt(!1)}}static _setConstantIntArray(e,n,r){switch(Wt(Vn(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:Wt(!1)}}static _setConstantUintArray(e,n,r){switch(Wt(Vn(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:Wt(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return Wt(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const Aj="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Ij=/^(.+)__LOCATION_([0-9]+)$/,Mj=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class kj{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Ys(e),QR(this,"VertexArray","v6.0",Mj),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:o}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,o)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:o}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ur(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ur&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof ur&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const o={location:-1,accessor:null},{location:h,name:l}=this._getAttributeIndex(e);if(!Number.isFinite(h)||h<0)return this.unused[e]=n,un.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),o;const m=this._getAttributeInfo(l||h);if(!m)return o;const _=this.accessors[h]||{},E=Qs.resolve(m.accessor,_,r,i),{size:T,type:A}=E;return Wt(Number.isFinite(T)&&Number.isFinite(A)),{location:h,accessor:E}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=Ij.exec(e),i=r?r[1]:e,o=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+o,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof ur)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof ur){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof ur){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(Aj)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let o=1;o<this.vertexArrayObject.MAX_ATTRIBUTES;o++)i=this.values[o],ArrayBuffer.isView(i)&&this._setConstantAttribute(o,i)}_setConstantAttributeZero(e,n){if(Ys.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Ys.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:o}=i,h=o>0;if(e.isInstanced=e.isInstanced||h,r instanceof ur){const l=r;if(h){const m=l.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,m)}else{const m=l.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,m)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return un.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function Lj(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let h=0;h<t.length&&h<n;++h)h>0&&(i+=",".concat(h%r===0?" ":"")),i+=dm(t[h],e);const o=t.length>n?"...":"]";return"".concat(i).concat(o)}function dm(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return Lj(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function fA(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;Wt(n);const o=".*_.*",h=".*Matrix",l=n._uniformSetters,m={},_=Object.keys(l).sort();let E=0;for(const L of _)!L.match(o)&&!L.match(h)&&P1({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&E++;for(const L of _)L.match(h)&&P1({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&E++;for(const L of _)m[L]||P1({table:m,header:e,uniforms:r,uniformName:L,undefinedOnly:i})&&E++;let T=0;const A={};if(!i)for(const L in r){const R=r[L];m[L]||(T++,A[L]={Type:"NOT USED: ".concat(R),[e]:dm(R)})}return{table:m,count:E,unusedTable:A,unusedCount:T}}function P1(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:o}=t;const h=r[i],l=Rj(h);return!o||!l?(e[i]={[n]:l?dm(h):"N/A","Uniform Type":l?h:"NOT PROVIDED"},!0):!1}function Rj(t){return t!=null}function Oj(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=pA(e,e.elements,null,n));const i=e.values;for(const o in i){const h=e._getAttributeInfo(o);if(h){let l="".concat(o,": ").concat(h.name);const m=e.accessors[h.location];m&&(l="".concat(o,": ").concat(zj(h.name,m))),r[l]=pA(e,i[o],m,n)}}return r}function pA(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let o="NOT PROVIDED",h=1,l=0,m=0,_,E,T;if(n&&(o=n.type,h=n.size,o=String(o).replace("Array",""),_=o.indexOf("nt")!==-1),e instanceof ur){const A=e,{data:L,changed:R}=A.getDebugData();E=R?"*":"",T=L,m=A.byteLength,l=m/L.BYTES_PER_ELEMENT/h;let D;if(n){const W=n.divisor>0;D="".concat(W?"I ":"P "," ").concat(l," (x").concat(h,"=").concat(m," bytes ").concat(yc(i,o),")")}else _=!0,D="".concat(m," bytes");return{[r]:"".concat(E).concat(dm(T,{size:h,isInteger:_})),"Format ":D}}return T=e,h=e.length,o=String(e.constructor.name).replace("Array",""),_=o.indexOf("nt")!==-1,{[r]:"".concat(dm(T,{size:h,isInteger:_})," (constant)"),"Format ":"".concat(h,"x").concat(o," (constant)")}}function zj(t,e){const{type:n,size:r}=e,i=c3(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function Dj(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=mA(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=mA(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function mA(t){const{type:e,size:n}=t.accessor,r=c3(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const gA=xl()&&typeof document<"u";let Fj=0;class Nj{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=W=>JR(W),onAddHTML:r=null,onInitialize:i=()=>{},onRender:o=()=>{},onFinalize:h=()=>{},onError:l,gl:m=null,glOptions:_={},debug:E=!1,createFramebuffer:T=!1,autoResizeViewport:A=!0,autoResizeDrawingBuffer:L=!0,stats:R=uu.get("animation-loop-".concat(Fj++))}=e;let{useDevicePixels:D=!0}=e;"useDevicePixelRatio"in e&&(un.deprecated("useDevicePixelRatio","useDevicePixels")(),D=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:o,onFinalize:h,onError:l,gl:m,glOptions:_,debug:E,createFramebuffer:T},this.gl=m,this.needsRedraw=null,this.timeline=null,this.stats=R,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:A,autoResizeDrawingBuffer:L,useDevicePixels:D}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Wt(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Y0.isSupported(this.gl,["timers"])?new Y0(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return un.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=gA?new Promise((e,n)=>{if(gA&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):GU(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):$U(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?uT(this.props.gl,e):this.onCreateContext(e),!z_(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");MU(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&zU(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new vi(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Nm="vs",gT="fs";function so(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const C1={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function Bj(t){const e={};for(const n in t){const r=t[n],i=Uj(r);e[n]=i}return e}function Uj(t){let e=yA(t);return e==="object"?t?"type"in t?Object.assign({},t,C1[t.type]):"value"in t?(e=yA(t.value),Object.assign({type:e},t,C1[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},C1[e])}function yA(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const Vj="vs",jj="fs";class _A{constructor(e){let{name:n,vs:r,fs:i,dependencies:o=[],uniforms:h,getUniforms:l,deprecations:m=[],defines:_={},inject:E={},vertexShader:T,fragmentShader:A}=e;so(typeof n=="string"),this.name=n,this.vs=r||T,this.fs=i||A,this.getModuleUniforms=l,this.dependencies=o,this.deprecations=this._parseDeprecationDefinitions(m),this.defines=_,this.injections=$j(E),h&&(this.uniforms=Bj(h))}getModuleSource(e){let n;switch(e){case Vj:n=this.vs||"";break;case jj:n=this.fs||"";break;default:so(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const o=r[i];i in e&&!o.private?(o.validate&&so(o.validate(e[i],o),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=o.value}return n}}function $j(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function Gj(t){return Wj(f3(t))}function Wj(t){const e={},n={};return d3({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function d3(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const o of e)r[o.name]=o,(i[o.name]===void 0||i[o.name]<n)&&(i[o.name]=n);for(const o of e)o.dependencies&&d3({modules:o.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function f3(t,e){return t.map(n=>(n instanceof _A||(so(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),so(n.name,"shader module has no name"),n=new _A(n),n.dependencies=f3(n.dependencies)),n))}function Hj(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const qj=7936,Zj=7937,Xj=7938,Yj=35724,yT={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},ru={};Object.keys(yT).forEach(t=>{ru[t]=t});function Kj(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function Jj(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||qj),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||Zj);return{gpuVendor:Qj(n,r),vendor:n,renderer:r,version:t.getParameter(Xj),shadingLanguageVersion:t.getParameter(Yj)}}function Qj(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const A1={};function vA(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=yT[e];if(so(r,e),!Hj(n))return!0;if(e in A1)return A1[e];const i=r[0],o=n.behavior||"enable",h="#extension GL_".concat(i," : ").concat(o,`
void main(void) {}`),l=t.createShader(35633);t.shaderSource(l,h),t.compileShader(l);const m=t.getShaderParameter(l,35713);return t.deleteShader(l),A1[e]=m,m}function e8(t,e){const n=yT[e];so(n,e);const r=Kj(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return so(i===!1||i===!0),i}function Ty(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>e8(t,n))}function t8(t){switch(Jj(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function n8(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return Ty(t,ru.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),Ty(t,ru.GLSL_DERIVATIVES)&&vA(t,ru.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),Ty(t,ru.GLSL_FRAG_DATA)&&vA(t,ru.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),Ty(t,ru.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const r8=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,i8=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,s8={[Nm]:r8,[gT]:i8},u0="__LUMA_INJECT_DECLARATIONS__",xA=/void\s+main\s*\([^)]*\)\s*\{\n?/,bA=/}\n?[^{}]*$/,I1=[];function wA(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Nm;for(const o in n){const h=n[o];h.sort((m,_)=>m.order-_.order),I1.length=h.length;for(let m=0,_=h.length;m<_;++m)I1[m]=h[m].injection;const l="".concat(I1.join(`
`),`
`);switch(o){case"vs:#decl":i&&(t=t.replace(u0,l));break;case"vs:#main-start":i&&(t=t.replace(xA,m=>m+l));break;case"vs:#main-end":i&&(t=t.replace(bA,m=>l+m));break;case"fs:#decl":i||(t=t.replace(u0,l));break;case"fs:#main-start":i||(t=t.replace(xA,m=>m+l));break;case"fs:#main-end":i||(t=t.replace(bA,m=>l+m));break;default:t=t.replace(o,m=>m+l)}}return t=t.replace(u0,""),r&&(t=t.replace(/\}\s*$/,o=>o+s8[e])),t}function _w(t){const e={};return so(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function Ed(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const p3=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],o8=[...p3,[Ed("attribute"),"in $1"],[Ed("varying"),"out $1"]],a8=[...p3,[Ed("varying"),"in $1"]],m3=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],l8=[...m3,[Ed("in"),"attribute $1"],[Ed("out"),"varying $1"]],c8=[...m3,[Ed("in"),"varying $1"]],vw="gl_FragColor",xw=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,u8=/void\s+main\s*\([^)]*\)\s*\{\n?/;function h8(t,e,n){switch(e){case 300:return n?K0(t,o8):d8(t);case 100:return n?K0(t,l8):f8(t);default:throw new Error("unknown GLSL version ".concat(e))}}function K0(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function d8(t){t=K0(t,a8);const e=t.match(xw);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(vw,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(u8,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(vw,"\\b"),"g"),n)}return t}function f8(t){t=K0(t,c8);const e=t.match(xw);if(e){const n=e[1];t=t.replace(xw,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),vw)}return t}const p8=`

`.concat(u0,`

`),g3={[Nm]:"vertex",[gT]:"fragment"},m8=`precision highp float;

`;function g8(t,e){const{vs:n,fs:r}=e,i=Gj(e.modules||[]);return{gl:t,vs:EA(t,Object.assign({},e,{source:n,type:Nm,modules:i})),fs:EA(t,Object.assign({},e,{source:r,type:gT,modules:i})),getUniforms:y8(i)}}function EA(t,e){let{id:n,source:r,type:i,modules:o,defines:h={},hookFunctions:l=[],inject:m={},transpileToGLSL100:_=!1,prologue:E=!0,log:T}=e;so(typeof r=="string","shader source must be a string");const A=i===Nm,L=r.split(`
`);let R=100,D="",W=r;L[0].indexOf("#version ")===0?(R=300,D=L[0],W=L.slice(1).join(`
`)):D="#version ".concat(R);const z={};o.forEach(re=>{Object.assign(z,re.getDefines())}),Object.assign(z,h);let N=E?"".concat(D,`
`).concat(v8({id:n,source:r,type:i}),`
`).concat(_8({type:i}),`
`).concat(t8(t),`
`).concat(n8(t),`
`).concat(x8(z),`
`).concat(A?"":m8,`
`):"".concat(D,`
`);const F=w8(l),$={},K={},ne={};for(const re in m){const be=typeof m[re]=="string"?{injection:m[re],order:0}:m[re],xe=re.match(/^(v|f)s:(#)?([\w-]+)$/);if(xe){const fe=xe[2],Re=xe[3];fe?Re==="decl"?K[re]=[be]:ne[re]=[be]:$[re]=[be]}else ne[re]=[be]}for(const re of o){T&&re.checkDeprecations(W,T);const be=re.getModuleSource(i,R);N+=be;const xe=re.injections[i];for(const fe in xe){const Re=fe.match(/^(v|f)s:#([\w-]+)$/);if(Re){const Fe=Re[2]==="decl"?K:ne;Fe[fe]=Fe[fe]||[],Fe[fe].push(xe[fe])}else $[fe]=$[fe]||[],$[fe].push(xe[fe])}}return N+=p8,N=wA(N,i,K),N+=b8(F[i],$),N+=W,N=wA(N,i,ne),N=h8(N,_?100:R,A),N}function y8(t){return function(n){const r={};for(const i of t){const o=i.getUniforms(n,r);Object.assign(r,o)}return r}}function _8(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(g3[e].toUpperCase(),`
`)}function v8(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(g3[r],`

`):""}function x8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function b8(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const o=e[r];o.sort((h,l)=>h.order-l.order);for(const h of o)n+="  ".concat(h.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function w8(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,o]=n.split(":"),h=n.replace(/\(.+/,"");e[i][h]=Object.assign(r,{signature:o})}),e}const E8="void main() {gl_FragColor = vec4(0);}",y3=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,T8=`#version 300 es
`.concat(y3);function _3(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,o]=n;if(!e.includes(r)||!i||!o)return null;const h=o.split(";")[0];return{qualifier:r,type:i,name:h}}function v3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?T8:e>300?"#version ".concat(e,`
`).concat(y3):E8;const o=C8(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(o,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(o,`;
}`)}function S8(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return so(!1),null}}function P8(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return so(!1),null}}function C8(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return so(!1),null}}const A8=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,I8={name:"fp32",vs:A8,fs:null};function TA(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const no={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function M8(t,{precision:e=no.precision}={}){return t=k8(t),"".concat(parseFloat(t.toPrecision(e)))}function Td(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function rc(t,e,n){return R8(t,r=>Math.max(e,Math.min(n,r)))}function fm(t,e,n){return Td(t)?t.map((r,i)=>fm(r,e[i],n)):n*e+(1-n)*t}function pm(t,e,n){const r=no.EPSILON;n&&(no.EPSILON=n);try{if(t===e)return!0;if(Td(t)&&Td(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!pm(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=no.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{no.EPSILON=r}}function k8(t){return Math.round(t/no.EPSILON)*no.EPSILON}function L8(t){return t.clone?t.clone():new Array(t.length)}function R8(t,e,n){if(Td(t)){const r=t;n=n||L8(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function O8(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class x3 extends O8(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Td(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(no)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+M8(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!pm(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const o=e[i];this[i]=o+r*(n[i]-o)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(no.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function z8(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Js(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function M1(t,e,n=""){if(no.debug&&!z8(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class D8 extends x3{get x(){return this[0]}set x(e){this[0]=Js(e)}get y(){return this[1]}set y(e){this[1]=Js(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Js(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Js(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return TA(e>=0&&e<this.ELEMENTS,"index is out of range"),Js(this[e])}setComponent(e,n){return TA(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var h0=1e-6,Sd=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function F8(){var t=new Sd(2);return Sd!=Float32Array&&(t[0]=0,t[1]=0),t}function bw(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function N8(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function B8(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function U8(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function V8(t,e){return t[0]=-e[0],t[1]=-e[1],t}function b3(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function j8(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var $8=N8;(function(){var t=F8();return function(e,n,r,i,o,h){var l,m;for(n||(n=2),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],o(t,t,h),e[l]=t[0],e[l+1]=t[1];return e}})();function G8(t,e,n){const r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}function w3(t,e,n){const r=e[0],i=e[1],o=e[2],h=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/h,t[1]=(n[1]*r+n[5]*i+n[9]*o)/h,t[2]=(n[2]*r+n[6]*i+n[10]*o)/h,t}function W8(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function H8(){var t=new Sd(3);return Sd!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function q8(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Z8(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function X8(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Y8(t,e,n){var r=e[0],i=e[1],o=e[2],h=n[0],l=n[1],m=n[2];return t[0]=i*m-o*l,t[1]=o*h-r*m,t[2]=r*l-i*h,t}function E3(t,e,n){var r=e[0],i=e[1],o=e[2],h=n[3]*r+n[7]*i+n[11]*o+n[15];return h=h||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/h,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/h,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/h,t}function K8(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function J8(t,e,n){var r=n[0],i=n[1],o=n[2],h=n[3],l=e[0],m=e[1],_=e[2],E=i*_-o*m,T=o*l-r*_,A=r*m-i*l,L=i*A-o*T,R=o*E-r*A,D=r*T-i*E,W=h*2;return E*=W,T*=W,A*=W,L*=2,R*=2,D*=2,t[0]=l+E+L,t[1]=m+T+R,t[2]=_+A+D,t}function Q8(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function e$(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function t$(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function n$(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],h=e[1],l=e[2],m=Math.sqrt(n*n+r*r+i*i),_=Math.sqrt(o*o+h*h+l*l),E=m*_,T=E&&X8(t,e)/E;return Math.acos(Math.min(Math.max(T,-1),1))}var r$=q8;(function(){var t=H8();return function(e,n,r,i,o,h){var l,m;for(n||(n=3),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],o(t,t,h),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2];return e}})();const k1=[0,0,0];let Sy;class za extends D8{static get ZERO(){return Sy||(Sy=new za(0,0,0),Object.freeze(Sy)),Sy}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&Td(e)?this.copy(e):(no.debug&&(Js(e),Js(n),Js(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return no.debug&&(Js(e.x),Js(e.y),Js(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Js(e)}angle(e){return n$(this,e)}cross(e){return Y8(this,this,e),this.check()}rotateX({radians:e,origin:n=k1}){return Q8(this,this,n,e),this.check()}rotateY({radians:e,origin:n=k1}){return e$(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=k1}){return t$(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return E3(this,this,e),this.check()}transformAsVector(e){return w3(this,this,e),this.check()}transformByMatrix3(e){return K8(this,this,e),this.check()}transformByMatrix2(e){return W8(this,this,e),this.check()}transformByQuaternion(e){return J8(this,this,e),this.check()}}class i$ extends x3{toString(){let e="[";if(no.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Js(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function s$(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o$(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],h=e[7],l=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=h,t[14]=l}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ww(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],h=e[4],l=e[5],m=e[6],_=e[7],E=e[8],T=e[9],A=e[10],L=e[11],R=e[12],D=e[13],W=e[14],z=e[15],N=n*l-r*h,F=n*m-i*h,$=n*_-o*h,K=r*m-i*l,ne=r*_-o*l,re=i*_-o*m,be=E*D-T*R,xe=E*W-A*R,fe=E*z-L*R,Re=T*W-A*D,Ve=T*z-L*D,Fe=A*z-L*W,ze=N*Fe-F*Ve+$*Re+K*fe-ne*xe+re*be;return ze?(ze=1/ze,t[0]=(l*Fe-m*Ve+_*Re)*ze,t[1]=(i*Ve-r*Fe-o*Re)*ze,t[2]=(D*re-W*ne+z*K)*ze,t[3]=(A*ne-T*re-L*K)*ze,t[4]=(m*fe-h*Fe-_*xe)*ze,t[5]=(n*Fe-i*fe+o*xe)*ze,t[6]=(W*$-R*re-z*F)*ze,t[7]=(E*re-A*$+L*F)*ze,t[8]=(h*Ve-l*fe+_*be)*ze,t[9]=(r*fe-n*Ve-o*be)*ze,t[10]=(R*ne-D*$+z*N)*ze,t[11]=(T*$-E*ne-L*N)*ze,t[12]=(l*xe-h*Re-m*be)*ze,t[13]=(n*Re-r*xe+i*be)*ze,t[14]=(D*F-R*K-W*N)*ze,t[15]=(E*K-T*F+A*N)*ze,t):null}function a$(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],h=t[5],l=t[6],m=t[7],_=t[8],E=t[9],T=t[10],A=t[11],L=t[12],R=t[13],D=t[14],W=t[15],z=e*h-n*o,N=e*l-r*o,F=e*m-i*o,$=n*l-r*h,K=n*m-i*h,ne=r*m-i*l,re=_*R-E*L,be=_*D-T*L,xe=_*W-A*L,fe=E*D-T*R,Re=E*W-A*R,Ve=T*W-A*D;return z*Ve-N*Re+F*fe+$*xe-K*be+ne*re}function mu(t,e,n){var r=e[0],i=e[1],o=e[2],h=e[3],l=e[4],m=e[5],_=e[6],E=e[7],T=e[8],A=e[9],L=e[10],R=e[11],D=e[12],W=e[13],z=e[14],N=e[15],F=n[0],$=n[1],K=n[2],ne=n[3];return t[0]=F*r+$*l+K*T+ne*D,t[1]=F*i+$*m+K*A+ne*W,t[2]=F*o+$*_+K*L+ne*z,t[3]=F*h+$*E+K*R+ne*N,F=n[4],$=n[5],K=n[6],ne=n[7],t[4]=F*r+$*l+K*T+ne*D,t[5]=F*i+$*m+K*A+ne*W,t[6]=F*o+$*_+K*L+ne*z,t[7]=F*h+$*E+K*R+ne*N,F=n[8],$=n[9],K=n[10],ne=n[11],t[8]=F*r+$*l+K*T+ne*D,t[9]=F*i+$*m+K*A+ne*W,t[10]=F*o+$*_+K*L+ne*z,t[11]=F*h+$*E+K*R+ne*N,F=n[12],$=n[13],K=n[14],ne=n[15],t[12]=F*r+$*l+K*T+ne*D,t[13]=F*i+$*m+K*A+ne*W,t[14]=F*o+$*_+K*L+ne*z,t[15]=F*h+$*E+K*R+ne*N,t}function J0(t,e,n){var r=n[0],i=n[1],o=n[2],h,l,m,_,E,T,A,L,R,D,W,z;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*o+e[12],t[13]=e[1]*r+e[5]*i+e[9]*o+e[13],t[14]=e[2]*r+e[6]*i+e[10]*o+e[14],t[15]=e[3]*r+e[7]*i+e[11]*o+e[15]):(h=e[0],l=e[1],m=e[2],_=e[3],E=e[4],T=e[5],A=e[6],L=e[7],R=e[8],D=e[9],W=e[10],z=e[11],t[0]=h,t[1]=l,t[2]=m,t[3]=_,t[4]=E,t[5]=T,t[6]=A,t[7]=L,t[8]=R,t[9]=D,t[10]=W,t[11]=z,t[12]=h*r+E*i+R*o+e[12],t[13]=l*r+T*i+D*o+e[13],t[14]=m*r+A*i+W*o+e[14],t[15]=_*r+L*i+z*o+e[15]),t}function _T(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function l$(t,e,n,r){var i=r[0],o=r[1],h=r[2],l=Math.hypot(i,o,h),m,_,E,T,A,L,R,D,W,z,N,F,$,K,ne,re,be,xe,fe,Re,Ve,Fe,ze,Ye;return l<h0?null:(l=1/l,i*=l,o*=l,h*=l,m=Math.sin(n),_=Math.cos(n),E=1-_,T=e[0],A=e[1],L=e[2],R=e[3],D=e[4],W=e[5],z=e[6],N=e[7],F=e[8],$=e[9],K=e[10],ne=e[11],re=i*i*E+_,be=o*i*E+h*m,xe=h*i*E-o*m,fe=i*o*E-h*m,Re=o*o*E+_,Ve=h*o*E+i*m,Fe=i*h*E+o*m,ze=o*h*E-i*m,Ye=h*h*E+_,t[0]=T*re+D*be+F*xe,t[1]=A*re+W*be+$*xe,t[2]=L*re+z*be+K*xe,t[3]=R*re+N*be+ne*xe,t[4]=T*fe+D*Re+F*Ve,t[5]=A*fe+W*Re+$*Ve,t[6]=L*fe+z*Re+K*Ve,t[7]=R*fe+N*Re+ne*Ve,t[8]=T*Fe+D*ze+F*Ye,t[9]=A*Fe+W*ze+$*Ye,t[10]=L*Fe+z*ze+K*Ye,t[11]=R*Fe+N*ze+ne*Ye,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function T3(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],h=e[5],l=e[6],m=e[7],_=e[8],E=e[9],T=e[10],A=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+_*r,t[5]=h*i+E*r,t[6]=l*i+T*r,t[7]=m*i+A*r,t[8]=_*i-o*r,t[9]=E*i-h*r,t[10]=T*i-l*r,t[11]=A*i-m*r,t}function c$(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],h=e[1],l=e[2],m=e[3],_=e[8],E=e[9],T=e[10],A=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-_*r,t[1]=h*i-E*r,t[2]=l*i-T*r,t[3]=m*i-A*r,t[8]=o*r+_*i,t[9]=h*r+E*i,t[10]=l*r+T*i,t[11]=m*r+A*i,t}function S3(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],h=e[1],l=e[2],m=e[3],_=e[4],E=e[5],T=e[6],A=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+_*r,t[1]=h*i+E*r,t[2]=l*i+T*r,t[3]=m*i+A*r,t[4]=_*i-o*r,t[5]=E*i-h*r,t[6]=T*i-l*r,t[7]=A*i-m*r,t}function u$(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],h=n+n,l=r+r,m=i+i,_=n*h,E=r*h,T=r*l,A=i*h,L=i*l,R=i*m,D=o*h,W=o*l,z=o*m;return t[0]=1-T-R,t[1]=E+z,t[2]=A-W,t[3]=0,t[4]=E-z,t[5]=1-_-R,t[6]=L+D,t[7]=0,t[8]=A+W,t[9]=L-D,t[10]=1-_-T,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function h$(t,e,n,r,i,o,h){var l=1/(n-e),m=1/(i-r),_=1/(o-h);return t[0]=o*2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*m,t[6]=0,t[7]=0,t[8]=(n+e)*l,t[9]=(i+r)*m,t[10]=(h+o)*_,t[11]=-1,t[12]=0,t[13]=0,t[14]=h*o*2*_,t[15]=0,t}function d$(t,e,n,r,i){var o=1/Math.tan(e/2),h;return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(h=1/(r-i),t[10]=(i+r)*h,t[14]=2*i*r*h):(t[10]=-1,t[14]=-2*r),t}var f$=d$;function p$(t,e,n,r,i,o,h){var l=1/(e-n),m=1/(r-i),_=1/(o-h);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*m,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*_,t[11]=0,t[12]=(e+n)*l,t[13]=(i+r)*m,t[14]=(h+o)*_,t[15]=1,t}var m$=p$;function g$(t,e,n,r){var i,o,h,l,m,_,E,T,A,L,R=e[0],D=e[1],W=e[2],z=r[0],N=r[1],F=r[2],$=n[0],K=n[1],ne=n[2];return Math.abs(R-$)<h0&&Math.abs(D-K)<h0&&Math.abs(W-ne)<h0?s$(t):(E=R-$,T=D-K,A=W-ne,L=1/Math.hypot(E,T,A),E*=L,T*=L,A*=L,i=N*A-F*T,o=F*E-z*A,h=z*T-N*E,L=Math.hypot(i,o,h),L?(L=1/L,i*=L,o*=L,h*=L):(i=0,o=0,h=0),l=T*h-A*o,m=A*i-E*h,_=E*o-T*i,L=Math.hypot(l,m,_),L?(L=1/L,l*=L,m*=L,_*=L):(l=0,m=0,_=0),t[0]=i,t[1]=l,t[2]=E,t[3]=0,t[4]=o,t[5]=m,t[6]=T,t[7]=0,t[8]=h,t[9]=_,t[10]=A,t[11]=0,t[12]=-(i*R+o*D+h*W),t[13]=-(l*R+m*D+_*W),t[14]=-(E*R+T*D+A*W),t[15]=1,t)}function y$(){var t=new Sd(4);return Sd!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function _$(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Bm(t,e,n){var r=e[0],i=e[1],o=e[2],h=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*h,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*h,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*h,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*h,t}(function(){var t=y$();return function(e,n,r,i,o,h){var l,m;for(n||(n=4),r||(r=0),i?m=Math.min(i*n+r,e.length):m=e.length,l=r;l<m;l+=n)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],t[3]=e[l+3],o(t,t,h),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2],e[l+3]=t[3];return e}})();var Ew;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Ew||(Ew={}));const v$=45*Math.PI/180,x$=1,L1=.1,R1=500,b$=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Da extends i${static get IDENTITY(){return E$()}static get ZERO(){return w$()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Ew}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,o,h,l,m,_,E,T,A,L,R,D,W){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=o,this[5]=h,this[6]=l,this[7]=m,this[8]=_,this[9]=E,this[10]=T,this[11]=A,this[12]=L,this[13]=R,this[14]=D,this[15]=W,this.check()}setRowMajor(e,n,r,i,o,h,l,m,_,E,T,A,L,R,D,W){return this[0]=e,this[1]=o,this[2]=_,this[3]=L,this[4]=n,this[5]=h,this[6]=E,this[7]=R,this[8]=r,this[9]=l,this[10]=T,this[11]=D,this[12]=i,this[13]=m,this[14]=A,this[15]=W,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(b$)}fromObject(e){return this.check()}fromQuaternion(e){return u$(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:o,near:h=L1,far:l=R1}=e;return l===1/0?T$(this,n,r,i,o,h):h$(this,n,r,i,o,h,l),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return g$(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:o,near:h=L1,far:l=R1}=e;return m$(this,n,r,i,o,h,l),this.check()}orthographic(e){const{fovy:n=v$,aspect:r=x$,focalDistance:i=1,near:o=L1,far:h=R1}=e;SA(n);const l=n/2,m=i*Math.tan(l),_=m*r;return this.ortho({left:-_,right:_,bottom:-m,top:m,near:o,far:h})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:o=500}=e;return SA(n),f$(this,n,r,i,o),this.check()}determinant(){return a$(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],o=1/r[1],h=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*o,e[2]=this[2]*h,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*o,e[6]=this[6]*h,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*o,e[10]=this[10]*h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],o=1/r[1],h=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*o,e[2]=this[2]*h,e[3]=this[4]*i,e[4]=this[5]*o,e[5]=this[6]*h,e[6]=this[8]*i,e[7]=this[9]*o,e[8]=this[10]*h,e}transpose(){return o$(this,this),this.check()}invert(){return ww(this,this),this.check()}multiplyLeft(e){return mu(this,e,this),this.check()}multiplyRight(e){return mu(this,this,e),this.check()}rotateX(e){return T3(this,this,e),this.check()}rotateY(e){return c$(this,this,e),this.check()}rotateZ(e){return S3(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return l$(this,this,e,n),this.check()}scale(e){return _T(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return J0(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Bm(n||[-0,-0,-0,-0],e,this),M1(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=j8(n||[-0,-0],e,this);break;case 3:i=E3(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return M1(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=G8(n||[-0,-0],e,this);break;case 3:r=w3(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return M1(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Py,Cy;function w$(){return Py||(Py=new Da([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Py)),Py}function E$(){return Cy||(Cy=new Da,Object.freeze(Cy)),Cy}function SA(t){if(t>Math.PI*2)throw Error("expected radians")}function T$(t,e,n,r,i,o){const h=2*o/(n-e),l=2*o/(i-r),m=(n+e)/(n-e),_=(i+r)/(i-r),E=-1,T=-1,A=-2*o;return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=m,t[9]=_,t[10]=E,t[11]=T,t[12]=0,t[13]=0,t[14]=A,t[15]=0,t}const PA=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,S$={lightSources:{}};function O1(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function P$(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=O1(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((o,h)=>{i["lighting_uPointLight[".concat(h,"].color")]=O1(o),i["lighting_uPointLight[".concat(h,"].position")]=o.position,i["lighting_uPointLight[".concat(h,"].attenuation")]=o.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((o,h)=>{i["lighting_uDirectionalLight[".concat(h,"].color")]=O1(o),i["lighting_uDirectionalLight[".concat(h,"].direction")]=o.direction}),i.lighting_uDirectionalLightCount=r.length,i}function P3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:S$;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},P$({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return P3({lightSources:e})}return{}}const C$={name:"lights",vs:PA,fs:PA,getUniforms:P3,defines:{MAX_LIGHTS:3}},A$=new Uint8Array([0,255,255,255]),I$={pickingSelectedColor:null,pickingHighlightColor:A$,pickingActive:!1,pickingAttribute:!1};function M$(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I$;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const k$=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,L$=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,R$={name:"picking",vs:k$,fs:L$,getUniforms:M$},O$=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,z$={};function D$(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(o=>o/255)}}function F$(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:z$;if(!("material"in t))return{};const{material:e}=t;return e?D$(e):{lighting_uEnabled:!1}}const N$={name:"gouraud-lighting",dependencies:[C$],vs:O$,defines:{LIGHTING_VERTEX:1},getUniforms:F$},B$=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,U$={name:"transform",vs:B$,fs:null};class Um{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Um(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:o={},varyings:h=[],bufferMode:l=35981,transpileToGLSL100:m=!1}=e,_=this._getModuleList(e.modules),E=this._getHash(n),T=this._getHash(r),A=_.map(F=>this._getHash(F.name)).sort(),L=h.map(F=>this._getHash(F)),R=Object.keys(i).sort(),D=Object.keys(o).sort(),W=[],z=[];for(const F of R)W.push(this._getHash(F)),W.push(this._getHash(i[F]));for(const F of D)z.push(this._getHash(F)),z.push(this._getHash(o[F]));const N="".concat(E,"/").concat(T,"D").concat(W.join("/"),"M").concat(A.join("/"),"I").concat(z.join("/"),"V").concat(L.join("/"),"H").concat(this.stateHash,"B").concat(l).concat(m?"T":"");if(!this._programCache[N]){const F=g8(this.gl,{vs:n,fs:r,modules:_,inject:o,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:m});this._programCache[N]=new u3(this.gl,{hash:N,vs:F.vs,fs:F.fs,varyings:h,bufferMode:l}),this._getUniforms[N]=F.getUniforms||($=>{}),this._useCounts[N]=0}return this._useCounts[N]++,this._programCache[N]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let o=0,h=this._defaultModules.length;o<h;++o){const l=this._defaultModules[o],m=l.name;n[i++]=l,r[m]=!0}for(let o=0,h=e.length;o<h;++o){const l=e[o],m=l.name;r[m]||(n[i++]=l,r[m]=!0)}return n.length=i,n}}const V$={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function j$(t,e,n){const r={};let i=e.indices;for(const o in e.attributes){const h=e.attributes[o],l=$$(o,n);if(o==="indices")i=h;else if(h.constant)r[l]=h.value;else{const m=h.value,_={...h};delete _.value,r[l]=[new ur(t,m),_],G$(o,_)}}if(i){const o=i.value||i;Wt(o instanceof Uint16Array||o instanceof Uint32Array,'attribute array for "indices" must be of integer type');const h={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new ur(t,{data:o,target:34963}),h]}return r}function $$(t,e){const{attributeMap:n=V$}=e||{};return n&&n[t]||t}function G$(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Wt(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Th=2,W$=1e4,H$="Model needs drawMode and vertexCount",CA=()=>{},q$={};class mm{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=wc("model")}=n;Wt(z_(e)),this.id=r,this.gl=e,this.id=n.id||wc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Um.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:o,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:E}=e;this.programProps={program:n,vs:r,fs:i,modules:o,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:E},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Wt(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),H$)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:o,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:E}=e;this.programProps={program:n,vs:r,fs:i,modules:o,defines:h,inject:l,varyings:m,bufferMode:_,transpileToGLSL100:E},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Wt(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Wt(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=j$(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(bd(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return fT(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:o={},transformFeedback:h=this.transformFeedback,parameters:l={},vertexArray:m=this.vertexArray}=e;this.setAttributes(o),this.updateModuleSettings(n),this.setUniforms(i);let _;un.priority>=Th&&(_=this._logDrawCallStart(Th));const E=this.vertexArray.getDrawParams(),{isIndexed:T=E.isIndexed,indexType:A=E.indexType,indexOffset:L=E.indexOffset,vertexArrayInstanced:R=E.isInstanced}=this.props;R&&!this.isInstanced&&un.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:D,instanceCount:W}=this,{onBeforeRender:z=CA,onAfterRender:N=CA}=this.props;z(),this.program.setUniforms(this.uniforms);const F=this.program.draw(Object.assign(q$,e,{logPriority:_,uniforms:null,framebuffer:r,parameters:l,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:m,transformFeedback:h,isIndexed:T,indexType:A,isInstanced:D,instanceCount:W,offset:T?L:0}));return N(),un.priority>=Th&&this._logDrawCallEnd(_,m,r),F}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:o}=e;r&&this._setFeedbackBuffers(r),n&&(o=Object.assign({},o,{35977:n})),i.forEach(h=>h.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:o}))}finally{i.forEach(h=>h.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return un.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:o,inject:h,defines:l,varyings:m,bufferMode:_,transpileToGLSL100:E}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:o,inject:h,defines:l,varyings:m,bufferMode:_,transpileToGLSL100:E}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Wt(n instanceof u3,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new kj(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof ur&&n.delete()}}_setAnimationProps(e){this.animated&&Wt(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(bd(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new h3(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:W$;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),un.group(Th,">>> DRAWING MODEL ".concat(this.id),{collapsed:un.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const o=Oj({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:h,unusedTable:l,unusedCount:m}=fA({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:_,count:E}=fA({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});E>0&&un.log("MISSING UNIFORMS",Object.keys(_))(),m>0&&un.log("UNUSED UNIFORMS",Object.keys(l))();const T=Dj(this.vertexArray.configuration);un.table(e,o)(),un.table(e,h)(),un.table(e+1,T)(),i&&i.log({logLevel:Th,message:"Rendered to ".concat(i.id)}),un.groupEnd(Th)()}}class Z${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof ur?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Wt(Vn(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const o=this.feedbackMap[i];i in n&&(r[o]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const o=r[i];if(typeof o=="string"){const h=n[o],{byteLength:l,usage:m,accessor:_}=h;r[i]=this._createNewBuffer(i,{byteLength:l,usage:m,accessor:_})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new h3(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const o=this.feedbackMap[i];n[i]=e.feedbackBuffers[o],r[o]=e.sourceBuffers[i],Wt(r[o]instanceof ur)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new ur(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const X$="transform_uSampler_",Q0="transform_uSize_",AA="transform_position";function Y$(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,h=Object.keys(n).length,l=null;const m={};let _=e,E={};if(h>0||r){const T=_.split(`
`),A=T.slice();if(T.forEach((L,R,D)=>{if(h>0){const W=t9(L,n);if(W){const{updatedLine:z,inject:N}=W;A[R]=z,E=_w([E,N]),Object.assign(m,W.samplerTextureMap),h--}}r&&!l&&(l=e9(L,r))}),r){Wt(i);const L="".concat(Q0).concat(r),R="uniform vec2 ".concat(L,`;
`),D="     vec2 ".concat(AA," = transform_getPos(").concat(L,`);
     gl_Position = vec4(`).concat(AA,`, 0, 1.);
`);E=_w([E,{"vs:#decl":R,"vs:#main-start":D}])}_=A.join(`
`)}return{vs:_,targetTextureType:l,inject:E,samplerTextureMap:m}}function K$(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let o,h;n&&({width:o,height:h}=r,i["".concat(Q0).concat(n)]=[o,h]);for(const l in e)({width:o,height:h}=e[l]),i["".concat(Q0).concat(l)]=[o,h];return i}function J$(t){return _3(t,["attribute","in"])}function Q$(t){const e="".concat(X$).concat(t),n="".concat(Q0).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function e9(t,e){const n=_3(t,["varying","out"]);return n&&n.name===e?n.type:null}function t9(t,e){const n={},r=J$(t);if(!r)return null;const{type:i,name:o}=r;if(o&&e[o]){const h="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:l,sizeName:m,uniformDeclerations:_}=Q$(o),E=S8(i),T="  ".concat(i," ").concat(o," = transform_getInput(").concat(l,", ").concat(m,").").concat(E,`;
`);return n[l]=o,{updatedLine:h,inject:{"vs:#decl":_,"vs:#main-start":T},samplerTextureMap:n}}return null}const n9={10241:9728,10240:9728,10242:33071,10243:33071},r9="transform_output";class i9{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:o}=this.bindings[this.currentIndex],h=Object.assign({},n,e.attributes),l=Object.assign({},e.uniforms),m=Object.assign({},e.parameters);let _=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){h.transform_elementID=this.elementIDBuffer;for(const T in this.samplerTextureMap){const A=this.samplerTextureMap[T];l[T]=r[A]}this._setSourceTextureParameters();const E=K$({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:o});Object.assign(l,E)}return this.hasTargetTexture&&(_=!1,m.viewport=[0,0,i.width,i.height]),{attributes:h,framebuffer:i,uniforms:l,discard:_,parameters:m}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=F_(n);if(!e)return r;const i=r.constructor,o=P8(this.targetTextureType),h=new i(r.length*o/4);let l=0;for(let m=0;m<r.length;m+=4)for(let _=0;_<o;_++)h[l++]=r[m+_];return h}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof la)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,o=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:o}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,o)=>{o[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new ur(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:o}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),o){e.targetTexture=o;const{width:h,height:l}=o,{framebuffer:m}=e;m?(m.update({attachments:{36064:o},resizeAttachments:!1}),m.resize({width:h,height:l})):e.framebuffer=new vi(this.gl,{id:"transform-framebuffer",width:h,height:l,attachments:{36064:o}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(n9)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=xV(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:o,targetTextureType:h,inject:l,samplerTextureMap:m}=Y$({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),_=_w([e.inject||{},l]);this.targetTextureType=h,this.samplerTextureMap=m;const E=e._fs||v3({version:l3(i),input:this.targetTextureVarying,inputType:h,output:r9}),T=this.hasSourceTextures||this.targetTextureVarying?[U$].concat(e.modules||[]):e.modules;return{vs:i,fs:E,modules:T,uniforms:o,inject:_}}}class vT{static isSupported(e){return Vn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();Wt(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new mm(n,Object.assign({},e,{fs:e.fs||v3({version:l3(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){s9(n)&&(this.bufferTransform=new Z$(e,n)),o9(n)&&(this.textureTransform=new i9(e,n)),Wt(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function s9(t){return!!(!bd(t.feedbackBuffers)||!bd(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function o9(t){return!!(!bd(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const IA={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class xT{static get DRAW_MODE(){return IA}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=wc("geometry"),drawMode:r=IA.TRIANGLES,attributes:i={},indices:o=null,vertexCount:h=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,o),this.vertexCount=h||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,Wt(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(Wt(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const o=e[i],{value:h,size:l,constant:m}=o;!m&&h&&l>=1&&(r=Math.min(r,h.length/l))}return Wt(Number.isFinite(r)),r}}let a9=1,l9=1;class C3{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:o=1}=e,h=a9++,l={time:0,delay:n,duration:r,rate:i,repeat:o};return this._setChannelTime(l,this.time),this.channels.set(h,l),h}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:o,channel:h}=i;o.setTime(this.getTime(h))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=l9++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const c9=[255,255,255],u9=1;let h9=0;class d9{constructor(e={}){J(this,"id",void 0),J(this,"color",void 0),J(this,"intensity",void 0),J(this,"type","ambient");const{color:n=c9}=e,{intensity:r=u9}=e;this.id=e.id||"ambient-".concat(h9++),this.color=n,this.intensity=r}}const f9=[255,255,255],p9=1,m9=[0,0,-1];let g9=0;class MA{constructor(e={}){J(this,"id",void 0),J(this,"color",void 0),J(this,"intensity",void 0),J(this,"type","directional"),J(this,"direction",void 0),J(this,"shadow",void 0);const{color:n=f9}=e,{intensity:r=p9}=e,{direction:i=m9}=e,{_shadow:o=!1}=e;this.id=e.id||"directional-".concat(g9++),this.color=n,this.intensity=r,this.type="directional",this.direction=new za(i).normalize().toArray(),this.shadow=o}getProjectedLight(e){return this}}class y9{constructor(e,n={id:"pass"}){J(this,"id",void 0),J(this,"gl",void 0),J(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class bT extends y9{constructor(...e){super(...e),J(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return pl(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:o,onViewportActive:h,clearStack:l=!0,clearCanvas:m=!0}=e;e.pass=e.pass||"unknown";const _=this.gl;m&&v9(_,n),l&&(this._lastRenderIndex=-1);const E=[];for(const T of i){const A=o&&o[T.id];h==null||h(T);const L=this._getDrawLayerParams(T,e),R=T.subViewports||[T];for(const D of R){const W=this._drawLayersInViewport(_,{target:n,moduleParameters:r,viewport:D,view:A,pass:e.pass,layers:e.layers},L);E.push(W)}}return E}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:o,cullRect:h,effects:l,moduleParameters:m},_=!1){const E=[],T=A3(this._lastRenderIndex+1),A={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:h},L={};for(let R=0;R<n.length;R++){const D=n[R],W=this._shouldDrawLayer(D,A,o,L),z={shouldDrawLayer:W};W&&!_&&(z.layerRenderIndex=T(D,W),z.moduleParameters=this._getModuleParameters(D,l,r,m),z.layerParameters=this.getLayerParameters(D,R,e)),E[R]=z}return E}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:o,viewport:h,view:l},m){const _=_9(e,{moduleParameters:r,target:o,viewport:h});if(l&&l.props.clear){const T=l.props.clear===!0?{color:!0,depth:!0}:l.props.clear;oa(e,{scissorTest:!0,scissor:_},()=>fT(e,T))}const E={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};pl(e,{viewport:_});for(let T=0;T<n.length;T++){const A=n[T],{shouldDrawLayer:L,layerRenderIndex:R,moduleParameters:D,layerParameters:W}=m[T];if(L&&A.props.pickable&&E.pickableCount++,A.isComposite)E.compositeCount++;else if(L){E.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,R),D.viewport=h;try{A._drawLayer({moduleParameters:D,uniforms:{layerIndex:R},parameters:W})}catch(z){A.raiseError(z,"drawing ".concat(A," to ").concat(i))}}}return E}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let h=e.parent;for(;h;){if(!h.props.visible||!h.filterSubLayer(n))return!1;n.layer=h,h=h.parent}if(r){const l=n.layer.id;if(l in i||(i[l]=r(n)),!i[l])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var o;const h=Object.assign(Object.create(((o=e.internalState)===null||o===void 0?void 0:o.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:xd(this.gl)});if(n)for(const m of n){var l;Object.assign(h,(l=m.getModuleParameters)===null||l===void 0?void 0:l.call(m,e))}return Object.assign(h,this.getModuleParameters(e,n),i)}}function A3(t=0,e={}){const n={},r=(i,o)=>{const h=i.props._offset,l=i.id,m=i.parent&&i.parent.id;let _;if(m&&!(m in e)&&r(i.parent,!1),m in n){const E=n[m]=n[m]||A3(e[m],e);_=E(i,o),n[l]=E}else Number.isFinite(h)?(_=h+(e[m]||0),n[l]=null):_=t;return o&&_>=t&&(t=_+1),e[l]=_,_};return r}function _9(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",o=e&&e.devicePixelRatio||xd(t),h=i?n.height:t.drawingBufferHeight,l=r;return[l.x*o,h-(l.y+l.height)*o,l.width*o,l.height*o]}function v9(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;pl(t,{viewport:[0,0,n,r]}),t.clear(16640)}class x9 extends bT{constructor(e,n){super(e,n),J(this,"shadowMap",void 0),J(this,"depthBuffer",void 0),J(this,"fbo",void 0),this.shadowMap=new la(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Kh(e,{format:33189,width:1,height:1}),this.fbo=new vi(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;oa(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=xd(this.gl),o=r.width*i,h=r.height*i;(o!==n.width||h!==n.height)&&n.resize({width:o,height:h}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const I3="#define SMOOTH_EDGE_RADIUS 0.5",b9=`
`.concat(I3,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),w9=`
`.concat(I3,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),E9={name:"geometry",vs:b9,fs:w9},T9=Object.keys(qn).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(qn[t],";")).join(""),S9=Object.keys(Ia).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Ia[t],";")).join(""),P9=Object.keys(cm).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(cm[t],";")).join(""),C9="".concat(T9,`
`).concat(S9,`
`).concat(P9,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function A9(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Vm(t){let e={},n;return r=>{for(const i in r)if(!A9(r[i],e[i])){n=t(r),e=r;break}return n}}const kA=[0,0,0,0],I9=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],M3=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],M9=[0,0,0],k3=[0,0,0],k9=Vm(O9);function L3(t,e,n=k3){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,o=!0;switch(e===qn.LNGLAT_OFFSETS||e===qn.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Ia.WEB_MERCATOR:(e===qn.LNGLAT||e===qn.CARTESIAN)&&(i=[0,0,0],o=!1);break;case Ia.WEB_MERCATOR_AUTO_OFFSET:e===qn.LNGLAT?r=i:e===qn.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case Ia.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case Ia.GLOBE:o=!1,i=null;break;default:o=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:o}}function L9(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:o,viewProjectionMatrix:h}=t,l=kA,m=kA,_=t.cameraPosition;const{geospatialOrigin:E,shaderCoordinateOrigin:T,offsetMode:A}=L3(t,e,n);return A&&(m=t.projectPosition(E||T),_=[_[0]-m[0],_[1]-m[1],_[2]-m[2]],m[3]=1,l=Bm([],m,h),o=r||o,h=mu([],i,o),h=mu([],h,I9)),{viewMatrix:o,viewProjectionMatrix:h,projectionCenter:l,originCommon:m,cameraPosCommon:_,shaderCoordinateOrigin:T,geospatialOrigin:E}}function R9({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=qn.DEFAULT,coordinateOrigin:i=k3,autoWrapLongitude:o=!1}){r===qn.DEFAULT&&(r=t.isGeospatial?qn.LNGLAT:qn.CARTESIAN);const h=k9({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return h.project_uWrapLongitude=o,h.project_uModelMatrix=n||M3,h}function O9({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:o,originCommon:h,cameraPosCommon:l,shaderCoordinateOrigin:m,geospatialOrigin:_}=L9(t,n,r),E=t.getDistanceScales(),T=[t.width*e,t.height*e],A=Bm([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,L={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:m,project_uCommonOrigin:h.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:T,project_uDevicePixelRatio:e,project_uFocalDistance:A,project_uCommonUnitsPerMeter:E.unitsPerMeter,project_uCommonUnitsPerWorldUnit:E.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:M9,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:o,project_uModelMatrix:M3,project_uCameraPosition:l};if(_){const R=t.getDistanceScales(_);switch(n){case qn.METER_OFFSETS:L.project_uCommonUnitsPerWorldUnit=R.unitsPerMeter,L.project_uCommonUnitsPerWorldUnit2=R.unitsPerMeter2;break;case qn.LNGLAT:case qn.LNGLAT_OFFSETS:t._pseudoMeters||(L.project_uCommonUnitsPerMeter=R.unitsPerMeter),L.project_uCommonUnitsPerWorldUnit=R.unitsPerDegree,L.project_uCommonUnitsPerWorldUnit2=R.unitsPerDegree2;break;case qn.CARTESIAN:L.project_uCommonUnitsPerWorldUnit=[1,1,R.unitsPerMeter[2]],L.project_uCommonUnitsPerWorldUnit2=[0,0,R.unitsPerMeter2[2]];break}}return L}const z9={};function D9(t=z9){return"viewport"in t?R9(t):{}}const wT={name:"project",dependencies:[I8,E9],vs:C9,getUniforms:D9};function F9(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ad(t,e){const n=Bm([],e,t);return _$(n,n,1/n[3]),n}function LA(t,e){const n=t%e;return n<0?e+n:n}function N9(t,e,n){return n*e+(1-n)*t}function Tw(t,e,n){return t<e?e:t>n?n:t}function B9(t){return Math.log(t)*Math.LOG2E}const ET=Math.log2||B9;function ml(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const ta=Math.PI,R3=ta/4,ko=ta/180,Sw=180/ta,Pd=512,e_=4003e4,Ay=85.051129,U9=1.5;function RA(t){return Math.pow(2,t)}function O3(t){return ET(t)}function Cd(t){const[e,n]=t;ml(Number.isFinite(e)),ml(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*ko,i=n*ko,o=Pd*(r+ta)/(2*ta),h=Pd*(ta+Math.log(Math.tan(R3+i*.5)))/(2*ta);return[o,h]}function Eu(t){const[e,n]=t,r=e/Pd*(2*ta)-ta,i=2*(Math.atan(Math.exp(n/Pd*(2*ta)-ta))-R3);return[r*Sw,i*Sw]}function V9(t){const{latitude:e}=t;ml(Number.isFinite(e));const n=Math.cos(e*ko);return O3(e_*n)-9}function z1(t){const e=Math.cos(t*ko);return Pd/e_/e}function Pw(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;ml(Number.isFinite(e)&&Number.isFinite(n));const i=Pd,o=Math.cos(e*ko),h=i/360,l=h/o,m=i/e_/o,_={unitsPerMeter:[m,m,m],metersPerUnit:[1/m,1/m,1/m],unitsPerDegree:[h,l,m],degreesPerUnit:[1/h,1/l,1/m]};if(r){const E=ko*Math.tan(e*ko)/o,T=h*E/2,A=i/e_*E,L=A/l*m;_.unitsPerDegree2=[0,T,A],_.unitsPerMeter2=[L,0,L]}return _}function z3(t,e){const[n,r,i]=t,[o,h,l]=e,{unitsPerMeter:m,unitsPerMeter2:_}=Pw({longitude:n,latitude:r,highPrecision:!0}),E=Cd(t);E[0]+=o*(m[0]+_[0]*h),E[1]+=h*(m[1]+_[1]*h);const T=Eu(E),A=(i||0)+(l||0);return Number.isFinite(i)||Number.isFinite(l)?[T[0],T[1],A]:T}function j9(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:o,center:h}=t,l=F9();J0(l,l,[0,0,-i]),T3(l,l,-n*ko),S3(l,l,r*ko);const m=o/e;return _T(l,l,[m,m,m]),h&&J0(l,l,Z8([],h)),l}function $9(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:o,center:h,scale:l,nearZMultiplier:m=1,farZMultiplier:_=1}=t;let{fovy:E=t_(U9)}=t;r!==void 0&&(E=t_(r));const T=E*ko,A=i*ko,L=D3(E);let R=L;h&&(R+=h[2]*l/Math.cos(A)/n);const D=T*(.5+(o?o[1]:0)/n),W=Math.sin(D)*R/Math.sin(Tw(Math.PI/2-A-D,.01,Math.PI-.01)),z=Math.sin(A)*W+R,N=R*10,F=Math.min(z*_,N);return{fov:T,aspect:e/n,focalDistance:L,near:m,far:F}}function t_(t){return 2*Math.atan(.5/t)*Sw}function D3(t){return .5/Math.tan(.5*t*ko)}function F3(t,e){const[n,r,i=0]=t;return ml(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),ad(e,[n,r,i,1])}function TT(t,e,n=0){const[r,i,o]=t;if(ml(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(o))return ad(e,[r,i,o,1]);const h=ad(e,[r,i,0,1]),l=ad(e,[r,i,1,1]),m=h[2],_=l[2],E=m===_?0:((n||0)-m)/(_-m);return b3([],h,l,E)}function G9(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:o=24,offset:h=[0,0]}=t,[[l,m],[_,E]]=r,T=W9(t.padding),A=Cd([l,Tw(E,-Ay,Ay)]),L=Cd([_,Tw(m,-Ay,Ay)]),R=[Math.max(Math.abs(L[0]-A[0]),i),Math.max(Math.abs(L[1]-A[1]),i)],D=[e-T.left-T.right-Math.abs(h[0])*2,n-T.top-T.bottom-Math.abs(h[1])*2];ml(D[0]>0&&D[1]>0);const W=D[0]/R[0],z=D[1]/R[1],N=(T.right-T.left)/2/W,F=(T.top-T.bottom)/2/z,$=[(L[0]+A[0])/2+N,(L[1]+A[1])/2+F],K=Eu($),ne=Math.min(o,ET(Math.abs(Math.min(W,z))));return ml(Number.isFinite(ne)),{longitude:K[0],latitude:K[1],zoom:ne}}function W9(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(ml(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const OA=Math.PI/180;function H9(t,e=0){const{width:n,height:r,unproject:i}=t,o={targetZ:e},h=i([0,r],o),l=i([n,r],o);let m,_;const E=t.fovy?.5*t.fovy*OA:Math.atan(.5/t.altitude),T=(90-t.pitch)*OA;return E>T-.01?(m=zA(t,0,e),_=zA(t,n,e)):(m=i([0,0],o),_=i([n,0],o)),[h,l,_,m]}function zA(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=ad(r,[e,0,1,1]),o=ad(r,[e,t.height,1,1]),l=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(o[2]-i[2]),m=b3([],i,o,l),_=Eu(m);return _.push(n),_}const DA=512;function q9(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:o,zoom:h,bearing:l=0}=t;(i<-180||i>180)&&(i=LA(i+180,360)-180),(l<-180||l>180)&&(l=LA(l+180,360)-180);const m=ET(n/DA);if(h<=m)h=m,o=0;else{const _=n/2/Math.pow(2,h),E=Eu([0,_])[1];if(o<E)o=E;else{const T=Eu([0,DA-_])[1];o>T&&(o=T)}}return{width:e,height:n,longitude:i,latitude:o,zoom:h,pitch:r,bearing:l}}const N3=.01,Z9=["longitude","latitude","zoom"],B3={curve:1.414,speed:1.2};function X9(t,e,n,r){const{startZoom:i,startCenterXY:o,uDelta:h,w0:l,u1:m,S:_,rho:E,rho2:T,r0:A}=U3(t,e,r);if(m<N3){const $={};for(const K of Z9){const ne=t[K],re=e[K];$[K]=N9(ne,re,n)}return $}const L=n*_,R=Math.cosh(A)/Math.cosh(A+E*L),D=l*((Math.cosh(A)*Math.tanh(A+E*L)-Math.sinh(A))/T)/m,W=1/R,z=i+O3(W),N=B8([],h,D);bw(N,N,o);const F=Eu(N);return{longitude:F[0],latitude:F[1],zoom:z}}function Y9(t,e,n){const r={...B3,...n},{screenSpeed:i,speed:o,maxDuration:h}=r,{S:l,rho:m}=U3(t,e,r),_=1e3*l;let E;return Number.isFinite(i)?E=_/(i/m):E=_/o,Number.isFinite(h)&&E>h?0:E}function U3(t,e,n){n=Object.assign({},B3,n);const r=n.curve,i=t.zoom,o=[t.longitude,t.latitude],h=RA(i),l=e.zoom,m=[e.longitude,e.latitude],_=RA(l-i),E=Cd(o),T=Cd(m),A=$8([],T,E),L=Math.max(t.width,t.height),R=L/_,D=U8(A)*h,W=Math.max(D,N3),z=r*r,N=(R*R-L*L+z*z*W*W)/(2*L*z*W),F=(R*R-L*L-z*z*W*W)/(2*R*z*W),$=Math.log(Math.sqrt(N*N+1)-N),K=Math.log(Math.sqrt(F*F+1)-F),ne=(K-$)/r;return{startZoom:i,startCenterXY:E,uDelta:A,w0:L,u1:D,S:ne,rho:r,rho2:z,r0:$,r1:K}}const K9=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,J9=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,Q9=Vm(iG),eG=Vm(sG),tG=[0,0,0,1],nG=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function rG(t,e){const[n,r,i]=t,o=TT([n,r,i],e);return Number.isFinite(i)?o:[o[0],o[1],0]}function iG({viewport:t,center:e}){return new Da(t.viewProjectionMatrix).invert().transform(e)}function sG({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,o=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(h=>rG(h,r));for(const h of e){const l=h.clone().translate(new za(t.center).negate()),m=o.map(E=>l.transform(E)),_=new Da().ortho({left:Math.min(...m.map(E=>E[0])),right:Math.max(...m.map(E=>E[0])),bottom:Math.min(...m.map(E=>E[1])),top:Math.max(...m.map(E=>E[1])),near:Math.min(...m.map(E=>-E[2])),far:Math.max(...m.map(E=>-E[2]))});n.push(_.multiplyRight(h))}return n}function oG(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||tG,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=Q9({viewport:t.viewport,center:e.project_uCenter}),o=[],h=eG({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let l=0;l<t.shadowMatrices.length;l++){const m=h[l],_=m.clone().translate(new za(t.viewport.center).negate());e.project_uCoordinateSystem===qn.LNGLAT&&e.project_uProjectionMode===Ia.WEB_MERCATOR?(h[l]=_,o[l]=i):(h[l]=m.clone().multiplyRight(nG),o[l]=_.transform(i))}for(let l=0;l<h.length;l++)r["shadow_uViewProjectionMatrices[".concat(l,"]")]=h[l],r["shadow_uProjectCenters[".concat(l,"]")]=o[l],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(l)]=t.shadowMaps[l]:r["shadow_uShadowMap".concat(l)]=t.dummyShadowMap;return r}const D1={name:"shadow",dependencies:[wT],vs:K9,fs:J9,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?oG(t,e):{}},aG={color:[255,255,255],intensity:1},FA=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],lG=[0,0,0,200/255];class V3{constructor(e={}){J(this,"id","lighting-effect"),J(this,"props",void 0),J(this,"shadowColor",lG),J(this,"shadow",void 0),J(this,"ambientLight",void 0),J(this,"directionalLights",void 0),J(this,"pointLights",void 0),J(this,"shadowPasses",[]),J(this,"shadowMaps",[]),J(this,"dummyShadowMap",null),J(this,"programManager",void 0),J(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:o,views:h}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Um.getDefaultProgramManager(e),D1&&this.programManager.addDefaultModule(D1)),this.dummyShadowMap||(this.dummyShadowMap=new la(e,{width:1,height:1}));for(let l=0;l<this.shadowPasses.length;l++)this.shadowPasses[l].render({layers:n,layerFilter:r,viewports:i,onViewportActive:o,views:h,moduleParameters:{shadowLightId:l,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(D1),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Da().lookAt({eye:new za(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new x9(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new d9(aG),this.directionalLights.push(new MA(FA[0]),new MA(FA[1])))}}class cG{constructor(e={}){J(this,"_pool",[]),J(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:o=0,copy:h=!1,initialize:l=!1,maxCount:m}){const _=i||e&&e.constructor||Float32Array,E=n*r+o;if(ArrayBuffer.isView(e)){if(E<=e.length)return e;if(E*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new _(e.buffer,0,E)}let T=1/0;m&&(T=m*r+o);const A=this._allocate(_,E,l,T);return e&&h?A.set(e):l||A.fill(0,0,4),this._release(e),A}release(e){this._release(e)}_allocate(e,n,r,i){let o=Math.max(Math.ceil(n*this.opts.overAlloc),1);o>i&&(o=i);const h=this._pool,l=e.BYTES_PER_ELEMENT*o,m=h.findIndex(_=>_.byteLength>=l);if(m>=0){const _=new e(h.splice(m,1)[0],0,o);return r&&_.fill(0),_}return new e(o)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,o=n.findIndex(h=>h.byteLength>=i);o<0?n.push(r):(o>0||n.length<this.opts.poolSize)&&n.splice(o,0,r),n.length>this.opts.poolSize&&n.shift()}}const Ad=new cG;function Ep(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function uG(t){return[t[12],t[13],t[14]]}function hG(t){return{left:Sh(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Sh(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Sh(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Sh(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Sh(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Sh(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const NA=new za;function Sh(t,e,n,r){NA.set(t,e,n);const i=NA.len();return{distance:r/i,normal:new za(-t/i,-e/i,-n/i)}}function dG(t){return t-Math.fround(t)}let op;function F1(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,o=(i-r)/n;op=Ad.allocate(op,o,{type:Float32Array,size:n*2});let h=r,l=0;for(;h<i;){for(let m=0;m<n;m++){const _=t[h++];op[l+m]=_,op[l+m+n]=dG(_)}l+=n*2}return op.subarray(0,o*n*2)}function fG(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const pG=Math.PI/180,mG=Ep(),BA=[0,0,0],gG={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function yG({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:o,near:h,far:l}){const m=t/e,_=n?new Da().orthographic({fovy:r,aspect:m,focalDistance:i,near:h,far:l}):new Da().perspective({fovy:r,aspect:m,near:h,far:l});if(o){const{left:E=0,right:T=0,top:A=0,bottom:L=0}=o,R=rc((E+t-T)/2,0,t)-t/2,D=rc((A+e-L)/2,0,e)-e/2;_[8]-=R*2/t,_[9]+=D*2/e}return _}class $d{constructor(e={}){J(this,"id",void 0),J(this,"x",void 0),J(this,"y",void 0),J(this,"width",void 0),J(this,"height",void 0),J(this,"padding",void 0),J(this,"isGeospatial",void 0),J(this,"zoom",void 0),J(this,"focalDistance",void 0),J(this,"position",void 0),J(this,"modelMatrix",void 0),J(this,"distanceScales",void 0),J(this,"scale",void 0),J(this,"center",void 0),J(this,"cameraPosition",void 0),J(this,"projectionMatrix",void 0),J(this,"viewMatrix",void 0),J(this,"viewMatrixUncentered",void 0),J(this,"viewMatrixInverse",void 0),J(this,"viewProjectionMatrix",void 0),J(this,"pixelProjectionMatrix",void 0),J(this,"pixelUnprojectionMatrix",void 0),J(this,"resolution",void 0),J(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||gG,this.focalDistance=e.focalDistance||1,this.position=e.position||BA,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Ia.WEB_MERCATOR:Ia.WEB_MERCATOR_AUTO_OFFSET:Ia.IDENTITY}equals(e){return e instanceof $d?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&pm(e.projectionMatrix,this.projectionMatrix)&&pm(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=F3(r,this.pixelProjectionMatrix),[o,h]=i,l=n?h:this.height-h;return e.length===2?[o,l]:[o,l,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,o,h]=e,l=n?o:this.height-o,m=r&&r*this.distanceScales.unitsPerMeter[2],_=TT([i,l,h],this.pixelUnprojectionMatrix,m),[E,T,A]=this.unprojectPosition(_);return Number.isFinite(h)?[E,T,A]:Number.isFinite(r)?[E,T,r]:[E,T]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=Cd(e);return n[1]=rc(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Eu(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),o=this.unproject([0,this.height],n),h=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],o[0],h[0]),Math.min(r[1],i[1],o[1],h[1]),Math.max(r[0],i[0],o[0],h[0]),Math.max(r[1],i[1],o[1],h[1])]}getDistanceScales(e){return e?Pw({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,hG(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=V9({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Pw({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:o,modelMatrix:h}=e;let l=BA;if(o&&(l=h?new Da(h).transformAsVector(o,[]):o),this.isGeospatial){const m=this.projectPosition([n,r,0]);this.center=new za(l).scale(this.distanceScales.unitsPerMeter).add(m)}else this.center=this.projectPosition(l)}_initMatrices(e){const{viewMatrix:n=mG,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:o,fovy:h=75,near:l=.1,far:m=1e3,padding:_=null,focalDistance:E=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Da().multiplyRight(n).translate(new za(this.center).negate()),this.projectionMatrix=r||yG({width:this.width,height:this.height,orthographic:i,fovyRadians:o||h*pG,focalDistance:E,padding:_,near:l,far:m});const T=Ep();mu(T,T,this.projectionMatrix),mu(T,T,this.viewMatrix),this.viewProjectionMatrix=T,this.viewMatrixInverse=ww([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=uG(this.viewMatrixInverse);const A=Ep(),L=Ep();_T(A,A,[this.width/2,-this.height/2,1]),J0(A,A,[1,-1,0]),mu(L,A,this.viewProjectionMatrix),this.pixelProjectionMatrix=L,this.pixelUnprojectionMatrix=ww(Ep(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||hr.warn("Pixel project matrix not invertible")()}}J($d,"displayName","Viewport");class Id extends $d{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:o=0,bearing:h=0,nearZMultiplier:l=.1,farZMultiplier:m=1.01,nearZ:_,farZ:E,orthographic:T=!1,projectionMatrix:A,repeat:L=!1,worldOffset:R=0,position:D,padding:W,legacyMeterSizes:z=!1}=e;let{width:N,height:F,altitude:$=1.5}=e;const K=Math.pow(2,i);N=N||1,F=F||1;let ne,re=null;if(A)$=A[5]/2,ne=t_($);else{e.fovy?(ne=e.fovy,$=D3(ne)):ne=t_($);let xe;if(W){const{top:fe=0,bottom:Re=0}=W;xe=[0,rc((fe+F-Re)/2,0,F)-F/2]}re=$9({width:N,height:F,scale:K,center:D&&[0,0,D[2]*z1(n)],offset:xe,pitch:o,fovy:ne,nearZMultiplier:l,farZMultiplier:m}),Number.isFinite(_)&&(re.near=_),Number.isFinite(E)&&(re.far=E)}let be=j9({height:F,pitch:o,bearing:h,scale:K,altitude:$});R&&(be=new Da().translate([512*R,0,0]).multiplyLeft(be)),super({...e,width:N,height:F,viewMatrix:be,longitude:r,latitude:n,zoom:i,...re,fovy:ne,focalDistance:$}),J(this,"longitude",void 0),J(this,"latitude",void 0),J(this,"pitch",void 0),J(this,"bearing",void 0),J(this,"altitude",void 0),J(this,"fovy",void 0),J(this,"orthographic",void 0),J(this,"_subViewports",void 0),J(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=o,this.bearing=h,this.altitude=$,this.fovy=ne,this.orthographic=T,this._subViewports=L?[]:null,this._pseudoMeters=z,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const o=i?new Id({...this,worldOffset:i}):this;this._subViewports.push(o)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*z1(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/z1(r);return[n,r,i]}addMetersToLngLat(e,n){return z3(e,n)}panByPosition(e,n){const r=TT(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),o=bw([],i,V8([],r)),h=bw([],this.center,o),[l,m]=this.unprojectFlat(h);return{longitude:l,latitude:m}}getBounds(e={}){const n=H9(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:o,latitude:h,zoom:l}=G9({width:r,height:i,bounds:e,...n});return new Id({width:r,height:i,longitude:o,latitude:h,zoom:l})}}J(Id,"displayName","WebMercatorViewport");const UA=[0,0,0];function N1(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Id){const[i,o,h=0]=t,l=e.getDistanceScales([i,o]);r[2]=h*l.unitsPerMeter[2]}return r}function _G(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:o,fromCoordinateOrigin:h}=t;return i===qn.DEFAULT&&(i=e.isGeospatial?qn.LNGLAT:qn.CARTESIAN),o===void 0&&(o=i),h===void 0&&(h=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:o,fromCoordinateOrigin:h}}function j3(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:o}){let[h,l,m=0]=t;switch(n&&([h,l,m]=Bm([],[h,l,m,1],n)),r){case qn.LNGLAT:return N1([h,l,m],e,o);case qn.LNGLAT_OFFSETS:return N1([h+i[0],l+i[1],m+(i[2]||0)],e,o);case qn.METER_OFFSETS:return N1(z3(i,[h,l,m]),e,o);case qn.CARTESIAN:default:return e.isGeospatial?[h+i[0],l+i[1],m+i[2]]:e.projectPosition([h,l,m])}}function vG(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:o,fromCoordinateSystem:h,fromCoordinateOrigin:l}=_G(e),{autoOffset:m=!0}=e,{geospatialOrigin:_=UA,shaderCoordinateOrigin:E=UA,offsetMode:T=!1}=m?L3(n,r,i):{},A=j3(t,{viewport:n,modelMatrix:o,coordinateSystem:h,coordinateOrigin:l,offsetMode:T});if(T){const L=n.projectPosition(_||E);r$(A,A,L)}return A}const VA={blendFunc:[1,0,32771,0],blendEquation:32774};class $3 extends bT{constructor(...e){super(...e),J(this,"pickZ",void 0),J(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:o,pickingFBO:h,deviceRect:{x:l,y:m,width:_,height:E},cullRect:T,effects:A,pass:L="picking",pickZ:R,moduleParameters:D}){const W=this.gl;this.pickZ=R;const z=this._resetColorEncoder(R),N=oa(W,{scissorTest:!0,scissor:[l,m,_,E],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...VA,blend:!R},()=>super.render({target:h,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:o,cullRect:T,effects:A==null?void 0:A.filter($=>$.useInPicking),pass:L,isPicking:!0,moduleParameters:D}));return this._colorEncoderState=null,{decodePickingColor:z&&bG.bind(null,z),stats:N}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:o,operation:h}=e.props;return this._colorEncoderState?o&&h.includes("draw")&&(Object.assign(i,VA),i.blend=!0,i.blendColor=xG(this._colorEncoderState,e,r)):i.blend=!1,h.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function xG(t,e,n){const{byLayer:r,byAlpha:i}=t;let o,h=r.get(e);return h?(h.viewports.push(n),o=h.a):(o=r.size+1,o<=255?(h={a:o,layer:e,viewports:[n]},r.set(e,h),i[o]=h):(hr.warn("Too many pickable layers, only picking the first 255")(),o=0)),[0,0,0,o/255]}function bG(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Fh={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},n_=Symbol.for("component"),_c=Symbol.for("propTypes"),B1=Symbol.for("deprecatedProps"),ld=Symbol.for("asyncPropDefaults"),Tu=Symbol.for("asyncPropOriginal"),ic=Symbol.for("asyncPropResolved");function ST(t,e=()=>!0){return Array.isArray(t)?G3(t,e,[]):e(t)?[t]:[]}function G3(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?G3(i,e,n):e(i)&&n.push(i)}return n}function wG({target:t,source:e,start:n=0,count:r=1}){const i=e.length,o=r*i;let h=0;for(let l=n;h<i;h++)t[l++]=e[h];for(;h<o;)h<o-h?(t.copyWithin(n+h,n,n+h),h*=2):(t.copyWithin(n+h,n,n+o-h),h=o);return t}class EG{constructor(e,n,r){J(this,"id",void 0),J(this,"context",void 0),J(this,"isLoaded",void 0),J(this,"persistent",void 0),J(this,"_loadCount",0),J(this,"_subscribers",new Set),J(this,"_data",void 0),J(this,"_loader",void 0),J(this,"_error",void 0),J(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=cw(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(o=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=o)}).catch(o=>{this._loadCount===r&&(this.isLoaded=!0,this._error=o||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const o of this._subscribers)o.onChange(this.getData())}}class TG{constructor({gl:e,protocol:n}){J(this,"protocol",void 0),J(this,"_context",void 0),J(this,"_resources",void 0),J(this,"_consumers",void 0),J(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let o=this._resources[e];o?o.setData(n,r):(o=new EG(e,n,this._context),this._resources[e]=o),o.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],o=this._resources[i.resourceId];o&&o.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:o,protocol:h}=this;e.startsWith(h)&&(e=e.replace(h,""),o[e]||this.add({resourceId:e,data:null,persistent:!1}));const l=o[e];if(this._track(r,i,l,n),l)return l.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const o=this._consumers,h=o[e]=o[e]||{},l=h[n]||{},m=l.resourceId&&this._resources[l.resourceId];m&&(m.unsubscribe(l),this.prune()),r&&(h[n]=l,l.onChange=i,l.resourceId=r.id,r.subscribe(l))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const SG=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,PT={name:"project32",dependencies:[wT],vs:SG},CT={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...R$},PG=[wT],CG=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function AG(t){const e=Um.getDefaultProgramManager(t);for(const n of PG)e.addDefaultModule(n);for(const n of CG)e.addShaderHook(n);return e}const IG="layerManager.setLayers",MG="layerManager.activateViewport";class kG{constructor(e,{deck:n,stats:r,viewport:i,timeline:o}={}){J(this,"layers",void 0),J(this,"context",void 0),J(this,"resourceManager",void 0),J(this,"_lastRenderedLayers",[]),J(this,"_needsRedraw",!1),J(this,"_needsUpdate",!1),J(this,"_nextLayers",null),J(this,"_debug",!1),J(this,"activateViewport",h=>{ss(MG,this,h),h&&(this.context.viewport=h)}),this.layers=[],this.resourceManager=new TG({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&AG(e),stats:r||new hT({id:"deck.gl"}),viewport:i||new $d({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new C3,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){ss(IG,this,n,e),this._lastRenderedLayers=e;const r=ST(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const h of e)r[h.id]?hr.warn("Multiple old layers with same id ".concat(h.id))():r[h.id]=h;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let o=!1;for(const h of i)if(h.hasUniformTransition()){o="Uniform transition in ".concat(h);break}this._needsUpdate=o,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const o=n[i.id];o===null&&hr.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let h=null;try{this._debug&&o!==i&&i.validateProps(),o?(this._transferLayerState(o,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),h=i.isComposite?i.getSubLayers():null}catch(l){this._handleError("matching",l,i)}h&&this._updateSublayersRecursively(h,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Fh.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Fh.MATCHED,n!==e&&(e.lifecycle=Fh.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Fh.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Fh.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Ma(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Ma(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const o of r)if(!e.hasOwnProperty(o)||!Ma(t[o],e[o],n-1))return!1;return!0}return!1}class LG{constructor(e){J(this,"width",void 0),J(this,"height",void 0),J(this,"views",void 0),J(this,"viewState",void 0),J(this,"controllers",void 0),J(this,"timeline",void 0),J(this,"_viewports",void 0),J(this,"_viewportMap",void 0),J(this,"_isUpdating",void 0),J(this,"_needsRedraw",void 0),J(this,"_needsUpdate",void 0),J(this,"_eventManager",void 0),J(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let o=r.length-1;o>=0;--o){const h=r[o];if(h.containsPixel(i)){const l=e.slice();return l[0]-=h.x,l[1]-=h.y,h.unproject(l,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=ST(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Ma(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):hr.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:o=>{var h;return(h=this.getView(e.id))===null||h===void 0?void 0:h.makeViewport({viewState:o,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const o=e.controller;if(o&&r){const h={...n,...o,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==o.type)&&(i=this._createController(e,h)),i&&i.setProps(h),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const o=e[i],h=this.getViewState(o),l=o.makeViewport({viewState:h,width:this.width,height:this.height});let m=n[o.id];const _=!!o.controller;_&&!m&&(r=!0),(r||!_)&&m&&(m.finalize(),m=null),this.controllers[o.id]=this._updateController(o,h,l,m),l&&this._viewports.unshift(l)}for(const i in n){const o=n[i];o&&!this.controllers[i]&&o.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const RG=/([0-9]+\.?[0-9]*)(%|px)/;function Wl(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=RG.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Hl(t,e){return t.relative?Math.round(t.position*e):t.position}function Ci(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class Md{constructor(e){J(this,"id",void 0),J(this,"viewportInstance",void 0),J(this,"_x",void 0),J(this,"_y",void 0),J(this,"_width",void 0),J(this,"_height",void 0),J(this,"_padding",void 0),J(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:o="100%",height:h="100%",padding:l=null,viewportInstance:m}=e||{};Ci(!m||m instanceof $d),this.viewportInstance=m,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Wl(r),this._y=Wl(i),this._width=Wl(o),this._height=Wl(h),this._padding=l&&{left:Wl(l.left||0),right:Wl(l.right||0),top:Wl(l.top||0),bottom:Wl(l.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Ma(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Hl(this._x,e),y:Hl(this._y,n),width:Hl(this._width,e),height:Hl(this._height,n)};return this._padding&&(r.padding={left:Hl(this._padding.left,e),top:Hl(this._padding.top,n),right:Hl(this._padding.right,e),bottom:Hl(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let jm=class{constructor(e){J(this,"_inProgress",void 0),J(this,"_handle",void 0),J(this,"_timeline",void 0),J(this,"time",void 0),J(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const jA=()=>{},Cw={BREAK:1,SNAP_TO_END:2,IGNORE:3},OG=t=>t,zG=Cw.BREAK;class DG{constructor(e){J(this,"getControllerState",void 0),J(this,"props",void 0),J(this,"propsInTransition",void 0),J(this,"transition",void 0),J(this,"onViewStateChange",void 0),J(this,"onStateChange",void 0),J(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:o,endProps:h,duration:l,easing:m}}=n,_=m(r/l),E=i.interpolateProps(o,h,_);this.propsInTransition=this.getControllerState({...this.props,...E}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new jm(e.timeline),this.onViewStateChange=e.onViewStateChange||jA,this.onStateChange=e.onStateChange||jA}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:o,endProps:h}=this.transition.settings;i={...r,...o===Cw.SNAP_TO_END?h:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Cw.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),o=n.transitionInterpolator,h=o.getDuration?o.getDuration(e,n):n.transitionDuration;if(h===0)return;const l=o.initializeProps(e,i);this.propsInTransition={};const m={duration:h,easing:n.transitionEasing||OG,interpolator:o,interruption:n.transitionInterruption||zG,startProps:l.start,endProps:l.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(m),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class W3{constructor(e){J(this,"_propsToCompare",void 0),J(this,"_propsToExtract",void 0),J(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!pm(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const o of this._propsToExtract)(o in e||o in n)&&(r[o]=e[o],i[o]=n[o]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Ci(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const FG=["longitude","latitude","zoom","bearing","pitch"],NG=["longitude","latitude","zoom"];class H3 extends W3{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:FG,required:NG},super(r.transitionProps),J(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:o}=this.opts;if(i&&o){const h=i(e),l=i(n),m=h.unproject(o);r.start.around=o,Object.assign(r.end,{around:l.project(m),aroundPosition:m,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const o of this._propsToExtract)i[o]=fm(e[o]||0,n[o]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const o=this.opts.makeViewport({...n,...i});Object.assign(i,o.panByPosition(n.aroundPosition,fm(e.around,n.around,r)))}return i}}const ql={transitionDuration:0},BG=300,Iy=t=>1-(1-t)*(1-t),Ph={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Jc={};class UG{constructor(e){J(this,"props",void 0),J(this,"state",{}),J(this,"transitionManager",void 0),J(this,"eventManager",void 0),J(this,"onViewStateChange",void 0),J(this,"onStateChange",void 0),J(this,"makeViewport",void 0),J(this,"_controllerState",void 0),J(this,"_events",{}),J(this,"_interactionState",{isDragging:!1}),J(this,"_customEvents",[]),J(this,"_eventStartBlocked",null),J(this,"_panMove",!1),J(this,"invertPan",!1),J(this,"dragMode","rotate"),J(this,"inertia",0),J(this,"scrollZoom",!0),J(this,"dragPan",!0),J(this,"dragRotate",!0),J(this,"doubleClickZoom",!0),J(this,"touchZoom",!0),J(this,"touchRotate",!1),J(this,"keyboard",!0),this.transitionManager=new DG({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const o=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return o&&n&&n.stopPropagation(),o}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?BG:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:o=!0,doubleClickZoom:h=!0,touchZoom:l=!0,touchRotate:m=!1,keyboard:_=!0}=e,E=!!this.onViewStateChange;this.toggleEvents(Ph.WHEEL,E&&r),this.toggleEvents(Ph.PAN,E),this.toggleEvents(Ph.PINCH,E&&(l||m)),this.toggleEvents(Ph.TRIPLE_PAN,E&&m),this.toggleEvents(Ph.DOUBLE_TAP,E&&h),this.toggleEvents(Ph.KEYBOARD,E&&_),this.scrollZoom=r,this.dragPan=i,this.dragRotate=o,this.doubleClickZoom=h,this.touchZoom=l,this.touchRotate=m,this.keyboard=_}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},o=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),o){const h=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:h})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,ql,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,ql,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],o=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Iy},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,ql,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],o=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Iy},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:o}=e;let h=2/(1+Math.exp(-Math.abs(o*r)));o<0&&h!==0&&(h=1/h);const l=this.controllerState.zoom({pos:n,scale:h});return this.updateViewport(l,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,ql,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,ql,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],o=this.controllerState.rotate({pos:i});this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Iy},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Jc._startPinchRotation=e.rotation,Jc._lastPinchEvent=e,this.updateViewport(r,ql,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Jc._startPinchRotation-r})}return this.updateViewport(n,ql,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Jc._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Jc;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let o=this.controllerState.rotateEnd();const h=Math.log2(e.scale),l=(h-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),m=Math.pow(2,h+l*n/2);o=o.zoom({pos:i,scale:m}).zoomEnd(),this.updateViewport(o,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Iy},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Jc._startPinchRotation=null,Jc._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:o,rotateSpeedY:h}=this.keyboard===!0?{}:this.keyboard,{controllerState:l}=this;let m;const _={};switch(e.srcEvent.code){case"Minus":m=n?l.zoomOut(r).zoomOut(r):l.zoomOut(r),_.isZooming=!0;break;case"Equal":m=n?l.zoomIn(r).zoomIn(r):l.zoomIn(r),_.isZooming=!0;break;case"ArrowLeft":n?(m=l.rotateLeft(o),_.isRotating=!0):(m=l.moveLeft(i),_.isPanning=!0);break;case"ArrowRight":n?(m=l.rotateRight(o),_.isRotating=!0):(m=l.moveRight(i),_.isPanning=!0);break;case"ArrowUp":n?(m=l.rotateUp(h),_.isRotating=!0):(m=l.moveUp(i),_.isPanning=!0);break;case"ArrowDown":n?(m=l.rotateDown(h),_.isRotating=!0):(m=l.moveDown(i),_.isPanning=!0);break;default:return!1}return this.updateViewport(m,this._getTransitionProps(),_),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?ql:e?{...n,transitionInterpolator:new H3({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class VG{constructor(e,n){J(this,"_viewportProps",void 0),J(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const $A=5,jG=1.2;class $G extends VG{constructor(e){const{width:n,height:r,latitude:i,longitude:o,zoom:h,bearing:l=0,pitch:m=0,altitude:_=1.5,position:E=[0,0,0],maxZoom:T=20,minZoom:A=0,maxPitch:L=60,minPitch:R=0,startPanLngLat:D,startZoomLngLat:W,startRotatePos:z,startBearing:N,startPitch:F,startZoom:$,normalize:K=!0}=e;Ci(Number.isFinite(o)),Ci(Number.isFinite(i)),Ci(Number.isFinite(h)),super({width:n,height:r,latitude:i,longitude:o,zoom:h,bearing:l,pitch:m,altitude:_,maxZoom:T,minZoom:A,maxPitch:L,minPitch:R,normalize:K,position:E},{startPanLngLat:D,startZoomLngLat:W,startRotatePos:z,startBearing:N,startPitch:F,startZoom:$}),J(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const o=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(o)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:o,startPitch:h}=this.getState();if(!i||o===void 0||h===void 0)return this;let l;return e?l=this._getNewRotation(e,i,h,o):l={bearing:o+n,pitch:h+r},this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:o}=this.getState();if(o||(i=this.getViewportProps().zoom,o=this._unproject(n)||this._unproject(e)),!o)return this;const{maxZoom:h,minZoom:l}=this.getViewportProps();let m=i+Math.log2(r);m=rc(m,l,h);const _=this.makeViewport({...this.getViewportProps(),zoom:m});return this._getUpdatedState({zoom:m,..._.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:o}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(o-n.longitude)>180&&(r.longitude=o<0?o+360:o-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=rc(i,r,n);const{maxPitch:o,minPitch:h,pitch:l}=e;e.pitch=rc(l,h,o);const{normalize:m=!0}=e;return m&&Object.assign(e,q9(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const o=e[0]-n[0],h=e[1]-n[1],l=e[1],m=n[1],{width:_,height:E}=this.getViewportProps(),T=o/_;let A=0;h>0?Math.abs(E-m)>$A&&(A=h/(m-E)*jG):h<0&&m>$A&&(A=1-l/m),A=rc(A,-1,1);const{minPitch:L,maxPitch:R}=this.getViewportProps(),D=i+180*T;let W=r;return A>0?W=r+A*(R-r):A<0&&(W=r-A*(L-r)),{pitch:W,bearing:D}}}class GG extends UG{constructor(...e){super(...e),J(this,"ControllerState",$G),J(this,"transition",{transitionDuration:300,transitionInterpolator:new H3({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),J(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class q3 extends Md{get ViewportType(){return Id}get ControllerType(){return GG}}J(q3,"displayName","MapView");const WG=new V3;function HG(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,o=(r=e.order)!==null&&r!==void 0?r:1/0;return i-o}class qG{constructor(){J(this,"effects",void 0),J(this,"_resolvedEffects",[]),J(this,"_defaultEffects",[]),J(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>HG(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Ma(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const o=n[i.id];o&&o!==i?o.setProps?(o.setProps(i.props),r.push(o)):(o.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof V3)||this._resolvedEffects.push(WG),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class ZG extends bT{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const XG="deckRenderer.renderLayers";class YG{constructor(e){J(this,"gl",void 0),J(this,"layerFilter",void 0),J(this,"drawPickingColors",void 0),J(this,"drawLayersPass",void 0),J(this,"pickLayersPass",void 0),J(this,"renderCount",void 0),J(this,"_needsRedraw",void 0),J(this,"renderBuffers",void 0),J(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new ZG(e),this.pickLayersPass=new $3(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||vi.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,o=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,ss(XG,this,o,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new vi(this.gl),new vi(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const o of e)if(o.postRender){if(o.id===this.lastPostProcessEffect){i.target=n.target,o.postRender(this.gl,i);break}const h=o.postRender(this.gl,i);i.inputBuffer=h,i.swapBuffer=h===r[0]?r[1]:r[0]}}}const KG={pickedColor:null,pickedObjectIndex:-1};function JG({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:o}){const{x:h,y:l,width:m,height:_}=o;let E=i*i,T=-1,A=0;for(let L=0;L<_;L++){const R=L+l-r,D=R*R;if(D>E)A+=4*m;else for(let W=0;W<m;W++){if(t[A+3]-1>=0){const N=W+h-n,F=N*N+D;F<=E&&(E=F,T=A)}A+=4}}if(T>=0){const L=t.slice(T,T+4),R=e(L);if(R){const D=Math.floor(T/4/m),W=T/4-D*m;return{...R,pickedColor:L,pickedX:h+W,pickedY:l+D}}hr.error("Picked non-existent layer. Is picking buffer corrupt?")()}return KG}function QG({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const o=t.slice(r,r+4),h=o.join(",");if(!n.has(h)){const l=e(o);l?n.set(h,{...l,color:o}):hr.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function Z3({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:o}){let h=e[0];e.length>1&&(h=t7((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let l;if(h){const m=[r-h.x,i-h.y];o!==void 0&&(m[2]=o),l=h.unproject(m)}return{color:null,layer:null,viewport:h,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:l,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function e7(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:o,pickedLayer:h,pickedObjectIndex:l}=e,m=h?[h]:[];if(r==="hover"){const T=n.index,A=n.layerId,L=h?h.props.id:null;if(L!==A||l!==T){if(L!==A){const R=i.find(D=>D.props.id===A);R&&m.unshift(R)}n.layerId=L,n.index=l,n.info=null}}const _=Z3(t),E=new Map;return E.set(null,_),m.forEach(T=>{let A={..._};T===h&&(A.color=o,A.index=l,A.picked=!0),A=X3({layer:T,info:A,mode:r});const L=A.layer;T===h&&r==="hover"&&(n.info=A),E.set(L.id,A),r==="hover"&&L.updateAutoHighlight(A)}),E}function X3({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function t7(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class n7{constructor(e){J(this,"gl",void 0),J(this,"pickingFBO",void 0),J(this,"depthFBO",void 0),J(this,"pickLayersPass",void 0),J(this,"layerFilter",void 0),J(this,"lastPickedInfo",void 0),J(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new $3(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},o=this.lastPickedInfo.info){const h=o&&o.layer&&o.layer.id,l=o&&o.viewport&&o.viewport.id,m=h?r.find(A=>A.id===h):null,_=l&&i.find(A=>A.id===l)||i[0],E=_&&_.unproject([e-_.x,n-_.y]);return{...o,...{x:e,y:n,viewport:_,coordinate:E,layer:m}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new vi(r),vi.isSupported(r,{colorBufferFloat:!0}))){const i=new vi(r);i.attach({36064:new la(r,{format:Vn(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:o,radius:h=0,depth:l=1,mode:m="query",unproject3D:_,onViewportActive:E,effects:T}){const A=this._getPickable(e),L=xd(this.gl);if(!A)return{result:[],emptyInfo:Z3({viewports:r,x:i,y:o,pixelRatio:L})};this._resizeBuffer();const R=b1(this.gl,[i,o],!0),D=[R.x+Math.floor(R.width/2),R.y+Math.floor(R.height/2)],W=Math.round(h*L),{width:z,height:N}=this.pickingFBO,F=this._getPickingRect({deviceX:D[0],deviceY:D[1],deviceRadius:W,deviceWidth:z,deviceHeight:N}),$={x:i-h,y:o-h,width:h*2+1,height:h*2+1};let K;const ne=[],re=new Set;for(let be=0;be<l;be++){let xe;if(F){const Re=this._drawAndSample({layers:A,views:n,viewports:r,onViewportActive:E,deviceRect:F,cullRect:$,effects:T,pass:"picking:".concat(m)});xe=JG({...Re,deviceX:D[0],deviceY:D[1],deviceRadius:W,deviceRect:F})}else xe={pickedColor:null,pickedObjectIndex:-1};let fe;if(xe.pickedLayer&&_&&this.depthFBO){const{pickedColors:Re}=this._drawAndSample({layers:[xe.pickedLayer],views:n,viewports:r,onViewportActive:E,deviceRect:{x:xe.pickedX,y:xe.pickedY,width:1,height:1},cullRect:$,effects:T,pass:"picking:".concat(m,":z")},!0);Re[3]&&(fe=Re[0])}xe.pickedLayer&&be+1<l&&(re.add(xe.pickedLayer),xe.pickedLayer.disablePickingIndex(xe.pickedObjectIndex)),K=e7({pickInfo:xe,lastPickedInfo:this.lastPickedInfo,mode:m,layers:A,viewports:r,x:i,y:o,z:fe,pixelRatio:L});for(const Re of K.values())Re.layer&&ne.push(Re);if(!xe.pickedColor)break}for(const be of re)be.restorePickingColors();return{result:ne,emptyInfo:K.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:o,width:h=1,height:l=1,mode:m="query",maxObjects:_=null,onViewportActive:E,effects:T}){const A=this._getPickable(e);if(!A)return[];this._resizeBuffer();const L=xd(this.gl),R=b1(this.gl,[i,o],!0),D=R.x,W=R.y+R.height,z=b1(this.gl,[i+h,o+l],!0),N=z.x+z.width,F=z.y,$={x:D,y:F,width:N-D,height:W-F},K=this._drawAndSample({layers:A,views:n,viewports:r,onViewportActive:E,deviceRect:$,cullRect:{x:i,y:o,width:h,height:l},effects:T,pass:"picking:".concat(m)}),ne=QG(K),re=new Map,be=Number.isFinite(_);for(let xe=0;xe<ne.length&&!(be&&_&&re.size>=_);xe++){const fe=ne[xe];let Re={color:fe.pickedColor,layer:null,index:fe.pickedObjectIndex,picked:!0,x:i,y:o,pixelRatio:L};Re=X3({layer:fe.pickedLayer,info:Re,mode:m}),re.has(Re.object)||re.set(Re.object,Re)}return Array.from(re.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:o,cullRect:h,effects:l,pass:m},_=!1){const E=_?this.depthFBO:this.pickingFBO,T={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:E,deviceRect:o,cullRect:h,effects:l,pass:m,pickZ:_,preRenderStats:{}};for(const N of l)N.useInPicking&&(T.preRenderStats[N.id]=N.preRender(this.gl,T));const{decodePickingColor:A}=this.pickLayersPass.render(T),{x:L,y:R,width:D,height:W}=o,z=new(_?Float32Array:Uint8Array)(D*W*4);return F_(E,{sourceX:L,sourceY:R,sourceWidth:D,sourceHeight:W,target:z}),{pickedColors:z,decodePickingColor:A}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:o}){const h=Math.max(0,e-r),l=Math.max(0,n-r),m=Math.min(i,e+r+1)-h,_=Math.min(o,n+r+1)-l;return m<=0||_<=0?null:{x:h,y:l,width:m,height:_}}}const r7={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};let i7=class{constructor(e){J(this,"el",null),J(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,r7),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}};var Y3={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var o=["","webkit","Moz","MS","ms","o"],h=n.createElement("div"),l="function",m=Math.round,_=Math.abs,E=Date.now;function T(te,oe,we){return setTimeout(F(te,we),oe)}function A(te,oe,we){return Array.isArray(te)?(L(te,we[oe],we),!0):!1}function L(te,oe,we){var Be;if(te)if(te.forEach)te.forEach(oe,we);else if(te.length!==i)for(Be=0;Be<te.length;)oe.call(we,te[Be],Be,te),Be++;else for(Be in te)te.hasOwnProperty(Be)&&oe.call(we,te[Be],Be,te)}function R(te,oe,we){var Be="DEPRECATED METHOD: "+oe+`
`+we+` AT 
`;return function(){var st=new Error("get-stack-trace"),Bt=st&&st.stack?st.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Sn=e.console&&(e.console.warn||e.console.log);return Sn&&Sn.call(e.console,Be,Bt),te.apply(this,arguments)}}var D;typeof Object.assign!="function"?D=function(oe){if(oe===i||oe===null)throw new TypeError("Cannot convert undefined or null to object");for(var we=Object(oe),Be=1;Be<arguments.length;Be++){var st=arguments[Be];if(st!==i&&st!==null)for(var Bt in st)st.hasOwnProperty(Bt)&&(we[Bt]=st[Bt])}return we}:D=Object.assign;var W=R(function(oe,we,Be){for(var st=Object.keys(we),Bt=0;Bt<st.length;)(!Be||Be&&oe[st[Bt]]===i)&&(oe[st[Bt]]=we[st[Bt]]),Bt++;return oe},"extend","Use `assign`."),z=R(function(oe,we){return W(oe,we,!0)},"merge","Use `assign`.");function N(te,oe,we){var Be=oe.prototype,st;st=te.prototype=Object.create(Be),st.constructor=te,st._super=Be,we&&D(st,we)}function F(te,oe){return function(){return te.apply(oe,arguments)}}function $(te,oe){return typeof te==l?te.apply(oe&&oe[0]||i,oe):te}function K(te,oe){return te===i?oe:te}function ne(te,oe,we){L(fe(oe),function(Be){te.addEventListener(Be,we,!1)})}function re(te,oe,we){L(fe(oe),function(Be){te.removeEventListener(Be,we,!1)})}function be(te,oe){for(;te;){if(te==oe)return!0;te=te.parentNode}return!1}function xe(te,oe){return te.indexOf(oe)>-1}function fe(te){return te.trim().split(/\s+/g)}function Re(te,oe,we){if(te.indexOf&&!we)return te.indexOf(oe);for(var Be=0;Be<te.length;){if(we&&te[Be][we]==oe||!we&&te[Be]===oe)return Be;Be++}return-1}function Ve(te){return Array.prototype.slice.call(te,0)}function Fe(te,oe,we){for(var Be=[],st=[],Bt=0;Bt<te.length;){var Sn=oe?te[Bt][oe]:te[Bt];Re(st,Sn)<0&&Be.push(te[Bt]),st[Bt]=Sn,Bt++}return we&&(oe?Be=Be.sort(function(jr,di){return jr[oe]>di[oe]}):Be=Be.sort()),Be}function ze(te,oe){for(var we,Be,st=oe[0].toUpperCase()+oe.slice(1),Bt=0;Bt<o.length;){if(we=o[Bt],Be=we?we+st:oe,Be in te)return Be;Bt++}return i}var Ye=1;function je(){return Ye++}function tt(te){var oe=te.ownerDocument||te;return oe.defaultView||oe.parentWindow||e}var ke=/mobile|tablet|ip(ad|hone|od)|android/i,Ge="ontouchstart"in e,nt=ze(e,"PointerEvent")!==i,Dt=Ge&&ke.test(navigator.userAgent),ht="touch",ot="pen",ct="mouse",xt="kinect",bt=25,Jt=1,Je=2,Et=4,sn=8,Qt=1,hn=2,$t=4,Lt=8,Ft=16,wn=hn|$t,vn=Lt|Ft,pt=wn|vn,dn=["x","y"],Ae=["clientX","clientY"];function Ct(te,oe){var we=this;this.manager=te,this.callback=oe,this.element=te.element,this.target=te.options.inputTarget,this.domHandler=function(Be){$(te.options.enable,[te])&&we.handler(Be)},this.init()}Ct.prototype={handler:function(){},init:function(){this.evEl&&ne(this.element,this.evEl,this.domHandler),this.evTarget&&ne(this.target,this.evTarget,this.domHandler),this.evWin&&ne(tt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&re(this.element,this.evEl,this.domHandler),this.evTarget&&re(this.target,this.evTarget,this.domHandler),this.evWin&&re(tt(this.element),this.evWin,this.domHandler)}};function En(te){var oe,we=te.options.inputClass;return we?oe=we:nt?oe=Kr:Dt?oe=Se:Ge?oe=$e:oe=fn,new oe(te,en)}function en(te,oe,we){var Be=we.pointers.length,st=we.changedPointers.length,Bt=oe&Jt&&Be-st===0,Sn=oe&(Et|sn)&&Be-st===0;we.isFirst=!!Bt,we.isFinal=!!Sn,Bt&&(te.session={}),we.eventType=oe,It(te,we),te.emit("hammer.input",we),te.recognize(we),te.session.prevInput=we}function It(te,oe){var we=te.session,Be=oe.pointers,st=Be.length;we.firstInput||(we.firstInput=Mt(oe)),st>1&&!we.firstMultiple?we.firstMultiple=Mt(oe):st===1&&(we.firstMultiple=!1);var Bt=we.firstInput,Sn=we.firstMultiple,Ir=Sn?Sn.center:Bt.center,jr=oe.center=Rt(Be);oe.timeStamp=E(),oe.deltaTime=oe.timeStamp-Bt.timeStamp,oe.angle=He(Ir,jr),oe.distance=mn(Ir,jr),Qe(we,oe),oe.offsetDirection=gn(oe.deltaX,oe.deltaY);var di=Pt(oe.deltaTime,oe.deltaX,oe.deltaY);oe.overallVelocityX=di.x,oe.overallVelocityY=di.y,oe.overallVelocity=_(di.x)>_(di.y)?di.x:di.y,oe.scale=Sn?Zt(Sn.pointers,Be):1,oe.rotation=Sn?mt(Sn.pointers,Be):0,oe.maxPointers=we.prevInput?oe.pointers.length>we.prevInput.maxPointers?oe.pointers.length:we.prevInput.maxPointers:oe.pointers.length,gt(we,oe);var cs=te.element;be(oe.srcEvent.target,cs)&&(cs=oe.srcEvent.target),oe.target=cs}function Qe(te,oe){var we=oe.center,Be=te.offsetDelta||{},st=te.prevDelta||{},Bt=te.prevInput||{};(oe.eventType===Jt||Bt.eventType===Et)&&(st=te.prevDelta={x:Bt.deltaX||0,y:Bt.deltaY||0},Be=te.offsetDelta={x:we.x,y:we.y}),oe.deltaX=st.x+(we.x-Be.x),oe.deltaY=st.y+(we.y-Be.y)}function gt(te,oe){var we=te.lastInterval||oe,Be=oe.timeStamp-we.timeStamp,st,Bt,Sn,Ir;if(oe.eventType!=sn&&(Be>bt||we.velocity===i)){var jr=oe.deltaX-we.deltaX,di=oe.deltaY-we.deltaY,cs=Pt(Be,jr,di);Bt=cs.x,Sn=cs.y,st=_(cs.x)>_(cs.y)?cs.x:cs.y,Ir=gn(jr,di),te.lastInterval=oe}else st=we.velocity,Bt=we.velocityX,Sn=we.velocityY,Ir=we.direction;oe.velocity=st,oe.velocityX=Bt,oe.velocityY=Sn,oe.direction=Ir}function Mt(te){for(var oe=[],we=0;we<te.pointers.length;)oe[we]={clientX:m(te.pointers[we].clientX),clientY:m(te.pointers[we].clientY)},we++;return{timeStamp:E(),pointers:oe,center:Rt(oe),deltaX:te.deltaX,deltaY:te.deltaY}}function Rt(te){var oe=te.length;if(oe===1)return{x:m(te[0].clientX),y:m(te[0].clientY)};for(var we=0,Be=0,st=0;st<oe;)we+=te[st].clientX,Be+=te[st].clientY,st++;return{x:m(we/oe),y:m(Be/oe)}}function Pt(te,oe,we){return{x:oe/te||0,y:we/te||0}}function gn(te,oe){return te===oe?Qt:_(te)>=_(oe)?te<0?hn:$t:oe<0?Lt:Ft}function mn(te,oe,we){we||(we=dn);var Be=oe[we[0]]-te[we[0]],st=oe[we[1]]-te[we[1]];return Math.sqrt(Be*Be+st*st)}function He(te,oe,we){we||(we=dn);var Be=oe[we[0]]-te[we[0]],st=oe[we[1]]-te[we[1]];return Math.atan2(st,Be)*180/Math.PI}function mt(te,oe){return He(oe[1],oe[0],Ae)+He(te[1],te[0],Ae)}function Zt(te,oe){return mn(oe[0],oe[1],Ae)/mn(te[0],te[1],Ae)}var Ln={mousedown:Jt,mousemove:Je,mouseup:Et},Fn="mousedown",it="mousemove mouseup";function fn(){this.evEl=Fn,this.evWin=it,this.pressed=!1,Ct.apply(this,arguments)}N(fn,Ct,{handler:function(oe){var we=Ln[oe.type];we&Jt&&oe.button===0&&(this.pressed=!0),we&Je&&oe.which!==1&&(we=Et),this.pressed&&(we&Et&&(this.pressed=!1),this.callback(this.manager,we,{pointers:[oe],changedPointers:[oe],pointerType:ct,srcEvent:oe}))}});var ln={pointerdown:Jt,pointermove:Je,pointerup:Et,pointercancel:sn,pointerout:sn},Cr={2:ht,3:ot,4:ct,5:xt},li="pointerdown",cn="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(li="MSPointerDown",cn="MSPointerMove MSPointerUp MSPointerCancel");function Kr(){this.evEl=li,this.evWin=cn,Ct.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}N(Kr,Ct,{handler:function(oe){var we=this.store,Be=!1,st=oe.type.toLowerCase().replace("ms",""),Bt=ln[st],Sn=Cr[oe.pointerType]||oe.pointerType,Ir=Sn==ht,jr=Re(we,oe.pointerId,"pointerId");Bt&Jt&&(oe.button===0||Ir)?jr<0&&(we.push(oe),jr=we.length-1):Bt&(Et|sn)&&(Be=!0),!(jr<0)&&(we[jr]=oe,this.callback(this.manager,Bt,{pointers:we,changedPointers:[oe],pointerType:Sn,srcEvent:oe}),Be&&we.splice(jr,1))}});var xi={touchstart:Jt,touchmove:Je,touchend:Et,touchcancel:sn},de="touchstart",G="touchstart touchmove touchend touchcancel";function Z(){this.evTarget=de,this.evWin=G,this.started=!1,Ct.apply(this,arguments)}N(Z,Ct,{handler:function(oe){var we=xi[oe.type];if(we===Jt&&(this.started=!0),!!this.started){var Be=se.call(this,oe,we);we&(Et|sn)&&Be[0].length-Be[1].length===0&&(this.started=!1),this.callback(this.manager,we,{pointers:Be[0],changedPointers:Be[1],pointerType:ht,srcEvent:oe})}}});function se(te,oe){var we=Ve(te.touches),Be=Ve(te.changedTouches);return oe&(Et|sn)&&(we=Fe(we.concat(Be),"identifier",!0)),[we,Be]}var ue={touchstart:Jt,touchmove:Je,touchend:Et,touchcancel:sn},ve="touchstart touchmove touchend touchcancel";function Se(){this.evTarget=ve,this.targetIds={},Ct.apply(this,arguments)}N(Se,Ct,{handler:function(oe){var we=ue[oe.type],Be=Te.call(this,oe,we);Be&&this.callback(this.manager,we,{pointers:Be[0],changedPointers:Be[1],pointerType:ht,srcEvent:oe})}});function Te(te,oe){var we=Ve(te.touches),Be=this.targetIds;if(oe&(Jt|Je)&&we.length===1)return Be[we[0].identifier]=!0,[we,we];var st,Bt,Sn=Ve(te.changedTouches),Ir=[],jr=this.target;if(Bt=we.filter(function(di){return be(di.target,jr)}),oe===Jt)for(st=0;st<Bt.length;)Be[Bt[st].identifier]=!0,st++;for(st=0;st<Sn.length;)Be[Sn[st].identifier]&&Ir.push(Sn[st]),oe&(Et|sn)&&delete Be[Sn[st].identifier],st++;if(Ir.length)return[Fe(Bt.concat(Ir),"identifier",!0),Ir]}var ye=2500,Ce=25;function $e(){Ct.apply(this,arguments);var te=F(this.handler,this);this.touch=new Se(this.manager,te),this.mouse=new fn(this.manager,te),this.primaryTouch=null,this.lastTouches=[]}N($e,Ct,{handler:function(oe,we,Be){var st=Be.pointerType==ht,Bt=Be.pointerType==ct;if(!(Bt&&Be.sourceCapabilities&&Be.sourceCapabilities.firesTouchEvents)){if(st)We.call(this,we,Be);else if(Bt&&At.call(this,Be))return;this.callback(oe,we,Be)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function We(te,oe){te&Jt?(this.primaryTouch=oe.changedPointers[0].identifier,qe.call(this,oe)):te&(Et|sn)&&qe.call(this,oe)}function qe(te){var oe=te.changedPointers[0];if(oe.identifier===this.primaryTouch){var we={x:oe.clientX,y:oe.clientY};this.lastTouches.push(we);var Be=this.lastTouches,st=function(){var Bt=Be.indexOf(we);Bt>-1&&Be.splice(Bt,1)};setTimeout(st,ye)}}function At(te){for(var oe=te.srcEvent.clientX,we=te.srcEvent.clientY,Be=0;Be<this.lastTouches.length;Be++){var st=this.lastTouches[Be],Bt=Math.abs(oe-st.x),Sn=Math.abs(we-st.y);if(Bt<=Ce&&Sn<=Ce)return!0}return!1}var nn=ze(h.style,"touchAction"),Ot=nn!==i,dt="compute",Nt="auto",xn="manipulation",bn="none",pn="pan-x",yn="pan-y",Ar=xr();function Ut(te,oe){this.manager=te,this.set(oe)}Ut.prototype={set:function(te){te==dt&&(te=this.compute()),Ot&&this.manager.element.style&&Ar[te]&&(this.manager.element.style[nn]=te),this.actions=te.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var te=[];return L(this.manager.recognizers,function(oe){$(oe.options.enable,[oe])&&(te=te.concat(oe.getTouchAction()))}),zn(te.join(" "))},preventDefaults:function(te){var oe=te.srcEvent,we=te.offsetDirection;if(this.manager.session.prevented){oe.preventDefault();return}var Be=this.actions,st=xe(Be,bn)&&!Ar[bn],Bt=xe(Be,yn)&&!Ar[yn],Sn=xe(Be,pn)&&!Ar[pn];if(st){var Ir=te.pointers.length===1,jr=te.distance<2,di=te.deltaTime<250;if(Ir&&jr&&di)return}if(!(Sn&&Bt)&&(st||Bt&&we&wn||Sn&&we&vn))return this.preventSrc(oe)},preventSrc:function(te){this.manager.session.prevented=!0,te.preventDefault()}};function zn(te){if(xe(te,bn))return bn;var oe=xe(te,pn),we=xe(te,yn);return oe&&we?bn:oe||we?oe?pn:yn:xe(te,xn)?xn:Nt}function xr(){if(!Ot)return!1;var te={},oe=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(we){te[we]=oe?e.CSS.supports("touch-action",we):!0}),te}var Vs=1,Jr=2,ls=4,po=8,Cn=po,No=16,ki=32;function ir(te){this.options=D({},this.defaults,te||{}),this.id=je(),this.manager=null,this.options.enable=K(this.options.enable,!0),this.state=Vs,this.simultaneous={},this.requireFail=[]}ir.prototype={defaults:{},set:function(te){return D(this.options,te),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(te){if(A(te,"recognizeWith",this))return this;var oe=this.simultaneous;return te=hi(te,this),oe[te.id]||(oe[te.id]=te,te.recognizeWith(this)),this},dropRecognizeWith:function(te){return A(te,"dropRecognizeWith",this)?this:(te=hi(te,this),delete this.simultaneous[te.id],this)},requireFailure:function(te){if(A(te,"requireFailure",this))return this;var oe=this.requireFail;return te=hi(te,this),Re(oe,te)===-1&&(oe.push(te),te.requireFailure(this)),this},dropRequireFailure:function(te){if(A(te,"dropRequireFailure",this))return this;te=hi(te,this);var oe=Re(this.requireFail,te);return oe>-1&&this.requireFail.splice(oe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(te){return!!this.simultaneous[te.id]},emit:function(te){var oe=this,we=this.state;function Be(st){oe.manager.emit(st,te)}we<po&&Be(oe.options.event+bi(we)),Be(oe.options.event),te.additionalEvent&&Be(te.additionalEvent),we>=po&&Be(oe.options.event+bi(we))},tryEmit:function(te){if(this.canEmit())return this.emit(te);this.state=ki},canEmit:function(){for(var te=0;te<this.requireFail.length;){if(!(this.requireFail[te].state&(ki|Vs)))return!1;te++}return!0},recognize:function(te){var oe=D({},te);if(!$(this.options.enable,[this,oe])){this.reset(),this.state=ki;return}this.state&(Cn|No|ki)&&(this.state=Vs),this.state=this.process(oe),this.state&(Jr|ls|po|No)&&this.tryEmit(oe)},process:function(te){},getTouchAction:function(){},reset:function(){}};function bi(te){return te&No?"cancel":te&po?"end":te&ls?"move":te&Jr?"start":""}function Fu(te){return te==Ft?"down":te==Lt?"up":te==hn?"left":te==$t?"right":""}function hi(te,oe){var we=oe.manager;return we?we.get(te):te}function Zn(){ir.apply(this,arguments)}N(Zn,ir,{defaults:{pointers:1},attrTest:function(te){var oe=this.options.pointers;return oe===0||te.pointers.length===oe},process:function(te){var oe=this.state,we=te.eventType,Be=oe&(Jr|ls),st=this.attrTest(te);return Be&&(we&sn||!st)?oe|No:Be||st?we&Et?oe|po:oe&Jr?oe|ls:Jr:ki}});function Bo(){Zn.apply(this,arguments),this.pX=null,this.pY=null}N(Bo,Zn,{defaults:{event:"pan",threshold:10,pointers:1,direction:pt},getTouchAction:function(){var te=this.options.direction,oe=[];return te&wn&&oe.push(yn),te&vn&&oe.push(pn),oe},directionTest:function(te){var oe=this.options,we=!0,Be=te.distance,st=te.direction,Bt=te.deltaX,Sn=te.deltaY;return st&oe.direction||(oe.direction&wn?(st=Bt===0?Qt:Bt<0?hn:$t,we=Bt!=this.pX,Be=Math.abs(te.deltaX)):(st=Sn===0?Qt:Sn<0?Lt:Ft,we=Sn!=this.pY,Be=Math.abs(te.deltaY))),te.direction=st,we&&Be>oe.threshold&&st&oe.direction},attrTest:function(te){return Zn.prototype.attrTest.call(this,te)&&(this.state&Jr||!(this.state&Jr)&&this.directionTest(te))},emit:function(te){this.pX=te.deltaX,this.pY=te.deltaY;var oe=Fu(te.direction);oe&&(te.additionalEvent=this.options.event+oe),this._super.emit.call(this,te)}});function mo(){Zn.apply(this,arguments)}N(mo,Zn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bn]},attrTest:function(te){return this._super.attrTest.call(this,te)&&(Math.abs(te.scale-1)>this.options.threshold||this.state&Jr)},emit:function(te){if(te.scale!==1){var oe=te.scale<1?"in":"out";te.additionalEvent=this.options.event+oe}this._super.emit.call(this,te)}});function Jn(){ir.apply(this,arguments),this._timer=null,this._input=null}N(Jn,ir,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Nt]},process:function(te){var oe=this.options,we=te.pointers.length===oe.pointers,Be=te.distance<oe.threshold,st=te.deltaTime>oe.time;if(this._input=te,!Be||!we||te.eventType&(Et|sn)&&!st)this.reset();else if(te.eventType&Jt)this.reset(),this._timer=T(function(){this.state=Cn,this.tryEmit()},oe.time,this);else if(te.eventType&Et)return Cn;return ki},reset:function(){clearTimeout(this._timer)},emit:function(te){this.state===Cn&&(te&&te.eventType&Et?this.manager.emit(this.options.event+"up",te):(this._input.timeStamp=E(),this.manager.emit(this.options.event,this._input)))}});function Dn(){Zn.apply(this,arguments)}N(Dn,Zn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bn]},attrTest:function(te){return this._super.attrTest.call(this,te)&&(Math.abs(te.rotation)>this.options.threshold||this.state&Jr)}});function js(){Zn.apply(this,arguments)}N(js,Zn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:wn|vn,pointers:1},getTouchAction:function(){return Bo.prototype.getTouchAction.call(this)},attrTest:function(te){var oe=this.options.direction,we;return oe&(wn|vn)?we=te.overallVelocity:oe&wn?we=te.overallVelocityX:oe&vn&&(we=te.overallVelocityY),this._super.attrTest.call(this,te)&&oe&te.offsetDirection&&te.distance>this.options.threshold&&te.maxPointers==this.options.pointers&&_(we)>this.options.velocity&&te.eventType&Et},emit:function(te){var oe=Fu(te.offsetDirection);oe&&this.manager.emit(this.options.event+oe,te),this.manager.emit(this.options.event,te)}});function Qn(){ir.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}N(Qn,ir,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xn]},process:function(te){var oe=this.options,we=te.pointers.length===oe.pointers,Be=te.distance<oe.threshold,st=te.deltaTime<oe.time;if(this.reset(),te.eventType&Jt&&this.count===0)return this.failTimeout();if(Be&&st&&we){if(te.eventType!=Et)return this.failTimeout();var Bt=this.pTime?te.timeStamp-this.pTime<oe.interval:!0,Sn=!this.pCenter||mn(this.pCenter,te.center)<oe.posThreshold;this.pTime=te.timeStamp,this.pCenter=te.center,!Sn||!Bt?this.count=1:this.count+=1,this._input=te;var Ir=this.count%oe.taps;if(Ir===0)return this.hasRequireFailures()?(this._timer=T(function(){this.state=Cn,this.tryEmit()},oe.interval,this),Jr):Cn}return ki},failTimeout:function(){return this._timer=T(function(){this.state=ki},this.options.interval,this),ki},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Cn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Gi(te,oe){return oe=oe||{},oe.recognizers=K(oe.recognizers,Gi.defaults.preset),new Ps(te,oe)}Gi.VERSION="2.0.7",Gi.defaults={domEvents:!1,touchAction:dt,enable:!0,inputTarget:null,inputClass:null,preset:[[Dn,{enable:!1}],[mo,{enable:!1},["rotate"]],[js,{direction:wn}],[Bo,{direction:wn},["swipe"]],[Qn],[Qn,{event:"doubletap",taps:2},["tap"]],[Jn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Wi=1,El=2;function Ps(te,oe){this.options=D({},Gi.defaults,oe||{}),this.options.inputTarget=this.options.inputTarget||te,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=te,this.input=En(this),this.touchAction=new Ut(this,this.options.touchAction),Ic(this,!0),L(this.options.recognizers,function(we){var Be=this.add(new we[0](we[1]));we[2]&&Be.recognizeWith(we[2]),we[3]&&Be.requireFailure(we[3])},this)}Ps.prototype={set:function(te){return D(this.options,te),te.touchAction&&this.touchAction.update(),te.inputTarget&&(this.input.destroy(),this.input.target=te.inputTarget,this.input.init()),this},stop:function(te){this.session.stopped=te?El:Wi},recognize:function(te){var oe=this.session;if(!oe.stopped){this.touchAction.preventDefaults(te);var we,Be=this.recognizers,st=oe.curRecognizer;(!st||st&&st.state&Cn)&&(st=oe.curRecognizer=null);for(var Bt=0;Bt<Be.length;)we=Be[Bt],oe.stopped!==El&&(!st||we==st||we.canRecognizeWith(st))?we.recognize(te):we.reset(),!st&&we.state&(Jr|ls|po)&&(st=oe.curRecognizer=we),Bt++}},get:function(te){if(te instanceof ir)return te;for(var oe=this.recognizers,we=0;we<oe.length;we++)if(oe[we].options.event==te)return oe[we];return null},add:function(te){if(A(te,"add",this))return this;var oe=this.get(te.options.event);return oe&&this.remove(oe),this.recognizers.push(te),te.manager=this,this.touchAction.update(),te},remove:function(te){if(A(te,"remove",this))return this;if(te=this.get(te),te){var oe=this.recognizers,we=Re(oe,te);we!==-1&&(oe.splice(we,1),this.touchAction.update())}return this},on:function(te,oe){if(te!==i&&oe!==i){var we=this.handlers;return L(fe(te),function(Be){we[Be]=we[Be]||[],we[Be].push(oe)}),this}},off:function(te,oe){if(te!==i){var we=this.handlers;return L(fe(te),function(Be){oe?we[Be]&&we[Be].splice(Re(we[Be],oe),1):delete we[Be]}),this}},emit:function(te,oe){this.options.domEvents&&Mc(te,oe);var we=this.handlers[te]&&this.handlers[te].slice();if(!(!we||!we.length)){oe.type=te,oe.preventDefault=function(){oe.srcEvent.preventDefault()};for(var Be=0;Be<we.length;)we[Be](oe),Be++}},destroy:function(){this.element&&Ic(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ic(te,oe){var we=te.element;if(we.style){var Be;L(te.options.cssProps,function(st,Bt){Be=ze(we.style,Bt),oe?(te.oldCssProps[Be]=we.style[Be],we.style[Be]=st):we.style[Be]=te.oldCssProps[Be]||""}),oe||(te.oldCssProps={})}}function Mc(te,oe){var we=n.createEvent("Event");we.initEvent(te,!0,!0),we.gesture=oe,oe.target.dispatchEvent(we)}D(Gi,{INPUT_START:Jt,INPUT_MOVE:Je,INPUT_END:Et,INPUT_CANCEL:sn,STATE_POSSIBLE:Vs,STATE_BEGAN:Jr,STATE_CHANGED:ls,STATE_ENDED:po,STATE_RECOGNIZED:Cn,STATE_CANCELLED:No,STATE_FAILED:ki,DIRECTION_NONE:Qt,DIRECTION_LEFT:hn,DIRECTION_RIGHT:$t,DIRECTION_UP:Lt,DIRECTION_DOWN:Ft,DIRECTION_HORIZONTAL:wn,DIRECTION_VERTICAL:vn,DIRECTION_ALL:pt,Manager:Ps,Input:Ct,TouchAction:Ut,TouchInput:Se,MouseInput:fn,PointerEventInput:Kr,TouchMouseInput:$e,SingleTouchInput:Z,Recognizer:ir,AttrRecognizer:Zn,Tap:Qn,Pan:Bo,Swipe:js,Pinch:mo,Rotate:Dn,Press:Jn,on:ne,off:re,each:L,merge:z,extend:W,assign:D,inherit:N,bindFn:F,prefixed:ze});var Tl=typeof e<"u"?e:typeof self<"u"?self:{};Tl.Hammer=Gi,typeof i=="function"&&i.amd?i(function(){return Gi}):t.exports?t.exports=Gi:e[r]=Gi})(window,document,"Hammer")})(Y3);var $m=Y3.exports;const s7=Am($m),xa=lk({__proto__:null,default:s7},[$m]),K3=1,J3=2,Aw=4,o7={mousedown:K3,mousemove:J3,mouseup:Aw};function a7(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function l7(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(a7(i,o=>o.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function c7(t){t.prototype.handler=function(n){let r=o7[n.type];r&K3&&n.button>=0&&(this.pressed=!0),r&J3&&n.which===0&&(r=Aw),this.pressed&&(r&Aw&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}l7($m.PointerEventInput);c7($m.MouseInput);const u7=$m.Manager;let N_=class{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}};const h7=xa?[[xa.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[xa.Rotate,{enable:!1}],[xa.Pinch,{enable:!1}],[xa.Swipe,{enable:!1}],[xa.Pan,{threshold:0,enable:!1}],[xa.Press,{enable:!1}],[xa.Tap,{event:"doubletap",taps:2,enable:!1}],[xa.Tap,{event:"anytap",enable:!1}],[xa.Tap,{enable:!1}]]:null,GA={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},d7={doubletap:["tap"]},f7={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},AT={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},p7={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},WA={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},m7=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Jh=typeof window<"u"?window:global;let Iw=!1;try{const t={get passive(){return Iw=!0,!0}};Jh.addEventListener("test",null,t),Jh.removeEventListener("test",null)}catch{Iw=!1}const g7=m7.indexOf("firefox")!==-1,{WHEEL_EVENTS:y7}=AT,HA="wheel",qA=4.000244140625,_7=40,v7=.25;class x7 extends N_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let o=i.deltaY;Jh.WheelEvent&&(g7&&i.deltaMode===Jh.WheelEvent.DOM_DELTA_PIXEL&&(o/=Jh.devicePixelRatio),i.deltaMode===Jh.WheelEvent.DOM_DELTA_LINE&&(o*=_7)),o!==0&&o%qA===0&&(o=Math.floor(o/qA)),i.shiftKey&&o&&(o=o*v7),this.callback({type:HA,center:{x:i.clientX,y:i.clientY},delta:-o,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(y7),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Iw?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===HA&&(this.options.enable=n)}}const{MOUSE_EVENTS:b7}=AT,ZA="pointermove",XA="pointerover",YA="pointerout",KA="pointerenter",JA="pointerleave";class w7 extends N_{constructor(e,n,r){super(e,n,r),this.handleEvent=o=>{this.handleOverEvent(o),this.handleOutEvent(o),this.handleEnterEvent(o),this.handleLeaveEvent(o),this.handleMoveEvent(o)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(b7),this.events.forEach(o=>e.addEventListener(o,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===ZA&&(this.enableMoveEvent=n),e===XA&&(this.enableOverEvent=n),e===YA&&(this.enableOutEvent=n),e===KA&&(this.enableEnterEvent=n),e===JA&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(XA,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(YA,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(KA,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(JA,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(ZA,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:E7}=AT,QA="keydown",eI="keyup";class T7 extends N_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const o=i.target||i.srcElement;o.tagName==="INPUT"&&o.type==="text"||o.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:QA,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:eI,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(E7),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===QA&&(this.enableDownEvent=n),e===eI&&(this.enableUpEvent=n)}}const tI="contextmenu";class S7 extends N_{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:tI,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===tI&&(this.options.enable=n)}}const Mw=1,r_=2,kw=4,P7={pointerdown:Mw,pointermove:r_,pointerup:kw,mousedown:Mw,mousemove:r_,mouseup:kw},C7=1,A7=2,I7=3,M7=0,k7=1,L7=2,R7=1,O7=2,z7=4;function D7(t){const e=P7[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let o=!1,h=!1,l=!1;return e===kw||e===r_&&!Number.isFinite(n)?(o=i===C7,h=i===A7,l=i===I7):e===r_?(o=!!(n&R7),h=!!(n&z7),l=!!(n&O7)):e===Mw&&(o=r===M7,h=r===k7,l=r===L7),{leftButton:o,middleButton:h,rightButton:l}}function F7(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,o=r.height/e.offsetHeight||1,h={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/o};return{center:n,offsetCenter:h}}const U1={srcElement:"root",priority:0};class N7{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,o=!1){const{handlers:h,handlersByElement:l}=this;let m=U1;typeof r=="string"||r&&r.addEventListener?m={...U1,srcElement:r}:r&&(m={...U1,...r});let _=l.get(m.srcElement);_||(_=[],l.set(m.srcElement,_));const E={type:e,handler:n,srcElement:m.srcElement,priority:m.priority};i&&(E.once=!0),o&&(E.passive=!0),h.push(E),this._active=this._active||!E.passive;let T=_.length-1;for(;T>=0&&!(_[T].priority>=E.priority);)T--;_.splice(T+1,0,E)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let o=r.length-1;o>=0;o--){const h=r[o];if(h.type===e&&h.handler===n){r.splice(o,1);const l=i.get(h.srcElement);l.splice(l.indexOf(h),1),l.length===0&&i.delete(h.srcElement)}}this._active=r.some(o=>!o.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const o=()=>{e.handled=!0},h=()=>{e.handled=!0,i=!0},l=[];for(let m=0;m<r.length;m++){const{type:_,handler:E,once:T}=r[m];if(E({...e,type:_,stopPropagation:o,stopImmediatePropagation:h}),T&&l.push(r[m]),i)break}for(let m=0;m<l.length;m++){const{type:_,handler:E}=l[m];this.remove(_,E)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...D7(e),...F7(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const B7={events:null,recognizers:null,recognizerOptions:{},Manager:u7,touchAction:"none",tabIndex:0};class U7{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:o}=i,h=f7[o.type];h&&this.manager.emit(h,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...B7,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||h7}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(GA).forEach(i=>{const o=this.manager.get(i);o&&GA[i].forEach(h=>{o.recognizeWith(h)})});for(const i in n.recognizerOptions){const o=this.manager.get(i);if(o){const h=n.recognizerOptions[i];delete h.enable,o.set(h)}}this.wheelInput=new x7(e,this._onOtherEvent,{enable:!1}),this.moveInput=new w7(e,this._onOtherEvent,{enable:!1}),this.keyInput=new T7(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new S7(e,this._onOtherEvent,{enable:!1});for(const[i,o]of this.events)o.isEmpty()||(this._toggleRecognizer(o.recognizerName,!0),this.manager.on(i,o.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const o=d7[e];o&&!this.options.recognizers&&o.forEach(h=>{const l=r.get(h);n?(l.requireFailure(e),i.dropRequireFailure(h)):l.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,o){if(typeof e!="string"){r=n;for(const E in e)this._addEventHandler(E,e[E],r,i,o);return}const{manager:h,events:l}=this,m=WA[e]||e;let _=l.get(m);_||(_=new N7(this),l.set(m,_),_.recognizerName=p7[m]||m,h&&h.on(m,_.handleEvent)),_.add(e,n,r,i,o),_.isEmpty()||this._toggleRecognizer(_.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const h in e)this._removeEventHandler(h,e[h]);return}const{events:r}=this,i=WA[e]||e,o=r.get(i);if(o&&(o.remove(e,n),o.isEmpty())){const{recognizerName:h}=o;let l=!1;for(const m of r.values())if(m.recognizerName===h&&!m.isEmpty()){l=!0;break}l||this._toggleRecognizer(h,!1)}}}function Qc(){}const V7=({isDragging:t})=>t?"grabbing":"grab",Q3={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Qc,onResize:Qc,onViewStateChange:Qc,onInteractionStateChange:Qc,onBeforeRender:Qc,onAfterRender:Qc,onLoad:Qc,onError:t=>hr.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:V7,getTooltip:null,debug:!1,drawPickingColors:!1};class B_{constructor(e){J(this,"props",void 0),J(this,"width",0),J(this,"height",0),J(this,"userData",{}),J(this,"canvas",null),J(this,"viewManager",null),J(this,"layerManager",null),J(this,"effectManager",null),J(this,"deckRenderer",null),J(this,"deckPicker",null),J(this,"eventManager",null),J(this,"tooltip",null),J(this,"metrics",void 0),J(this,"animationLoop",void 0),J(this,"stats",void 0),J(this,"viewState",void 0),J(this,"cursorState",void 0),J(this,"_needsRedraw",void 0),J(this,"_pickRequest",void 0),J(this,"_lastPointerDownInfo",null),J(this,"_metricsCounter",void 0),J(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),J(this,"_onEvent",n=>{const r=NC[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const o=this.layerManager.getLayers(),h=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:o,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:l}=h,m=l&&(l[r.handler]||l.props[r.handler]),_=this.props[r.handler];let E=!1;m&&(E=m.call(l,h,n)),!E&&_&&_(h,n)}),J(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...Q3,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&hr.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),WR()==="IE"&&hr.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new hT({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Ad.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,o,h,l,m;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(o=this.deckRenderer)===null||o===void 0||o.finalize(),this.deckRenderer=null,(h=this.deckPicker)===null||h===void 0||h.finalize(),this.deckPicker=null,(l=this.eventManager)===null||l===void 0||l.destroy(),this.eventManager=null,(m=this.tooltip)===null||m===void 0||m.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var _;(_=this.canvas.parentElement)===null||_===void 0||_.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&hr.removed("onLayerHover","onHover")(),"onLayerClick"in e&&hr.removed("onLayerClick","onClick")(),e.initialViewState&&!Ma(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),o=this.effectManager.needsRedraw(e),h=this.deckRenderer.needsRedraw(e);return n=n||r||i||o||h,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Ci(this.viewManager),this.viewManager.views}getViewports(e){return Ci(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Ci(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const o=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),o}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Ci(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const o=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=o}if(r||r===0){var i;const o=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=o}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,o=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||o!==this.height){var h,l;this.width=i,this.height=o,(h=this.viewManager)===null||h===void 0||h.setProps({width:i,height:o}),(l=this.layerManager)===null||l===void 0||l.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:o})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:o,debug:h,onError:l,onBeforeRender:m,onAfterRender:_,useDevicePixels:E}=e;return new Nj({width:n,height:r,useDevicePixels:E,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:T=>JR({...o,...T,canvas:this.canvas,debug:h,onContextLost:()=>this._onContextLost()}),onInitialize:T=>this._setGLContext(T.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:m,onAfterRender:_,onError:l})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new q3({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let o=i,h=!1;for(const l of r){var n;o=l,h=((n=l.layer)===null||n===void 0?void 0:n.onHover(l,e.event))||h}if(!h&&this.props.onHover&&this.props.onHover(o,e.event),this.props.getTooltip&&this.tooltip){const l=this.props.getTooltip(o);this.tooltip.setTooltip(l,o.x,o.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,uT(e,{enable:!0,copyState:!0})),this.tooltip=new i7(this.canvas),pl(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new C3;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new U7(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in NC)this.eventManager.on(i,this._onEvent);this.viewManager=new LG({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new kG(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new qG,this.deckRenderer=new YG(e),this.deckPicker=new n7(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;pl(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),hr.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=uu.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}J(B_,"defaultProps",Q3);J(B_,"VERSION",$6);class V1{constructor(e,n){J(this,"opts",void 0),J(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let o=r;if(r&&r.length!==i){o=new Float32Array(i);const h=n.elementOffset||0;for(let l=0;l<i;++l)o[l]=r[h+l]}return o}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function j7(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function d0(t){return t.stride||t.size*t.bytesPerElement}function eO(t,e){e.offset&&hr.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=d0(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,o=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:o,stride:n}}function $7(t,e){const n=eO(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class G7{constructor(e,n,r){J(this,"gl",void 0),J(this,"id",void 0),J(this,"size",void 0),J(this,"settings",void 0),J(this,"value",void 0),J(this,"doublePrecision",void 0),J(this,"_buffer",void 0),J(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,o=i===5130;let{defaultValue:h}=n;h=Number.isFinite(h)?[h]:h||new Array(this.size).fill(0);let l;o?l=5126:!i&&n.isIndexed?l=e&&pV(e,Sr.ELEMENT_INDEX_UINT32)?5125:5123:l=i||5126;let m=j7(i||l||5126);this.doublePrecision=o,o&&n.fp64===!1&&(m=Float32Array),this.value=null,this.settings={...n,defaultType:m,defaultValue:h,logicalType:i,type:l,size:this.size,bytesPerElement:m.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new ur(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*d0(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Ad.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,o=$7(this.getAccessor(),n||{});return r[e]=new V1(this,o.high),r["".concat(e,"64Low")]=i?new V1(this,o.low):new Float32Array(this.size),r}if(n){const r=eO(this.getAccessor(),n);return{[e]:new V1(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,o=r*i;if(n&&o&&n.length>=o){const h=new Array(i).fill(1/0),l=new Array(i).fill(-1/0);for(let m=0;m<o;)for(let _=0;_<i;_++){const E=n[m++];E<h[_]&&(h[_]=E),E>l[_]&&(l[_]=E)}e=[h,l]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof ur?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let o=r.value;if(o=this._normalizeValue(o,[],0),this.settings.normalized&&(o=this.normalizeConstant(o)),!(!n.constant||!this._areValuesEqual(o,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=o}else if(r.buffer){const o=r.buffer;n.externalBuffer=o,n.constant=!1,this.value=r.value||null;const h=r.value instanceof Float64Array;i.type=r.type||o.accessor.type,i.bytesPerElement=o.accessor.BYTES_PER_ELEMENT*(h?2:1),i.stride=d0(i)}else if(r.value){this._checkExternalBuffer(r);let o=r.value;n.externalBuffer=null,n.constant=!1,this.value=o,i.bytesPerElement=o.BYTES_PER_ELEMENT,i.stride=d0(i);const{buffer:h,byteOffset:l}=this;this.doublePrecision&&o instanceof Float64Array&&(o=F1(o,i));const m=o.byteLength+l+i.stride*2;h.byteLength<m&&h.reallocate(m),h.setAccessor(null),h.subData({data:o,offset:l}),i.type=r.type||h.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?F1(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,o=Ad.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=o;const{buffer:h,byteOffset:l}=this;return h.byteLength<o.byteLength+l&&(h.reallocate(o.byteLength+l),n&&i&&h.subData({data:i instanceof Float64Array?F1(i,this):i,offset:l})),r.allocatedValue=o,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&hr.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:o}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let h=o;for(;--h>=0;)n[r+h]=i[h];return n}switch(o){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let h=o;for(;--h>=0;)n[r+h]=Number.isFinite(e[h])?e[h]:i[h]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const nI=[],rI=[];function IT(t,e=0,n=1/0){let r=nI;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(rI.length=t.length,r=rI):r=nI,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function tO(t){return t&&t[Symbol.asyncIterator]}function nO(t,e){const{size:n,stride:r,offset:i,startIndices:o,nested:h}=e,l=t.BYTES_PER_ELEMENT,m=r?r/l:n,_=i?i/l:0,E=Math.floor((t.length-_)/m);return(T,{index:A,target:L})=>{if(!o){const z=A*m+_;for(let N=0;N<n;N++)L[N]=t[z+N];return L}const R=o[A],D=o[A+1]||E;let W;if(h){W=new Array(D-R);for(let z=R;z<D;z++){const N=z*m+_;L=new Array(n);for(let F=0;F<n;F++)L[F]=t[N+F];W[z-R]=L}}else if(m===n)W=t.subarray(R*n+_,D*n+_);else{W=new t.constructor((D-R)*n);let z=0;for(let N=R;N<D;N++){const F=N*m+_;for(let $=0;$<n;$++)W[z++]=t[F+$]}}return W}}const W7=[],f0=[[0,1/0]];function H7(t,e){if(t===f0||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let o=0;o<r;o++){const h=t[o];h[1]<e[0]?(n.push(h),i=o+1):h[0]>e[1]?n.push(h):e=[Math.min(h[0],e[0]),Math.max(h[1],e[1])]}return n.splice(i,0,e),n}function j1(t){const{source:e,target:n,start:r=0,size:i,getData:o}=t,h=t.end||n.length,l=e.length,m=h-r;if(l>m){n.set(e.subarray(0,m),r);return}if(n.set(e,r),!o)return;let _=l;for(;_<m;){const E=o(_,e);for(let T=0;T<i;T++)n[r+_]=E[T]||0,_++}}function q7({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:o}){if(!Array.isArray(o))return j1({source:t,target:e,size:n,getData:r}),e;let h=0,l=0;const m=r&&((E,T)=>r(E+l,T)),_=Math.min(i.length,o.length);for(let E=1;E<_;E++){const T=i[E]*n,A=o[E]*n;j1({source:t.subarray(h,T),target:e,start:l,end:A,size:n,getData:m}),h=T,l=A}return l<e.length&&j1({source:[],target:e,start:l,size:n,getData:m}),e}const Z7={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function rO(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...Z7[n],...e,...t,type:n}}function iO(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function sO(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function oO(t){t.push(t.shift())}function MT(t,e){const{doublePrecision:n,settings:r,value:i,size:o}=t,h=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*o)*h}function aO({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:o=h=>h}){const h=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*h,m=n.byteOffset,_=n.startIndices,E=i&&_,T=MT(n,e),A=n.isConstant;if(!E&&r>=T)return;const L=A?n.value:n.getBuffer().getData({srcByteOffset:m});if(n.settings.normalized&&!A){const z=o;o=(N,F)=>n.normalizeConstant(z(N,F))}const R=A?(z,N)=>o(L,N):(z,N)=>o(L.subarray(z,z+l),N),D=t.getData({length:r}),W=new Float32Array(T);q7({source:D,target:W,sourceStartIndices:i,targetStartIndices:_,size:l,getData:R}),t.byteLength<W.byteLength+m&&t.reallocate(W.byteLength+m),t.subData({data:W,offset:m})}class kT extends G7{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:f0}),J(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(o=>e[o])]:e[n];return rO(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=H7(this.state.updateRanges,[r,i])}else this.state.updateRanges=f0}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=W7}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==f0),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:o},settings:{update:h,noAlloc:l}}=this;let m=!0;if(h){for(const[_,E]of o)h.call(i,this,{data:n,startRow:_,endRow:E,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[_,E]of o){const T=Number.isFinite(_)?this.getVertexOffset(_):0,A=Number.isFinite(E)?this.getVertexOffset(E):l||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:T,endOffset:A})}this._checkAttributeArray()}else m=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),m}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const h=e;Ci(ArrayBuffer.isView(h.value),"invalid ".concat(i.accessor));const l=!!h.size&&h.size!==this.size;return r.binaryAccessor=nO(h.value,{size:h.size||this.size,stride:h.stride,offset:h.offset,startIndices:n,nested:l}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:o,numInstances:h}){if(e.constant)return;const{settings:l,state:m,value:_,size:E,startIndices:T}=e,{accessor:A,transform:L}=l,R=m.binaryAccessor||(typeof A=="function"?A:o[A]);Ci(typeof R=="function",'accessor "'.concat(A,'" is not a function'));let D=e.getVertexOffset(r);const{iterable:W,objectInfo:z}=IT(n,r,i);for(const N of W){z.index++;let F=R(N,z);if(L&&(F=L.call(this,F)),T){const $=(z.index<T.length-1?T[z.index+1]:h)-T[z.index];if(F&&Array.isArray(F[0])){let K=D;for(const ne of F)e._normalizeValue(ne,_,K),K+=E}else F&&F.length>E?_.set(F,D):(e._normalizeValue(F,z.target,0),wG({target:_,source:z.target,start:D,count:$}));D+=$*E}else e._normalizeValue(F,_,D),D+=E}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class X7{constructor({gl:e,attribute:n,timeline:r}){J(this,"gl",void 0),J(this,"type","interpolation"),J(this,"attributeInTransition",void 0),J(this,"settings",void 0),J(this,"attribute",void 0),J(this,"transition",void 0),J(this,"currentStartIndices",void 0),J(this,"currentLength",void 0),J(this,"transform",void 0),J(this,"buffers",void 0),this.gl=e,this.transition=new jm(r),this.attribute=n,this.attributeInTransition=new kT(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=K7(e,n);const i={byteLength:0,usage:35050};this.buffers=[new ur(e,i),new ur(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:o}=this;oO(i);const h={numInstances:n,attribute:o,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const l of i)aO({buffer:l,...h});this.currentStartIndices=o.startIndices,this.currentLength=MT(o,n),this.attributeInTransition.setData({buffer:i[1],value:o.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/o.size),sourceBuffers:{aFrom:i[0],aTo:iO(r,o)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let o=i/n;r&&(o=r(o)),this.transform.run({uniforms:{time:o}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const Y7=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function K7(t,e){const n=sO(e.size);return new vT(t,{vs:Y7,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class J7{constructor({gl:e,attribute:n,timeline:r}){J(this,"gl",void 0),J(this,"type","spring"),J(this,"attributeInTransition",void 0),J(this,"settings",void 0),J(this,"attribute",void 0),J(this,"transition",void 0),J(this,"currentStartIndices",void 0),J(this,"currentLength",void 0),J(this,"texture",void 0),J(this,"framebuffer",void 0),J(this,"transform",void 0),J(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new jm(r),this.attribute=n,this.attributeInTransition=new kT(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=eW(e),this.framebuffer=tW(e,this.texture),this.transform=Q7(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new ur(e,i),new ur(e,i),new ur(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:o}=this,h={numInstances:n,attribute:o,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const l of i)aO({buffer:l,...h});this.settings=e,this.currentStartIndices=o.startIndices,this.currentLength=MT(o,n),this.attributeInTransition.setData({buffer:i[1],value:o.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/o.size),sourceBuffers:{aTo:iO(r,o)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const h=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:h.stiffness,damping:h.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),oO(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),F_(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function Q7(t,e,n){const r=sO(e.size);return new vT(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function eW(t){return new la(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function tW(t,e){return new vi(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const nW={interpolation:X7,spring:J7};class rW{constructor(e,{id:n,timeline:r}){J(this,"id",void 0),J(this,"isSupported",void 0),J(this,"gl",void 0),J(this,"timeline",void 0),J(this,"transitions",void 0),J(this,"needsRedraw",void 0),J(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=vT.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const o=e[i],h=o.getTransitionSetting(n);h&&this._updateAttribute(i,o,h)}for(const i in this.transitions){const o=e[i];(!o||!o.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let o=!i||i.type!==r.type;if(o){if(!this.isSupported){hr.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const h=nW[r.type];h?this.transitions[e]=new h({attribute:n,timeline:this.timeline,gl:this.gl}):(hr.error("unsupported transition type '".concat(r.type,"'"))(),o=!1)}(o||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const iI="attributeManager.invalidate",iW="attributeManager.updateStart",sW="attributeManager.updateEnd",oW="attribute.updateStart",aW="attribute.allocate",lW="attribute.updateEnd";class cW{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){J(this,"id",void 0),J(this,"gl",void 0),J(this,"attributes",void 0),J(this,"updateTriggers",void 0),J(this,"needsRedraw",void 0),J(this,"userData",void 0),J(this,"stats",void 0),J(this,"attributeTransitionManager",void 0),J(this,"mergeBoundsMemoized",Vm(fG)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new rW(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);ss(iI,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);ss(iI,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:o={},buffers:h={},context:l={}}){let m=!1;ss(iW,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const _ in this.attributes){const E=this.attributes[_],T=E.settings.accessor;E.startIndices=r,E.numInstances=n,o[_]&&hr.removed("props.".concat(_),"data.attributes.".concat(_))(),E.setExternalBuffer(h[_])||E.setBinaryValue(typeof T=="string"?h[T]:void 0,e.startIndices)||typeof T=="string"&&!h[T]&&E.setConstantValue(o[T])||E.needsUpdate()&&(m=!0,this._updateAttribute({attribute:E,numInstances:n,data:e,props:o,context:l})),this.needsRedraw=this.needsRedraw||E.needsRedraw()}m&&ss(sW,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const o in n){const h=n[o];h.needsRedraw(e)&&!r.hasAttribute(o)&&(i[o]=h)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new kT(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,o=i[e];return o&&o.forEach(h=>{const l=r[h];l&&l.setNeedsUpdate(l.id,n)}),o}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(ss(oW,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&ss(aW,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,ss(lW,n,r))}}class uW extends jm{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:o}}=this,h=o(e/i);this._value=fm(n,r,h)}}const sI=1e-5;function oI(t,e,n,r,i){const o=e-t,l=(n-e)*i,m=-o*r;return l+m+o+e}function hW(t,e,n,r,i){if(Array.isArray(n)){const o=[];for(let h=0;h<n.length;h++)o[h]=oI(t[h],e[h],n[h],r,i);return o}return oI(t,e,n,r,i)}function aI(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class dW extends jm{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:o=e,_currValue:h=e}=this;let l=hW(o,h,n,r,i);const m=aI(l,n),_=aI(l,h);m<sI&&_<sI&&(l=n,this.end()),this._prevValue=h,this._currValue=l}}const fW={interpolation:uW,spring:dW};class pW{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:o}=this;if(o.has(e)){const m=o.get(e),{value:_=m.settings.fromValue}=m;n=_,this.remove(e)}if(i=rO(i),!i)return;const h=fW[i.type];if(!h){hr.error("unsupported transition type '".concat(i.type,"'"))();return}const l=new h(this.timeline);l.start({...i,fromValue:n,toValue:r}),o.set(e,l)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function mW(t){const e=t[_c];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function gW(t,e){const n=lO({newProps:t,oldProps:e,propTypes:t[_c],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=_W(t,e);let i=!1;return r||(i=vW(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:xW(t,e),transitionsChanged:yW(t,e)}}function yW(t,e){if(!t.transitions)return!1;const n={},r=t[_c];let i=!1;for(const o in t.transitions){const h=r[o],l=h&&h.type;(l==="number"||l==="color"||l==="array")&&Lw(t[o],e[o],h)&&(n[o]=!0,i=!0)}return i?n:!1}function lO({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(i,".").concat(o," added");const h=Lw(t[o],e[o],r[o]);if(h)return"".concat(i,".").concat(o," ").concat(h)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(i,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const h=Lw(t[o],e[o],r[o]);if(h)return"".concat(i,".").concat(o," ").concat(h)}}return!1}function Lw(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function _W(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function vW(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&lI(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&lI(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function xW(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function lI(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},lO({oldProps:i,newProps:r,triggerName:n})}const bW="count(): argument not an object",wW="count(): argument not a container";function EW(t){if(!SW(t))throw new Error(bW);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(TW(t))return Object.keys(t).length;throw new Error(wW)}function TW(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function SW(t){return t!==null&&typeof t=="object"}function PW(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const CW={10241:9987,10240:9729,10242:33071,10243:33071},Rw={};function AW(t,e,n,r){if(n instanceof la)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const o=new la(e,{...n,parameters:{...CW,...i,...r}});return Rw[o.id]=t,o}function IW(t,e){!e||!(e instanceof la)||Rw[e.id]===t&&(e.delete(),delete Rw[e.id])}const MW={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Ow(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Ma(t,e,1)}},accessor:{validate(t,e){const n=i_(t);return n==="function"||n===i_(e.value)},equal(t,e,n){return typeof e=="function"?!0:Ma(t,e,1)}},array:{validate(t,e){return e.optional&&!t||Ow(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Ma(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Ma(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:AW(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{IW(n.id,t)}}};function kW(t){const e={},n={},r={};for(const[i,o]of Object.entries(t)){const h=o==null?void 0:o.deprecatedFor;if(h)r[i]=Array.isArray(h)?h:[h];else{const l=LW(i,o);e[i]=l,n[i]=l.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function LW(t,e){switch(i_(e)){case"object":return ap(t,e);case"array":return ap(t,{type:"array",value:e,compare:!1});case"boolean":return ap(t,{type:"boolean",value:e});case"number":return ap(t,{type:"number",value:e});case"function":return ap(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function ap(t,e){return"type"in e?{name:t,...MW[e.type],...e}:"value"in e?{name:t,type:i_(e.value),...e}:{name:t,type:"object",value:e}}function Ow(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function i_(t){return Ow(t)?"array":t===null?"null":typeof t}function RW(t,e){let n;for(let o=e.length-1;o>=0;o--){const h=e[o];"extensions"in h&&(n=h.extensions)}const r=zw(t.constructor,n),i=Object.create(r);i[n_]=t,i[Tu]={},i[ic]={};for(let o=0;o<e.length;++o){const h=e[o];for(const l in h)i[l]=h[l]}return Object.freeze(i),i}const OW="_mergedDefaultProps";function zw(t,e){let n=OW;if(e)for(const i of e){const o=i.constructor;o&&(n+=":".concat(o.extensionName||o.name))}const r=cO(t,n);return r||(t[n]=zW(t,e||[]))}function zW(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=zw(r),o=cO(t,"defaultProps")||{},h=kW(o),l=Object.assign(Object.create(null),i,h.defaultProps),m=Object.assign(Object.create(null),i==null?void 0:i[_c],h.propTypes),_=Object.assign(Object.create(null),i==null?void 0:i[B1],h.deprecatedProps);for(const E of e){const T=zw(E.constructor);T&&(Object.assign(l,T),Object.assign(m,T[_c]),Object.assign(_,T[B1]))}return DW(l,t),NW(l,m),FW(l,_),l[_c]=m,l[B1]=_,e.length===0&&!LT(t,"_propTypes")&&(t._propTypes=m),l}function DW(t,e){const n=UW(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function FW(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const o of e[n])LT(this,o)||(this[o]=r);hr.deprecated(i,e[n].join("/"))()}})}function NW(t,e){const n={},r={};for(const i in e){const o=e[i],{name:h,value:l}=o;o.async&&(n[h]=l,r[h]=BW(h))}t[ld]=n,t[Tu]={},Object.defineProperties(t,r)}function BW(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||tO(e)?this[Tu][t]=e:this[ic][t]=e},get(){if(this[ic]){if(t in this[ic])return this[ic][t]||this[ld][t];if(t in this[Tu]){const e=this[n_]&&this[n_].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[ld][t]}}return this[ld][t]}}}function LT(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function cO(t,e){return LT(t,e)&&t[e]}function UW(t){const e=t.componentName;return e||hr.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let VW=0;class RT{constructor(...e){J(this,"id",void 0),J(this,"props",void 0),J(this,"count",void 0),this.props=RW(this,e),this.id=this.props.id,this.count=VW++}clone(e){const{props:n}=this,r={};for(const i in n[ld])i in n[ic]?r[i]=n[ic][i]:i in n[Tu]&&(r[i]=n[Tu][i]);return new this.constructor({...n,...r,...e})}}J(RT,"componentName","Component");J(RT,"defaultProps",{});const jW=Object.freeze({});class $W{constructor(e){J(this,"component",void 0),J(this,"onAsyncPropUpdated",void 0),J(this,"asyncProps",void 0),J(this,"oldProps",void 0),J(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||jW}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[n_]||this.component;const n=e[ic]||{},r=e[Tu]||e,i=e[ld]||{};for(const o in n){const h=n[o];this._createAsyncPropData(o,i[o]),this._updateAsyncProp(o,h),n[o]=this.getAsyncProp(o)}for(const o in r){const h=r[o];this._createAsyncPropData(o,i[o]),this._updateAsyncProp(o,h)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(tO(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(o=>{this.component&&(o=this._postProcessValue(r,o),this._setAsyncPropValue(e,o,i),this._onResolve(e,o))}).catch(o=>{this._onError(e,o)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let o=[],h=0;for await(const l of n){if(!this.component)return;const{dataTransform:m}=this.component.props;m?o=m(l,o):o=o.concat(l),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:h,endRow:o.length}]}),h=o.length,this._setAsyncPropValue(e,o,i)}this._onResolve(e,o)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[_c];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class GW extends $W{constructor({attributeManager:e,layer:n}){super(n),J(this,"attributeManager",void 0),J(this,"needsRedraw",void 0),J(this,"needsUpdate",void 0),J(this,"subLayers",void 0),J(this,"usesPickingColorCache",void 0),J(this,"hasPickingBuffer",void 0),J(this,"changeFlags",void 0),J(this,"viewport",void 0),J(this,"uniformTransitions",void 0),J(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const WW="layer.changeFlag",HW="layer.initialize",qW="layer.update",ZW="layer.finalize",XW="layer.matched",cI=2**24-1,YW=Object.freeze([]),KW=Vm(({oldViewport:t,viewport:e})=>t.equals(e));let ba=new Uint8ClampedArray(0);const JW={data:{type:"data",value:YW,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:o})=>{const{resourceManager:h}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,o){var l;i={...i,fetch:{...(l=i)===null||l===void 0?void 0:l.fetch,signal:o}}}let m=h.contains(t);return!m&&!i&&(h.add({resourceId:t,data:cw(t,r),persistent:!1}),m=!0),m?h.subscribe({resourceId:t,onChange:_=>{var E;return(E=n.internalState)===null||E===void 0?void 0:E.reloadAsyncProp(e,_)},consumerId:n.id,requestId:e}):cw(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:qn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Ou extends RT{constructor(...e){super(...e),J(this,"internalState",null),J(this,"lifecycle",Fh.NO_STATE),J(this,"context",void 0),J(this,"state",void 0),J(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Ci(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=j3(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,o,h]=F3(r,n.pixelProjectionMatrix);return e.length===2?[i,o]:[i,o,h]}unproject(e){return Ci(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Ci(this.internalState);const r=this.internalState.viewport||this.context.viewport;return vG(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===qn.DEFAULT||e===qn.LNGLAT||e===qn.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Ci(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:EW(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=PW(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,o=this.internalState.hasPickingBuffer,h=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(l=>l.getNeedsPickingBuffer.call(this,l));if(o!==h){this.internalState.hasPickingBuffer=h;const{pickingColors:l,instancePickingColors:m}=n.attributes,_=l||m;_&&(h&&_.constant&&(_.constant=!1,n.invalidate(_.id)),!_.value&&!h&&(_.constant=!0,_.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var o,h;(o=this.context)===null||o===void 0||(h=o.onError)===null||h===void 0||h.call(o,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!KW({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const o=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(ba.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>cI&&hr.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),ba=Ad.allocate(ba,n,{size:3,copy:!0,maxCount:Math.max(n,cI)});const i=Math.floor(ba.length/3),o=[];for(let h=r;h<i;h++)this.encodePickingColor(h,o),ba[h*3+0]=o[0],ba[h*3+1]=o[1],ba[h*3+2]=o[2]}e.value=ba.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},o=r.getShaderAttributes(n,i);e.setAttributes(o)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,o=r||i,h=o&&n.attributes&&n.attributes[o.id];if(h&&h.value){const l=h.value,m=this.encodePickingColor(e);for(let _=0;_<n.length;_++){const E=o.getVertexOffset(_);l[E]===m[0]&&l[E+1]===m[1]&&l[E+2]===m[2]&&this._disablePickingIndex(_)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const o=i.getVertexOffset(e),h=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(h-o),offset:o})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==ba.buffer&&(r.value=ba.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Ci(!this.internalState),Ci(Number.isFinite(this.props.coordinateSystem)),ss(HW,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new GW({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(hr.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new pW(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){ss(XW,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(ss(qW,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,o=r.viewport,h=this._updateUniformTransition();i.propsInTransition=h,r.viewport=i.viewport||o,this.props=h;try{const l=this._getUpdateParams(),m=this.getModels();if(r.gl)this.updateState(l);else try{this.updateState(l)}catch{}for(const E of this.props.extensions)E.updateState.call(this,l,E);const _=this.getModels()[0]!==m[0];this._postUpdate(l,_)}finally{r.viewport=o,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){ss(ZW,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,o=this.context;this.props=this.internalState.propsInTransition||i;const h=this.props.opacity;n.opacity=Math.pow(h,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:l}=this.props,m=l&&l(n)||[0,0];pl(o.gl,{polygonOffset:m}),oa(o.gl,r,()=>{const _={moduleParameters:e,uniforms:n,parameters:r,context:o};for(const E of this.props.extensions)E.draw.call(this,_,E);this.draw(_)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let o=!1;switch(i){case"dataChanged":const h=e[i],l=n[i];h&&Array.isArray(l)&&(n.dataChanged=Array.isArray(h)?l.concat(h):h,o=!0);default:n[i]||(n[i]=e[i],o=!0)}o&&ss(WW,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=gW(e,n);if(r.updateTriggersChanged)for(const o in r.updateTriggersChanged)r.updateTriggersChanged[o]&&this.invalidateAttribute(o);if(r.transitionsChanged)for(const o in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(o,n[o],e[o],(i=e.transitions)===null||i===void 0?void 0:i[o])}return this.setChangeFlags(r)}validateProps(){mW(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new cW(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:o}=this.state;o==null||o.setInstanceCount(this.getNumInstances());const{autoHighlight:h,highlightedObjectIndex:l,highlightColor:m}=r;if(n||i.autoHighlight!==h||i.highlightedObjectIndex!==l||i.highlightColor!==m){const _={};h||(_.pickingSelectedColor=null),Array.isArray(m)&&(_.pickingHighlightColor=m),(n||l!==i.highlightedObjectIndex)&&(_.pickingSelectedColor=Number.isFinite(l)&&l>=0?this.encodePickingColor(l):null),this.setModuleParameters(_)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const o of this.props.extensions)o.onNeedsRedraw.call(this,o);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}J(Ou,"defaultProps",JW);J(Ou,"layerName","Layer");const QW="compositeLayer.renderLayers";class uO extends Ou{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:o,parameters:h,getPolygonOffset:l,highlightedObjectIndex:m,autoHighlight:_,highlightColor:E,coordinateSystem:T,coordinateOrigin:A,wrapLongitude:L,positionFormat:R,modelMatrix:D,extensions:W,fetch:z,operation:N,_subLayerProps:F}=this.props,$={id:"",updateTriggers:{},opacity:r,pickable:i,visible:o,parameters:h,getPolygonOffset:l,highlightedObjectIndex:m,autoHighlight:_,highlightColor:E,coordinateSystem:T,coordinateOrigin:A,wrapLongitude:L,positionFormat:R,modelMatrix:D,extensions:W,fetch:z,operation:N},K=F&&e.id&&F[e.id],ne=K&&K.updateTriggers,re=e.id||"sublayer";if(K){const be=this.props[_c],xe=e.type?e.type._propTypes:{};for(const fe in K){const Re=xe[fe]||be[fe];Re&&Re.type==="accessor"&&(K[fe]=this.getSubLayerAccessor(K[fe]))}}Object.assign($,e,K),$.id="".concat(this.props.id,"-").concat(re),$.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...ne};for(const be of W){const xe=be.getSubLayerProps.call(this,be);xe&&Object.assign($,xe,{updateTriggers:Object.assign($.updateTriggers,xe.updateTriggers)})}return $}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const o=this.renderLayers();r=ST(o,Boolean),this.internalState.subLayers=r}ss(QW,this,i,r);for(const o of r)o.parent=this}}J(uO,"layerName","CompositeLayer");const $1={bearing:0,pitch:0,position:[0,0,0]},eH={speed:1.2,curve:1.414};class tH extends W3{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),J(this,"opts",void 0),this.opts={...eH,...e}}interpolateProps(e,n,r){const i=X9(e,n,r,this.opts);for(const o in $1)i[o]=fm(e[o]||$1[o],n[o]||$1[o],r);return i}getDuration(e,n){let{transitionDuration:r}=n;return r==="auto"&&(r=Y9(e,n,this.opts)),r}}class hO{constructor(e){J(this,"opts",void 0),J(this,"typedArrayManager",void 0),J(this,"indexStarts",[0]),J(this,"vertexStarts",[0]),J(this,"vertexCount",0),J(this,"instanceCount",0),J(this,"attributes",void 0),J(this,"_attributeDefs",void 0),J(this,"data",void 0),J(this,"getGeometry",void 0),J(this,"geometryBuffer",void 0),J(this,"buffers",void 0),J(this,"positionSize",void 0),J(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=Ad,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:o,positionFormat:h,dataChanged:l,normalize:m=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=o&&o.size||(h==="XY"?2:3),this.buffers=r,this.normalize=m,o&&(Ci(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(o),m||(r.positions=o)),this.geometryBuffer=r.positions,Array.isArray(l))for(const _ of l)this._rebuildGeometry(_);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?nO(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:o,typedArrayManager:h}=this;for(const l in o)if(l in i)h.release(r[l]),r[l]=null;else{const m=o[l];m.copy=n,r[l]=h.allocate(r[l],e,m)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:o}=this,{iterable:h,objectInfo:l}=IT(i,n,r);for(const m of h){l.index++;const _=o?o(m,l):null;e(_,l.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:o,geometryBuffer:h}=this,{startRow:l=0,endRow:m=1/0}=e||{},_={};if(e||(n=[0],r=[0]),this.normalize||!h)this._forEachGeometry((T,A)=>{const L=T&&this.normalizeGeometry(T);_[A]=L,r[A+1]=r[A]+(L?this.getGeometrySize(L):0)},l,m),i=r[r.length-1];else if(r=o.startIndices,i=r[o.length]||0,ArrayBuffer.isView(h))i=i||h.length/this.positionSize;else if(h instanceof ur){const T=h.accessor.stride||this.positionSize*4;i=i||h.byteLength/T}else if(h.buffer){const T=h.stride||this.positionSize*4;i=i||h.buffer.byteLength/T}else if(h.value){const T=h.value,A=h.stride/T.BYTES_PER_ELEMENT||this.positionSize;i=i||T.length/A}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const E={};this._forEachGeometry((T,A)=>{const L=_[A]||T;E.vertexStart=r[A],E.indexStart=n[A];const R=A<r.length-1?r[A+1]:i;E.geometrySize=R-r[A],E.geometryIndex=A,this.updateGeometryAttributes(L,E)},l,m),this.vertexCount=n[n.length-1]}}const nH=typeof window<"u"?q.useLayoutEffect:q.useEffect,rH=nH;function s_(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const iH={position:"absolute",zIndex:-1};function dO(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>dO(n,e));if(U_(t)){if(sH(t))return e.style=iH,q.cloneElement(t,e);if(oH(t))return q.cloneElement(t,e)}return t}function U_(t){return t&&typeof t=="object"&&"type"in t||!1}function sH(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function oH(t){const e=t.type;return e&&e.deckGLViewProps}function Dw(t){if(typeof t=="function")return q.createElement(Md,{},t);if(Array.isArray(t))return t.map(Dw);if(U_(t)){if(t.type===q.Fragment)return Dw(t.props.children);if(s_(t.type,Md))return t}return t}function aH({children:t,layers:e=[],views:n=null}){const r=[],i=[],o={};return q.Children.forEach(Dw(t),h=>{if(U_(h)){const l=h.type;if(s_(l,Ou)){const m=lH(l,h.props);i.push(m)}else r.push(h);if(s_(l,Md)&&l!==Md&&h.props.id){const m=new l(h.props);o[m.id]=m}}else h&&r.push(h)}),Object.keys(o).length>0&&(Array.isArray(n)?n.forEach(h=>{o[h.id]=h}):n&&(o[n.id]=n),n=Object.values(o)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function lH(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function cH({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},o=r.views[0].id;for(const h of t){let l=o,m=h;U_(h)&&s_(h.type,Md)&&(l=h.props.id||o,m=h.props.children);const _=r.getViewport(l),E=r.getViewState(l);if(_){E.padding=_.padding;const{x:T,y:A,width:L,height:R}=_;m=dO(m,{x:T,y:A,width:L,height:R,viewport:_,viewState:E}),i[l]||(i[l]={viewport:_,children:[]}),i[l].children.push(m)}}return Object.keys(i).map(h=>{const{viewport:l,children:m}=i[h],{x:_,y:E,width:T,height:A}=l,L={position:"absolute",left:_,top:E,width:T,height:A},R="view-".concat(h),D=q.createElement("div",{key:R,id:R,style:L},...m);if(n){const W={viewport:l,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:z=>{z.viewId=h,e._onViewStateChange(z)}};return q.createElement(n,{key:R,value:W},D)}return D})}const uH={mixBlendMode:null};function hH({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const o in n)o in uH?i[o]=n[o]:r[o]=n[o];return{containerStyle:r,canvasStyle:i}}function dH(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function fO(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function fH(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const o=r.getViewports();t.lastRenderedViewports!==o?t.forceUpdate():fO(t)}});return r}const pO=q.forwardRef((t,e)=>{const[n,r]=q.useState(0),o=q.useRef({control:null,version:n,forceUpdate:()=>r(K=>K+1)}).current,h=q.useRef(null),l=q.useRef(null),m=q.useMemo(()=>aH(t),[t.layers,t.views,t.children]);let _=!0;const E=K=>{var ne;return _&&t.viewState?(o.viewStateUpdateRequested=K,null):(o.viewStateUpdateRequested=null,(ne=t.onViewStateChange)===null||ne===void 0?void 0:ne.call(t,K))},T=K=>{if(_)o.interactionStateUpdateRequested=K;else{var ne;o.interactionStateUpdateRequested=null,(ne=t.onInteractionStateChange)===null||ne===void 0||ne.call(t,K)}},A=q.useMemo(()=>{const K={...t,style:null,width:"100%",height:"100%",parent:h.current,canvas:l.current,layers:m.layers,views:m.views,onViewStateChange:E,onInteractionStateChange:T};return delete K._customRender,o.deck&&o.deck.setProps(K),K},[t]);q.useEffect(()=>{const K=t.Deck||B_;return o.deck=fH(o,K,{...A,parent:h.current,canvas:l.current}),()=>{var ne;return(ne=o.deck)===null||ne===void 0?void 0:ne.finalize()}},[]),rH(()=>{fO(o);const{viewStateUpdateRequested:K,interactionStateUpdateRequested:ne}=o;K&&E(K),ne&&T(ne)}),q.useImperativeHandle(e,()=>dH(o),[]);const L=o.deck&&o.deck.isInitialized?o.deck.getViewports():void 0,{ContextProvider:R,width:D,height:W,id:z,style:N}=t,{containerStyle:F,canvasStyle:$}=q.useMemo(()=>hH({width:D,height:W,style:N}),[D,W,N]);if(!o.viewStateUpdateRequested&&o.lastRenderedViewports===L||o.version!==n){o.lastRenderedViewports=L,o.version=n;const K=cH({children:m.children,deck:o.deck,ContextProvider:R}),ne=q.createElement("canvas",{key:"canvas",id:z||"deckgl-overlay",ref:l,style:$});o.control=q.createElement("div",{id:"".concat(z||"deckgl","-wrapper"),ref:h,style:F},[ne,K])}return _=!1,o.control});pO.defaultProps=B_.defaultProps;const pH=pO,mH="modulepreload",gH=function(t){return"/"+t},uI={},yH=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=gH(o),o in uI)return;uI[o]=!0;const h=o.endsWith(".css"),l=h?'[rel="stylesheet"]':"";if(!!r)for(let E=i.length-1;E>=0;E--){const T=i[E];if(T.href===o&&(!h||T.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const _=document.createElement("link");if(_.rel=h?"stylesheet":mH,h||(_.as="script",_.crossOrigin=""),_.href=o,document.head.appendChild(_),h)return new Promise((E,T)=>{_.addEventListener("load",E),_.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=o,window.dispatchEvent(h),!h.defaultPrevented)throw o})},_H=q.createContext(null);function vH(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,o=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===o}function il(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!il(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!il(t[i],e[i]))return!1;return!0}return!1}function xH(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function hI(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();il(n,r)||e.setProjection(n)}function dI(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function fI(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const bH=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function pI(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const o=e[r.ref];if(o){i=i||Object.assign({},r),delete i.ref;for(const h of bH)h in o&&(i[h]=o[h])}return i||r});return{...t,layers:n}}const mI={version:8,sources:{},layers:[]},gI={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},G1={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},yI={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},wH=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],EH=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class kd{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const o=this.props[yI[i.type]];o?o(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const o=this.props[gI[i.type]];o&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),o(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const o=this.props[G1[i.type]];o&&o(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),o=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||o&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=kd.savedMaps.pop();if(!r)return null;const i=r.map,o=i.getContainer();for(n.className=o.className;o.childNodes.length>0;)n.appendChild(o.childNodes[0]);i._container=n;const h=i._resizeObserver;h&&(h.disconnect(),h.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:l}=e;return l&&(l.bounds?i.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):r._updateViewState(l,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=mI}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||TH()||null,container:e,style:pI(r)},o=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[o.longitude||0,o.latitude||0],zoom:o.zoom||0,pitch:o.pitch||0,bearing:o.bearing||0}),n.gl){const E=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=E,n.gl)}const h=new this._MapClass(i);o.padding&&h.setPadding(o.padding),n.cursor&&(h.getCanvas().style.cursor=n.cursor),this._createShadowTransform(h);const l=h._render;h._render=E=>{this._inRender=!0,l.call(h,E),this._inRender=!1};const m=h._renderTaskQueue.run;h._renderTaskQueue.run=E=>{m.call(h._renderTaskQueue,E),this._onBeforeRepaint()},h.on("render",()=>this._onAfterRepaint());const _=h.fire;h.fire=this._fireEvent.bind(this,_),h.on("resize",()=>{this._renderTransform.resize(h.transform.width,h.transform.height)}),h.on("styledata",()=>{this._updateStyleComponents(this.props,{}),hI(h.transform,this._renderTransform)}),h.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const E in gI)h.on(E,this._onPointerEvent);for(const E in G1)h.on(E,this._onCameraEvent);for(const E in yI)h.on(E,this._onEvent);this._map=h}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),kd.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=xH(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:o,pitch:h,bearing:l}=i,m=r.isMoving();m&&(i.cameraElevationReference="sea");const _=fI(i,{...dI(r.transform),...e});if(m&&(i.cameraElevationReference="ground"),_&&n){const E=this._deferredEvents;E.move=!0,E.zoom||(E.zoom=o!==i.zoom),E.rotate||(E.rotate=l!==i.bearing),E.pitch||(E.pitch=h!==i.pitch)}return m||fI(r.transform,e),_}_updateSettings(e,n){const r=this._map;let i=!1;for(const o of wH)if(o in e&&!il(e[o],n[o])){i=!0;const h=r[`set${o[0].toUpperCase()}${o.slice(1)}`];h==null||h.call(r,e[o])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=mI,styleDiffing:i=!0}=e,o={diff:i};return"localIdeographFontFamily"in e&&(o.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(pI(r),o),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!il(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!il(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!il(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const o=this._map;let h=!1;for(const l of EH){const m=(r=e[l])!==null&&r!==void 0?r:!0,_=(i=n[l])!==null&&i!==void 0?i:!0;il(m,_)||(h=!0,m?o[l].enable(m):o[l].disable())}return h}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const o=e.type,h=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,l=this._queryRenderedFeatures(e.point),m=l.length>0;!m&&h&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=l,m&&!h&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=o}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,o=i.transform,h=typeof n=="string"?n:n.type;return h==="move"&&this._updateViewState(this.props,!1),h in G1&&(typeof n=="object"&&(n.viewState=dI(o)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=o,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{hI(this._renderTransform,n),e.transform=n}}}kd.savedMaps=[];function TH(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const SH=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function PH(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const o=e.project(r);return e.transform=i,o},unproject:r=>{const i=e.transform;e.transform=t.transform;const o=e.unproject(r);return e.transform=i,o},queryTerrainElevation:(r,i)=>{const o=e.transform;e.transform=t.transform;const h=e.queryTerrainElevation(r,i);return e.transform=o,h},queryRenderedFeatures:(r,i)=>{const o=e.transform;e.transform=t.transform;const h=e.queryRenderedFeatures(r,i);return e.transform=o,h}};for(const r of CH(e))!(r in n)&&!SH.includes(r)&&(n[r]=e[r].bind(e));return n}function CH(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const AH=typeof document<"u"?q.useLayoutEffect:q.useEffect,IH=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function MH(t,e){for(const r of IH)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!1)}const V_=q.createContext(null);function kH(t,e,n){const r=q.useContext(_H),[i,o]=q.useState(null),h=q.useRef(),{current:l}=q.useRef({mapLib:null,map:null});q.useEffect(()=>{const E=t.mapLib;let T=!0,A;return Promise.resolve(E||n).then(L=>{if(!T)return;if(!L)throw new Error("Invalid mapLib");const R="Map"in L?L:L.default;if(!R.Map)throw new Error("Invalid mapLib");if(MH(R,t),!R.supported||R.supported(t))t.reuseMaps&&(A=kd.reuse(t,h.current)),A||(A=new kd(R.Map,t,h.current)),l.map=PH(A),l.mapLib=R,o(A),r==null||r.onMapMount(l.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(L=>{const{onError:R}=t;R?R({type:"error",target:null,originalEvent:null,error:L}):console.error(L)}),()=>{T=!1,A&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?A.recycle():A.destroy())}},[]),AH(()=>{i&&i.setProps(t)}),q.useImperativeHandle(e,()=>l.map,[i]);const m=q.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),_={height:"100%"};return q.createElement("div",{id:t.id,ref:h,style:m},i&&q.createElement(V_.Provider,{value:l},q.createElement("div",{"mapboxgl-children":"",style:_},t.children)))}const LH=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function zu(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!LH.test(r)?n[r]=`${i}px`:n[r]=i}}function RH(t,e){const{map:n,mapLib:r}=q.useContext(V_),i=q.useRef({props:t});i.current.props=t;const o=q.useMemo(()=>{let D=!1;q.Children.forEach(t.children,N=>{N&&(D=!0)});const W={...t,element:D?document.createElement("div"):null},z=new r.Marker(W);return z.setLngLat([t.longitude,t.latitude]),z.getElement().addEventListener("click",N=>{var F,$;($=(F=i.current.props).onClick)===null||$===void 0||$.call(F,{type:"click",target:z,originalEvent:N})}),z.on("dragstart",N=>{var F,$;const K=N;K.lngLat=o.getLngLat(),($=(F=i.current.props).onDragStart)===null||$===void 0||$.call(F,K)}),z.on("drag",N=>{var F,$;const K=N;K.lngLat=o.getLngLat(),($=(F=i.current.props).onDrag)===null||$===void 0||$.call(F,K)}),z.on("dragend",N=>{var F,$;const K=N;K.lngLat=o.getLngLat(),($=(F=i.current.props).onDragEnd)===null||$===void 0||$.call(F,K)}),z},[]);q.useEffect(()=>(o.addTo(n.getMap()),()=>{o.remove()}),[]);const{longitude:h,latitude:l,offset:m,style:_,draggable:E=!1,popup:T=null,rotation:A=0,rotationAlignment:L="auto",pitchAlignment:R="auto"}=t;return q.useEffect(()=>{zu(o.getElement(),_)},[_]),q.useImperativeHandle(e,()=>o,[]),(o.getLngLat().lng!==h||o.getLngLat().lat!==l)&&o.setLngLat([h,l]),m&&!vH(o.getOffset(),m)&&o.setOffset(m),o.isDraggable()!==E&&o.setDraggable(E),o.getRotation()!==A&&o.setRotation(A),o.getRotationAlignment()!==L&&o.setRotationAlignment(L),o.getPitchAlignment()!==R&&o.setPitchAlignment(R),o.getPopup()!==T&&o.setPopup(T),jd.createPortal(t.children,o.getElement())}q.memo(q.forwardRef(RH));function _I(t){return new Set(t?t.trim().split(/\s+/):[])}function OH(t,e){const{map:n,mapLib:r}=q.useContext(V_),i=q.useMemo(()=>document.createElement("div"),[]),o=q.useRef({props:t});o.current.props=t;const h=q.useMemo(()=>{const l={...t},m=new r.Popup(l);return m.setLngLat([t.longitude,t.latitude]),m.once("open",_=>{var E,T;(T=(E=o.current.props).onOpen)===null||T===void 0||T.call(E,_)}),m},[]);if(q.useEffect(()=>{const l=m=>{var _,E;(E=(_=o.current.props).onClose)===null||E===void 0||E.call(_,m)};return h.on("close",l),h.setDOMContent(i).addTo(n.getMap()),()=>{h.off("close",l),h.isOpen()&&h.remove()}},[]),q.useEffect(()=>{zu(h.getElement(),t.style)},[t.style]),q.useImperativeHandle(e,()=>h,[]),h.isOpen()&&((h.getLngLat().lng!==t.longitude||h.getLngLat().lat!==t.latitude)&&h.setLngLat([t.longitude,t.latitude]),t.offset&&!il(h.options.offset,t.offset)&&h.setOffset(t.offset),(h.options.anchor!==t.anchor||h.options.maxWidth!==t.maxWidth)&&(h.options.anchor=t.anchor,h.setMaxWidth(t.maxWidth)),h.options.className!==t.className)){const l=_I(h.options.className),m=_I(t.className);for(const _ of l)m.has(_)||h.removeClassName(_);for(const _ of m)l.has(_)||h.addClassName(_);h.options.className=t.className}return jd.createPortal(t.children,i)}q.memo(q.forwardRef(OH));function Gm(t,e,n,r){const i=q.useContext(V_),o=q.useMemo(()=>t(i),[]);return q.useEffect(()=>{const h=r||n||e,l=typeof e=="function"&&typeof n=="function"?e:null,m=typeof n=="function"?n:typeof e=="function"?e:null,{map:_}=i;return _.hasControl(o)||(_.addControl(o,h==null?void 0:h.position),l&&l(i)),()=>{m&&m(i),_.hasControl(o)&&_.removeControl(o)}},[]),o}function zH(t){const e=Gm(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return q.useEffect(()=>{zu(e._container,t.style)},[t.style]),null}q.memo(zH);function DH(t){const e=Gm(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return q.useEffect(()=>{zu(e._controlContainer,t.style)},[t.style]),null}q.memo(DH);function FH(t,e){const n=q.useRef({props:t}),r=Gm(({mapLib:i})=>{const o=new i.GeolocateControl(t),h=o._setupUI;return o._setupUI=l=>{o._container.hasChildNodes()||h(l)},o.on("geolocate",l=>{var m,_;(_=(m=n.current.props).onGeolocate)===null||_===void 0||_.call(m,l)}),o.on("error",l=>{var m,_;(_=(m=n.current.props).onError)===null||_===void 0||_.call(m,l)}),o.on("outofmaxbounds",l=>{var m,_;(_=(m=n.current.props).onOutOfMaxBounds)===null||_===void 0||_.call(m,l)}),o.on("trackuserlocationstart",l=>{var m,_;(_=(m=n.current.props).onTrackUserLocationStart)===null||_===void 0||_.call(m,l)}),o.on("trackuserlocationend",l=>{var m,_;(_=(m=n.current.props).onTrackUserLocationEnd)===null||_===void 0||_.call(m,l)}),o},{position:t.position});return n.current.props=t,q.useImperativeHandle(e,()=>r,[]),q.useEffect(()=>{zu(r._container,t.style)},[t.style]),null}q.memo(q.forwardRef(FH));function NH(t){const e=Gm(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return q.useEffect(()=>{zu(e._container,t.style)},[t.style]),null}q.memo(NH);function BH(t){const e=Gm(({mapLib:o})=>new o.ScaleControl(t),{position:t.position}),n=q.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),q.useEffect(()=>{zu(e._container,i)},[i]),null}q.memo(BH);const UH=yH(()=>import("./mapbox-gl-b94eea6b.js").then(t=>t.m),[]),VH=(()=>q.forwardRef(function(e,n){return kH(e,n,UH)}))();var mO={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(HF,function(){var n,r,i;function o(l,m){if(!n)n=m;else if(!r)r=m;else{var _="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",E={};n(E),i=m(E),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([_],{type:"text/javascript"})))}}o(["exports"],function(l){function m(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var _=E;function E(c,s){this.x=c,this.y=s}E.prototype={clone:function(){return new E(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,s){return this.clone()._rotateAround(c,s)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var s=c.x-this.x,u=c.y-this.y;return s*s+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,s){return Math.atan2(this.x*s-this.y*c,this.x*c+this.y*s)},_matMult:function(c){var s=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=s,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var s=Math.cos(c),u=Math.sin(c),f=u*this.x+s*this.y;return this.x=s*this.x-u*this.y,this.y=f,this},_rotateAround:function(c,s){var u=Math.cos(c),f=Math.sin(c),g=s.y+f*(this.x-s.x)+u*(this.y-s.y);return this.x=s.x+u*(this.x-s.x)-f*(this.y-s.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},E.convert=function(c){return c instanceof E?c:Array.isArray(c)?new E(c[0],c[1]):c};var T=m(_),A=L;function L(c,s,u,f){this.cx=3*c,this.bx=3*(u-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(f-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=s,this.p2x=u,this.p2y=f}L.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,s){if(s===void 0&&(s=1e-6),c<0)return 0;if(c>1)return 1;for(var u=c,f=0;f<8;f++){var g=this.sampleCurveX(u)-c;if(Math.abs(g)<s)return u;var x=this.sampleCurveDerivativeX(u);if(Math.abs(x)<1e-6)break;u-=g/x}var w=0,S=1;for(u=c,f=0;f<20&&(g=this.sampleCurveX(u),!(Math.abs(g-c)<s));f++)c>g?w=u:S=u,u=.5*(S-w)+w;return u},solve:function(c,s){return this.sampleCurveY(this.solveCurveX(c,s))}};var R=m(A);let D,W;function z(){return D==null&&(D=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),D}function N(){if(W==null&&(W=!1,z())){const s=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(s){for(let f=0;f<5*5;f++){const g=4*f;s.fillStyle=`rgb(${g},${g+1},${g+2})`,s.fillRect(f%5,Math.floor(f/5),1,1)}const u=s.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&u[f]!==f){W=!0;break}}}return W||!1}function F(c,s,u,f){const g=new R(c,s,u,f);return function(x){return g.solve(x)}}const $=F(.25,.1,.25,1);function K(c,s,u){return Math.min(u,Math.max(s,c))}function ne(c,s,u){const f=u-s,g=((c-s)%f+f)%f+s;return g===s?u:g}function re(c,...s){for(const u of s)for(const f in u)c[f]=u[f];return c}let be=1;function xe(c,s,u){const f={};for(const g in c)f[g]=s.call(u||this,c[g],g,c);return f}function fe(c,s,u){const f={};for(const g in c)s.call(u||this,c[g],g,c)&&(f[g]=c[g]);return f}function Re(c){return Array.isArray(c)?c.map(Re):typeof c=="object"&&c?xe(c,Re):c}const Ve={};function Fe(c){Ve[c]||(typeof console<"u"&&console.warn(c),Ve[c]=!0)}function ze(c,s,u){return(u.y-c.y)*(s.x-c.x)>(s.y-c.y)*(u.x-c.x)}function Ye(c){let s=0;for(let u,f,g=0,x=c.length,w=x-1;g<x;w=g++)u=c[g],f=c[w],s+=(f.x-u.x)*(u.y+f.y);return s}function je(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let tt=null;function ke(c){if(tt==null){const s=c.navigator?c.navigator.userAgent:null;tt=!!c.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return tt}function Ge(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const nt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";async function Dt(c,s,u,f,g){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(c,{timestamp:0});try{const w=x==null?void 0:x.format;if(!w||!w.startsWith("BGR")&&!w.startsWith("RGB"))throw new Error(`Unrecognized format ${w}`);const S=w.startsWith("BGR"),I=new Uint8ClampedArray(f*g*4);if(await x.copyTo(I,function(k,B,j,H,Y){const ee=4*Math.max(-B,0),le=(Math.max(0,j)-j)*H*4+ee,me=4*H,_e=Math.max(0,B),Me=Math.max(0,j);return{rect:{x:_e,y:Me,width:Math.min(k.width,B+H)-_e,height:Math.min(k.height,j+Y)-Me},layout:[{offset:le,stride:me}]}}(c,s,u,f,g)),S)for(let k=0;k<I.length;k+=4){const B=I[k];I[k]=I[k+2],I[k+2]=B}return I}finally{x.close()}}let ht,ot,ct,xt;const bt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(c){const s=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(c,s=0){return this.getImageCanvasContext(c).getImageData(-s,-s,c.width+2*s,c.height+2*s)},getImageCanvasContext(c){const s=window.document.createElement("canvas"),u=s.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return s.width=c.width,s.height=c.height,u.drawImage(c,0,0,c.width,c.height),u},resolveURL:c=>(ct||(ct=document.createElement("a")),ct.href=c,ct.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(xt==null&&(xt=matchMedia("(prefers-reduced-motion: reduce)")),xt.matches)}},Jt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Je extends Error{constructor(s,u,f,g){super(`AJAXError: ${u} (${s}): ${f}`),this.status=s,this.statusText=u,this.url=f,this.body=g}}const Et=je()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,sn=c=>Jt.REGISTERED_PROTOCOLS[c.substring(0,c.indexOf("://"))];function Qt(c,s){const u=new AbortController,f=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:Et(),signal:u.signal});let g=!1,x=!1;return c.type==="json"&&f.headers.set("Accept","application/json"),x||fetch(f).then(w=>w.ok?(S=>{(c.type==="arrayBuffer"||c.type==="image"?S.arrayBuffer():c.type==="json"?S.json():S.text()).then(I=>{x||(g=!0,s(null,I,S.headers.get("Cache-Control"),S.headers.get("Expires")))}).catch(I=>{x||s(new Error(I.message))})})(w):w.blob().then(S=>s(new Je(w.status,w.statusText,c.url,S)))).catch(w=>{w.code!==20&&s(new Error(w.message))}),{cancel:()=>{x=!0,g||u.abort()}}}const hn=function(c,s){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){if(je()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,s);if(!je())return(sn(c.url)||Qt)(c,s)}if(!(/^file:/.test(u=c.url)||/^file:/.test(Et())&&!/^\w+:/.test(u))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Qt(c,s);if(je()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,s,void 0,!0)}var u;return function(f,g){const x=new XMLHttpRequest;x.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(x.responseType="arraybuffer");for(const w in f.headers)x.setRequestHeader(w,f.headers[w]);return f.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=f.credentials==="include",x.onerror=()=>{g(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let w=x.response;if(f.type==="json")try{w=JSON.parse(x.response)}catch(S){return g(S)}g(null,w,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else{const w=new Blob([x.response],{type:x.getResponseHeader("Content-Type")});g(new Je(x.status,x.statusText,f.url,w))}},x.send(f.body),{cancel:()=>x.abort()}}(c,s)},$t=function(c,s){return hn(re(c,{type:"arrayBuffer"}),s)};function Lt(c){if(!c||c.indexOf("://")<=0||c.indexOf("data:image/")===0||c.indexOf("blob:")===0)return!0;const s=new URL(c),u=window.location;return s.protocol===u.protocol&&s.host===u.host}function Ft(c,s,u){u[c]&&u[c].indexOf(s)!==-1||(u[c]=u[c]||[],u[c].push(s))}function wn(c,s,u){if(u&&u[c]){const f=u[c].indexOf(s);f!==-1&&u[c].splice(f,1)}}class vn{constructor(s,u={}){re(this,u),this.type=s}}class pt extends vn{constructor(s,u={}){super("error",re({error:s},u))}}class dn{on(s,u){return this._listeners=this._listeners||{},Ft(s,u,this._listeners),this}off(s,u){return wn(s,u,this._listeners),wn(s,u,this._oneTimeListeners),this}once(s,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},Ft(s,u,this._oneTimeListeners),this):new Promise(f=>this.once(s,f))}fire(s,u){typeof s=="string"&&(s=new vn(s,u||{}));const f=s.type;if(this.listens(f)){s.target=this;const g=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const S of g)S.call(this,s);const x=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const S of x)wn(f,S,this._oneTimeListeners),S.call(this,s);const w=this._eventedParent;w&&(re(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(s))}else s instanceof pt&&console.error(s.error);return this}listens(s){return this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s)}setEventedParent(s,u){return this._eventedParent=s,this._eventedParentData=u,this}}var Ae={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ct=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function En(c,s){const u={};for(const f in c)f!=="ref"&&(u[f]=c[f]);return Ct.forEach(f=>{f in s&&(u[f]=s[f])}),u}function en(c,s){if(Array.isArray(c)){if(!Array.isArray(s)||c.length!==s.length)return!1;for(let u=0;u<c.length;u++)if(!en(c[u],s[u]))return!1;return!0}if(typeof c=="object"&&c!==null&&s!==null){if(typeof s!="object"||Object.keys(c).length!==Object.keys(s).length)return!1;for(const u in c)if(!en(c[u],s[u]))return!1;return!0}return c===s}const It={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Qe(c,s,u){u.push({command:It.addSource,args:[c,s[c]]})}function gt(c,s,u){s.push({command:It.removeSource,args:[c]}),u[c]=!0}function Mt(c,s,u,f){gt(c,u,f),Qe(c,s,u)}function Rt(c,s,u){let f;for(f in c[u])if(Object.prototype.hasOwnProperty.call(c[u],f)&&f!=="data"&&!en(c[u][f],s[u][f]))return!1;for(f in s[u])if(Object.prototype.hasOwnProperty.call(s[u],f)&&f!=="data"&&!en(c[u][f],s[u][f]))return!1;return!0}function Pt(c,s,u,f,g,x){let w;for(w in s=s||{},c=c||{})Object.prototype.hasOwnProperty.call(c,w)&&(en(c[w],s[w])||u.push({command:x,args:[f,w,s[w],g]}));for(w in s)Object.prototype.hasOwnProperty.call(s,w)&&!Object.prototype.hasOwnProperty.call(c,w)&&(en(c[w],s[w])||u.push({command:x,args:[f,w,s[w],g]}))}function gn(c){return c.id}function mn(c,s){return c[s.id]=s,c}class He{constructor(s,u,f,g){this.message=(s?`${s}: `:"")+f,g&&(this.identifier=g),u!=null&&u.__line__&&(this.line=u.__line__)}}function mt(c,...s){for(const u of s)for(const f in u)c[f]=u[f];return c}class Zt extends Error{constructor(s,u){super(u),this.message=u,this.key=s}}class Ln{constructor(s,u=[]){this.parent=s,this.bindings={};for(const[f,g]of u)this.bindings[f]=g}concat(s){return new Ln(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const Fn={kind:"null"},it={kind:"number"},fn={kind:"string"},ln={kind:"boolean"},Cr={kind:"color"},li={kind:"object"},cn={kind:"value"},Kr={kind:"collator"},xi={kind:"formatted"},de={kind:"padding"},G={kind:"resolvedImage"},Z={kind:"variableAnchorOffsetCollection"};function se(c,s){return{kind:"array",itemType:c,N:s}}function ue(c){if(c.kind==="array"){const s=ue(c.itemType);return typeof c.N=="number"?`array<${s}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${s}>`}return c.kind}const ve=[Fn,it,fn,ln,Cr,xi,li,se(cn),de,G,Z];function Se(c,s){if(s.kind==="error")return null;if(c.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!Se(c.itemType,s.itemType))&&(typeof c.N!="number"||c.N===s.N))return null}else{if(c.kind===s.kind)return null;if(c.kind==="value"){for(const u of ve)if(!Se(u,s))return null}}return`Expected ${ue(c)} but found ${ue(s)} instead.`}function Te(c,s){return s.some(u=>u.kind===c.kind)}function ye(c,s){return s.some(u=>u==="null"?c===null:u==="array"?Array.isArray(c):u==="object"?c&&!Array.isArray(c)&&typeof c=="object":u===typeof c)}function Ce(c,s){return c.kind==="array"&&s.kind==="array"?c.itemType.kind===s.itemType.kind&&typeof c.N=="number":c.kind===s.kind}const $e=.96422,We=.82521,qe=4/29,At=6/29,nn=3*At*At,Ot=At*At*At,dt=Math.PI/180,Nt=180/Math.PI;function xn(c){return(c%=360)<0&&(c+=360),c}function bn([c,s,u,f]){let g,x;const w=yn((.2225045*(c=pn(c))+.7168786*(s=pn(s))+.0606169*(u=pn(u)))/1);c===s&&s===u?g=x=w:(g=yn((.4360747*c+.3850649*s+.1430804*u)/$e),x=yn((.0139322*c+.0971045*s+.7141733*u)/We));const S=116*w-16;return[S<0?0:S,500*(g-w),200*(w-x),f]}function pn(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function yn(c){return c>Ot?Math.pow(c,1/3):c/nn+qe}function Ar([c,s,u,f]){let g=(c+16)/116,x=isNaN(s)?g:g+s/500,w=isNaN(u)?g:g-u/200;return g=1*zn(g),x=$e*zn(x),w=We*zn(w),[Ut(3.1338561*x-1.6168667*g-.4906146*w),Ut(-.9787684*x+1.9161415*g+.033454*w),Ut(.0719453*x-.2289914*g+1.4052427*w),f]}function Ut(c){return(c=c<=.00304?12.92*c:1.055*Math.pow(c,1/2.4)-.055)<0?0:c>1?1:c}function zn(c){return c>At?c*c*c:nn*(c-qe)}function xr(c){return parseInt(c.padEnd(2,c),16)/255}function Vs(c,s){return Jr(s?c/100:c,0,1)}function Jr(c,s,u){return Math.min(Math.max(s,c),u)}function ls(c){return!c.some(Number.isNaN)}const po={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Cn{constructor(s,u,f,g=1,x=!0){this.r=s,this.g=u,this.b=f,this.a=g,x||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[s,u,f,g]))}static parse(s){if(s instanceof Cn)return s;if(typeof s!="string")return;const u=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=po[f];if(g){const[w,S,I]=g;return[w/255,S/255,I/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const w=f.length<6?1:2;let S=1;return[xr(f.slice(S,S+=w)),xr(f.slice(S,S+=w)),xr(f.slice(S,S+=w)),xr(f.slice(S,S+w)||"ff")]}if(f.startsWith("rgb")){const w=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[S,I,k,B,j,H,Y,ee,le,me,_e,Me]=w,Ee=[B||" ",Y||" ",me].join("");if(Ee==="  "||Ee==="  /"||Ee===",,"||Ee===",,,"){const Le=[k,H,le].join(""),De=Le==="%%%"?100:Le===""?255:0;if(De){const Xe=[Jr(+I/De,0,1),Jr(+j/De,0,1),Jr(+ee/De,0,1),_e?Vs(+_e,Me):1];if(ls(Xe))return Xe}}return}}const x=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,S,I,k,B,j,H,Y,ee]=x,le=[I||" ",B||" ",H].join("");if(le==="  "||le==="  /"||le===",,"||le===",,,"){const me=[+S,Jr(+k,0,100),Jr(+j,0,100),Y?Vs(+Y,ee):1];if(ls(me))return function([_e,Me,Ee,Le]){function De(Xe){const St=(Xe+_e/30)%12,jt=Me*Math.min(Ee,1-Ee);return Ee-jt*Math.max(-1,Math.min(St-3,9-St,1))}return _e=xn(_e),Me/=100,Ee/=100,[De(0),De(8),De(4),Le]}(me)}}}(s);return u?new Cn(...u,!1):void 0}get rgb(){const{r:s,g:u,b:f,a:g}=this,x=g||1/0;return this.overwriteGetter("rgb",[s/x,u/x,f/x,g])}get hcl(){return this.overwriteGetter("hcl",function(s){const[u,f,g,x]=bn(s),w=Math.sqrt(f*f+g*g);return[Math.round(1e4*w)?xn(Math.atan2(g,f)*Nt):NaN,w,u,x]}(this.rgb))}get lab(){return this.overwriteGetter("lab",bn(this.rgb))}overwriteGetter(s,u){return Object.defineProperty(this,s,{value:u}),u}toString(){const[s,u,f,g]=this.rgb;return`rgba(${[s,u,f].map(x=>Math.round(255*x)).join(",")},${g})`}}Cn.black=new Cn(0,0,0,1),Cn.white=new Cn(1,1,1,1),Cn.transparent=new Cn(0,0,0,0),Cn.red=new Cn(1,0,0,1);class No{constructor(s,u,f){this.sensitivity=s?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,u){return this.collator.compare(s,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ki{constructor(s,u,f,g,x){this.text=s,this.image=u,this.scale=f,this.fontStack=g,this.textColor=x}}class ir{constructor(s){this.sections=s}static fromString(s){return new ir([new ki(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof ir?s:ir.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}}class bi{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof bi)return s;if(typeof s=="number")return new bi([s,s,s,s]);if(Array.isArray(s)&&!(s.length<1||s.length>4)){for(const u of s)if(typeof u!="number")return;switch(s.length){case 1:s=[s[0],s[0],s[0],s[0]];break;case 2:s=[s[0],s[1],s[0],s[1]];break;case 3:s=[s[0],s[1],s[2],s[1]]}return new bi(s)}}toString(){return JSON.stringify(this.values)}}const Fu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class hi{constructor(s){this.values=s.slice()}static parse(s){if(s instanceof hi)return s;if(Array.isArray(s)&&!(s.length<1)&&s.length%2==0){for(let u=0;u<s.length;u+=2){const f=s[u],g=s[u+1];if(typeof f!="string"||!Fu.has(f)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new hi(s)}}toString(){return JSON.stringify(this.values)}}class Zn{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new Zn({name:s,available:!1}):null}}function Bo(c,s,u,f){return typeof c=="number"&&c>=0&&c<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[c,s,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[c,s,u,f]:[c,s,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function mo(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Cn||c instanceof No||c instanceof ir||c instanceof bi||c instanceof hi||c instanceof Zn)return!0;if(Array.isArray(c)){for(const s of c)if(!mo(s))return!1;return!0}if(typeof c=="object"){for(const s in c)if(!mo(c[s]))return!1;return!0}return!1}function Jn(c){if(c===null)return Fn;if(typeof c=="string")return fn;if(typeof c=="boolean")return ln;if(typeof c=="number")return it;if(c instanceof Cn)return Cr;if(c instanceof No)return Kr;if(c instanceof ir)return xi;if(c instanceof bi)return de;if(c instanceof hi)return Z;if(c instanceof Zn)return G;if(Array.isArray(c)){const s=c.length;let u;for(const f of c){const g=Jn(f);if(u){if(u===g)continue;u=cn;break}u=g}return se(u||cn,s)}return li}function Dn(c){const s=typeof c;return c===null?"":s==="string"||s==="number"||s==="boolean"?String(c):c instanceof Cn||c instanceof ir||c instanceof bi||c instanceof hi||c instanceof Zn?c.toString():JSON.stringify(c)}class js{constructor(s,u){this.type=s,this.value=u}static parse(s,u){if(s.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!mo(s[1]))return u.error("invalid value");const f=s[1];let g=Jn(f);const x=u.expectedType;return g.kind!=="array"||g.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(g=x),new js(g,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Qn{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const Gi={string:fn,number:it,boolean:ln,object:li};class Wi{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");let f,g=1;const x=s[0];if(x==="array"){let S,I;if(s.length>2){const k=s[1];if(typeof k!="string"||!(k in Gi)||k==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);S=Gi[k],g++}else S=cn;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return u.error('The length argument to "array" must be a positive integer literal',2);I=s[2],g++}f=se(S,I)}else{if(!Gi[x])throw new Error(`Types doesn't contain name = ${x}`);f=Gi[x]}const w=[];for(;g<s.length;g++){const S=u.parse(s[g],g,cn);if(!S)return null;w.push(S)}return new Wi(f,w)}evaluate(s){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(s);if(!Se(this.type,Jn(f)))return f;if(u===this.args.length-1)throw new Qn(`Expected value to be of type ${ue(this.type)}, but found ${ue(Jn(f))} instead.`)}throw new Error}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const El={"to-boolean":ln,"to-color":Cr,"to-number":it,"to-string":fn};class Ps{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const f=s[0];if(!El[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&s.length!==2)return u.error("Expected one argument.");const g=El[f],x=[];for(let w=1;w<s.length;w++){const S=u.parse(s[w],w,cn);if(!S)return null;x.push(S)}return new Ps(g,x)}evaluate(s){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(s);case"color":{let u,f;for(const g of this.args){if(u=g.evaluate(s),f=null,u instanceof Cn)return u;if(typeof u=="string"){const x=s.parseColor(u);if(x)return x}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:Bo(u[0],u[1],u[2],u[3]),!f))return new Cn(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new Qn(f||`Could not parse color from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"padding":{let u;for(const f of this.args){u=f.evaluate(s);const g=bi.parse(u);if(g)return g}throw new Qn(`Could not parse padding from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"variableAnchorOffsetCollection":{let u;for(const f of this.args){u=f.evaluate(s);const g=hi.parse(u);if(g)return g}throw new Qn(`Could not parse variableAnchorOffsetCollection from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"number":{let u=null;for(const f of this.args){if(u=f.evaluate(s),u===null)return 0;const g=Number(u);if(!isNaN(g))return g}throw new Qn(`Could not convert ${JSON.stringify(u)} to number.`)}case"formatted":return ir.fromString(Dn(this.args[0].evaluate(s)));case"resolvedImage":return Zn.fromString(Dn(this.args[0].evaluate(s)));default:return Dn(this.args[0].evaluate(s))}}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}const Ic=["Unknown","Point","LineString","Polygon"];class Mc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ic[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(s){let u=this._parseColorCache[s];return u||(u=this._parseColorCache[s]=Cn.parse(s)),u}}class Tl{constructor(s,u,f=[],g,x=new Ln,w=[]){this.registry=s,this.path=f,this.key=f.map(S=>`[${S}]`).join(""),this.scope=x,this.errors=w,this.expectedType=g,this._isConstant=u}parse(s,u,f,g,x={}){return u?this.concat(u,f,g)._parse(s,x):this._parse(s,x)}_parse(s,u){function f(g,x,w){return w==="assert"?new Wi(x,[g]):w==="coerce"?new Ps(x,[g]):g}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=s[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[g];if(x){let w=x.parse(s,this);if(!w)return null;if(this.expectedType){const S=this.expectedType,I=w.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||I.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string")if(S.kind!=="padding"||I.kind!=="value"&&I.kind!=="number"&&I.kind!=="array")if(S.kind!=="variableAnchorOffsetCollection"||I.kind!=="value"&&I.kind!=="array"){if(this.checkSubtype(S,I))return null}else w=f(w,S,u.typeAnnotation||"coerce");else w=f(w,S,u.typeAnnotation||"coerce");else w=f(w,S,u.typeAnnotation||"coerce");else w=f(w,S,u.typeAnnotation||"assert")}if(!(w instanceof js)&&w.type.kind!=="resolvedImage"&&this._isConstant(w)){const S=new Mc;try{w=new js(w.type,w.evaluate(S))}catch(I){return this.error(I.message),null}}return w}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,u,f){const g=typeof s=="number"?this.path.concat(s):this.path,x=f?this.scope.concat(f):this.scope;return new Tl(this.registry,this._isConstant,g,u||null,x,this.errors)}error(s,...u){const f=`${this.key}${u.map(g=>`[${g}]`).join("")}`;this.errors.push(new Zt(f,s))}checkSubtype(s,u){const f=Se(s,u);return f&&this.error(f),f}}class te{constructor(s,u,f){this.type=Kr,this.locale=f,this.caseSensitive=s,this.diacriticSensitive=u}static parse(s,u){if(s.length!==2)return u.error("Expected one argument.");const f=s[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const g=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,ln);if(!g)return null;const x=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,ln);if(!x)return null;let w=null;return f.locale&&(w=u.parse(f.locale,1,fn),!w)?null:new te(g,x,w)}evaluate(s){return new No(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}}const oe=8192;function we(c,s){c[0]=Math.min(c[0],s[0]),c[1]=Math.min(c[1],s[1]),c[2]=Math.max(c[2],s[0]),c[3]=Math.max(c[3],s[1])}function Be(c,s){return!(c[0]<=s[0]||c[2]>=s[2]||c[1]<=s[1]||c[3]>=s[3])}function st(c,s){const u=(180+c[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,s.z);return[Math.round(u*g*oe),Math.round(f*g*oe)]}function Bt(c,s,u){const f=c[0]-s[0],g=c[1]-s[1],x=c[0]-u[0],w=c[1]-u[1];return f*w-x*g==0&&f*x<=0&&g*w<=0}function Sn(c,s){let u=!1;for(let w=0,S=s.length;w<S;w++){const I=s[w];for(let k=0,B=I.length;k<B-1;k++){if(Bt(c,I[k],I[k+1]))return!1;(g=I[k])[1]>(f=c)[1]!=(x=I[k+1])[1]>f[1]&&f[0]<(x[0]-g[0])*(f[1]-g[1])/(x[1]-g[1])+g[0]&&(u=!u)}}var f,g,x;return u}function Ir(c,s){for(let u=0;u<s.length;u++)if(Sn(c,s[u]))return!0;return!1}function jr(c,s,u,f){const g=f[0]-u[0],x=f[1]-u[1],w=(c[0]-u[0])*x-g*(c[1]-u[1]),S=(s[0]-u[0])*x-g*(s[1]-u[1]);return w>0&&S<0||w<0&&S>0}function di(c,s,u){for(const k of u)for(let B=0;B<k.length-1;++B)if((S=[(w=k[B+1])[0]-(x=k[B])[0],w[1]-x[1]])[0]*(I=[(g=s)[0]-(f=c)[0],g[1]-f[1]])[1]-S[1]*I[0]!=0&&jr(f,g,x,w)&&jr(x,w,f,g))return!0;var f,g,x,w,S,I;return!1}function cs(c,s){for(let u=0;u<c.length;++u)if(!Sn(c[u],s))return!1;for(let u=0;u<c.length-1;++u)if(di(c[u],c[u+1],s))return!1;return!0}function Jm(c,s){for(let u=0;u<s.length;u++)if(cs(c,s[u]))return!0;return!1}function Nu(c,s,u){const f=[];for(let g=0;g<c.length;g++){const x=[];for(let w=0;w<c[g].length;w++){const S=st(c[g][w],u);we(s,S),x.push(S)}f.push(x)}return f}function Qm(c,s,u){const f=[];for(let g=0;g<c.length;g++){const x=Nu(c[g],s,u);f.push(x)}return f}function eg(c,s,u,f){if(c[0]<u[0]||c[0]>u[2]){const g=.5*f;let x=c[0]-u[0]>g?-f:u[0]-c[0]>g?f:0;x===0&&(x=c[0]-u[2]>g?-f:u[2]-c[0]>g?f:0),c[0]+=x}we(s,c)}function Hd(c,s,u,f){const g=Math.pow(2,f.z)*oe,x=[f.x*oe,f.y*oe],w=[];for(const S of c)for(const I of S){const k=[I.x+x[0],I.y+x[1]];eg(k,s,u,g),w.push(k)}return w}function qd(c,s,u,f){const g=Math.pow(2,f.z)*oe,x=[f.x*oe,f.y*oe],w=[];for(const I of c){const k=[];for(const B of I){const j=[B.x+x[0],B.y+x[1]];we(s,j),k.push(j)}w.push(k)}if(s[2]-s[0]<=g/2){(S=s)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const I of w)for(const k of I)eg(k,s,u,g)}var S;return w}class Na{constructor(s,u){this.type=ln,this.geojson=s,this.geometries=u}static parse(s,u){if(s.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(mo(s[1])){const f=s[1];if(f.type==="FeatureCollection")for(let g=0;g<f.features.length;++g){const x=f.features[g].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new Na(f,f.features[g].geometry)}else if(f.type==="Feature"){const g=f.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Na(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Na(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(f.type==="Polygon"){const S=Nu(f.coordinates,x,w),I=Hd(u.geometry(),g,x,w);if(!Be(g,x))return!1;for(const k of I)if(!Sn(k,S))return!1}if(f.type==="MultiPolygon"){const S=Qm(f.coordinates,x,w),I=Hd(u.geometry(),g,x,w);if(!Be(g,x))return!1;for(const k of I)if(!Ir(k,S))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(f.type==="Polygon"){const S=Nu(f.coordinates,x,w),I=qd(u.geometry(),g,x,w);if(!Be(g,x))return!1;for(const k of I)if(!cs(k,S))return!1}if(f.type==="MultiPolygon"){const S=Qm(f.coordinates,x,w),I=qd(u.geometry(),g,x,w);if(!Be(g,x))return!1;for(const k of I)if(!Jm(k,S))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Bu{constructor(s,u){this.type=u.type,this.name=s,this.boundExpression=u}static parse(s,u){if(s.length!==2||typeof s[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=s[1];return u.scope.has(f)?new Bu(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}}class Cs{constructor(s,u,f,g){this.name=s,this.type=u,this._evaluate=f,this.args=g}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}static parse(s,u){const f=s[0],g=Cs.definitions[f];if(!g)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(g)?g[0]:g.type,w=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,S=w.filter(([k])=>!Array.isArray(k)||k.length===s.length-1);let I=null;for(const[k,B]of S){I=new Tl(u.registry,Uu,u.path,null,u.scope);const j=[];let H=!1;for(let Y=1;Y<s.length;Y++){const ee=s[Y],le=Array.isArray(k)?k[Y-1]:k.type,me=I.parse(ee,1+j.length,le);if(!me){H=!0;break}j.push(me)}if(!H)if(Array.isArray(k)&&k.length!==j.length)I.error(`Expected ${k.length} arguments, but found ${j.length} instead.`);else{for(let Y=0;Y<j.length;Y++){const ee=Array.isArray(k)?k[Y]:k.type,le=j[Y];I.concat(Y+1).checkSubtype(ee,le.type)}if(I.errors.length===0)return new Cs(f,x,B,j)}}if(S.length===1)u.errors.push(...I.errors);else{const k=(S.length?S:w).map(([j])=>{return H=j,Array.isArray(H)?`(${H.map(ue).join(", ")})`:`(${ue(H.type)}...)`;var H}).join(" | "),B=[];for(let j=1;j<s.length;j++){const H=u.parse(s[j],1+B.length);if(!H)return null;B.push(ue(H.type))}u.error(`Expected arguments of type ${k}, but found (${B.join(", ")}) instead.`)}return null}static register(s,u){Cs.definitions=u;for(const f in u)s[f]=Cs}}function Uu(c){if(c instanceof Bu)return Uu(c.boundExpression);if(c instanceof Cs&&c.name==="error"||c instanceof te||c instanceof Na)return!1;const s=c instanceof Ps||c instanceof Wi;let u=!0;return c.eachChild(f=>{u=s?u&&Uu(f):u&&f instanceof js}),!!u&&Vu(c)&&ju(c,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Vu(c){if(c instanceof Cs&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Na)return!1;let s=!0;return c.eachChild(u=>{s&&!Vu(u)&&(s=!1)}),s}function kc(c){if(c instanceof Cs&&c.name==="feature-state")return!1;let s=!0;return c.eachChild(u=>{s&&!kc(u)&&(s=!1)}),s}function ju(c,s){if(c instanceof Cs&&s.indexOf(c.name)>=0)return!1;let u=!0;return c.eachChild(f=>{u&&!ju(f,s)&&(u=!1)}),u}function Sl(c,s){const u=c.length-1;let f,g,x=0,w=u,S=0;for(;x<=w;)if(S=Math.floor((x+w)/2),f=c[S],g=c[S+1],f<=s){if(S===u||s<g)return S;x=S+1}else{if(!(f>s))throw new Qn("Input is not a number.");w=S-1}return 0}class ha{constructor(s,u,f){this.type=s,this.input=u,this.labels=[],this.outputs=[];for(const[g,x]of f)this.labels.push(g),this.outputs.push(x)}static parse(s,u){if(s.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(s[1],1,it);if(!f)return null;const g=[];let x=null;u.expectedType&&u.expectedType.kind!=="value"&&(x=u.expectedType);for(let w=1;w<s.length;w+=2){const S=w===1?-1/0:s[w],I=s[w+1],k=w,B=w+1;if(typeof S!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(g.length&&g[g.length-1][0]>=S)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const j=u.parse(I,B,x);if(!j)return null;x=x||j.type,g.push([S,j])}return new ha(x,f,g)}evaluate(s){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(s);const g=this.input.evaluate(s);if(g<=u[0])return f[0].evaluate(s);const x=u.length;return g>=u[x-1]?f[x-1].evaluate(s):f[Sl(u,g)].evaluate(s)}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Rn(c,s,u){return c+u*(s-c)}function $u(c,s,u){return c.map((f,g)=>Rn(f,s[g],u))}const us={number:Rn,color:function(c,s,u,f="rgb"){switch(f){case"rgb":{const[g,x,w,S]=$u(c.rgb,s.rgb,u);return new Cn(g,x,w,S,!1)}case"hcl":{const[g,x,w,S]=c.hcl,[I,k,B,j]=s.hcl;let H,Y;if(isNaN(g)||isNaN(I))isNaN(g)?isNaN(I)?H=NaN:(H=I,w!==1&&w!==0||(Y=k)):(H=g,B!==1&&B!==0||(Y=x));else{let Me=I-g;I>g&&Me>180?Me-=360:I<g&&g-I>180&&(Me+=360),H=g+u*Me}const[ee,le,me,_e]=function([Me,Ee,Le,De]){return Me=isNaN(Me)?0:Me*dt,Ar([Le,Math.cos(Me)*Ee,Math.sin(Me)*Ee,De])}([H,Y??Rn(x,k,u),Rn(w,B,u),Rn(S,j,u)]);return new Cn(ee,le,me,_e,!1)}case"lab":{const[g,x,w,S]=Ar($u(c.lab,s.lab,u));return new Cn(g,x,w,S,!1)}}},array:$u,padding:function(c,s,u){return new bi($u(c.values,s.values,u))},variableAnchorOffsetCollection:function(c,s,u){const f=c.values,g=s.values;if(f.length!==g.length)throw new Qn(`Cannot interpolate values of different length. from: ${c.toString()}, to: ${s.toString()}`);const x=[];for(let w=0;w<f.length;w+=2){if(f[w]!==g[w])throw new Qn(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${f[w]}, to[${w}]: ${g[w]}`);x.push(f[w]);const[S,I]=f[w+1],[k,B]=g[w+1];x.push([Rn(S,k,u),Rn(I,B,u)])}return new hi(x)}};class hs{constructor(s,u,f,g,x){this.type=s,this.operator=u,this.interpolation=f,this.input=g,this.labels=[],this.outputs=[];for(const[w,S]of x)this.labels.push(w),this.outputs.push(S)}static interpolationFactor(s,u,f,g){let x=0;if(s.name==="exponential")x=Zd(u,s.base,f,g);else if(s.name==="linear")x=Zd(u,1,f,g);else if(s.name==="cubic-bezier"){const w=s.controlPoints;x=new R(w[0],w[1],w[2],w[3]).solve(Zd(u,1,f,g))}return x}static parse(s,u){let[f,g,x,...w]=s;if(!Array.isArray(g)||g.length===0)return u.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const k=g[1];if(typeof k!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:k}}else{if(g[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const k=g.slice(1);if(k.length!==4||k.some(B=>typeof B!="number"||B<0||B>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:k}}}if(s.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(x=u.parse(x,2,it),!x)return null;const S=[];let I=null;f==="interpolate-hcl"||f==="interpolate-lab"?I=Cr:u.expectedType&&u.expectedType.kind!=="value"&&(I=u.expectedType);for(let k=0;k<w.length;k+=2){const B=w[k],j=w[k+1],H=k+3,Y=k+4;if(typeof B!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(S.length&&S[S.length-1][0]>=B)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',H);const ee=u.parse(j,Y,I);if(!ee)return null;I=I||ee.type,S.push([B,ee])}return Ce(I,it)||Ce(I,Cr)||Ce(I,de)||Ce(I,Z)||Ce(I,se(it))?new hs(I,f,g,x,S):u.error(`Type ${ue(I)} is not interpolatable.`)}evaluate(s){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(s);const g=this.input.evaluate(s);if(g<=u[0])return f[0].evaluate(s);const x=u.length;if(g>=u[x-1])return f[x-1].evaluate(s);const w=Sl(u,g),S=hs.interpolationFactor(this.interpolation,g,u[w],u[w+1]),I=f[w].evaluate(s),k=f[w+1].evaluate(s);switch(this.operator){case"interpolate":return us[this.type.kind](I,k,S);case"interpolate-hcl":return us.color(I,k,S,"hcl");case"interpolate-lab":return us.color(I,k,S,"lab")}}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}}function Zd(c,s,u,f){const g=f-u,x=c-u;return g===0?0:s===1?x/g:(Math.pow(s,x)-1)/(Math.pow(s,g)-1)}class Gu{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expectected at least one argument.");let f=null;const g=u.expectedType;g&&g.kind!=="value"&&(f=g);const x=[];for(const S of s.slice(1)){const I=u.parse(S,1+x.length,f,void 0,{typeAnnotation:"omit"});if(!I)return null;f=f||I.type,x.push(I)}if(!f)throw new Error("No output type");const w=g&&x.some(S=>Se(g,S.type));return new Gu(w?cn:f,x)}evaluate(s){let u,f=null,g=0;for(const x of this.args)if(g++,f=x.evaluate(s),f&&f instanceof Zn&&!f.available&&(u||(u=f.name),f=null,g===this.args.length&&(f=u)),f!==null)break;return f}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}}class Wu{constructor(s,u){this.type=u.type,this.bindings=[].concat(s),this.result=u}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const u of this.bindings)s(u[1]);s(this.result)}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const f=[];for(let x=1;x<s.length-1;x+=2){const w=s[x];if(typeof w!="string")return u.error(`Expected string, but found ${typeof w} instead.`,x);if(/[^a-zA-Z0-9_]/.test(w))return u.error("Variable names must contain only alphanumeric characters or '_'.",x);const S=u.parse(s[x+1],x+1);if(!S)return null;f.push([w,S])}const g=u.parse(s[s.length-1],s.length-1,u.expectedType,f);return g?new Wu(f,g):null}outputDefined(){return this.result.outputDefined()}}class Xd{constructor(s,u,f){this.type=s,this.index=u,this.input=f}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,it),g=u.parse(s[2],2,se(u.expectedType||cn));return f&&g?new Xd(g.type.itemType,f,g):null}evaluate(s){const u=this.index.evaluate(s),f=this.input.evaluate(s);if(u<0)throw new Qn(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new Qn(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new Qn(`Array index must be an integer, but found ${u} instead.`);return f[u]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}}class Yd{constructor(s,u){this.type=ln,this.needle=s,this.haystack=u}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,cn),g=u.parse(s[2],2,cn);return f&&g?Te(f.type,[ln,fn,it,Fn,cn])?new Yd(f,g):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${ue(f.type)} instead`):null}evaluate(s){const u=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!f)return!1;if(!ye(u,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${ue(Jn(u))} instead.`);if(!ye(f,["string","array"]))throw new Qn(`Expected second argument to be of type array or string, but found ${ue(Jn(f))} instead.`);return f.indexOf(u)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}}class Hu{constructor(s,u,f){this.type=it,this.needle=s,this.haystack=u,this.fromIndex=f}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,cn),g=u.parse(s[2],2,cn);if(!f||!g)return null;if(!Te(f.type,[ln,fn,it,Fn,cn]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${ue(f.type)} instead`);if(s.length===4){const x=u.parse(s[3],3,it);return x?new Hu(f,g,x):null}return new Hu(f,g)}evaluate(s){const u=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!ye(u,["boolean","string","number","null"]))throw new Qn(`Expected first argument to be of type boolean, string, number or null, but found ${ue(Jn(u))} instead.`);if(!ye(f,["string","array"]))throw new Qn(`Expected second argument to be of type array or string, but found ${ue(Jn(f))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(s);return f.indexOf(u,g)}return f.indexOf(u)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}}class Kd{constructor(s,u,f,g,x,w){this.inputType=s,this.type=u,this.input=f,this.cases=g,this.outputs=x,this.otherwise=w}static parse(s,u){if(s.length<5)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return u.error("Expected an even number of arguments.");let f,g;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);const x={},w=[];for(let k=2;k<s.length-1;k+=2){let B=s[k];const j=s[k+1];Array.isArray(B)||(B=[B]);const H=u.concat(k);if(B.length===0)return H.error("Expected at least one branch label.");for(const ee of B){if(typeof ee!="number"&&typeof ee!="string")return H.error("Branch labels must be numbers or strings.");if(typeof ee=="number"&&Math.abs(ee)>Number.MAX_SAFE_INTEGER)return H.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ee=="number"&&Math.floor(ee)!==ee)return H.error("Numeric branch labels must be integer values.");if(f){if(H.checkSubtype(f,Jn(ee)))return null}else f=Jn(ee);if(x[String(ee)]!==void 0)return H.error("Branch labels must be unique.");x[String(ee)]=w.length}const Y=u.parse(j,k,g);if(!Y)return null;g=g||Y.type,w.push(Y)}const S=u.parse(s[1],1,cn);if(!S)return null;const I=u.parse(s[s.length-1],s.length-1,g);return I?S.type.kind!=="value"&&u.concat(1).checkSubtype(f,S.type)?null:new Kd(f,g,S,x,w,I):null}evaluate(s){const u=this.input.evaluate(s);return(Jn(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}}class Jd{constructor(s,u,f){this.type=s,this.branches=u,this.otherwise=f}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const g=[];for(let w=1;w<s.length-1;w+=2){const S=u.parse(s[w],w,ln);if(!S)return null;const I=u.parse(s[w+1],w+1,f);if(!I)return null;g.push([S,I]),f=f||I.type}const x=u.parse(s[s.length-1],s.length-1,f);if(!x)return null;if(!f)throw new Error("Can't infer output type");return new Jd(f,g,x)}evaluate(s){for(const[u,f]of this.branches)if(u.evaluate(s))return f.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[u,f]of this.branches)s(u),s(f);s(this.otherwise)}outputDefined(){return this.branches.every(([s,u])=>u.outputDefined())&&this.otherwise.outputDefined()}}class qu{constructor(s,u,f,g){this.type=s,this.input=u,this.beginIndex=f,this.endIndex=g}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=u.parse(s[1],1,cn),g=u.parse(s[2],2,it);if(!f||!g)return null;if(!Te(f.type,[se(cn),fn,cn]))return u.error(`Expected first argument to be of type array or string, but found ${ue(f.type)} instead`);if(s.length===4){const x=u.parse(s[3],3,it);return x?new qu(f.type,f,g,x):null}return new qu(f.type,f,g)}evaluate(s){const u=this.input.evaluate(s),f=this.beginIndex.evaluate(s);if(!ye(u,["string","array"]))throw new Qn(`Expected first argument to be of type array or string, but found ${ue(Jn(u))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(s);return u.slice(f,g)}return u.slice(f)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}}function tg(c,s){return c==="=="||c==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function ng(c,s,u,f){return f.compare(s,u)===0}function Pl(c,s,u){const f=c!=="=="&&c!=="!=";return class gO{constructor(x,w,S){this.type=ln,this.lhs=x,this.rhs=w,this.collator=S,this.hasUntypedArgument=x.type.kind==="value"||w.type.kind==="value"}static parse(x,w){if(x.length!==3&&x.length!==4)return w.error("Expected two or three arguments.");const S=x[0];let I=w.parse(x[1],1,cn);if(!I)return null;if(!tg(S,I.type))return w.concat(1).error(`"${S}" comparisons are not supported for type '${ue(I.type)}'.`);let k=w.parse(x[2],2,cn);if(!k)return null;if(!tg(S,k.type))return w.concat(2).error(`"${S}" comparisons are not supported for type '${ue(k.type)}'.`);if(I.type.kind!==k.type.kind&&I.type.kind!=="value"&&k.type.kind!=="value")return w.error(`Cannot compare types '${ue(I.type)}' and '${ue(k.type)}'.`);f&&(I.type.kind==="value"&&k.type.kind!=="value"?I=new Wi(k.type,[I]):I.type.kind!=="value"&&k.type.kind==="value"&&(k=new Wi(I.type,[k])));let B=null;if(x.length===4){if(I.type.kind!=="string"&&k.type.kind!=="string"&&I.type.kind!=="value"&&k.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(B=w.parse(x[3],3,Kr),!B)return null}return new gO(I,k,B)}evaluate(x){const w=this.lhs.evaluate(x),S=this.rhs.evaluate(x);if(f&&this.hasUntypedArgument){const I=Jn(w),k=Jn(S);if(I.kind!==k.kind||I.kind!=="string"&&I.kind!=="number")throw new Qn(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${I.kind}, ${k.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const I=Jn(w),k=Jn(S);if(I.kind!=="string"||k.kind!=="string")return s(x,w,S)}return this.collator?u(x,w,S,this.collator.evaluate(x)):s(x,w,S)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const Fv=Pl("==",function(c,s,u){return s===u},ng),Nv=Pl("!=",function(c,s,u){return s!==u},function(c,s,u,f){return!ng(0,s,u,f)}),Bv=Pl("<",function(c,s,u){return s<u},function(c,s,u,f){return f.compare(s,u)<0}),Uv=Pl(">",function(c,s,u){return s>u},function(c,s,u,f){return f.compare(s,u)>0}),Vv=Pl("<=",function(c,s,u){return s<=u},function(c,s,u,f){return f.compare(s,u)<=0}),jv=Pl(">=",function(c,s,u){return s>=u},function(c,s,u,f){return f.compare(s,u)>=0});class Qd{constructor(s,u,f,g,x){this.type=fn,this.number=s,this.locale=u,this.currency=f,this.minFractionDigits=g,this.maxFractionDigits=x}static parse(s,u){if(s.length!==3)return u.error("Expected two arguments.");const f=u.parse(s[1],1,it);if(!f)return null;const g=s[2];if(typeof g!="object"||Array.isArray(g))return u.error("NumberFormat options argument must be an object.");let x=null;if(g.locale&&(x=u.parse(g.locale,1,fn),!x))return null;let w=null;if(g.currency&&(w=u.parse(g.currency,1,fn),!w))return null;let S=null;if(g["min-fraction-digits"]&&(S=u.parse(g["min-fraction-digits"],1,it),!S))return null;let I=null;return g["max-fraction-digits"]&&(I=u.parse(g["max-fraction-digits"],1,it),!I)?null:new Qd(f,x,w,S,I)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}}class Zu{constructor(s){this.type=xi,this.sections=s}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const f=s[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const g=[];let x=!1;for(let w=1;w<=s.length-1;++w){const S=s[w];if(x&&typeof S=="object"&&!Array.isArray(S)){x=!1;let I=null;if(S["font-scale"]&&(I=u.parse(S["font-scale"],1,it),!I))return null;let k=null;if(S["text-font"]&&(k=u.parse(S["text-font"],1,se(fn)),!k))return null;let B=null;if(S["text-color"]&&(B=u.parse(S["text-color"],1,Cr),!B))return null;const j=g[g.length-1];j.scale=I,j.font=k,j.textColor=B}else{const I=u.parse(s[w],1,cn);if(!I)return null;const k=I.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,g.push({content:I,scale:null,font:null,textColor:null})}}return new Zu(g)}evaluate(s){return new ir(this.sections.map(u=>{const f=u.content.evaluate(s);return Jn(f)===G?new ki("",f,null,null,null):new ki(Dn(f),null,u.scale?u.scale.evaluate(s):null,u.font?u.font.evaluate(s).join(","):null,u.textColor?u.textColor.evaluate(s):null)}))}eachChild(s){for(const u of this.sections)s(u.content),u.scale&&s(u.scale),u.font&&s(u.font),u.textColor&&s(u.textColor)}outputDefined(){return!1}}class ef{constructor(s){this.type=G,this.input=s}static parse(s,u){if(s.length!==2)return u.error("Expected two arguments.");const f=u.parse(s[1],1,fn);return f?new ef(f):u.error("No image name provided.")}evaluate(s){const u=this.input.evaluate(s),f=Zn.fromString(u);return f&&s.availableImages&&(f.available=s.availableImages.indexOf(u)>-1),f}eachChild(s){s(this.input)}outputDefined(){return!1}}class tf{constructor(s){this.type=it,this.input=s}static parse(s,u){if(s.length!==2)return u.error(`Expected 1 argument, but found ${s.length-1} instead.`);const f=u.parse(s[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${ue(f.type)} instead.`):new tf(f):null}evaluate(s){const u=this.input.evaluate(s);if(typeof u=="string"||Array.isArray(u))return u.length;throw new Qn(`Expected value to be of type string or array, but found ${ue(Jn(u))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}}const Cl={"==":Fv,"!=":Nv,">":Uv,"<":Bv,">=":jv,"<=":Vv,array:Wi,at:Xd,boolean:Wi,case:Jd,coalesce:Gu,collator:te,format:Zu,image:ef,in:Yd,"index-of":Hu,interpolate:hs,"interpolate-hcl":hs,"interpolate-lab":hs,length:tf,let:Wu,literal:js,match:Kd,number:Wi,"number-format":Qd,object:Wi,slice:qu,step:ha,string:Wi,"to-boolean":Ps,"to-color":Ps,"to-number":Ps,"to-string":Ps,var:Bu,within:Na};function rg(c,[s,u,f,g]){s=s.evaluate(c),u=u.evaluate(c),f=f.evaluate(c);const x=g?g.evaluate(c):1,w=Bo(s,u,f,x);if(w)throw new Qn(w);return new Cn(s/255,u/255,f/255,x,!1)}function ig(c,s){return c in s}function nf(c,s){const u=s[c];return u===void 0?null:u}function Ba(c){return{type:c}}function sg(c){return{result:"success",value:c}}function da(c){return{result:"error",value:c}}function Al(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function og(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function rf(c){return!!c.expression&&c.expression.interpolated}function $n(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function mr(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function $v(c){return c}function On(c,s){const u=s.type==="color",f=c.stops&&typeof c.stops[0][0]=="object",g=f||!(f||c.property!==void 0),x=c.type||(rf(s)?"exponential":"interval");if(u||s.type==="padding"){const B=u?Cn.parse:bi.parse;(c=mt({},c)).stops&&(c.stops=c.stops.map(j=>[j[0],B(j[1])])),c.default=B(c.default?c.default:s.default)}if(c.colorSpace&&(w=c.colorSpace)!=="rgb"&&w!=="hcl"&&w!=="lab")throw new Error(`Unknown color space: "${c.colorSpace}"`);var w;let S,I,k;if(x==="exponential")S=Lc;else if(x==="interval")S=fr;else if(x==="categorical"){S=gr,I=Object.create(null);for(const B of c.stops)I[B[0]]=B[1];k=typeof c.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);S=ag}if(f){const B={},j=[];for(let ee=0;ee<c.stops.length;ee++){const le=c.stops[ee],me=le[0].zoom;B[me]===void 0&&(B[me]={zoom:me,type:c.type,property:c.property,default:c.default,stops:[]},j.push(me)),B[me].stops.push([le[0].value,le[1]])}const H=[];for(const ee of j)H.push([B[ee].zoom,On(B[ee],s)]);const Y={name:"linear"};return{kind:"composite",interpolationType:Y,interpolationFactor:hs.interpolationFactor.bind(void 0,Y),zoomStops:H.map(ee=>ee[0]),evaluate:({zoom:ee},le)=>Lc({stops:H,base:c.base},s,ee).evaluate(ee,le)}}if(g){const B=x==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:B,interpolationFactor:hs.interpolationFactor.bind(void 0,B),zoomStops:c.stops.map(j=>j[0]),evaluate:({zoom:j})=>S(c,s,j,I,k)}}return{kind:"source",evaluate(B,j){const H=j&&j.properties?j.properties[c.property]:void 0;return H===void 0?Ua(c.default,s.default):S(c,s,H,I,k)}}}function Ua(c,s,u){return c!==void 0?c:s!==void 0?s:u!==void 0?u:void 0}function gr(c,s,u,f,g){return Ua(typeof u===g?f[u]:void 0,c.default,s.default)}function fr(c,s,u){if($n(u)!=="number")return Ua(c.default,s.default);const f=c.stops.length;if(f===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[f-1][0])return c.stops[f-1][1];const g=Sl(c.stops.map(x=>x[0]),u);return c.stops[g][1]}function Lc(c,s,u){const f=c.base!==void 0?c.base:1;if($n(u)!=="number")return Ua(c.default,s.default);const g=c.stops.length;if(g===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[g-1][0])return c.stops[g-1][1];const x=Sl(c.stops.map(B=>B[0]),u),w=function(B,j,H,Y){const ee=Y-H,le=B-H;return ee===0?0:j===1?le/ee:(Math.pow(j,le)-1)/(Math.pow(j,ee)-1)}(u,f,c.stops[x][0],c.stops[x+1][0]),S=c.stops[x][1],I=c.stops[x+1][1],k=us[s.type]||$v;return typeof S.evaluate=="function"?{evaluate(...B){const j=S.evaluate.apply(void 0,B),H=I.evaluate.apply(void 0,B);if(j!==void 0&&H!==void 0)return k(j,H,w,c.colorSpace)}}:k(S,I,w,c.colorSpace)}function ag(c,s,u){switch(s.type){case"color":u=Cn.parse(u);break;case"formatted":u=ir.fromString(u.toString());break;case"resolvedImage":u=Zn.fromString(u.toString());break;case"padding":u=bi.parse(u);break;default:$n(u)===s.type||s.type==="enum"&&s.values[u]||(u=void 0)}return Ua(u,c.default,s.default)}Cs.register(Cl,{error:[{kind:"error"},[fn],(c,[s])=>{throw new Qn(s.evaluate(c))}],typeof:[fn,[cn],(c,[s])=>ue(Jn(s.evaluate(c)))],"to-rgba":[se(it,4),[Cr],(c,[s])=>{const[u,f,g,x]=s.evaluate(c).rgb;return[255*u,255*f,255*g,x]}],rgb:[Cr,[it,it,it],rg],rgba:[Cr,[it,it,it,it],rg],has:{type:ln,overloads:[[[fn],(c,[s])=>ig(s.evaluate(c),c.properties())],[[fn,li],(c,[s,u])=>ig(s.evaluate(c),u.evaluate(c))]]},get:{type:cn,overloads:[[[fn],(c,[s])=>nf(s.evaluate(c),c.properties())],[[fn,li],(c,[s,u])=>nf(s.evaluate(c),u.evaluate(c))]]},"feature-state":[cn,[fn],(c,[s])=>nf(s.evaluate(c),c.featureState||{})],properties:[li,[],c=>c.properties()],"geometry-type":[fn,[],c=>c.geometryType()],id:[cn,[],c=>c.id()],zoom:[it,[],c=>c.globals.zoom],"heatmap-density":[it,[],c=>c.globals.heatmapDensity||0],"line-progress":[it,[],c=>c.globals.lineProgress||0],accumulated:[cn,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[it,Ba(it),(c,s)=>{let u=0;for(const f of s)u+=f.evaluate(c);return u}],"*":[it,Ba(it),(c,s)=>{let u=1;for(const f of s)u*=f.evaluate(c);return u}],"-":{type:it,overloads:[[[it,it],(c,[s,u])=>s.evaluate(c)-u.evaluate(c)],[[it],(c,[s])=>-s.evaluate(c)]]},"/":[it,[it,it],(c,[s,u])=>s.evaluate(c)/u.evaluate(c)],"%":[it,[it,it],(c,[s,u])=>s.evaluate(c)%u.evaluate(c)],ln2:[it,[],()=>Math.LN2],pi:[it,[],()=>Math.PI],e:[it,[],()=>Math.E],"^":[it,[it,it],(c,[s,u])=>Math.pow(s.evaluate(c),u.evaluate(c))],sqrt:[it,[it],(c,[s])=>Math.sqrt(s.evaluate(c))],log10:[it,[it],(c,[s])=>Math.log(s.evaluate(c))/Math.LN10],ln:[it,[it],(c,[s])=>Math.log(s.evaluate(c))],log2:[it,[it],(c,[s])=>Math.log(s.evaluate(c))/Math.LN2],sin:[it,[it],(c,[s])=>Math.sin(s.evaluate(c))],cos:[it,[it],(c,[s])=>Math.cos(s.evaluate(c))],tan:[it,[it],(c,[s])=>Math.tan(s.evaluate(c))],asin:[it,[it],(c,[s])=>Math.asin(s.evaluate(c))],acos:[it,[it],(c,[s])=>Math.acos(s.evaluate(c))],atan:[it,[it],(c,[s])=>Math.atan(s.evaluate(c))],min:[it,Ba(it),(c,s)=>Math.min(...s.map(u=>u.evaluate(c)))],max:[it,Ba(it),(c,s)=>Math.max(...s.map(u=>u.evaluate(c)))],abs:[it,[it],(c,[s])=>Math.abs(s.evaluate(c))],round:[it,[it],(c,[s])=>{const u=s.evaluate(c);return u<0?-Math.round(-u):Math.round(u)}],floor:[it,[it],(c,[s])=>Math.floor(s.evaluate(c))],ceil:[it,[it],(c,[s])=>Math.ceil(s.evaluate(c))],"filter-==":[ln,[fn,cn],(c,[s,u])=>c.properties()[s.value]===u.value],"filter-id-==":[ln,[cn],(c,[s])=>c.id()===s.value],"filter-type-==":[ln,[fn],(c,[s])=>c.geometryType()===s.value],"filter-<":[ln,[fn,cn],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[ln,[cn],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u<f}],"filter->":[ln,[fn,cn],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[ln,[cn],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u>f}],"filter-<=":[ln,[fn,cn],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[ln,[cn],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u<=f}],"filter->=":[ln,[fn,cn],(c,[s,u])=>{const f=c.properties()[s.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[ln,[cn],(c,[s])=>{const u=c.id(),f=s.value;return typeof u==typeof f&&u>=f}],"filter-has":[ln,[cn],(c,[s])=>s.value in c.properties()],"filter-has-id":[ln,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[ln,[se(fn)],(c,[s])=>s.value.indexOf(c.geometryType())>=0],"filter-id-in":[ln,[se(cn)],(c,[s])=>s.value.indexOf(c.id())>=0],"filter-in-small":[ln,[fn,se(cn)],(c,[s,u])=>u.value.indexOf(c.properties()[s.value])>=0],"filter-in-large":[ln,[fn,se(cn)],(c,[s,u])=>function(f,g,x,w){for(;x<=w;){const S=x+w>>1;if(g[S]===f)return!0;g[S]>f?w=S-1:x=S+1}return!1}(c.properties()[s.value],u.value,0,u.value.length-1)],all:{type:ln,overloads:[[[ln,ln],(c,[s,u])=>s.evaluate(c)&&u.evaluate(c)],[Ba(ln),(c,s)=>{for(const u of s)if(!u.evaluate(c))return!1;return!0}]]},any:{type:ln,overloads:[[[ln,ln],(c,[s,u])=>s.evaluate(c)||u.evaluate(c)],[Ba(ln),(c,s)=>{for(const u of s)if(u.evaluate(c))return!0;return!1}]]},"!":[ln,[ln],(c,[s])=>!s.evaluate(c)],"is-supported-script":[ln,[fn],(c,[s])=>{const u=c.globals&&c.globals.isSupportedScript;return!u||u(s.evaluate(c))}],upcase:[fn,[fn],(c,[s])=>s.evaluate(c).toUpperCase()],downcase:[fn,[fn],(c,[s])=>s.evaluate(c).toLowerCase()],concat:[fn,Ba(cn),(c,s)=>s.map(u=>Dn(u.evaluate(c))).join("")],"resolved-locale":[fn,[Kr],(c,[s])=>s.evaluate(c).resolvedLocale()]});class sf{constructor(s,u){var f;this.expression=s,this._warningHistory={},this._evaluator=new Mc,this._defaultValue=u?(f=u).type==="color"&&mr(f.default)?new Cn(0,0,0,0):f.type==="color"?Cn.parse(f.default)||null:f.type==="padding"?bi.parse(f.default)||null:f.type==="variableAnchorOffsetCollection"?hi.parse(f.default)||null:f.default===void 0?null:f.default:null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._evaluator.globals=s,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(s,u,f,g,x,w){this._evaluator.globals=s,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Qn(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function Xu(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Cl}function Yu(c,s){const u=new Tl(Cl,Uu,[],s?function(g){const x={color:Cr,string:fn,number:it,enum:fn,boolean:ln,formatted:xi,padding:de,resolvedImage:G,variableAnchorOffsetCollection:Z};return g.type==="array"?se(x[g.value]||cn,g.length):x[g.type]}(s):void 0),f=u.parse(c,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?sg(new sf(f,s)):da(u.errors)}class of{constructor(s,u){this.kind=s,this._styleExpression=u,this.isStateDependent=s!=="constant"&&!kc(u.expression)}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,u,f,g,x,w)}evaluate(s,u,f,g,x,w){return this._styleExpression.evaluate(s,u,f,g,x,w)}}class Ku{constructor(s,u,f,g){this.kind=s,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=s!=="camera"&&!kc(u.expression),this.interpolationType=g}evaluateWithoutErrorHandling(s,u,f,g,x,w){return this._styleExpression.evaluateWithoutErrorHandling(s,u,f,g,x,w)}evaluate(s,u,f,g,x,w){return this._styleExpression.evaluate(s,u,f,g,x,w)}interpolationFactor(s,u,f){return this.interpolationType?hs.interpolationFactor(this.interpolationType,s,u,f):0}}function af(c,s){const u=Yu(c,s);if(u.result==="error")return u;const f=u.value.expression,g=Vu(f);if(!g&&!Al(s))return da([new Zt("","data expressions not supported")]);const x=ju(f,["zoom"]);if(!x&&!og(s))return da([new Zt("","zoom expressions not supported")]);const w=Oc(f);return w||x?w instanceof Zt?da([w]):w instanceof hs&&!rf(s)?da([new Zt("",'"interpolate" expressions cannot be used with this property')]):sg(w?new Ku(g?"camera":"composite",u.value,w.labels,w instanceof hs?w.interpolation:void 0):new of(g?"constant":"source",u.value)):da([new Zt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Rc{constructor(s,u){this._parameters=s,this._specification=u,mt(this,On(this._parameters,this._specification))}static deserialize(s){return new Rc(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Oc(c){let s=null;if(c instanceof Wu)s=Oc(c.result);else if(c instanceof Gu){for(const u of c.args)if(s=Oc(u),s)break}else(c instanceof ha||c instanceof hs)&&c.input instanceof Cs&&c.input.name==="zoom"&&(s=c);return s instanceof Zt||c.eachChild(u=>{const f=Oc(u);f instanceof Zt?s=f:!s&&f?s=new Zt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&f&&s!==f&&(s=new Zt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}function zc(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const s of c.slice(1))if(!zc(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}const Gv={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function lf(c){if(c==null)return{filter:()=>!0,needGeometry:!1};zc(c)||(c=Ju(c));const s=Yu(c,Gv);if(s.result==="error")throw new Error(s.value.map(u=>`${u.key}: ${u.message}`).join(", "));return{filter:(u,f,g)=>s.value.evaluate(u,f,{},g),needGeometry:lg(c)}}function Wv(c,s){return c<s?-1:c>s?1:0}function lg(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let s=1;s<c.length;s++)if(lg(c[s]))return!0;return!1}function Ju(c){if(!c)return!0;const s=c[0];return c.length<=1?s!=="any":s==="=="?cf(c[1],c[2],"=="):s==="!="?Dc(cf(c[1],c[2],"==")):s==="<"||s===">"||s==="<="||s===">="?cf(c[1],c[2],s):s==="any"?(u=c.slice(1),["any"].concat(u.map(Ju))):s==="all"?["all"].concat(c.slice(1).map(Ju)):s==="none"?["all"].concat(c.slice(1).map(Ju).map(Dc)):s==="in"?cg(c[1],c.slice(2)):s==="!in"?Dc(cg(c[1],c.slice(2))):s==="has"?ug(c[1]):s==="!has"?Dc(ug(c[1])):s!=="within"||c;var u}function cf(c,s,u){switch(c){case"$type":return[`filter-type-${u}`,s];case"$id":return[`filter-id-${u}`,s];default:return[`filter-${u}`,c,s]}}function cg(c,s){if(s.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(u=>typeof u!=typeof s[0])?["filter-in-large",c,["literal",s.sort(Wv)]]:["filter-in-small",c,["literal",s]]}}function ug(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Dc(c){return["!",c]}function Qu(c){const s=typeof c;if(s==="number"||s==="boolean"||s==="string"||c==null)return JSON.stringify(c);if(Array.isArray(c)){let g="[";for(const x of c)g+=`${Qu(x)},`;return`${g}]`}const u=Object.keys(c).sort();let f="{";for(let g=0;g<u.length;g++)f+=`${JSON.stringify(u[g])}:${Qu(c[u[g]])},`;return`${f}}`}function eh(c){let s="";for(const u of Ct)s+=`/${Qu(c[u])}`;return s}function hg(c){const s=c.value;return s?[new He(c.key,s,"constants have been deprecated as of v8")]:[]}function br(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Va(c){if(Array.isArray(c))return c.map(Va);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const s={};for(const u in c)s[u]=Va(c[u]);return s}return br(c)}function Hi(c){const s=c.key,u=c.value,f=c.valueSpec||{},g=c.objectElementValidators||{},x=c.style,w=c.styleSpec,S=c.validateSpec;let I=[];const k=$n(u);if(k!=="object")return[new He(s,u,`object expected, ${k} found`)];for(const B in u){const j=B.split(".")[0],H=f[j]||f["*"];let Y;if(g[j])Y=g[j];else if(f[j])Y=S;else if(g["*"])Y=g["*"];else{if(!f["*"]){I.push(new He(s,u[B],`unknown property "${B}"`));continue}Y=S}I=I.concat(Y({key:(s&&`${s}.`)+B,value:u[B],valueSpec:H,style:x,styleSpec:w,object:u,objectKey:B,validateSpec:S},u))}for(const B in f)g[B]||f[B].required&&f[B].default===void 0&&u[B]===void 0&&I.push(new He(s,u,`missing required property "${B}"`));return I}function Il(c){const s=c.value,u=c.valueSpec,f=c.style,g=c.styleSpec,x=c.key,w=c.arrayElementValidator||c.validateSpec;if($n(s)!=="array")return[new He(x,s,`array expected, ${$n(s)} found`)];if(u.length&&s.length!==u.length)return[new He(x,s,`array length ${u.length} expected, length ${s.length} found`)];if(u["min-length"]&&s.length<u["min-length"])return[new He(x,s,`array length at least ${u["min-length"]} expected, length ${s.length} found`)];let S={type:u.value,values:u.values};g.$version<7&&(S.function=u.function),$n(u.value)==="object"&&(S=u.value);let I=[];for(let k=0;k<s.length;k++)I=I.concat(w({array:s,arrayIndex:k,value:s[k],valueSpec:S,validateSpec:c.validateSpec,style:f,styleSpec:g,key:`${x}[${k}]`}));return I}function Fc(c){const s=c.key,u=c.value,f=c.valueSpec;let g=$n(u);return g==="number"&&u!=u&&(g="NaN"),g!=="number"?[new He(s,u,`number expected, ${g} found`)]:"minimum"in f&&u<f.minimum?[new He(s,u,`${u} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&u>f.maximum?[new He(s,u,`${u} is greater than the maximum value ${f.maximum}`)]:[]}function th(c){const s=c.valueSpec,u=br(c.value.type);let f,g,x,w={};const S=u!=="categorical"&&c.value.property===void 0,I=!S,k=$n(c.value.stops)==="array"&&$n(c.value.stops[0])==="array"&&$n(c.value.stops[0][0])==="object",B=Hi({key:c.key,value:c.value,valueSpec:c.styleSpec.function,validateSpec:c.validateSpec,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(Y){if(u==="identity")return[new He(Y.key,Y.value,'identity function may not have a "stops" property')];let ee=[];const le=Y.value;return ee=ee.concat(Il({key:Y.key,value:le,valueSpec:Y.valueSpec,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:j})),$n(le)==="array"&&le.length===0&&ee.push(new He(Y.key,le,"array must have at least one stop")),ee},default:function(Y){return Y.validateSpec({key:Y.key,value:Y.value,valueSpec:s,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec})}}});return u==="identity"&&S&&B.push(new He(c.key,c.value,'missing required property "property"')),u==="identity"||c.value.stops||B.push(new He(c.key,c.value,'missing required property "stops"')),u==="exponential"&&c.valueSpec.expression&&!rf(c.valueSpec)&&B.push(new He(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(I&&!Al(c.valueSpec)?B.push(new He(c.key,c.value,"property functions not supported")):S&&!og(c.valueSpec)&&B.push(new He(c.key,c.value,"zoom functions not supported"))),u!=="categorical"&&!k||c.value.property!==void 0||B.push(new He(c.key,c.value,'"property" property is required')),B;function j(Y){let ee=[];const le=Y.value,me=Y.key;if($n(le)!=="array")return[new He(me,le,`array expected, ${$n(le)} found`)];if(le.length!==2)return[new He(me,le,`array length 2 expected, length ${le.length} found`)];if(k){if($n(le[0])!=="object")return[new He(me,le,`object expected, ${$n(le[0])} found`)];if(le[0].zoom===void 0)return[new He(me,le,"object stop key must have zoom")];if(le[0].value===void 0)return[new He(me,le,"object stop key must have value")];if(x&&x>br(le[0].zoom))return[new He(me,le[0].zoom,"stop zoom values must appear in ascending order")];br(le[0].zoom)!==x&&(x=br(le[0].zoom),g=void 0,w={}),ee=ee.concat(Hi({key:`${me}[0]`,value:le[0],valueSpec:{zoom:{}},validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:Fc,value:H}}))}else ee=ee.concat(H({key:`${me}[0]`,value:le[0],valueSpec:{},validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec},le));return Xu(Va(le[1]))?ee.concat([new He(`${me}[1]`,le[1],"expressions are not allowed in function stops.")]):ee.concat(Y.validateSpec({key:`${me}[1]`,value:le[1],valueSpec:s,validateSpec:Y.validateSpec,style:Y.style,styleSpec:Y.styleSpec}))}function H(Y,ee){const le=$n(Y.value),me=br(Y.value),_e=Y.value!==null?Y.value:ee;if(f){if(le!==f)return[new He(Y.key,_e,`${le} stop domain type must match previous stop domain type ${f}`)]}else f=le;if(le!=="number"&&le!=="string"&&le!=="boolean")return[new He(Y.key,_e,"stop domain value must be a number, string, or boolean")];if(le!=="number"&&u!=="categorical"){let Me=`number expected, ${le} found`;return Al(s)&&u===void 0&&(Me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new He(Y.key,_e,Me)]}return u!=="categorical"||le!=="number"||isFinite(me)&&Math.floor(me)===me?u!=="categorical"&&le==="number"&&g!==void 0&&me<g?[new He(Y.key,_e,"stop domain values must appear in ascending order")]:(g=me,u==="categorical"&&me in w?[new He(Y.key,_e,"stop domain values must be unique")]:(w[me]=!0,[])):[new He(Y.key,_e,`integer expected, found ${me}`)]}}function ja(c){const s=(c.expressionContext==="property"?af:Yu)(Va(c.value),c.valueSpec);if(s.result==="error")return s.value.map(f=>new He(`${c.key}${f.key}`,c.value,f.message));const u=s.value.expression||s.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!u.outputDefined())return[new He(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!kc(u))return[new He(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter"&&!kc(u))return[new He(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!ju(u,["zoom","feature-state"]))return[new He(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!Vu(u))return[new He(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Nc(c){const s=c.key,u=c.value,f=c.valueSpec,g=[];return Array.isArray(f.values)?f.values.indexOf(br(u))===-1&&g.push(new He(s,u,`expected one of [${f.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(f.values).indexOf(br(u))===-1&&g.push(new He(s,u,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(u)} found`)),g}function Ml(c){return zc(Va(c.value))?ja(mt({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):dg(c)}function dg(c){const s=c.value,u=c.key;if($n(s)!=="array")return[new He(u,s,`array expected, ${$n(s)} found`)];const f=c.styleSpec;let g,x=[];if(s.length<1)return[new He(u,s,"filter array must have at least 1 element")];switch(x=x.concat(Nc({key:`${u}[0]`,value:s[0],valueSpec:f.filter_operator,style:c.style,styleSpec:c.styleSpec})),br(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&br(s[1])==="$type"&&x.push(new He(u,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&x.push(new He(u,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(g=$n(s[1]),g!=="string"&&x.push(new He(`${u}[1]`,s[1],`string expected, ${g} found`)));for(let w=2;w<s.length;w++)g=$n(s[w]),br(s[1])==="$type"?x=x.concat(Nc({key:`${u}[${w}]`,value:s[w],valueSpec:f.geometry_type,style:c.style,styleSpec:c.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&x.push(new He(`${u}[${w}]`,s[w],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let w=1;w<s.length;w++)x=x.concat(dg({key:`${u}[${w}]`,value:s[w],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":g=$n(s[1]),s.length!==2?x.push(new He(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):g!=="string"&&x.push(new He(`${u}[1]`,s[1],`string expected, ${g} found`));break;case"within":g=$n(s[1]),s.length!==2?x.push(new He(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):g!=="object"&&x.push(new He(`${u}[1]`,s[1],`object expected, ${g} found`))}return x}function fg(c,s){const u=c.key,f=c.validateSpec,g=c.style,x=c.styleSpec,w=c.value,S=c.objectKey,I=x[`${s}_${c.layerType}`];if(!I)return[];const k=S.match(/^(.*)-transition$/);if(s==="paint"&&k&&I[k[1]]&&I[k[1]].transition)return f({key:u,value:w,valueSpec:x.transition,style:g,styleSpec:x});const B=c.valueSpec||I[S];if(!B)return[new He(u,w,`unknown property "${S}"`)];let j;if($n(w)==="string"&&Al(B)&&!B.tokens&&(j=/^{([^}]+)}$/.exec(w)))return[new He(u,w,`"${S}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(j[1])} }\`.`)];const H=[];return c.layerType==="symbol"&&(S==="text-field"&&g&&!g.glyphs&&H.push(new He(u,w,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&mr(Va(w))&&br(w.type)==="identity"&&H.push(new He(u,w,'"text-font" does not support identity functions'))),H.concat(f({key:c.key,value:w,valueSpec:B,style:g,styleSpec:x,expressionContext:"property",propertyType:s,propertyKey:S}))}function pg(c){return fg(c,"paint")}function mg(c){return fg(c,"layout")}function gg(c){let s=[];const u=c.value,f=c.key,g=c.style,x=c.styleSpec;u.type||u.ref||s.push(new He(f,u,'either "type" or "ref" is required'));let w=br(u.type);const S=br(u.ref);if(u.id){const I=br(u.id);for(let k=0;k<c.arrayIndex;k++){const B=g.layers[k];br(B.id)===I&&s.push(new He(f,u.id,`duplicate layer id "${u.id}", previously used at line ${B.id.__line__}`))}}if("ref"in u){let I;["type","source","source-layer","filter","layout"].forEach(k=>{k in u&&s.push(new He(f,u[k],`"${k}" is prohibited for ref layers`))}),g.layers.forEach(k=>{br(k.id)===S&&(I=k)}),I?I.ref?s.push(new He(f,u.ref,"ref cannot reference another ref layer")):w=br(I.type):s.push(new He(f,u.ref,`ref layer "${S}" not found`))}else if(w!=="background")if(u.source){const I=g.sources&&g.sources[u.source],k=I&&br(I.type);I?k==="vector"&&w==="raster"?s.push(new He(f,u.source,`layer "${u.id}" requires a raster source`)):k!=="raster-dem"&&w==="hillshade"?s.push(new He(f,u.source,`layer "${u.id}" requires a raster-dem source`)):k==="raster"&&w!=="raster"?s.push(new He(f,u.source,`layer "${u.id}" requires a vector source`)):k!=="vector"||u["source-layer"]?k==="raster-dem"&&w!=="hillshade"?s.push(new He(f,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!u.paint||!u.paint["line-gradient"]||k==="geojson"&&I.lineMetrics||s.push(new He(f,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new He(f,u,`layer "${u.id}" must specify a "source-layer"`)):s.push(new He(f,u.source,`source "${u.source}" not found`))}else s.push(new He(f,u,'missing required property "source"'));return s=s.concat(Hi({key:f,value:u,valueSpec:x.layer,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,objectElementValidators:{"*":()=>[],type:()=>c.validateSpec({key:`${f}.type`,value:u.type,valueSpec:x.layer.type,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,object:u,objectKey:"type"}),filter:Ml,layout:I=>Hi({layer:u,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":k=>mg(mt({layerType:w},k))}}),paint:I=>Hi({layer:u,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":k=>pg(mt({layerType:w},k))}})}})),s}function go(c){const s=c.value,u=c.key,f=$n(s);return f!=="string"?[new He(u,s,`string expected, ${f} found`)]:[]}const Bc={promoteId:function({key:c,value:s}){if($n(s)==="string")return go({key:c,value:s});{const u=[];for(const f in s)u.push(...go({key:`${c}.${f}`,value:s[f]}));return u}}};function ds(c){const s=c.value,u=c.key,f=c.styleSpec,g=c.style,x=c.validateSpec;if(!s.type)return[new He(u,s,'"type" is required')];const w=br(s.type);let S;switch(w){case"vector":case"raster":return S=Hi({key:u,value:s,valueSpec:f[`source_${w.replace("-","_")}`],style:c.style,styleSpec:f,objectElementValidators:Bc,validateSpec:x}),S;case"raster-dem":return S=function(I){var k;const B=(k=I.sourceName)!==null&&k!==void 0?k:"",j=I.value,H=I.styleSpec,Y=H.source_raster_dem,ee=I.style;let le=[];const me=$n(j);if(j===void 0)return le;if(me!=="object")return le.push(new He("source_raster_dem",j,`object expected, ${me} found`)),le;const _e=br(j.encoding)==="custom",Me=["redFactor","greenFactor","blueFactor","baseShift"],Ee=I.value.encoding?`"${I.value.encoding}"`:"Default";for(const Le in j)!_e&&Me.includes(Le)?le.push(new He(Le,j[Le],`In "${B}": "${Le}" is only valid when "encoding" is set to "custom". ${Ee} encoding found`)):Y[Le]?le=le.concat(I.validateSpec({key:Le,value:j[Le],valueSpec:Y[Le],validateSpec:I.validateSpec,style:ee,styleSpec:H})):le.push(new He(Le,j[Le],`unknown property "${Le}"`));return le}({sourceName:u,value:s,style:c.style,styleSpec:f,validateSpec:x}),S;case"geojson":if(S=Hi({key:u,value:s,valueSpec:f.source_geojson,style:g,styleSpec:f,validateSpec:x,objectElementValidators:Bc}),s.cluster)for(const I in s.clusterProperties){const[k,B]=s.clusterProperties[I],j=typeof k=="string"?[k,["accumulated"],["get",I]]:k;S.push(...ja({key:`${u}.${I}.map`,value:B,validateSpec:x,expressionContext:"cluster-map"})),S.push(...ja({key:`${u}.${I}.reduce`,value:j,validateSpec:x,expressionContext:"cluster-reduce"}))}return S;case"video":return Hi({key:u,value:s,valueSpec:f.source_video,style:g,validateSpec:x,styleSpec:f});case"image":return Hi({key:u,value:s,valueSpec:f.source_image,style:g,validateSpec:x,styleSpec:f});case"canvas":return[new He(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Nc({key:`${u}.type`,value:s.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,validateSpec:x,styleSpec:f})}}function Uc(c){const s=c.value,u=c.styleSpec,f=u.light,g=c.style;let x=[];const w=$n(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new He("light",s,`object expected, ${w} found`)]),x;for(const S in s){const I=S.match(/^(.*)-transition$/);x=x.concat(I&&f[I[1]]&&f[I[1]].transition?c.validateSpec({key:S,value:s[S],valueSpec:u.transition,validateSpec:c.validateSpec,style:g,styleSpec:u}):f[S]?c.validateSpec({key:S,value:s[S],valueSpec:f[S],validateSpec:c.validateSpec,style:g,styleSpec:u}):[new He(S,s[S],`unknown property "${S}"`)])}return x}function yg(c){const s=c.value,u=c.styleSpec,f=u.terrain,g=c.style;let x=[];const w=$n(s);if(s===void 0)return x;if(w!=="object")return x=x.concat([new He("terrain",s,`object expected, ${w} found`)]),x;for(const S in s)x=x.concat(f[S]?c.validateSpec({key:S,value:s[S],valueSpec:f[S],validateSpec:c.validateSpec,style:g,styleSpec:u}):[new He(S,s[S],`unknown property "${S}"`)]);return x}function _g(c){let s=[];const u=c.value,f=c.key;if(Array.isArray(u)){const g=[],x=[];for(const w in u)u[w].id&&g.includes(u[w].id)&&s.push(new He(f,u,`all the sprites' ids must be unique, but ${u[w].id} is duplicated`)),g.push(u[w].id),u[w].url&&x.includes(u[w].url)&&s.push(new He(f,u,`all the sprites' URLs must be unique, but ${u[w].url} is duplicated`)),x.push(u[w].url),s=s.concat(Hi({key:`${f}[${w}]`,value:u[w],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:c.validateSpec}));return s}return go({key:f,value:u})}const vg={"*":()=>[],array:Il,boolean:function(c){const s=c.value,u=c.key,f=$n(s);return f!=="boolean"?[new He(u,s,`boolean expected, ${f} found`)]:[]},number:Fc,color:function(c){const s=c.key,u=c.value,f=$n(u);return f!=="string"?[new He(s,u,`color expected, ${f} found`)]:Cn.parse(String(u))?[]:[new He(s,u,`color expected, "${u}" found`)]},constants:hg,enum:Nc,filter:Ml,function:th,layer:gg,object:Hi,source:ds,light:Uc,terrain:yg,string:go,formatted:function(c){return go(c).length===0?[]:ja(c)},resolvedImage:function(c){return go(c).length===0?[]:ja(c)},padding:function(c){const s=c.key,u=c.value;if($n(u)==="array"){if(u.length<1||u.length>4)return[new He(s,u,`padding requires 1 to 4 values; ${u.length} values found`)];const f={type:"number"};let g=[];for(let x=0;x<u.length;x++)g=g.concat(c.validateSpec({key:`${s}[${x}]`,value:u[x],validateSpec:c.validateSpec,valueSpec:f}));return g}return Fc({key:s,value:u,valueSpec:{}})},variableAnchorOffsetCollection:function(c){const s=c.key,u=c.value,f=$n(u),g=c.styleSpec;if(f!=="array"||u.length<1||u.length%2!=0)return[new He(s,u,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let w=0;w<u.length;w+=2)x=x.concat(Nc({key:`${s}[${w}]`,value:u[w],valueSpec:g.layout_symbol["text-anchor"]})),x=x.concat(Il({key:`${s}[${w+1}]`,value:u[w+1],valueSpec:{length:2,value:"number"},validateSpec:c.validateSpec,style:c.style,styleSpec:g}));return x},sprite:_g};function Uo(c){const s=c.value,u=c.valueSpec,f=c.styleSpec;return c.validateSpec=Uo,u.expression&&mr(br(s))?th(c):u.expression&&Xu(Va(s))?ja(c):u.type&&vg[u.type]?vg[u.type](c):Hi(mt({},c,{valueSpec:u.type?f[u.type]:u}))}function xg(c){const s=c.value,u=c.key,f=go(c);return f.length||(s.indexOf("{fontstack}")===-1&&f.push(new He(u,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&f.push(new He(u,s,'"glyphs" url must include a "{range}" token'))),f}function As(c,s=Ae){let u=[];return u=u.concat(Uo({key:"",value:c,valueSpec:s.$root,styleSpec:s,style:c,validateSpec:Uo,objectElementValidators:{glyphs:xg,"*":()=>[]}})),c.constants&&(u=u.concat(hg({key:"constants",value:c.constants,style:c,styleSpec:s,validateSpec:Uo}))),nh(u)}function Vo(c){return function(s){return c({...s,validateSpec:Uo})}}function nh(c){return[].concat(c).sort((s,u)=>s.line-u.line)}function jo(c){return function(...s){return nh(c.apply(this,s))}}As.source=jo(Vo(ds)),As.sprite=jo(Vo(_g)),As.glyphs=jo(Vo(xg)),As.light=jo(Vo(Uc)),As.terrain=jo(Vo(yg)),As.layer=jo(Vo(gg)),As.filter=jo(Vo(Ml)),As.paintProperty=jo(Vo(pg)),As.layoutProperty=jo(Vo(mg));const $o=As,Hv=$o.light,uf=$o.paintProperty,bg=$o.layoutProperty;function rh(c,s){let u=!1;if(s&&s.length)for(const f of s)c.fire(new pt(new Error(f.message))),u=!0;return u}class kl{constructor(s,u,f){const g=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;const w=new Int32Array(this.arrayBuffer);s=w[0],this.d=(u=w[1])+2*(f=w[2]);for(let I=0;I<this.d*this.d;I++){const k=w[3+I],B=w[3+I+1];g.push(k===B?null:w.subarray(k,B))}const S=w[3+g.length+1];this.keys=w.subarray(w[3+g.length],S),this.bboxes=w.subarray(S),this.insert=this._insertReadonly}else{this.d=u+2*f;for(let w=0;w<this.d*this.d;w++)g.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=s,this.padding=f,this.scale=u/s,this.uid=0;const x=f/u*s;this.min=-x,this.max=s+x}insert(s,u,f,g,x){this._forEachCell(u,f,g,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(s),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(s,u,f,g,x,w){this.cells[x].push(w)}query(s,u,f,g,x){const w=this.min,S=this.max;if(s<=w&&u<=w&&S<=f&&S<=g&&!x)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(s,u,f,g,this._queryCell,I,{},x),I}}_queryCell(s,u,f,g,x,w,S,I){const k=this.cells[x];if(k!==null){const B=this.keys,j=this.bboxes;for(let H=0;H<k.length;H++){const Y=k[H];if(S[Y]===void 0){const ee=4*Y;(I?I(j[ee+0],j[ee+1],j[ee+2],j[ee+3]):s<=j[ee+2]&&u<=j[ee+3]&&f>=j[ee+0]&&g>=j[ee+1])?(S[Y]=!0,w.push(B[Y])):S[Y]=!1}}}}_forEachCell(s,u,f,g,x,w,S,I){const k=this._convertToCellCoord(s),B=this._convertToCellCoord(u),j=this._convertToCellCoord(f),H=this._convertToCellCoord(g);for(let Y=k;Y<=j;Y++)for(let ee=B;ee<=H;ee++){const le=this.d*ee+Y;if((!I||I(this._convertFromCellCoord(Y),this._convertFromCellCoord(ee),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(ee+1)))&&x.call(this,s,u,f,g,le,w,S,I))return}}_convertFromCellCoord(s){return(s-this.padding)/this.scale}_convertToCellCoord(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const s=this.cells,u=3+this.cells.length+1+1;let f=0;for(let w=0;w<this.cells.length;w++)f+=this.cells[w].length;const g=new Int32Array(u+f+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let x=u;for(let w=0;w<s.length;w++){const S=s[w];g[3+w]=x,g.set(S,x),x+=S.length}return g[3+s.length]=x,g.set(this.keys,x),x+=this.keys.length,g[3+s.length+1]=x,g.set(this.bboxes,x),x+=this.bboxes.length,g.buffer}static serialize(s,u){const f=s.toArrayBuffer();return u&&u.push(f),{buffer:f}}static deserialize(s){return new kl(s.buffer)}}const Go={};function kt(c,s,u={}){if(Go[c])throw new Error(`${c} is already registered.`);Object.defineProperty(s,"_classRegistryKey",{value:c,writeable:!1}),Go[c]={klass:s,omit:u.omit||[],shallow:u.shallow||[]}}kt("Object",Object),kt("TransferableGridIndex",kl),kt("Color",Cn),kt("Error",Error),kt("AJAXError",Je),kt("ResolvedImage",Zn),kt("StylePropertyFunction",Rc),kt("StyleExpression",sf,{omit:["_evaluator"]}),kt("ZoomDependentExpression",Ku),kt("ZoomConstantExpression",of),kt("CompoundExpression",Cs,{omit:["_evaluate"]});for(const c in Cl)Cl[c]._classRegistryKey||kt(`Expression_${c}`,Cl[c]);function ih(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function fa(c,s){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob)return c;if(ih(c)||Ge(c))return s&&s.push(c),c;if(ArrayBuffer.isView(c)){const u=c;return s&&s.push(u.buffer),u}if(c instanceof ImageData)return s&&s.push(c.data.buffer),c;if(Array.isArray(c)){const u=[];for(const f of c)u.push(fa(f,s));return u}if(typeof c=="object"){const u=c.constructor,f=u._classRegistryKey;if(!f)throw new Error("can't serialize object of unregistered class");if(!Go[f])throw new Error(`${f} is not registered.`);const g=u.serialize?u.serialize(c,s):{};if(u.serialize){if(s&&g===s[s.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in c){if(!c.hasOwnProperty(x)||Go[f].omit.indexOf(x)>=0)continue;const w=c[x];g[x]=Go[f].shallow.indexOf(x)>=0?w:fa(w,s)}c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(g.$name=f),g}throw new Error("can't serialize object of type "+typeof c)}function Ll(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||ih(c)||Ge(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(Ll);if(typeof c=="object"){const s=c.$name||"Object";if(!Go[s])throw new Error(`can't deserialize unregistered class ${s}`);const{klass:u}=Go[s];if(!u)throw new Error(`can't deserialize unregistered class ${s}`);if(u.deserialize)return u.deserialize(c);const f=Object.create(u.prototype);for(const g of Object.keys(c)){if(g==="$name")continue;const x=c[g];f[g]=Go[s].shallow.indexOf(g)>=0?x:Ll(x)}return f}throw new Error("can't deserialize object of type "+typeof c)}class wg{constructor(){this.first=!0}update(s,u){const f=Math.floor(s);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=s,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=u),s!==this.lastZoom&&(this.lastZoom=s,this.lastFloorZoom=f,!0))}}const Tt={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function hf(c){for(const s of c)if(ff(s.charCodeAt(0)))return!0;return!1}function df(c){for(const s of c)if(!qv(s.charCodeAt(0)))return!1;return!0}function qv(c){return!(Tt.Arabic(c)||Tt["Arabic Supplement"](c)||Tt["Arabic Extended-A"](c)||Tt["Arabic Presentation Forms-A"](c)||Tt["Arabic Presentation Forms-B"](c))}function ff(c){return!(c!==746&&c!==747&&(c<4352||!(Tt["Bopomofo Extended"](c)||Tt.Bopomofo(c)||Tt["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Tt["CJK Compatibility Ideographs"](c)||Tt["CJK Compatibility"](c)||Tt["CJK Radicals Supplement"](c)||Tt["CJK Strokes"](c)||!(!Tt["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Tt["CJK Unified Ideographs Extension A"](c)||Tt["CJK Unified Ideographs"](c)||Tt["Enclosed CJK Letters and Months"](c)||Tt["Hangul Compatibility Jamo"](c)||Tt["Hangul Jamo Extended-A"](c)||Tt["Hangul Jamo Extended-B"](c)||Tt["Hangul Jamo"](c)||Tt["Hangul Syllables"](c)||Tt.Hiragana(c)||Tt["Ideographic Description Characters"](c)||Tt.Kanbun(c)||Tt["Kangxi Radicals"](c)||Tt["Katakana Phonetic Extensions"](c)||Tt.Katakana(c)&&c!==12540||!(!Tt["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Tt["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Tt["Unified Canadian Aboriginal Syllabics"](c)||Tt["Unified Canadian Aboriginal Syllabics Extended"](c)||Tt["Vertical Forms"](c)||Tt["Yijing Hexagram Symbols"](c)||Tt["Yi Syllables"](c)||Tt["Yi Radicals"](c))))}function Eg(c){return!(ff(c)||function(s){return!!(Tt["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||Tt["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||Tt["Letterlike Symbols"](s)||Tt["Number Forms"](s)||Tt["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||Tt["Control Pictures"](s)&&s!==9251||Tt["Optical Character Recognition"](s)||Tt["Enclosed Alphanumerics"](s)||Tt["Geometric Shapes"](s)||Tt["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Tt["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Tt["CJK Symbols and Punctuation"](s)||Tt.Katakana(s)||Tt["Private Use Area"](s)||Tt["CJK Compatibility Forms"](s)||Tt["Small Form Variants"](s)||Tt["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(c))}function Tg(c){return c>=1424&&c<=2303||Tt["Arabic Presentation Forms-A"](c)||Tt["Arabic Presentation Forms-B"](c)}function Sg(c,s){return!(!s&&Tg(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Tt.Khmer(c))}function Zv(c){for(const s of c)if(Tg(s.charCodeAt(0)))return!0;return!1}const pf="deferred",mf="loading",gf="loaded";let yf=null,qi="unavailable",pa=null;const Vc=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(qi="error"),yf&&yf(c)};function _f(){jc.fire(new vn("pluginStateChange",{pluginStatus:qi,pluginURL:pa}))}const jc=new dn,vf=function(){return qi},Pg=function(){if(qi!==pf||!pa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qi=mf,_f(),pa&&$t({url:pa},c=>{c?Vc(c):(qi=gf,_f())})},fs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>qi===gf||fs.applyArabicShaping!=null,isLoading:()=>qi===mf,setState(c){if(!je())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");qi=c.pluginStatus,pa=c.pluginURL},isParsed(){if(!je())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return fs.applyArabicShaping!=null&&fs.processBidirectionalText!=null&&fs.processStyledBidirectionalText!=null},getPluginURL(){if(!je())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return pa}};class sr{constructor(s,u){this.zoom=s,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new wg,this.transition={})}isSupportedScript(s){return function(u,f){for(const g of u)if(!Sg(g.charCodeAt(0),f))return!1;return!0}(s,fs.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const s=this.zoom,u=s-Math.floor(s),f=this.crossFadingFactor();return s>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*u}}}class sh{constructor(s,u){this.property=s,this.value=u,this.expression=function(f,g){if(mr(f))return new Rc(f,g);if(Xu(f)){const x=af(f,g);if(x.result==="error")throw new Error(x.value.map(w=>`${w.key}: ${w.message}`).join(", "));return x.value}{let x=f;return g.type==="color"&&typeof f=="string"?x=Cn.parse(f):g.type!=="padding"||typeof f!="number"&&!Array.isArray(f)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(f)&&(x=hi.parse(f)):x=bi.parse(f),{kind:"constant",evaluate:()=>x}}}(u===void 0?s.specification.default:u,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,u,f){return this.property.possiblyEvaluate(this,s,u,f)}}class xf{constructor(s){this.property=s,this.value=new sh(s,void 0)}transitioned(s,u){return new Ag(this.property,this.value,u,re({},s.transition,this.transition),s.now)}untransitioned(){return new Ag(this.property,this.value,null,{},0)}}class Cg{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return Re(this._values[s].value.value)}setValue(s,u){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new xf(this._values[s].property)),this._values[s].value=new sh(this._values[s].property,u===null?void 0:Re(u))}getTransition(s){return Re(this._values[s].transition)}setTransition(s,u){Object.prototype.hasOwnProperty.call(this._values,s)||(this._values[s]=new xf(this._values[s].property)),this._values[s].transition=Re(u)||void 0}serialize(){const s={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(s[u]=f);const g=this.getTransition(u);g!==void 0&&(s[`${u}-transition`]=g)}return s}transitioned(s,u){const f=new Ig(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].transitioned(s,u._values[g]);return f}untransitioned(){const s=new Ig(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].untransitioned();return s}}class Ag{constructor(s,u,f,g,x){this.property=s,this.value=u,this.begin=x+g.delay||0,this.end=this.begin+g.duration||0,s.specification.transition&&(g.delay||g.duration)&&(this.prior=f)}possiblyEvaluate(s,u,f){const g=s.now||0,x=this.value.possiblyEvaluate(s,u,f),w=this.prior;if(w){if(g>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(g<this.begin)return w.possiblyEvaluate(s,u,f);{const S=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(s,u,f),x,function(I){if(I<=0)return 0;if(I>=1)return 1;const k=I*I,B=k*I;return 4*(I<.5?B:3*(I-k)+B-.75)}(S))}}return x}}class Ig{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,u,f){const g=new oh(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(s,u,f);return g}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Xv{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}hasValue(s){return this._values[s].value!==void 0}getValue(s){return Re(this._values[s].value)}setValue(s,u){this._values[s]=new sh(this._values[s].property,u===null?void 0:Re(u))}serialize(){const s={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(s[u]=f)}return s}possiblyEvaluate(s,u,f){const g=new oh(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(s,u,f);return g}}class Li{constructor(s,u,f){this.property=s,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,u,f,g){return this.property.evaluate(this.value,this.parameters,s,u,f,g)}}class oh{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Xt{constructor(s){this.specification=s}possiblyEvaluate(s,u){if(s.isDataDriven())throw new Error("Value should not be data driven");return s.expression.evaluate(u)}interpolate(s,u,f){const g=us[this.specification.type];return g?g(s,u,f):s}}class on{constructor(s,u){this.specification=s,this.overrides=u}possiblyEvaluate(s,u,f,g){return new Li(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(u,null,{},f,g)}:s.expression,u)}interpolate(s,u,f){if(s.value.kind!=="constant"||u.value.kind!=="constant")return s;if(s.value.value===void 0||u.value.value===void 0)return new Li(this,{kind:"constant",value:void 0},s.parameters);const g=us[this.specification.type];if(g){const x=g(s.value.value,u.value.value,f);return new Li(this,{kind:"constant",value:x},s.parameters)}return s}evaluate(s,u,f,g,x,w){return s.kind==="constant"?s.value:s.evaluate(u,f,g,x,w)}}class $c extends on{possiblyEvaluate(s,u,f,g){if(s.value===void 0)return new Li(this,{kind:"constant",value:void 0},u);if(s.expression.kind==="constant"){const x=s.expression.evaluate(u,null,{},f,g),w=s.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,S=this._calculate(w,w,w,u);return new Li(this,{kind:"constant",value:S},u)}if(s.expression.kind==="camera"){const x=this._calculate(s.expression.evaluate({zoom:u.zoom-1}),s.expression.evaluate({zoom:u.zoom}),s.expression.evaluate({zoom:u.zoom+1}),u);return new Li(this,{kind:"constant",value:x},u)}return new Li(this,s.expression,u)}evaluate(s,u,f,g,x,w){if(s.kind==="source"){const S=s.evaluate(u,f,g,x,w);return this._calculate(S,S,S,u)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(u.zoom)-1},f,g),s.evaluate({zoom:Math.floor(u.zoom)},f,g),s.evaluate({zoom:Math.floor(u.zoom)+1},f,g),u):s.value}_calculate(s,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:s,to:u}:{from:f,to:u}}interpolate(s){return s}}class bf{constructor(s){this.specification=s}possiblyEvaluate(s,u,f,g){if(s.value!==void 0){if(s.expression.kind==="constant"){const x=s.expression.evaluate(u,null,{},f,g);return this._calculate(x,x,x,u)}return this._calculate(s.expression.evaluate(new sr(Math.floor(u.zoom-1),u)),s.expression.evaluate(new sr(Math.floor(u.zoom),u)),s.expression.evaluate(new sr(Math.floor(u.zoom+1),u)),u)}}_calculate(s,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:s,to:u}:{from:f,to:u}}interpolate(s){return s}}class wf{constructor(s){this.specification=s}possiblyEvaluate(s,u,f,g){return!!s.expression.evaluate(u,null,{},f,g)}interpolate(){return!1}}class zr{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const u in s){const f=s[u];f.specification.overridable&&this.overridableProperties.push(u);const g=this.defaultPropertyValues[u]=new sh(f,void 0),x=this.defaultTransitionablePropertyValues[u]=new xf(f);this.defaultTransitioningPropertyValues[u]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=g.possiblyEvaluate({})}}}kt("DataDrivenProperty",on),kt("DataConstantProperty",Xt),kt("CrossFadedDataDrivenProperty",$c),kt("CrossFadedProperty",bf),kt("ColorRampProperty",wf);const Ef="-transition";class Is extends dn{constructor(s,u){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1},s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),u.layout&&(this._unevaluatedLayout=new Xv(u.layout)),u.paint)){this._transitionablePaint=new Cg(u.paint);for(const f in s.paint)this.setPaintProperty(f,s.paint[f],{validate:!1});for(const f in s.layout)this.setLayoutProperty(f,s.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new oh(u.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,u,f={}){u!=null&&this._validate(bg,`layers.${this.id}.layout.${s}`,s,u,f)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,u):this.visibility=u)}getPaintProperty(s){return s.endsWith(Ef)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,u,f={}){if(u!=null&&this._validate(uf,`layers.${this.id}.paint.${s}`,s,u,f))return!1;if(s.endsWith(Ef))return this._transitionablePaint.setTransition(s.slice(0,-11),u||void 0),!1;{const g=this._transitionablePaint._values[s],x=g.property.specification["property-type"]==="cross-faded-data-driven",w=g.value.isDataDriven(),S=g.value;this._transitionablePaint.setValue(s,u),this._handleSpecialPaintPropertyUpdate(s);const I=this._transitionablePaint._values[s].value;return I.isDataDriven()||w||x||this._handleOverridablePaintPropertyUpdate(s,S,I)}}_handleSpecialPaintPropertyUpdate(s){}_handleOverridablePaintPropertyUpdate(s,u,f){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,u){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,u)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),fe(s,(u,f)=>!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length))}_validate(s,u,f,g,x={}){return(!x||x.validate!==!1)&&rh(this,s.call($o,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:Ae,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const u=this.paint.get(s);if(u instanceof Li&&Al(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}}const Mg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class $a{constructor(s,u){this._structArray=s,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class wr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,u){return s._trim(),u&&(s.isTransferred=!0,u.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const u=Object.create(this.prototype);return u.arrayBuffer=s.arrayBuffer,u.length=s.length,u.capacity=s.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function yr(c,s=1){let u=0,f=0;return{members:c.map(g=>{const x=Mg[g.type].BYTES_PER_ELEMENT,w=u=Rl(u,Math.max(s,x)),S=g.components||1;return f=Math.max(f,x),u+=x*S,{name:g.name,type:g.type,components:S,offset:w}}),size:Rl(u,Math.max(f,s)),alignment:s}}function Rl(c,s){return Math.ceil(c/s)*s}class Gc extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.int16[g+0]=u,this.int16[g+1]=f,s}}Gc.prototype.bytesPerElement=4,kt("StructArrayLayout2i4",Gc);class Wc extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.int16[x+0]=u,this.int16[x+1]=f,this.int16[x+2]=g,s}}Wc.prototype.bytesPerElement=6,kt("StructArrayLayout3i6",Wc);class Ga extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=4*s;return this.int16[w+0]=u,this.int16[w+1]=f,this.int16[w+2]=g,this.int16[w+3]=x,s}}Ga.prototype.bytesPerElement=8,kt("StructArrayLayout4i8",Ga);class Tf extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const S=this.length;return this.resize(S+1),this.emplace(S,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,S){const I=6*s;return this.int16[I+0]=u,this.int16[I+1]=f,this.int16[I+2]=g,this.int16[I+3]=x,this.int16[I+4]=w,this.int16[I+5]=S,s}}Tf.prototype.bytesPerElement=12,kt("StructArrayLayout2i4i12",Tf);class Sf extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const S=this.length;return this.resize(S+1),this.emplace(S,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,S){const I=4*s,k=8*s;return this.int16[I+0]=u,this.int16[I+1]=f,this.uint8[k+4]=g,this.uint8[k+5]=x,this.uint8[k+6]=w,this.uint8[k+7]=S,s}}Sf.prototype.bytesPerElement=8,kt("StructArrayLayout2i4ub8",Sf);class Ol extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.float32[g+0]=u,this.float32[g+1]=f,s}}Ol.prototype.bytesPerElement=8,kt("StructArrayLayout2f8",Ol);class Pf extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,S,I,k,B){const j=this.length;return this.resize(j+1),this.emplace(j,s,u,f,g,x,w,S,I,k,B)}emplace(s,u,f,g,x,w,S,I,k,B,j){const H=10*s;return this.uint16[H+0]=u,this.uint16[H+1]=f,this.uint16[H+2]=g,this.uint16[H+3]=x,this.uint16[H+4]=w,this.uint16[H+5]=S,this.uint16[H+6]=I,this.uint16[H+7]=k,this.uint16[H+8]=B,this.uint16[H+9]=j,s}}Pf.prototype.bytesPerElement=20,kt("StructArrayLayout10ui20",Pf);class Cf extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,S,I,k,B,j,H){const Y=this.length;return this.resize(Y+1),this.emplace(Y,s,u,f,g,x,w,S,I,k,B,j,H)}emplace(s,u,f,g,x,w,S,I,k,B,j,H,Y){const ee=12*s;return this.int16[ee+0]=u,this.int16[ee+1]=f,this.int16[ee+2]=g,this.int16[ee+3]=x,this.uint16[ee+4]=w,this.uint16[ee+5]=S,this.uint16[ee+6]=I,this.uint16[ee+7]=k,this.int16[ee+8]=B,this.int16[ee+9]=j,this.int16[ee+10]=H,this.int16[ee+11]=Y,s}}Cf.prototype.bytesPerElement=24,kt("StructArrayLayout4i4ui4i24",Cf);class Gn extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.float32[x+0]=u,this.float32[x+1]=f,this.float32[x+2]=g,s}}Gn.prototype.bytesPerElement=12,kt("StructArrayLayout3f12",Gn);class v extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint32[1*s+0]=u,s}}v.prototype.bytesPerElement=4,kt("StructArrayLayout1ul4",v);class a extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,S,I,k){const B=this.length;return this.resize(B+1),this.emplace(B,s,u,f,g,x,w,S,I,k)}emplace(s,u,f,g,x,w,S,I,k,B){const j=10*s,H=5*s;return this.int16[j+0]=u,this.int16[j+1]=f,this.int16[j+2]=g,this.int16[j+3]=x,this.int16[j+4]=w,this.int16[j+5]=S,this.uint32[H+3]=I,this.uint16[j+8]=k,this.uint16[j+9]=B,s}}a.prototype.bytesPerElement=20,kt("StructArrayLayout6i1ul2ui20",a);class d extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w){const S=this.length;return this.resize(S+1),this.emplace(S,s,u,f,g,x,w)}emplace(s,u,f,g,x,w,S){const I=6*s;return this.int16[I+0]=u,this.int16[I+1]=f,this.int16[I+2]=g,this.int16[I+3]=x,this.int16[I+4]=w,this.int16[I+5]=S,s}}d.prototype.bytesPerElement=12,kt("StructArrayLayout2i2i2i12",d);class p extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x){const w=this.length;return this.resize(w+1),this.emplace(w,s,u,f,g,x)}emplace(s,u,f,g,x,w){const S=4*s,I=8*s;return this.float32[S+0]=u,this.float32[S+1]=f,this.float32[S+2]=g,this.int16[I+6]=x,this.int16[I+7]=w,s}}p.prototype.bytesPerElement=16,kt("StructArrayLayout2f1f2i16",p);class y extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=12*s,S=3*s;return this.uint8[w+0]=u,this.uint8[w+1]=f,this.float32[S+1]=g,this.float32[S+2]=x,s}}y.prototype.bytesPerElement=12,kt("StructArrayLayout2ub2f12",y);class b extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.uint16[x+0]=u,this.uint16[x+1]=f,this.uint16[x+2]=g,s}}b.prototype.bytesPerElement=6,kt("StructArrayLayout3ui6",b);class P extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,S,I,k,B,j,H,Y,ee,le,me,_e){const Me=this.length;return this.resize(Me+1),this.emplace(Me,s,u,f,g,x,w,S,I,k,B,j,H,Y,ee,le,me,_e)}emplace(s,u,f,g,x,w,S,I,k,B,j,H,Y,ee,le,me,_e,Me){const Ee=24*s,Le=12*s,De=48*s;return this.int16[Ee+0]=u,this.int16[Ee+1]=f,this.uint16[Ee+2]=g,this.uint16[Ee+3]=x,this.uint32[Le+2]=w,this.uint32[Le+3]=S,this.uint32[Le+4]=I,this.uint16[Ee+10]=k,this.uint16[Ee+11]=B,this.uint16[Ee+12]=j,this.float32[Le+7]=H,this.float32[Le+8]=Y,this.uint8[De+36]=ee,this.uint8[De+37]=le,this.uint8[De+38]=me,this.uint32[Le+10]=_e,this.int16[Ee+22]=Me,s}}P.prototype.bytesPerElement=48,kt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",P);class C extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g,x,w,S,I,k,B,j,H,Y,ee,le,me,_e,Me,Ee,Le,De,Xe,St,jt,wt,_t,lt,zt){const ft=this.length;return this.resize(ft+1),this.emplace(ft,s,u,f,g,x,w,S,I,k,B,j,H,Y,ee,le,me,_e,Me,Ee,Le,De,Xe,St,jt,wt,_t,lt,zt)}emplace(s,u,f,g,x,w,S,I,k,B,j,H,Y,ee,le,me,_e,Me,Ee,Le,De,Xe,St,jt,wt,_t,lt,zt,ft){const rt=32*s,tn=16*s;return this.int16[rt+0]=u,this.int16[rt+1]=f,this.int16[rt+2]=g,this.int16[rt+3]=x,this.int16[rt+4]=w,this.int16[rt+5]=S,this.int16[rt+6]=I,this.int16[rt+7]=k,this.uint16[rt+8]=B,this.uint16[rt+9]=j,this.uint16[rt+10]=H,this.uint16[rt+11]=Y,this.uint16[rt+12]=ee,this.uint16[rt+13]=le,this.uint16[rt+14]=me,this.uint16[rt+15]=_e,this.uint16[rt+16]=Me,this.uint16[rt+17]=Ee,this.uint16[rt+18]=Le,this.uint16[rt+19]=De,this.uint16[rt+20]=Xe,this.uint16[rt+21]=St,this.uint16[rt+22]=jt,this.uint32[tn+12]=wt,this.float32[tn+13]=_t,this.float32[tn+14]=lt,this.uint16[rt+30]=zt,this.uint16[rt+31]=ft,s}}C.prototype.bytesPerElement=64,kt("StructArrayLayout8i15ui1ul2f2ui64",C);class M extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.float32[1*s+0]=u,s}}M.prototype.bytesPerElement=4,kt("StructArrayLayout1f4",M);class O extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=3*s;return this.uint16[6*s+0]=u,this.float32[x+1]=f,this.float32[x+2]=g,s}}O.prototype.bytesPerElement=12,kt("StructArrayLayout1ui2f12",O);class U extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,s,u,f)}emplace(s,u,f,g){const x=4*s;return this.uint32[2*s+0]=u,this.uint16[x+2]=f,this.uint16[x+3]=g,s}}U.prototype.bytesPerElement=8,kt("StructArrayLayout1ul2ui8",U);class V extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u){const f=this.length;return this.resize(f+1),this.emplace(f,s,u)}emplace(s,u,f){const g=2*s;return this.uint16[g+0]=u,this.uint16[g+1]=f,s}}V.prototype.bytesPerElement=4,kt("StructArrayLayout2ui4",V);class X extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint16[1*s+0]=u,s}}X.prototype.bytesPerElement=2,kt("StructArrayLayout1ui2",X);class he extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,f,g){const x=this.length;return this.resize(x+1),this.emplace(x,s,u,f,g)}emplace(s,u,f,g,x){const w=4*s;return this.float32[w+0]=u,this.float32[w+1]=f,this.float32[w+2]=g,this.float32[w+3]=x,s}}he.prototype.bytesPerElement=16,kt("StructArrayLayout4f16",he);class ce extends $a{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new T(this.anchorPointX,this.anchorPointY)}}ce.prototype.size=20;class pe extends a{get(s){return new ce(this,s)}}kt("CollisionBoxArray",pe);class ae extends $a{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(s){this._structArray.uint8[this._pos1+37]=s}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(s){this._structArray.uint8[this._pos1+38]=s}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(s){this._structArray.uint32[this._pos4+10]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ae.prototype.size=48;class Pe extends P{get(s){return new ae(this,s)}}kt("PlacedSymbolArray",Pe);class Oe extends $a{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(s){this._structArray.uint32[this._pos4+12]=s}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Oe.prototype.size=64;class ge extends C{get(s){return new Oe(this,s)}}kt("SymbolInstanceArray",ge);class Ie extends M{getoffsetX(s){return this.float32[1*s+0]}}kt("GlyphOffsetArray",Ie);class Ne extends Wc{getx(s){return this.int16[3*s+0]}gety(s){return this.int16[3*s+1]}gettileUnitDistanceFromAnchor(s){return this.int16[3*s+2]}}kt("SymbolLineVertexArray",Ne);class Ue extends $a{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ue.prototype.size=12;class Ze extends O{get(s){return new Ue(this,s)}}kt("TextAnchorOffsetArray",Ze);class et extends $a{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}et.prototype.size=8;class Ke extends U{get(s){return new et(this,s)}}kt("FeatureIndexArray",Ke);class at extends Gc{}class Vt extends Gc{}class An extends Gc{}class yt extends Tf{}class an extends Sf{}class Gt extends Ol{}class Hn extends Pf{}class Pn extends Cf{}class _n extends Gn{}class In extends v{}class Mr extends d{}class tr extends y{}class fi extends b{}class Qr extends V{}const Dr=yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:ps}=Dr;class or{constructor(s=[]){this.segments=s}prepareSegment(s,u,f,g){let x=this.segments[this.segments.length-1];return s>or.MAX_VERTEX_ARRAY_LENGTH&&Fe(`Max vertices per segment is ${or.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!x||x.vertexLength+s>or.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==g)&&(x={vertexOffset:u.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},g!==void 0&&(x.sortKey=g),this.segments.push(x)),x}get(){return this.segments}destroy(){for(const s of this.segments)for(const u in s.vaos)s.vaos[u].destroy()}static simpleSegment(s,u,f,g){return new or([{vertexOffset:s,primitiveOffset:u,vertexLength:f,primitiveLength:g,vaos:{},sortKey:0}])}}function yo(c,s){return 256*(c=K(Math.floor(c),0,255))+K(Math.floor(s),0,255)}or.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,kt("SegmentVector",or);const _o=yr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ma={exports:{}},Wa={exports:{}};Wa.exports=function(c,s){var u,f,g,x,w,S,I,k;for(f=c.length-(u=3&c.length),g=s,w=3432918353,S=461845907,k=0;k<f;)I=255&c.charCodeAt(k)|(255&c.charCodeAt(++k))<<8|(255&c.charCodeAt(++k))<<16|(255&c.charCodeAt(++k))<<24,++k,g=27492+(65535&(x=5*(65535&(g=(g^=I=(65535&(I=(I=(65535&I)*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*S+(((I>>>16)*S&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(I=0,u){case 3:I^=(255&c.charCodeAt(k+2))<<16;case 2:I^=(255&c.charCodeAt(k+1))<<8;case 1:g^=I=(65535&(I=(I=(65535&(I^=255&c.charCodeAt(k)))*w+(((I>>>16)*w&65535)<<16)&4294967295)<<15|I>>>17))*S+(((I>>>16)*S&65535)<<16)&4294967295}return g^=c.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var zl=Wa.exports,wi={exports:{}};wi.exports=function(c,s){for(var u,f=c.length,g=s^f,x=0;f>=4;)u=1540483477*(65535&(u=255&c.charCodeAt(x)|(255&c.charCodeAt(++x))<<8|(255&c.charCodeAt(++x))<<16|(255&c.charCodeAt(++x))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++x;switch(f){case 3:g^=(255&c.charCodeAt(x+2))<<16;case 2:g^=(255&c.charCodeAt(x+1))<<8;case 1:g=1540483477*(65535&(g^=255&c.charCodeAt(x)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var pi=zl,Ri=wi.exports;ma.exports=pi,ma.exports.murmur3=pi,ma.exports.murmur2=Ri;var Ha=m(ma.exports);class kr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,u,f,g){this.ids.push(ei(s)),this.positions.push(u,f,g)}getPositions(s){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const u=ei(s);let f=0,g=this.ids.length-1;for(;f<g;){const w=f+g>>1;this.ids[w]>=u?g=w:f=w+1}const x=[];for(;this.ids[f]===u;)x.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return x}static serialize(s,u){const f=new Float64Array(s.ids),g=new Uint32Array(s.positions);return Zi(f,g,0,f.length-1),u&&u.push(f.buffer,g.buffer),{ids:f,positions:g}}static deserialize(s){const u=new kr;return u.ids=s.ids,u.positions=s.positions,u.indexed=!0,u}}function ei(c){const s=+c;return!isNaN(s)&&s<=Number.MAX_SAFE_INTEGER?s:Ha(String(c))}function Zi(c,s,u,f){for(;u<f;){const g=c[u+f>>1];let x=u-1,w=f+1;for(;;){do x++;while(c[x]<g);do w--;while(c[w]>g);if(x>=w)break;Lr(c,x,w),Lr(s,3*x,3*w),Lr(s,3*x+1,3*w+1),Lr(s,3*x+2,3*w+2)}w-u<f-w?(Zi(c,s,u,w),u=w+1):(Zi(c,s,w+1,f),f=w)}}function Lr(c,s,u){const f=c[s];c[s]=c[u],c[u]=f}kt("FeaturePositionMap",kr);class qa{constructor(s,u){this.gl=s.gl,this.location=u}}class ah extends qa{constructor(s,u){super(s,u),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class kg extends qa{constructor(s,u){super(s,u),this.current=[0,0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))}}class Lg extends qa{constructor(s,u){super(s,u),this.current=Cn.transparent}set(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))}}const Yv=new Float32Array(16);function Af(c){return[yo(255*c.r,255*c.g),yo(255*c.b,255*c.a)]}class vo{constructor(s,u,f){this.value=s,this.uniformNames=u.map(g=>`u_${g}`),this.type=f}setUniform(s,u,f){s.set(f.constantOr(this.value))}getBinding(s,u,f){return this.type==="color"?new Lg(s,u):new ah(s,u)}}class Za{constructor(s,u){this.uniformNames=u.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(s,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=s.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=s.tlbr}setUniform(s,u,f,g){const x=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&s.set(x)}getBinding(s,u,f){return f.substr(0,9)==="u_pattern"?new kg(s,u):new ah(s,u)}}class xo{constructor(s,u,f,g){this.expression=s,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(x=>({name:`a_${x}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(s,u,f,g,x){const w=this.paintVertexArray.length,S=this.expression.evaluate(new sr(0),u,{},g,[],x);this.paintVertexArray.resize(s),this._setPaintValue(w,s,S)}updatePaintArray(s,u,f,g){const x=this.expression.evaluate({zoom:0},f,g);this._setPaintValue(s,u,x)}_setPaintValue(s,u,f){if(this.type==="color"){const g=Af(f);for(let x=s;x<u;x++)this.paintVertexArray.emplace(x,g[0],g[1])}else{for(let g=s;g<u;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ms{constructor(s,u,f,g,x,w){this.expression=s,this.uniformNames=u.map(S=>`u_${S}_t`),this.type=f,this.useIntegerZoom=g,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=u.map(S=>({name:`a_${S}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(s,u,f,g,x){const w=this.expression.evaluate(new sr(this.zoom),u,{},g,[],x),S=this.expression.evaluate(new sr(this.zoom+1),u,{},g,[],x),I=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(I,s,w,S)}updatePaintArray(s,u,f,g){const x=this.expression.evaluate({zoom:this.zoom},f,g),w=this.expression.evaluate({zoom:this.zoom+1},f,g);this._setPaintValue(s,u,x,w)}_setPaintValue(s,u,f,g){if(this.type==="color"){const x=Af(f),w=Af(g);for(let S=s;S<u;S++)this.paintVertexArray.emplace(S,x[0],x[1],w[0],w[1])}else{for(let x=s;x<u;x++)this.paintVertexArray.emplace(x,f,g);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(g))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,u){const f=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,g=K(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);s.set(g)}getBinding(s,u,f){return new ah(s,u)}}class bo{constructor(s,u,f,g,x,w){this.expression=s,this.type=u,this.useIntegerZoom=f,this.zoom=g,this.layerId=w,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(s,u,f){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(s),this.zoomOutPaintVertexArray.resize(s),this._setPaintValues(g,s,u.patterns&&u.patterns[this.layerId],f)}updatePaintArray(s,u,f,g,x){this._setPaintValues(s,u,f.patterns&&f.patterns[this.layerId],x)}_setPaintValues(s,u,f,g){if(!g||!f)return;const{min:x,mid:w,max:S}=f,I=g[x],k=g[w],B=g[S];if(I&&k&&B)for(let j=s;j<u;j++)this.zoomInPaintVertexArray.emplace(j,k.tl[0],k.tl[1],k.br[0],k.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],k.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(j,k.tl[0],k.tl[1],k.br[0],k.br[1],B.tl[0],B.tl[1],B.br[0],B.br[1],k.pixelRatio,B.pixelRatio)}upload(s){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=s.createVertexBuffer(this.zoomInPaintVertexArray,_o.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=s.createVertexBuffer(this.zoomOutPaintVertexArray,_o.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class If{constructor(s,u,f){this.binders={},this._buffers=[];const g=[];for(const x in s.paint._values){if(!f(x))continue;const w=s.paint.get(x);if(!(w instanceof Li&&Al(w.property.specification)))continue;const S=Jz(x,s.type),I=w.value,k=w.property.specification.type,B=w.property.useIntegerZoom,j=w.property.specification["property-type"],H=j==="cross-faded"||j==="cross-faded-data-driven";if(I.kind==="constant")this.binders[x]=H?new Za(I.value,S):new vo(I.value,S,k),g.push(`/u_${x}`);else if(I.kind==="source"||H){const Y=SS(x,k,"source");this.binders[x]=H?new bo(I,k,B,u,Y,s.id):new xo(I,S,k,Y),g.push(`/a_${x}`)}else{const Y=SS(x,k,"composite");this.binders[x]=new Ms(I,S,k,B,u,Y),g.push(`/z_${x}`)}}this.cacheKey=g.sort().join("")}getMaxValue(s){const u=this.binders[s];return u instanceof xo||u instanceof Ms?u.maxValue:0}populatePaintArrays(s,u,f,g,x){for(const w in this.binders){const S=this.binders[w];(S instanceof xo||S instanceof Ms||S instanceof bo)&&S.populatePaintArray(s,u,f,g,x)}}setConstantPatternPositions(s,u){for(const f in this.binders){const g=this.binders[f];g instanceof Za&&g.setConstantPatternPositions(s,u)}}updatePaintArrays(s,u,f,g,x){let w=!1;for(const S in s){const I=u.getPositions(S);for(const k of I){const B=f.feature(k.index);for(const j in this.binders){const H=this.binders[j];if((H instanceof xo||H instanceof Ms||H instanceof bo)&&H.expression.isStateDependent===!0){const Y=g.paint.get(j);H.expression=Y.value,H.updatePaintArray(k.start,k.end,B,s[S],x),w=!0}}}}return w}defines(){const s=[];for(const u in this.binders){const f=this.binders[u];(f instanceof vo||f instanceof Za)&&s.push(...f.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return s}getBinderAttributes(){const s=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof xo||f instanceof Ms)for(let g=0;g<f.paintVertexAttributes.length;g++)s.push(f.paintVertexAttributes[g].name);else if(f instanceof bo)for(let g=0;g<_o.members.length;g++)s.push(_o.members[g].name)}return s}getBinderUniforms(){const s=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof vo||f instanceof Za||f instanceof Ms)for(const g of f.uniformNames)s.push(g)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s,u){const f=[];for(const g in this.binders){const x=this.binders[g];if(x instanceof vo||x instanceof Za||x instanceof Ms){for(const w of x.uniformNames)if(u[w]){const S=x.getBinding(s,u[w],w);f.push({name:w,property:g,binding:S})}}}return f}setUniforms(s,u,f,g){for(const{name:x,property:w,binding:S}of u)this.binders[w].setUniform(S,g,f.get(w),x)}updatePaintBuffers(s){this._buffers=[];for(const u in this.binders){const f=this.binders[u];if(s&&f instanceof bo){const g=s.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(f instanceof xo||f instanceof Ms)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(s){for(const u in this.binders){const f=this.binders[u];(f instanceof xo||f instanceof Ms||f instanceof bo)&&f.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const u=this.binders[s];(u instanceof xo||u instanceof Ms||u instanceof bo)&&u.destroy()}}}class Wo{constructor(s,u,f=()=>!0){this.programConfigurations={};for(const g of s)this.programConfigurations[g.id]=new If(g,u,f);this.needsUpload=!1,this._featureMap=new kr,this._bufferOffset=0}populatePaintArrays(s,u,f,g,x,w){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(s,u,g,x,w);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,u,f,g){for(const x of f)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(s,this._featureMap,u,x,g)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}function Jz(c,s){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${s}-`,"").replace(/-/g,"_")]}function SS(c,s,u){const f={color:{source:Ol,composite:he},number:{source:M,composite:Ol}},g=function(x){return{"line-pattern":{source:Hn,composite:Hn},"fill-pattern":{source:Hn,composite:Hn},"fill-extrusion-pattern":{source:Hn,composite:Hn}}[x]}(c);return g&&g[u]||f[s][u]}kt("ConstantBinder",vo),kt("CrossFadedConstantBinder",Za),kt("SourceExpressionBinder",xo),kt("CrossFadedCompositeBinder",bo),kt("CompositeExpressionBinder",Ms),kt("ProgramConfiguration",If,{omit:["_buffers"]}),kt("ProgramConfigurationSet",Wo);const $r=8192,Kv=Math.pow(2,14)-1,PS=-Kv-1;function Hc(c){const s=$r/c.extent,u=c.loadGeometry();for(let f=0;f<u.length;f++){const g=u[f];for(let x=0;x<g.length;x++){const w=g[x],S=Math.round(w.x*s),I=Math.round(w.y*s);w.x=K(S,PS,Kv),w.y=K(I,PS,Kv),(S<w.x||S>w.x+1||I<w.y||I>w.y+1)&&Fe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return u}function qc(c,s){return{type:c.type,id:c.id,properties:c.properties,geometry:s?Hc(c):[]}}function Rg(c,s,u,f,g){c.emplaceBack(2*s+(f+1)/2,2*u+(g+1)/2)}class Jv{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new Vt,this.indexArray=new fi,this.segments=new or,this.programConfigurations=new Wo(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){const g=this.layers[0],x=[];let w=null,S=!1;g.type==="circle"&&(w=g.layout.get("circle-sort-key"),S=!w.isConstant());for(const{feature:I,id:k,index:B,sourceLayerIndex:j}of s){const H=this.layers[0]._featureFilter.needGeometry,Y=qc(I,H);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),Y,f))continue;const ee=S?w.evaluate(Y,{},f):void 0,le={id:k,properties:I.properties,type:I.type,sourceLayerIndex:j,index:B,geometry:H?Y.geometry:Hc(I),patterns:{},sortKey:ee};x.push(le)}S&&x.sort((I,k)=>I.sortKey-k.sortKey);for(const I of x){const{geometry:k,index:B,sourceLayerIndex:j}=I,H=s[B].feature;this.addFeature(I,k,B,f),u.featureIndex.insert(H,k,B,j,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ps),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,u,f,g){for(const x of u)for(const w of x){const S=w.x,I=w.y;if(S<0||S>=$r||I<0||I>=$r)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),B=k.vertexLength;Rg(this.layoutVertexArray,S,I,-1,-1),Rg(this.layoutVertexArray,S,I,1,-1),Rg(this.layoutVertexArray,S,I,1,1),Rg(this.layoutVertexArray,S,I,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+3,B+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,{},g)}}function CS(c,s){for(let u=0;u<c.length;u++)if(lh(s,c[u]))return!0;for(let u=0;u<s.length;u++)if(lh(c,s[u]))return!0;return!!Qv(c,s)}function Qz(c,s,u){return!!lh(c,s)||!!ex(s,c,u)}function AS(c,s){if(c.length===1)return MS(s,c[0]);for(let u=0;u<s.length;u++){const f=s[u];for(let g=0;g<f.length;g++)if(lh(c,f[g]))return!0}for(let u=0;u<c.length;u++)if(MS(s,c[u]))return!0;for(let u=0;u<s.length;u++)if(Qv(c,s[u]))return!0;return!1}function eD(c,s,u){if(c.length>1){if(Qv(c,s))return!0;for(let f=0;f<s.length;f++)if(ex(s[f],c,u))return!0}for(let f=0;f<c.length;f++)if(ex(c[f],s,u))return!0;return!1}function Qv(c,s){if(c.length===0||s.length===0)return!1;for(let u=0;u<c.length-1;u++){const f=c[u],g=c[u+1];for(let x=0;x<s.length-1;x++)if(tD(f,g,s[x],s[x+1]))return!0}return!1}function tD(c,s,u,f){return ze(c,u,f)!==ze(s,u,f)&&ze(c,s,u)!==ze(c,s,f)}function ex(c,s,u){const f=u*u;if(s.length===1)return c.distSqr(s[0])<f;for(let g=1;g<s.length;g++)if(IS(c,s[g-1],s[g])<f)return!0;return!1}function IS(c,s,u){const f=s.distSqr(u);if(f===0)return c.distSqr(s);const g=((c.x-s.x)*(u.x-s.x)+(c.y-s.y)*(u.y-s.y))/f;return c.distSqr(g<0?s:g>1?u:u.sub(s)._mult(g)._add(s))}function MS(c,s){let u,f,g,x=!1;for(let w=0;w<c.length;w++){u=c[w];for(let S=0,I=u.length-1;S<u.length;I=S++)f=u[S],g=u[I],f.y>s.y!=g.y>s.y&&s.x<(g.x-f.x)*(s.y-f.y)/(g.y-f.y)+f.x&&(x=!x)}return x}function lh(c,s){let u=!1;for(let f=0,g=c.length-1;f<c.length;g=f++){const x=c[f],w=c[g];x.y>s.y!=w.y>s.y&&s.x<(w.x-x.x)*(s.y-x.y)/(w.y-x.y)+x.x&&(u=!u)}return u}function nD(c,s,u){const f=u[0],g=u[2];if(c.x<f.x&&s.x<f.x||c.x>g.x&&s.x>g.x||c.y<f.y&&s.y<f.y||c.y>g.y&&s.y>g.y)return!1;const x=ze(c,s,u[0]);return x!==ze(c,s,u[1])||x!==ze(c,s,u[2])||x!==ze(c,s,u[3])}function Mf(c,s,u){const f=s.paint.get(c).value;return f.kind==="constant"?f.value:u.programConfigurations.get(s.id).getMaxValue(c)}function Og(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function zg(c,s,u,f,g){if(!s[0]&&!s[1])return c;const x=T.convert(s)._mult(g);u==="viewport"&&x._rotate(-f);const w=[];for(let S=0;S<c.length;S++)w.push(c[S].sub(x));return w}let kS,LS;kt("CircleBucket",Jv,{omit:["layers"]});var rD={get paint(){return LS=LS||new zr({"circle-radius":new on(Ae.paint_circle["circle-radius"]),"circle-color":new on(Ae.paint_circle["circle-color"]),"circle-blur":new on(Ae.paint_circle["circle-blur"]),"circle-opacity":new on(Ae.paint_circle["circle-opacity"]),"circle-translate":new Xt(Ae.paint_circle["circle-translate"]),"circle-translate-anchor":new Xt(Ae.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xt(Ae.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xt(Ae.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new on(Ae.paint_circle["circle-stroke-width"]),"circle-stroke-color":new on(Ae.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new on(Ae.paint_circle["circle-stroke-opacity"])})},get layout(){return kS=kS||new zr({"circle-sort-key":new on(Ae.layout_circle["circle-sort-key"])})}},Xi=1e-6,ch=typeof Float32Array<"u"?Float32Array:Array;function tx(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function RS(c,s,u){var f=s[0],g=s[1],x=s[2],w=s[3],S=s[4],I=s[5],k=s[6],B=s[7],j=s[8],H=s[9],Y=s[10],ee=s[11],le=s[12],me=s[13],_e=s[14],Me=s[15],Ee=u[0],Le=u[1],De=u[2],Xe=u[3];return c[0]=Ee*f+Le*S+De*j+Xe*le,c[1]=Ee*g+Le*I+De*H+Xe*me,c[2]=Ee*x+Le*k+De*Y+Xe*_e,c[3]=Ee*w+Le*B+De*ee+Xe*Me,c[4]=(Ee=u[4])*f+(Le=u[5])*S+(De=u[6])*j+(Xe=u[7])*le,c[5]=Ee*g+Le*I+De*H+Xe*me,c[6]=Ee*x+Le*k+De*Y+Xe*_e,c[7]=Ee*w+Le*B+De*ee+Xe*Me,c[8]=(Ee=u[8])*f+(Le=u[9])*S+(De=u[10])*j+(Xe=u[11])*le,c[9]=Ee*g+Le*I+De*H+Xe*me,c[10]=Ee*x+Le*k+De*Y+Xe*_e,c[11]=Ee*w+Le*B+De*ee+Xe*Me,c[12]=(Ee=u[12])*f+(Le=u[13])*S+(De=u[14])*j+(Xe=u[15])*le,c[13]=Ee*g+Le*I+De*H+Xe*me,c[14]=Ee*x+Le*k+De*Y+Xe*_e,c[15]=Ee*w+Le*B+De*ee+Xe*Me,c}Math.hypot||(Math.hypot=function(){for(var c=0,s=arguments.length;s--;)c+=arguments[s]*arguments[s];return Math.sqrt(c)});var kf,iD=RS;function Dg(c,s,u){var f=s[0],g=s[1],x=s[2],w=s[3];return c[0]=u[0]*f+u[4]*g+u[8]*x+u[12]*w,c[1]=u[1]*f+u[5]*g+u[9]*x+u[13]*w,c[2]=u[2]*f+u[6]*g+u[10]*x+u[14]*w,c[3]=u[3]*f+u[7]*g+u[11]*x+u[15]*w,c}kf=new ch(4),ch!=Float32Array&&(kf[0]=0,kf[1]=0,kf[2]=0,kf[3]=0);class sD extends Is{constructor(s){super(s,rD)}createBucket(s){return new Jv(s)}queryRadius(s){const u=s;return Mf("circle-radius",this,u)+Mf("circle-stroke-width",this,u)+Og(this.paint.get("circle-translate"))}queryIntersectsFeature(s,u,f,g,x,w,S,I){const k=zg(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,S),B=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),j=this.paint.get("circle-pitch-alignment")==="map",H=j?k:function(ee,le){return ee.map(me=>OS(me,le))}(k,I),Y=j?B*S:B;for(const ee of g)for(const le of ee){const me=j?le:OS(le,I);let _e=Y;const Me=Dg([],[le.x,le.y,0,1],I);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?_e*=Me[3]/w.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(_e*=w.cameraToCenterDistance/Me[3]),Qz(H,me,_e))return!0}return!1}}function OS(c,s){const u=Dg([],[c.x,c.y,0,1],s);return new T(u[0]/u[3],u[1]/u[3])}class zS extends Jv{}let DS;kt("HeatmapBucket",zS,{omit:["layers"]});var oD={get paint(){return DS=DS||new zr({"heatmap-radius":new on(Ae.paint_heatmap["heatmap-radius"]),"heatmap-weight":new on(Ae.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xt(Ae.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wf(Ae.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xt(Ae.paint_heatmap["heatmap-opacity"])})}};function nx(c,{width:s,height:u},f,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==s*u*f)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${s*u*f}`)}else g=new Uint8Array(s*u*f);return c.width=s,c.height=u,c.data=g,c}function FS(c,{width:s,height:u},f){if(s===c.width&&u===c.height)return;const g=nx({},{width:s,height:u},f);rx(c,g,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,s),height:Math.min(c.height,u)},f),c.width=s,c.height=u,c.data=g.data}function rx(c,s,u,f,g,x){if(g.width===0||g.height===0)return s;if(g.width>c.width||g.height>c.height||u.x>c.width-g.width||u.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>s.width||g.height>s.height||f.x>s.width-g.width||f.y>s.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const w=c.data,S=s.data;if(w===S)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<g.height;I++){const k=((u.y+I)*c.width+u.x)*x,B=((f.y+I)*s.width+f.x)*x;for(let j=0;j<g.width*x;j++)S[B+j]=w[k+j]}return s}class Lf{constructor(s,u){nx(this,s,1,u)}resize(s){FS(this,s,1)}clone(){return new Lf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,f,g,x){rx(s,u,f,g,x,1)}}class $s{constructor(s,u){nx(this,s,4,u)}resize(s){FS(this,s,4)}replace(s,u){u?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new $s({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,f,g,x){rx(s,u,f,g,x,4)}}function NS(c){const s={},u=c.resolution||256,f=c.clips?c.clips.length:1,g=c.image||new $s({width:u,height:f});if(Math.log(u)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${u}`);const x=(w,S,I)=>{s[c.evaluationKey]=I;const k=c.expression.evaluate(s);g.data[w+S+0]=Math.floor(255*k.r/k.a),g.data[w+S+1]=Math.floor(255*k.g/k.a),g.data[w+S+2]=Math.floor(255*k.b/k.a),g.data[w+S+3]=Math.floor(255*k.a)};if(c.clips)for(let w=0,S=0;w<f;++w,S+=4*u)for(let I=0,k=0;I<u;I++,k+=4){const B=I/(u-1),{start:j,end:H}=c.clips[w];x(S,k,j*(1-B)+H*B)}else for(let w=0,S=0;w<u;w++,S+=4)x(0,S,w/(u-1));return g}kt("AlphaImage",Lf),kt("RGBAImage",$s);class aD extends Is{createBucket(s){return new zS(s)}constructor(s){super(s,oD),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=NS({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let BS;var lD={get paint(){return BS=BS||new zr({"hillshade-illumination-direction":new Xt(Ae.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xt(Ae.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xt(Ae.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xt(Ae.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xt(Ae.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xt(Ae.paint_hillshade["hillshade-accent-color"])})}};class cD extends Is{constructor(s){super(s,lD)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const uD=yr([{name:"a_pos",components:2,type:"Int16"}],4),{members:hD}=uD;var ix={exports:{}};function Fg(c,s,u){u=u||2;var f,g,x,w,S,I,k,B=s&&s.length,j=B?s[0]*u:c.length,H=US(c,0,j,u,!0),Y=[];if(!H||H.next===H.prev)return Y;if(B&&(H=function(le,me,_e,Me){var Ee,Le,De,Xe=[];for(Ee=0,Le=me.length;Ee<Le;Ee++)(De=US(le,me[Ee]*Me,Ee<Le-1?me[Ee+1]*Me:le.length,Me,!1))===De.next&&(De.steiner=!0),Xe.push(vD(De));for(Xe.sort(gD),Ee=0;Ee<Xe.length;Ee++)_e=yD(Xe[Ee],_e);return _e}(c,s,H,u)),c.length>80*u){f=x=c[0],g=w=c[1];for(var ee=u;ee<j;ee+=u)(S=c[ee])<f&&(f=S),(I=c[ee+1])<g&&(g=I),S>x&&(x=S),I>w&&(w=I);k=(k=Math.max(x-f,w-g))!==0?32767/k:0}return Rf(H,Y,u,f,g,k,0),Y}function US(c,s,u,f,g){var x,w;if(g===ax(c,s,u,f)>0)for(x=s;x<u;x+=f)w=$S(x,c[x],c[x+1],w);else for(x=u-f;x>=s;x-=f)w=$S(x,c[x],c[x+1],w);return w&&Ng(w,w.next)&&(zf(w),w=w.next),w}function Zc(c,s){if(!c)return c;s||(s=c);var u,f=c;do if(u=!1,f.steiner||!Ng(f,f.next)&&Fr(f.prev,f,f.next)!==0)f=f.next;else{if(zf(f),(f=s=f.prev)===f.next)break;u=!0}while(u||f!==s);return s}function Rf(c,s,u,f,g,x,w){if(c){!w&&x&&function(B,j,H,Y){var ee=B;do ee.z===0&&(ee.z=sx(ee.x,ee.y,j,H,Y)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next;while(ee!==B);ee.prevZ.nextZ=null,ee.prevZ=null,function(le){var me,_e,Me,Ee,Le,De,Xe,St,jt=1;do{for(_e=le,le=null,Le=null,De=0;_e;){for(De++,Me=_e,Xe=0,me=0;me<jt&&(Xe++,Me=Me.nextZ);me++);for(St=jt;Xe>0||St>0&&Me;)Xe!==0&&(St===0||!Me||_e.z<=Me.z)?(Ee=_e,_e=_e.nextZ,Xe--):(Ee=Me,Me=Me.nextZ,St--),Le?Le.nextZ=Ee:le=Ee,Ee.prevZ=Le,Le=Ee;_e=Me}Le.nextZ=null,jt*=2}while(De>1)}(ee)}(c,f,g,x);for(var S,I,k=c;c.prev!==c.next;)if(S=c.prev,I=c.next,x?fD(c,f,g,x):dD(c))s.push(S.i/u|0),s.push(c.i/u|0),s.push(I.i/u|0),zf(c),c=I.next,k=I.next;else if((c=I)===k){w?w===1?Rf(c=pD(Zc(c),s,u),s,u,f,g,x,2):w===2&&mD(c,s,u,f,g,x):Rf(Zc(c),s,u,f,g,x,1);break}}}function dD(c){var s=c.prev,u=c,f=c.next;if(Fr(s,u,f)>=0)return!1;for(var g=s.x,x=u.x,w=f.x,S=s.y,I=u.y,k=f.y,B=g<x?g<w?g:w:x<w?x:w,j=S<I?S<k?S:k:I<k?I:k,H=g>x?g>w?g:w:x>w?x:w,Y=S>I?S>k?S:k:I>k?I:k,ee=f.next;ee!==s;){if(ee.x>=B&&ee.x<=H&&ee.y>=j&&ee.y<=Y&&uh(g,S,x,I,w,k,ee.x,ee.y)&&Fr(ee.prev,ee,ee.next)>=0)return!1;ee=ee.next}return!0}function fD(c,s,u,f){var g=c.prev,x=c,w=c.next;if(Fr(g,x,w)>=0)return!1;for(var S=g.x,I=x.x,k=w.x,B=g.y,j=x.y,H=w.y,Y=S<I?S<k?S:k:I<k?I:k,ee=B<j?B<H?B:H:j<H?j:H,le=S>I?S>k?S:k:I>k?I:k,me=B>j?B>H?B:H:j>H?j:H,_e=sx(Y,ee,s,u,f),Me=sx(le,me,s,u,f),Ee=c.prevZ,Le=c.nextZ;Ee&&Ee.z>=_e&&Le&&Le.z<=Me;){if(Ee.x>=Y&&Ee.x<=le&&Ee.y>=ee&&Ee.y<=me&&Ee!==g&&Ee!==w&&uh(S,B,I,j,k,H,Ee.x,Ee.y)&&Fr(Ee.prev,Ee,Ee.next)>=0||(Ee=Ee.prevZ,Le.x>=Y&&Le.x<=le&&Le.y>=ee&&Le.y<=me&&Le!==g&&Le!==w&&uh(S,B,I,j,k,H,Le.x,Le.y)&&Fr(Le.prev,Le,Le.next)>=0))return!1;Le=Le.nextZ}for(;Ee&&Ee.z>=_e;){if(Ee.x>=Y&&Ee.x<=le&&Ee.y>=ee&&Ee.y<=me&&Ee!==g&&Ee!==w&&uh(S,B,I,j,k,H,Ee.x,Ee.y)&&Fr(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.prevZ}for(;Le&&Le.z<=Me;){if(Le.x>=Y&&Le.x<=le&&Le.y>=ee&&Le.y<=me&&Le!==g&&Le!==w&&uh(S,B,I,j,k,H,Le.x,Le.y)&&Fr(Le.prev,Le,Le.next)>=0)return!1;Le=Le.nextZ}return!0}function pD(c,s,u){var f=c;do{var g=f.prev,x=f.next.next;!Ng(g,x)&&VS(g,f,f.next,x)&&Of(g,x)&&Of(x,g)&&(s.push(g.i/u|0),s.push(f.i/u|0),s.push(x.i/u|0),zf(f),zf(f.next),f=c=x),f=f.next}while(f!==c);return Zc(f)}function mD(c,s,u,f,g,x){var w=c;do{for(var S=w.next.next;S!==w.prev;){if(w.i!==S.i&&xD(w,S)){var I=jS(w,S);return w=Zc(w,w.next),I=Zc(I,I.next),Rf(w,s,u,f,g,x,0),void Rf(I,s,u,f,g,x,0)}S=S.next}w=w.next}while(w!==c)}function gD(c,s){return c.x-s.x}function yD(c,s){var u=function(g,x){var w,S=x,I=g.x,k=g.y,B=-1/0;do{if(k<=S.y&&k>=S.next.y&&S.next.y!==S.y){var j=S.x+(k-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(j<=I&&j>B&&(B=j,w=S.x<S.next.x?S:S.next,j===I))return w}S=S.next}while(S!==x);if(!w)return null;var H,Y=w,ee=w.x,le=w.y,me=1/0;S=w;do I>=S.x&&S.x>=ee&&I!==S.x&&uh(k<le?I:B,k,ee,le,k<le?B:I,k,S.x,S.y)&&(H=Math.abs(k-S.y)/(I-S.x),Of(S,g)&&(H<me||H===me&&(S.x>w.x||S.x===w.x&&_D(w,S)))&&(w=S,me=H)),S=S.next;while(S!==Y);return w}(c,s);if(!u)return s;var f=jS(u,c);return Zc(f,f.next),Zc(u,u.next)}function _D(c,s){return Fr(c.prev,c,s.prev)<0&&Fr(s.next,c,c.next)<0}function sx(c,s,u,f,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-u)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-f)*g|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function vD(c){var s=c,u=c;do(s.x<u.x||s.x===u.x&&s.y<u.y)&&(u=s),s=s.next;while(s!==c);return u}function uh(c,s,u,f,g,x,w,S){return(g-w)*(s-S)>=(c-w)*(x-S)&&(c-w)*(f-S)>=(u-w)*(s-S)&&(u-w)*(x-S)>=(g-w)*(f-S)}function xD(c,s){return c.next.i!==s.i&&c.prev.i!==s.i&&!function(u,f){var g=u;do{if(g.i!==u.i&&g.next.i!==u.i&&g.i!==f.i&&g.next.i!==f.i&&VS(g,g.next,u,f))return!0;g=g.next}while(g!==u);return!1}(c,s)&&(Of(c,s)&&Of(s,c)&&function(u,f){var g=u,x=!1,w=(u.x+f.x)/2,S=(u.y+f.y)/2;do g.y>S!=g.next.y>S&&g.next.y!==g.y&&w<(g.next.x-g.x)*(S-g.y)/(g.next.y-g.y)+g.x&&(x=!x),g=g.next;while(g!==u);return x}(c,s)&&(Fr(c.prev,c,s.prev)||Fr(c,s.prev,s))||Ng(c,s)&&Fr(c.prev,c,c.next)>0&&Fr(s.prev,s,s.next)>0)}function Fr(c,s,u){return(s.y-c.y)*(u.x-s.x)-(s.x-c.x)*(u.y-s.y)}function Ng(c,s){return c.x===s.x&&c.y===s.y}function VS(c,s,u,f){var g=Ug(Fr(c,s,u)),x=Ug(Fr(c,s,f)),w=Ug(Fr(u,f,c)),S=Ug(Fr(u,f,s));return g!==x&&w!==S||!(g!==0||!Bg(c,u,s))||!(x!==0||!Bg(c,f,s))||!(w!==0||!Bg(u,c,f))||!(S!==0||!Bg(u,s,f))}function Bg(c,s,u){return s.x<=Math.max(c.x,u.x)&&s.x>=Math.min(c.x,u.x)&&s.y<=Math.max(c.y,u.y)&&s.y>=Math.min(c.y,u.y)}function Ug(c){return c>0?1:c<0?-1:0}function Of(c,s){return Fr(c.prev,c,c.next)<0?Fr(c,s,c.next)>=0&&Fr(c,c.prev,s)>=0:Fr(c,s,c.prev)<0||Fr(c,c.next,s)<0}function jS(c,s){var u=new ox(c.i,c.x,c.y),f=new ox(s.i,s.x,s.y),g=c.next,x=s.prev;return c.next=s,s.prev=c,u.next=g,g.prev=u,f.next=u,u.prev=f,x.next=f,f.prev=x,f}function $S(c,s,u,f){var g=new ox(c,s,u);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function zf(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function ox(c,s,u){this.i=c,this.x=s,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ax(c,s,u,f){for(var g=0,x=s,w=u-f;x<u;x+=f)g+=(c[w]-c[x])*(c[x+1]+c[w+1]),w=x;return g}ix.exports=Fg,ix.exports.default=Fg,Fg.deviation=function(c,s,u,f){var g=s&&s.length,x=Math.abs(ax(c,0,g?s[0]*u:c.length,u));if(g)for(var w=0,S=s.length;w<S;w++)x-=Math.abs(ax(c,s[w]*u,w<S-1?s[w+1]*u:c.length,u));var I=0;for(w=0;w<f.length;w+=3){var k=f[w]*u,B=f[w+1]*u,j=f[w+2]*u;I+=Math.abs((c[k]-c[j])*(c[B+1]-c[k+1])-(c[k]-c[B])*(c[j+1]-c[k+1]))}return x===0&&I===0?0:Math.abs((I-x)/x)},Fg.flatten=function(c){for(var s=c[0][0].length,u={vertices:[],holes:[],dimensions:s},f=0,g=0;g<c.length;g++){for(var x=0;x<c[g].length;x++)for(var w=0;w<s;w++)u.vertices.push(c[g][x][w]);g>0&&u.holes.push(f+=c[g-1].length)}return u};var GS=m(ix.exports);function bD(c,s,u,f,g){WS(c,s,u||0,f||c.length-1,g||wD)}function WS(c,s,u,f,g){for(;f>u;){if(f-u>600){var x=f-u+1,w=s-u+1,S=Math.log(x),I=.5*Math.exp(2*S/3),k=.5*Math.sqrt(S*I*(x-I)/x)*(w-x/2<0?-1:1);WS(c,s,Math.max(u,Math.floor(s-w*I/x+k)),Math.min(f,Math.floor(s+(x-w)*I/x+k)),g)}var B=c[s],j=u,H=f;for(Df(c,u,s),g(c[f],B)>0&&Df(c,u,f);j<H;){for(Df(c,j,H),j++,H--;g(c[j],B)<0;)j++;for(;g(c[H],B)>0;)H--}g(c[u],B)===0?Df(c,u,H):Df(c,++H,f),H<=s&&(u=H+1),s<=H&&(f=H-1)}}function Df(c,s,u){var f=c[s];c[s]=c[u],c[u]=f}function wD(c,s){return c<s?-1:c>s?1:0}function lx(c,s){const u=c.length;if(u<=1)return[c];const f=[];let g,x;for(let w=0;w<u;w++){const S=Ye(c[w]);S!==0&&(c[w].area=Math.abs(S),x===void 0&&(x=S<0),x===S<0?(g&&f.push(g),g=[c[w]]):g.push(c[w]))}if(g&&f.push(g),s>1)for(let w=0;w<f.length;w++)f[w].length<=s||(bD(f[w],s,1,f[w].length-1,ED),f[w]=f[w].slice(0,s));return f}function ED(c,s){return s.area-c.area}function cx(c,s,u){const f=u.patternDependencies;let g=!1;for(const x of s){const w=x.paint.get(`${c}-pattern`);w.isConstant()||(g=!0);const S=w.constantOr(null);S&&(g=!0,f[S.to]=!0,f[S.from]=!0)}return g}function ux(c,s,u,f,g){const x=g.patternDependencies;for(const w of s){const S=w.paint.get(`${c}-pattern`).value;if(S.kind!=="constant"){let I=S.evaluate({zoom:f-1},u,{},g.availableImages),k=S.evaluate({zoom:f},u,{},g.availableImages),B=S.evaluate({zoom:f+1},u,{},g.availableImages);I=I&&I.name?I.name:I,k=k&&k.name?k.name:k,B=B&&B.name?B.name:B,x[I]=!0,x[k]=!0,x[B]=!0,u.patterns[w.id]={min:I,mid:k,max:B}}}return u}class hx{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new An,this.indexArray=new fi,this.indexArray2=new Qr,this.programConfigurations=new Wo(s.layers,s.zoom),this.segments=new or,this.segments2=new or,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.hasPattern=cx("fill",this.layers,u);const g=this.layers[0].layout.get("fill-sort-key"),x=!g.isConstant(),w=[];for(const{feature:S,id:I,index:k,sourceLayerIndex:B}of s){const j=this.layers[0]._featureFilter.needGeometry,H=qc(S,j);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),H,f))continue;const Y=x?g.evaluate(H,{},f,u.availableImages):void 0,ee={id:I,properties:S.properties,type:S.type,sourceLayerIndex:B,index:k,geometry:j?H.geometry:Hc(S),patterns:{},sortKey:Y};w.push(ee)}x&&w.sort((S,I)=>S.sortKey-I.sortKey);for(const S of w){const{geometry:I,index:k,sourceLayerIndex:B}=S;if(this.hasPattern){const j=ux("fill",this.layers,S,this.zoom,u);this.patternFeatures.push(j)}else this.addFeature(S,I,k,f,{});u.featureIndex.insert(s[k].feature,I,k,B,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}addFeatures(s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,hD),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,u,f,g,x){for(const w of lx(u,500)){let S=0;for(const Y of w)S+=Y.length;const I=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),k=I.vertexLength,B=[],j=[];for(const Y of w){if(Y.length===0)continue;Y!==w[0]&&j.push(B.length/2);const ee=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),le=ee.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(le+Y.length-1,le),B.push(Y[0].x),B.push(Y[0].y);for(let me=1;me<Y.length;me++)this.layoutVertexArray.emplaceBack(Y[me].x,Y[me].y),this.indexArray2.emplaceBack(le+me-1,le+me),B.push(Y[me].x),B.push(Y[me].y);ee.vertexLength+=Y.length,ee.primitiveLength+=Y.length}const H=GS(B,j);for(let Y=0;Y<H.length;Y+=3)this.indexArray.emplaceBack(k+H[Y],k+H[Y+1],k+H[Y+2]);I.vertexLength+=S,I.primitiveLength+=H.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}}let HS,qS;kt("FillBucket",hx,{omit:["layers","patternFeatures"]});var TD={get paint(){return qS=qS||new zr({"fill-antialias":new Xt(Ae.paint_fill["fill-antialias"]),"fill-opacity":new on(Ae.paint_fill["fill-opacity"]),"fill-color":new on(Ae.paint_fill["fill-color"]),"fill-outline-color":new on(Ae.paint_fill["fill-outline-color"]),"fill-translate":new Xt(Ae.paint_fill["fill-translate"]),"fill-translate-anchor":new Xt(Ae.paint_fill["fill-translate-anchor"]),"fill-pattern":new $c(Ae.paint_fill["fill-pattern"])})},get layout(){return HS=HS||new zr({"fill-sort-key":new on(Ae.layout_fill["fill-sort-key"])})}};class SD extends Is{constructor(s){super(s,TD)}recalculate(s,u){super.recalculate(s,u);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new hx(s)}queryRadius(){return Og(this.paint.get("fill-translate"))}queryIntersectsFeature(s,u,f,g,x,w,S){return AS(zg(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,S),g)}isTileClipped(){return!0}}const PD=yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),CD=yr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:AD}=PD;var Dl={},ID=_,ZS=hh;function hh(c,s,u,f,g){this.properties={},this.extent=u,this.type=0,this._pbf=c,this._geometry=-1,this._keys=f,this._values=g,c.readFields(MD,this,s)}function MD(c,s,u){c==1?s.id=u.readVarint():c==2?function(f,g){for(var x=f.readVarint()+f.pos;f.pos<x;){var w=g._keys[f.readVarint()],S=g._values[f.readVarint()];g.properties[w]=S}}(u,s):c==3?s.type=u.readVarint():c==4&&(s._geometry=u.pos)}function kD(c){for(var s,u,f=0,g=0,x=c.length,w=x-1;g<x;w=g++)f+=((u=c[w]).x-(s=c[g]).x)*(s.y+u.y);return f}hh.types=["Unknown","Point","LineString","Polygon"],hh.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var s,u=c.readVarint()+c.pos,f=1,g=0,x=0,w=0,S=[];c.pos<u;){if(g<=0){var I=c.readVarint();f=7&I,g=I>>3}if(g--,f===1||f===2)x+=c.readSVarint(),w+=c.readSVarint(),f===1&&(s&&S.push(s),s=[]),s.push(new ID(x,w));else{if(f!==7)throw new Error("unknown command "+f);s&&s.push(s[0].clone())}}return s&&S.push(s),S},hh.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var s=c.readVarint()+c.pos,u=1,f=0,g=0,x=0,w=1/0,S=-1/0,I=1/0,k=-1/0;c.pos<s;){if(f<=0){var B=c.readVarint();u=7&B,f=B>>3}if(f--,u===1||u===2)(g+=c.readSVarint())<w&&(w=g),g>S&&(S=g),(x+=c.readSVarint())<I&&(I=x),x>k&&(k=x);else if(u!==7)throw new Error("unknown command "+u)}return[w,I,S,k]},hh.prototype.toGeoJSON=function(c,s,u){var f,g,x=this.extent*Math.pow(2,u),w=this.extent*c,S=this.extent*s,I=this.loadGeometry(),k=hh.types[this.type];function B(Y){for(var ee=0;ee<Y.length;ee++){var le=Y[ee];Y[ee]=[360*(le.x+w)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(le.y+S)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var j=[];for(f=0;f<I.length;f++)j[f]=I[f][0];B(I=j);break;case 2:for(f=0;f<I.length;f++)B(I[f]);break;case 3:for(I=function(Y){var ee=Y.length;if(ee<=1)return[Y];for(var le,me,_e=[],Me=0;Me<ee;Me++){var Ee=kD(Y[Me]);Ee!==0&&(me===void 0&&(me=Ee<0),me===Ee<0?(le&&_e.push(le),le=[Y[Me]]):le.push(Y[Me]))}return le&&_e.push(le),_e}(I),f=0;f<I.length;f++)for(g=0;g<I[f].length;g++)B(I[f][g])}I.length===1?I=I[0]:k="Multi"+k;var H={type:"Feature",geometry:{type:k,coordinates:I},properties:this.properties};return"id"in this&&(H.id=this.id),H};var LD=ZS,XS=YS;function YS(c,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(RD,this,s),this.length=this._features.length}function RD(c,s,u){c===15?s.version=u.readVarint():c===1?s.name=u.readString():c===5?s.extent=u.readVarint():c===2?s._features.push(u.pos):c===3?s._keys.push(u.readString()):c===4&&s._values.push(function(f){for(var g=null,x=f.readVarint()+f.pos;f.pos<x;){var w=f.readVarint()>>3;g=w===1?f.readString():w===2?f.readFloat():w===3?f.readDouble():w===4?f.readVarint64():w===5?f.readVarint():w===6?f.readSVarint():w===7?f.readBoolean():null}return g}(u))}YS.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var s=this._pbf.readVarint()+this._pbf.pos;return new LD(this._pbf,s,this.extent,this._keys,this._values)};var OD=XS;function zD(c,s,u){if(c===3){var f=new OD(u,u.readVarint()+u.pos);f.length&&(s[f.name]=f)}}Dl.VectorTile=function(c,s){this.layers=c.readFields(zD,{},s)},Dl.VectorTileFeature=ZS,Dl.VectorTileLayer=XS;const DD=Dl.VectorTileFeature.types,dx=Math.pow(2,13);function Ff(c,s,u,f,g,x,w,S){c.emplaceBack(s,u,2*Math.floor(f*dx)+w,g*dx*2,x*dx*2,Math.round(S))}class fx{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.layoutVertexArray=new yt,this.centroidVertexArray=new at,this.indexArray=new fi,this.programConfigurations=new Wo(s.layers,s.zoom),this.segments=new or,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.features=[],this.hasPattern=cx("fill-extrusion",this.layers,u);for(const{feature:g,id:x,index:w,sourceLayerIndex:S}of s){const I=this.layers[0]._featureFilter.needGeometry,k=qc(g,I);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),k,f))continue;const B={id:x,sourceLayerIndex:S,index:w,geometry:I?k.geometry:Hc(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(ux("fill-extrusion",this.layers,B,this.zoom,u)):this.addFeature(B,B.geometry,w,f,{}),u.featureIndex.insert(g,B.geometry,w,S,this.index,!0)}}addFeatures(s,u,f){for(const g of this.features){const{geometry:x}=g;this.addFeature(g,x,g.index,u,f)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,AD),this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,CD.members,!0),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(s,u,f,g,x){const w={x:0,y:0,vertexCount:0};for(const S of lx(u,500)){let I=0;for(const ee of S)I+=ee.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ee of S){if(ee.length===0||ND(ee))continue;let le=0;for(let me=0;me<ee.length;me++){const _e=ee[me];if(me>=1){const Me=ee[me-1];if(!FD(_e,Me)){k.vertexLength+4>or.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ee=_e.sub(Me)._perp()._unit(),Le=Me.dist(_e);le+Le>32768&&(le=0),Ff(this.layoutVertexArray,_e.x,_e.y,Ee.x,Ee.y,0,0,le),Ff(this.layoutVertexArray,_e.x,_e.y,Ee.x,Ee.y,0,1,le),w.x+=2*_e.x,w.y+=2*_e.y,w.vertexCount+=2,le+=Le,Ff(this.layoutVertexArray,Me.x,Me.y,Ee.x,Ee.y,0,0,le),Ff(this.layoutVertexArray,Me.x,Me.y,Ee.x,Ee.y,0,1,le),w.x+=2*Me.x,w.y+=2*Me.y,w.vertexCount+=2;const De=k.vertexLength;this.indexArray.emplaceBack(De,De+2,De+1),this.indexArray.emplaceBack(De+1,De+2,De+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+I>or.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),DD[s.type]!=="Polygon")continue;const B=[],j=[],H=k.vertexLength;for(const ee of S)if(ee.length!==0){ee!==S[0]&&j.push(B.length/2);for(let le=0;le<ee.length;le++){const me=ee[le];Ff(this.layoutVertexArray,me.x,me.y,0,0,1,1,0),w.x+=me.x,w.y+=me.y,w.vertexCount+=1,B.push(me.x),B.push(me.y)}}const Y=GS(B,j);for(let ee=0;ee<Y.length;ee+=3)this.indexArray.emplaceBack(H+Y[ee],H+Y[ee+2],H+Y[ee+1]);k.primitiveLength+=Y.length/3,k.vertexLength+=I}for(let S=0;S<w.vertexCount;S++)this.centroidVertexArray.emplaceBack(Math.floor(w.x/w.vertexCount),Math.floor(w.y/w.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}}function FD(c,s){return c.x===s.x&&(c.x<0||c.x>$r)||c.y===s.y&&(c.y<0||c.y>$r)}function ND(c){return c.every(s=>s.x<0)||c.every(s=>s.x>$r)||c.every(s=>s.y<0)||c.every(s=>s.y>$r)}let KS;kt("FillExtrusionBucket",fx,{omit:["layers","features"]});var BD={get paint(){return KS=KS||new zr({"fill-extrusion-opacity":new Xt(Ae["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new on(Ae["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xt(Ae["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xt(Ae["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $c(Ae["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new on(Ae["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new on(Ae["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xt(Ae["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class UD extends Is{constructor(s){super(s,BD)}createBucket(s){return new fx(s)}queryRadius(){return Og(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(s,u,f,g,x,w,S,I){const k=zg(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,S),B=this.paint.get("fill-extrusion-height").evaluate(u,f),j=this.paint.get("fill-extrusion-base").evaluate(u,f),H=function(ee,le,me,_e){const Me=[];for(const Ee of ee){const Le=[Ee.x,Ee.y,0,1];Dg(Le,Le,le),Me.push(new T(Le[0]/Le[3],Le[1]/Le[3]))}return Me}(k,I),Y=function(ee,le,me,_e){const Me=[],Ee=[],Le=_e[8]*le,De=_e[9]*le,Xe=_e[10]*le,St=_e[11]*le,jt=_e[8]*me,wt=_e[9]*me,_t=_e[10]*me,lt=_e[11]*me;for(const zt of ee){const ft=[],rt=[];for(const tn of zt){const Ht=tn.x,Tn=tn.y,ar=_e[0]*Ht+_e[4]*Tn+_e[12],pr=_e[1]*Ht+_e[5]*Tn+_e[13],ni=_e[2]*Ht+_e[6]*Tn+_e[14],ks=_e[3]*Ht+_e[7]*Tn+_e[15],Yi=ni+Xe,Gr=ks+St,mi=ar+jt,Ti=pr+wt,Ki=ni+_t,Ji=ks+lt,ri=new T((ar+Le)/Gr,(pr+De)/Gr);ri.z=Yi/Gr,ft.push(ri);const ii=new T(mi/Ji,Ti/Ji);ii.z=Ki/Ji,rt.push(ii)}Me.push(ft),Ee.push(rt)}return[Me,Ee]}(g,j,B,I);return function(ee,le,me){let _e=1/0;AS(me,le)&&(_e=JS(me,le[0]));for(let Me=0;Me<le.length;Me++){const Ee=le[Me],Le=ee[Me];for(let De=0;De<Ee.length-1;De++){const Xe=Ee[De],St=[Xe,Ee[De+1],Le[De+1],Le[De],Xe];CS(me,St)&&(_e=Math.min(_e,JS(me,St)))}}return _e!==1/0&&_e}(Y[0],Y[1],H)}}function Nf(c,s){return c.x*s.x+c.y*s.y}function JS(c,s){if(c.length===1){let u=0;const f=s[u++];let g;for(;!g||f.equals(g);)if(g=s[u++],!g)return 1/0;for(;u<s.length;u++){const x=s[u],w=c[0],S=g.sub(f),I=x.sub(f),k=w.sub(f),B=Nf(S,S),j=Nf(S,I),H=Nf(I,I),Y=Nf(k,S),ee=Nf(k,I),le=B*H-j*j,me=(H*Y-j*ee)/le,_e=(B*ee-j*Y)/le,Me=f.z*(1-me-_e)+g.z*me+x.z*_e;if(isFinite(Me))return Me}return 1/0}{let u=1/0;for(const f of s)u=Math.min(u,f.z);return u}}const VD=yr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:jD}=VD,$D=yr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:GD}=$D,WD=Dl.VectorTileFeature.types,HD=Math.cos(Math.PI/180*37.5),QS=Math.pow(2,14)/.5;class px{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new an,this.layoutVertexArray2=new Gt,this.indexArray=new fi,this.programConfigurations=new Wo(s.layers,s.zoom),this.segments=new or,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(s,u,f){this.hasPattern=cx("line",this.layers,u);const g=this.layers[0].layout.get("line-sort-key"),x=!g.isConstant(),w=[];for(const{feature:S,id:I,index:k,sourceLayerIndex:B}of s){const j=this.layers[0]._featureFilter.needGeometry,H=qc(S,j);if(!this.layers[0]._featureFilter.filter(new sr(this.zoom),H,f))continue;const Y=x?g.evaluate(H,{},f):void 0,ee={id:I,properties:S.properties,type:S.type,sourceLayerIndex:B,index:k,geometry:j?H.geometry:Hc(S),patterns:{},sortKey:Y};w.push(ee)}x&&w.sort((S,I)=>S.sortKey-I.sortKey);for(const S of w){const{geometry:I,index:k,sourceLayerIndex:B}=S;if(this.hasPattern){const j=ux("line",this.layers,S,this.zoom,u);this.patternFeatures.push(j)}else this.addFeature(S,I,k,f,{});u.featureIndex.insert(s[k].feature,I,k,B,this.index)}}update(s,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,u,this.stateDependentLayers,f)}addFeatures(s,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,GD)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,jD),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(s.properties,"mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,u,f,g,x){const w=this.layers[0].layout,S=w.get("line-join").evaluate(s,{}),I=w.get("line-cap"),k=w.get("line-miter-limit"),B=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const j of u)this.addLine(j,s,S,I,k,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,x,g)}addLine(s,u,f,g,x,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _e=0;_e<s.length-1;_e++)this.totalDistance+=s[_e].dist(s[_e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S=WD[u.type]==="Polygon";let I=s.length;for(;I>=2&&s[I-1].equals(s[I-2]);)I--;let k=0;for(;k<I-1&&s[k].equals(s[k+1]);)k++;if(I<(S?3:2))return;f==="bevel"&&(x=1.05);const B=this.overscaling<=16?15*$r/(512*this.overscaling):0,j=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let H,Y,ee,le,me;this.e1=this.e2=-1,S&&(H=s[I-2],me=s[k].sub(H)._unit()._perp());for(let _e=k;_e<I;_e++){if(ee=_e===I-1?S?s[k+1]:void 0:s[_e+1],ee&&s[_e].equals(ee))continue;me&&(le=me),H&&(Y=H),H=s[_e],me=ee?ee.sub(H)._unit()._perp():le,le=le||me;let Me=le.add(me);Me.x===0&&Me.y===0||Me._unit();const Ee=le.x*me.x+le.y*me.y,Le=Me.x*me.x+Me.y*me.y,De=Le!==0?1/Le:1/0,Xe=2*Math.sqrt(2-2*Le),St=Le<HD&&Y&&ee,jt=le.x*me.y-le.y*me.x>0;if(St&&_e>k){const lt=H.dist(Y);if(lt>2*B){const zt=H.sub(H.sub(Y)._mult(B/lt)._round());this.updateDistance(Y,zt),this.addCurrentVertex(zt,le,0,0,j),Y=zt}}const wt=Y&&ee;let _t=wt?f:S?"butt":g;if(wt&&_t==="round"&&(De<w?_t="miter":De<=2&&(_t="fakeround")),_t==="miter"&&De>x&&(_t="bevel"),_t==="bevel"&&(De>2&&(_t="flipbevel"),De<x&&(_t="miter")),Y&&this.updateDistance(Y,H),_t==="miter")Me._mult(De),this.addCurrentVertex(H,Me,0,0,j);else if(_t==="flipbevel"){if(De>100)Me=me.mult(-1);else{const lt=De*le.add(me).mag()/le.sub(me).mag();Me._perp()._mult(lt*(jt?-1:1))}this.addCurrentVertex(H,Me,0,0,j),this.addCurrentVertex(H,Me.mult(-1),0,0,j)}else if(_t==="bevel"||_t==="fakeround"){const lt=-Math.sqrt(De*De-1),zt=jt?lt:0,ft=jt?0:lt;if(Y&&this.addCurrentVertex(H,le,zt,ft,j),_t==="fakeround"){const rt=Math.round(180*Xe/Math.PI/20);for(let tn=1;tn<rt;tn++){let Ht=tn/rt;if(Ht!==.5){const ar=Ht-.5;Ht+=Ht*ar*(Ht-1)*((1.0904+Ee*(Ee*(3.55645-1.43519*Ee)-3.2452))*ar*ar+(.848013+Ee*(.215638*Ee-1.06021)))}const Tn=me.sub(le)._mult(Ht)._add(le)._unit()._mult(jt?-1:1);this.addHalfVertex(H,Tn.x,Tn.y,!1,jt,0,j)}}ee&&this.addCurrentVertex(H,me,-zt,-ft,j)}else if(_t==="butt")this.addCurrentVertex(H,Me,0,0,j);else if(_t==="square"){const lt=Y?1:-1;this.addCurrentVertex(H,Me,lt,lt,j)}else _t==="round"&&(Y&&(this.addCurrentVertex(H,le,0,0,j),this.addCurrentVertex(H,le,1,1,j,!0)),ee&&(this.addCurrentVertex(H,me,-1,-1,j,!0),this.addCurrentVertex(H,me,0,0,j)));if(St&&_e<I-1){const lt=H.dist(ee);if(lt>2*B){const zt=H.add(ee.sub(H)._mult(B/lt)._round());this.updateDistance(H,zt),this.addCurrentVertex(zt,me,0,0,j),H=zt}}}}addCurrentVertex(s,u,f,g,x,w=!1){const S=u.y*g-u.x,I=-u.y-u.x*g;this.addHalfVertex(s,u.x+u.y*f,u.y-u.x*f,w,!1,f,x),this.addHalfVertex(s,S,I,w,!0,-g,x),this.distance>QS/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(s,u,f,g,x,w))}addHalfVertex({x:s,y:u},f,g,x,w,S,I){const k=.5*(this.lineClips?this.scaledDistance*(QS-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(x?1:0),(u<<1)+(w?1:0),Math.round(63*f)+128,Math.round(63*g)+128,1+(S===0?0:S<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const B=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,B),I.primitiveLength++),w?this.e2=B:this.e1=B}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(s,u){this.distance+=s.dist(u),this.updateScaledDistance()}}let e2,t2;kt("LineBucket",px,{omit:["layers","patternFeatures"]});var n2={get paint(){return t2=t2||new zr({"line-opacity":new on(Ae.paint_line["line-opacity"]),"line-color":new on(Ae.paint_line["line-color"]),"line-translate":new Xt(Ae.paint_line["line-translate"]),"line-translate-anchor":new Xt(Ae.paint_line["line-translate-anchor"]),"line-width":new on(Ae.paint_line["line-width"]),"line-gap-width":new on(Ae.paint_line["line-gap-width"]),"line-offset":new on(Ae.paint_line["line-offset"]),"line-blur":new on(Ae.paint_line["line-blur"]),"line-dasharray":new bf(Ae.paint_line["line-dasharray"]),"line-pattern":new $c(Ae.paint_line["line-pattern"]),"line-gradient":new wf(Ae.paint_line["line-gradient"])})},get layout(){return e2=e2||new zr({"line-cap":new Xt(Ae.layout_line["line-cap"]),"line-join":new on(Ae.layout_line["line-join"]),"line-miter-limit":new Xt(Ae.layout_line["line-miter-limit"]),"line-round-limit":new Xt(Ae.layout_line["line-round-limit"]),"line-sort-key":new on(Ae.layout_line["line-sort-key"])})}};class qD extends on{possiblyEvaluate(s,u){return u=new sr(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(s,u)}evaluate(s,u,f,g){return u=re({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(s,u,f,g)}}let Vg;class ZD extends Is{constructor(s){super(s,n2),this.gradientVersion=0,Vg||(Vg=new qD(n2.paint.properties["line-width"].specification),Vg.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const u=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(u)&&u._styleExpression.expression instanceof ha,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(s,u){super.recalculate(s,u),this.paint._values["line-floorwidth"]=Vg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new px(s)}queryRadius(s){const u=s,f=r2(Mf("line-width",this,u),Mf("line-gap-width",this,u)),g=Mf("line-offset",this,u);return f/2+Math.abs(g)+Og(this.paint.get("line-translate"))}queryIntersectsFeature(s,u,f,g,x,w,S){const I=zg(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,S),k=S/2*r2(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),B=this.paint.get("line-offset").evaluate(u,f);return B&&(g=function(j,H){const Y=[];for(let ee=0;ee<j.length;ee++){const le=j[ee],me=[];for(let _e=0;_e<le.length;_e++){const Me=le[_e-1],Ee=le[_e],Le=le[_e+1],De=_e===0?new T(0,0):Ee.sub(Me)._unit()._perp(),Xe=_e===le.length-1?new T(0,0):Le.sub(Ee)._unit()._perp(),St=De._add(Xe)._unit(),jt=St.x*Xe.x+St.y*Xe.y;jt!==0&&St._mult(1/jt),me.push(St._mult(H)._add(Ee))}Y.push(me)}return Y}(g,B*S)),function(j,H,Y){for(let ee=0;ee<H.length;ee++){const le=H[ee];if(j.length>=3){for(let me=0;me<le.length;me++)if(lh(j,le[me]))return!0}if(eD(j,le,Y))return!0}return!1}(I,g,k)}isTileClipped(){return!0}}function r2(c,s){return s>0?s+2*c:c}const XD=yr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),YD=yr([{name:"a_projected_pos",components:3,type:"Float32"}],4);yr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const KD=yr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);yr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const i2=yr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),JD=yr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function QD(c,s,u){return c.sections.forEach(f=>{f.text=function(g,x,w){const S=x.layout.get("text-transform").evaluate(w,{});return S==="uppercase"?g=g.toLocaleUpperCase():S==="lowercase"&&(g=g.toLocaleLowerCase()),fs.applyArabicShaping&&(g=fs.applyArabicShaping(g)),g}(f.text,s,u)}),c}yr([{name:"triangle",components:3,type:"Uint16"}]),yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),yr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),yr([{type:"Float32",name:"offsetX"}]),yr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),yr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Bf={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var ti=24,s2=Xn,o2=function(c,s,u,f,g){var x,w,S=8*g-f-1,I=(1<<S)-1,k=I>>1,B=-7,j=u?g-1:0,H=u?-1:1,Y=c[s+j];for(j+=H,x=Y&(1<<-B)-1,Y>>=-B,B+=S;B>0;x=256*x+c[s+j],j+=H,B-=8);for(w=x&(1<<-B)-1,x>>=-B,B+=f;B>0;w=256*w+c[s+j],j+=H,B-=8);if(x===0)x=1-k;else{if(x===I)return w?NaN:1/0*(Y?-1:1);w+=Math.pow(2,f),x-=k}return(Y?-1:1)*w*Math.pow(2,x-f)},a2=function(c,s,u,f,g,x){var w,S,I,k=8*x-g-1,B=(1<<k)-1,j=B>>1,H=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=f?0:x-1,ee=f?1:-1,le=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(S=isNaN(s)?1:0,w=B):(w=Math.floor(Math.log(s)/Math.LN2),s*(I=Math.pow(2,-w))<1&&(w--,I*=2),(s+=w+j>=1?H/I:H*Math.pow(2,1-j))*I>=2&&(w++,I/=2),w+j>=B?(S=0,w=B):w+j>=1?(S=(s*I-1)*Math.pow(2,g),w+=j):(S=s*Math.pow(2,j-1)*Math.pow(2,g),w=0));g>=8;c[u+Y]=255&S,Y+=ee,S/=256,g-=8);for(w=w<<g|S,k+=g;k>0;c[u+Y]=255&w,Y+=ee,w/=256,k-=8);c[u+Y-ee]|=128*le};function Xn(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}Xn.Varint=0,Xn.Fixed64=1,Xn.Bytes=2,Xn.Fixed32=5;var mx=4294967296,l2=1/mx,c2=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Xa(c){return c.type===Xn.Bytes?c.readVarint()+c.pos:c.pos+1}function dh(c,s,u){return u?4294967296*s+(c>>>0):4294967296*(s>>>0)+(c>>>0)}function u2(c,s,u){var f=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));u.realloc(f);for(var g=u.pos-1;g>=c;g--)u.buf[g+f]=u.buf[g]}function eF(c,s){for(var u=0;u<c.length;u++)s.writeVarint(c[u])}function tF(c,s){for(var u=0;u<c.length;u++)s.writeSVarint(c[u])}function nF(c,s){for(var u=0;u<c.length;u++)s.writeFloat(c[u])}function rF(c,s){for(var u=0;u<c.length;u++)s.writeDouble(c[u])}function iF(c,s){for(var u=0;u<c.length;u++)s.writeBoolean(c[u])}function sF(c,s){for(var u=0;u<c.length;u++)s.writeFixed32(c[u])}function oF(c,s){for(var u=0;u<c.length;u++)s.writeSFixed32(c[u])}function aF(c,s){for(var u=0;u<c.length;u++)s.writeFixed64(c[u])}function lF(c,s){for(var u=0;u<c.length;u++)s.writeSFixed64(c[u])}function jg(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+16777216*c[s+3]}function fh(c,s,u){c[u]=s,c[u+1]=s>>>8,c[u+2]=s>>>16,c[u+3]=s>>>24}function h2(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+(c[s+3]<<24)}Xn.prototype={destroy:function(){this.buf=null},readFields:function(c,s,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),g=f>>3,x=this.pos;this.type=7&f,c(g,s,this),this.pos===x&&this.skip(f)}return s},readMessage:function(c,s){return this.readFields(c,s,this.readVarint()+this.pos)},readFixed32:function(){var c=jg(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=h2(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=jg(this.buf,this.pos)+jg(this.buf,this.pos+4)*mx;return this.pos+=8,c},readSFixed64:function(){var c=jg(this.buf,this.pos)+h2(this.buf,this.pos+4)*mx;return this.pos+=8,c},readFloat:function(){var c=o2(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=o2(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var s,u,f=this.buf;return s=127&(u=f[this.pos++]),u<128?s:(s|=(127&(u=f[this.pos++]))<<7,u<128?s:(s|=(127&(u=f[this.pos++]))<<14,u<128?s:(s|=(127&(u=f[this.pos++]))<<21,u<128?s:function(g,x,w){var S,I,k=w.buf;if(S=(112&(I=k[w.pos++]))>>4,I<128||(S|=(127&(I=k[w.pos++]))<<3,I<128)||(S|=(127&(I=k[w.pos++]))<<10,I<128)||(S|=(127&(I=k[w.pos++]))<<17,I<128)||(S|=(127&(I=k[w.pos++]))<<24,I<128)||(S|=(1&(I=k[w.pos++]))<<31,I<128))return dh(g,S,x);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(u=f[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,s=this.pos;return this.pos=c,c-s>=12&&c2?function(u,f,g){return c2.decode(u.subarray(f,g))}(this.buf,s,c):function(u,f,g){for(var x="",w=f;w<g;){var S,I,k,B=u[w],j=null,H=B>239?4:B>223?3:B>191?2:1;if(w+H>g)break;H===1?B<128&&(j=B):H===2?(192&(S=u[w+1]))==128&&(j=(31&B)<<6|63&S)<=127&&(j=null):H===3?(I=u[w+2],(192&(S=u[w+1]))==128&&(192&I)==128&&((j=(15&B)<<12|(63&S)<<6|63&I)<=2047||j>=55296&&j<=57343)&&(j=null)):H===4&&(I=u[w+2],k=u[w+3],(192&(S=u[w+1]))==128&&(192&I)==128&&(192&k)==128&&((j=(15&B)<<18|(63&S)<<12|(63&I)<<6|63&k)<=65535||j>=1114112)&&(j=null)),j===null?(j=65533,H=1):j>65535&&(j-=65536,x+=String.fromCharCode(j>>>10&1023|55296),j=56320|1023&j),x+=String.fromCharCode(j),w+=H}return x}(this.buf,s,c)},readBytes:function(){var c=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,c);return this.pos=c,s},readPackedVarint:function(c,s){if(this.type!==Xn.Bytes)return c.push(this.readVarint(s));var u=Xa(this);for(c=c||[];this.pos<u;)c.push(this.readVarint(s));return c},readPackedSVarint:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSVarint());var s=Xa(this);for(c=c||[];this.pos<s;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==Xn.Bytes)return c.push(this.readBoolean());var s=Xa(this);for(c=c||[];this.pos<s;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFloat());var s=Xa(this);for(c=c||[];this.pos<s;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==Xn.Bytes)return c.push(this.readDouble());var s=Xa(this);for(c=c||[];this.pos<s;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFixed32());var s=Xa(this);for(c=c||[];this.pos<s;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSFixed32());var s=Xa(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==Xn.Bytes)return c.push(this.readFixed64());var s=Xa(this);for(c=c||[];this.pos<s;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==Xn.Bytes)return c.push(this.readSFixed64());var s=Xa(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed64());return c},skip:function(c){var s=7&c;if(s===Xn.Varint)for(;this.buf[this.pos++]>127;);else if(s===Xn.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Xn.Fixed32)this.pos+=4;else{if(s!==Xn.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(c,s){this.writeVarint(c<<3|s)},realloc:function(c){for(var s=this.length||16;s<this.pos+c;)s*=2;if(s!==this.length){var u=new Uint8Array(s);u.set(this.buf),this.buf=u,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),fh(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),fh(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),fh(this.buf,-1&c,this.pos),fh(this.buf,Math.floor(c*l2),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),fh(this.buf,-1&c,this.pos),fh(this.buf,Math.floor(c*l2),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(s,u){var f,g;if(s>=0?(f=s%4294967296|0,g=s/4294967296|0):(g=~(-s/4294967296),4294967295^(f=~(-s%4294967296))?f=f+1|0:(f=0,g=g+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(x,w,S){S.buf[S.pos++]=127&x|128,x>>>=7,S.buf[S.pos++]=127&x|128,x>>>=7,S.buf[S.pos++]=127&x|128,x>>>=7,S.buf[S.pos++]=127&x|128,S.buf[S.pos]=127&(x>>>=7)}(f,0,u),function(x,w){var S=(7&x)<<4;w.buf[w.pos++]|=S|((x>>>=3)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x)))))}(g,u)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var s=this.pos;this.pos=function(f,g,x){for(var w,S,I=0;I<g.length;I++){if((w=g.charCodeAt(I))>55295&&w<57344){if(!S){w>56319||I+1===g.length?(f[x++]=239,f[x++]=191,f[x++]=189):S=w;continue}if(w<56320){f[x++]=239,f[x++]=191,f[x++]=189,S=w;continue}w=S-55296<<10|w-56320|65536,S=null}else S&&(f[x++]=239,f[x++]=191,f[x++]=189,S=null);w<128?f[x++]=w:(w<2048?f[x++]=w>>6|192:(w<65536?f[x++]=w>>12|224:(f[x++]=w>>18|240,f[x++]=w>>12&63|128),f[x++]=w>>6&63|128),f[x++]=63&w|128)}return x}(this.buf,c,this.pos);var u=this.pos-s;u>=128&&u2(s,u,this),this.pos=s-1,this.writeVarint(u),this.pos+=u},writeFloat:function(c){this.realloc(4),a2(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),a2(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var s=c.length;this.writeVarint(s),this.realloc(s);for(var u=0;u<s;u++)this.buf[this.pos++]=c[u]},writeRawMessage:function(c,s){this.pos++;var u=this.pos;c(s,this);var f=this.pos-u;f>=128&&u2(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(c,s,u){this.writeTag(c,Xn.Bytes),this.writeRawMessage(s,u)},writePackedVarint:function(c,s){s.length&&this.writeMessage(c,eF,s)},writePackedSVarint:function(c,s){s.length&&this.writeMessage(c,tF,s)},writePackedBoolean:function(c,s){s.length&&this.writeMessage(c,iF,s)},writePackedFloat:function(c,s){s.length&&this.writeMessage(c,nF,s)},writePackedDouble:function(c,s){s.length&&this.writeMessage(c,rF,s)},writePackedFixed32:function(c,s){s.length&&this.writeMessage(c,sF,s)},writePackedSFixed32:function(c,s){s.length&&this.writeMessage(c,oF,s)},writePackedFixed64:function(c,s){s.length&&this.writeMessage(c,aF,s)},writePackedSFixed64:function(c,s){s.length&&this.writeMessage(c,lF,s)},writeBytesField:function(c,s){this.writeTag(c,Xn.Bytes),this.writeBytes(s)},writeFixed32Field:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeSFixed64(s)},writeVarintField:function(c,s){this.writeTag(c,Xn.Varint),this.writeVarint(s)},writeSVarintField:function(c,s){this.writeTag(c,Xn.Varint),this.writeSVarint(s)},writeStringField:function(c,s){this.writeTag(c,Xn.Bytes),this.writeString(s)},writeFloatField:function(c,s){this.writeTag(c,Xn.Fixed32),this.writeFloat(s)},writeDoubleField:function(c,s){this.writeTag(c,Xn.Fixed64),this.writeDouble(s)},writeBooleanField:function(c,s){this.writeVarintField(c,!!s)}};var gx=m(s2);const yx=3;function cF(c,s,u){c===1&&u.readMessage(uF,s)}function uF(c,s,u){if(c===3){const{id:f,bitmap:g,width:x,height:w,left:S,top:I,advance:k}=u.readMessage(hF,{});s.push({id:f,bitmap:new Lf({width:x+2*yx,height:w+2*yx},g),metrics:{width:x,height:w,left:S,top:I,advance:k}})}}function hF(c,s,u){c===1?s.id=u.readVarint():c===2?s.bitmap=u.readBytes():c===3?s.width=u.readVarint():c===4?s.height=u.readVarint():c===5?s.left=u.readSVarint():c===6?s.top=u.readSVarint():c===7&&(s.advance=u.readVarint())}const d2=yx;function f2(c){let s=0,u=0;for(const w of c)s+=w.w*w.h,u=Math.max(u,w.w);c.sort((w,S)=>S.h-w.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),u),h:1/0}];let g=0,x=0;for(const w of c)for(let S=f.length-1;S>=0;S--){const I=f[S];if(!(w.w>I.w||w.h>I.h)){if(w.x=I.x,w.y=I.y,x=Math.max(x,w.y+w.h),g=Math.max(g,w.x+w.w),w.w===I.w&&w.h===I.h){const k=f.pop();S<f.length&&(f[S]=k)}else w.h===I.h?(I.x+=w.w,I.w-=w.w):w.w===I.w?(I.y+=w.h,I.h-=w.h):(f.push({x:I.x+w.w,y:I.y,w:I.w-w.w,h:w.h}),I.y+=w.h,I.h-=w.h);break}}return{w:g,h:x,fill:s/(g*x)||0}}const ms=1;class _x{constructor(s,{pixelRatio:u,version:f,stretchX:g,stretchY:x,content:w}){this.paddedRect=s,this.pixelRatio=u,this.stretchX=g,this.stretchY=x,this.content=w,this.version=f}get tl(){return[this.paddedRect.x+ms,this.paddedRect.y+ms]}get br(){return[this.paddedRect.x+this.paddedRect.w-ms,this.paddedRect.y+this.paddedRect.h-ms]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ms)/this.pixelRatio,(this.paddedRect.h-2*ms)/this.pixelRatio]}}class p2{constructor(s,u){const f={},g={};this.haveRenderCallbacks=[];const x=[];this.addImages(s,f,x),this.addImages(u,g,x);const{w,h:S}=f2(x),I=new $s({width:w||1,height:S||1});for(const k in s){const B=s[k],j=f[k].paddedRect;$s.copy(B.data,I,{x:0,y:0},{x:j.x+ms,y:j.y+ms},B.data)}for(const k in u){const B=u[k],j=g[k].paddedRect,H=j.x+ms,Y=j.y+ms,ee=B.data.width,le=B.data.height;$s.copy(B.data,I,{x:0,y:0},{x:H,y:Y},B.data),$s.copy(B.data,I,{x:0,y:le-1},{x:H,y:Y-1},{width:ee,height:1}),$s.copy(B.data,I,{x:0,y:0},{x:H,y:Y+le},{width:ee,height:1}),$s.copy(B.data,I,{x:ee-1,y:0},{x:H-1,y:Y},{width:1,height:le}),$s.copy(B.data,I,{x:0,y:0},{x:H+ee,y:Y},{width:1,height:le})}this.image=I,this.iconPositions=f,this.patternPositions=g}addImages(s,u,f){for(const g in s){const x=s[g],w={x:0,y:0,w:x.data.width+2*ms,h:x.data.height+2*ms};f.push(w),u[g]=new _x(w,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(s,u){s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in s.updatedImages)this.patchUpdatedImage(this.iconPositions[f],s.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],s.getImage(f),u)}patchUpdatedImage(s,u,f){if(!s||!u||s.version===u.version)return;s.version=u.version;const[g,x]=s.tl;f.update(u.data,void 0,{x:g,y:x})}}var Fl;kt("ImagePosition",_x),kt("ImageAtlas",p2),l.WritingMode=void 0,(Fl=l.WritingMode||(l.WritingMode={}))[Fl.none=0]="none",Fl[Fl.horizontal=1]="horizontal",Fl[Fl.vertical=2]="vertical",Fl[Fl.horizontalOnly=3]="horizontalOnly";const Uf=-17;class Vf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,u){const f=new Vf;return f.scale=s||1,f.fontStack=u,f}static forImage(s){const u=new Vf;return u.imageName=s,u}}class ph{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,u){const f=new ph;for(let g=0;g<s.sections.length;g++){const x=s.sections[g];x.image?f.addImageSection(x):f.addTextSection(x,u)}return f}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(){this.text=function(s){let u="";for(let f=0;f<s.length;f++){const g=s.charCodeAt(f+1)||null,x=s.charCodeAt(f-1)||null;u+=g&&Eg(g)&&!Bf[s[f+1]]||x&&Eg(x)&&!Bf[s[f-1]]||!Bf[s[f]]?s[f]:Bf[s[f]]}return u}(this.text)}trim(){let s=0;for(let f=0;f<this.text.length&&Gg[this.text.charCodeAt(f)];f++)s++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=s&&Gg[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(s,u),this.sectionIndex=this.sectionIndex.slice(s,u)}substring(s,u){const f=new ph;return f.text=this.text.substring(s,u),f.sectionIndex=this.sectionIndex.slice(s,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,u)=>Math.max(s,this.sections[u].scale),0)}addTextSection(s,u){this.text+=s.text,this.sections.push(Vf.forText(s.scale,s.fontStack||u));const f=this.sections.length-1;for(let g=0;g<s.text.length;++g)this.sectionIndex.push(f)}addImageSection(s){const u=s.image?s.image.name:"";if(u.length===0)return void Fe("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Vf.forImage(u)),this.sectionIndex.push(this.sections.length-1)):Fe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function $g(c,s,u,f,g,x,w,S,I,k,B,j,H,Y,ee,le){const me=ph.fromFeature(c,g);let _e;j===l.WritingMode.vertical&&me.verticalizePunctuation();const{processBidirectionalText:Me,processStyledBidirectionalText:Ee}=fs;if(Me&&me.sections.length===1){_e=[];const Xe=Me(me.toString(),vx(me,k,x,s,f,Y,ee));for(const St of Xe){const jt=new ph;jt.text=St,jt.sections=me.sections;for(let wt=0;wt<St.length;wt++)jt.sectionIndex.push(0);_e.push(jt)}}else if(Ee){_e=[];const Xe=Ee(me.text,me.sectionIndex,vx(me,k,x,s,f,Y,ee));for(const St of Xe){const jt=new ph;jt.text=St[0],jt.sectionIndex=St[1],jt.sections=me.sections,_e.push(jt)}}else _e=function(Xe,St){const jt=[],wt=Xe.text;let _t=0;for(const lt of St)jt.push(Xe.substring(_t,lt)),_t=lt;return _t<wt.length&&jt.push(Xe.substring(_t,wt.length)),jt}(me,vx(me,k,x,s,f,Y,ee));const Le=[],De={positionedLines:Le,text:me.toString(),top:B[1],bottom:B[1],left:B[0],right:B[0],writingMode:j,iconsInText:!1,verticalizable:!1};return function(Xe,St,jt,wt,_t,lt,zt,ft,rt,tn,Ht,Tn){let ar=0,pr=Uf,ni=0,ks=0;const Yi=ft==="right"?1:ft==="left"?0:.5;let Gr=0;for(const ri of _t){ri.trim();const ii=ri.getMaxScale(),Oi=(ii-1)*ti,Qi={positionedGlyphs:[],lineOffset:0};Xe.positionedLines[Gr]=Qi;const zi=Qi.positionedGlyphs;let gs=0;if(!ri.length()){pr+=lt,++Gr;continue}for(let si=0;si<ri.length();si++){const Mn=ri.getSection(si),Di=ri.getSectionIndex(si),Si=ri.getCharCode(si);let oi=0,wo=null,Ho=null,qo=null,Ya=ti;const Eo=!(rt===l.WritingMode.horizontal||!Ht&&!ff(Si)||Ht&&(Gg[Si]||(mi=Si,Tt.Arabic(mi)||Tt["Arabic Supplement"](mi)||Tt["Arabic Extended-A"](mi)||Tt["Arabic Presentation Forms-A"](mi)||Tt["Arabic Presentation Forms-B"](mi))));if(Mn.imageName){const Ws=wt[Mn.imageName];if(!Ws)continue;qo=Mn.imageName,Xe.iconsInText=Xe.iconsInText||!0,Ho=Ws.paddedRect;const _s=Ws.displaySize;Mn.scale=Mn.scale*ti/Tn,wo={width:_s[0],height:_s[1],left:ms,top:-d2,advance:Eo?_s[1]:_s[0]},oi=Oi+(ti-_s[1]*Mn.scale),Ya=wo.advance;const Ka=Eo?_s[0]*Mn.scale-ti*ii:_s[1]*Mn.scale-ti*ii;Ka>0&&Ka>gs&&(gs=Ka)}else{const Ws=jt[Mn.fontStack],_s=Ws&&Ws[Si];if(_s&&_s.rect)Ho=_s.rect,wo=_s.metrics;else{const Ka=St[Mn.fontStack],Hf=Ka&&Ka[Si];if(!Hf)continue;wo=Hf.metrics}oi=(ii-Mn.scale)*ti}Eo?(Xe.verticalizable=!0,zi.push({glyph:Si,imageName:qo,x:ar,y:pr+oi,vertical:Eo,scale:Mn.scale,fontStack:Mn.fontStack,sectionIndex:Di,metrics:wo,rect:Ho}),ar+=Ya*Mn.scale+tn):(zi.push({glyph:Si,imageName:qo,x:ar,y:pr+oi,vertical:Eo,scale:Mn.scale,fontStack:Mn.fontStack,sectionIndex:Di,metrics:wo,rect:Ho}),ar+=wo.advance*Mn.scale+tn)}zi.length!==0&&(ni=Math.max(ar-tn,ni),pF(zi,0,zi.length-1,Yi,gs)),ar=0;const ys=lt*ii+gs;Qi.lineOffset=Math.max(gs,Oi),pr+=ys,ks=Math.max(ys,ks),++Gr}var mi;const Ti=pr-Uf,{horizontalAlign:Ki,verticalAlign:Ji}=xx(zt);(function(ri,ii,Oi,Qi,zi,gs,ys,si,Mn){const Di=(ii-Oi)*zi;let Si=0;Si=gs!==ys?-si*Qi-Uf:(-Qi*Mn+.5)*ys;for(const oi of ri)for(const wo of oi.positionedGlyphs)wo.x+=Di,wo.y+=Si})(Xe.positionedLines,Yi,Ki,Ji,ni,ks,lt,Ti,_t.length),Xe.top+=-Ji*Ti,Xe.bottom=Xe.top+Ti,Xe.left+=-Ki*ni,Xe.right=Xe.left+ni}(De,s,u,f,_e,w,S,I,j,k,H,le),!function(Xe){for(const St of Xe)if(St.positionedGlyphs.length!==0)return!1;return!0}(Le)&&De}const Gg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},dF={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function m2(c,s,u,f,g,x){if(s.imageName){const w=f[s.imageName];return w?w.displaySize[0]*s.scale*ti/x+g:0}{const w=u[s.fontStack],S=w&&w[c];return S?S.metrics.advance*s.scale+g:0}}function g2(c,s,u,f){const g=Math.pow(c-s,2);return f?c<s?g/2:2*g:g+Math.abs(u)*u}function fF(c,s,u){let f=0;return c===10&&(f-=1e4),u&&(f+=150),c!==40&&c!==65288||(f+=50),s!==41&&s!==65289||(f+=50),f}function y2(c,s,u,f,g,x){let w=null,S=g2(s,u,g,x);for(const I of f){const k=g2(s-I.x,u,g,x)+I.badness;k<=S&&(w=I,S=k)}return{index:c,x:s,priorBreak:w,badness:S}}function _2(c){return c?_2(c.priorBreak).concat(c.index):[]}function vx(c,s,u,f,g,x,w){if(x!=="point")return[];if(!c)return[];const S=[],I=function(H,Y,ee,le,me,_e){let Me=0;for(let Ee=0;Ee<H.length();Ee++){const Le=H.getSection(Ee);Me+=m2(H.getCharCode(Ee),Le,le,me,Y,_e)}return Me/Math.max(1,Math.ceil(Me/ee))}(c,s,u,f,g,w),k=c.text.indexOf("​")>=0;let B=0;for(let H=0;H<c.length();H++){const Y=c.getSection(H),ee=c.getCharCode(H);if(Gg[ee]||(B+=m2(ee,Y,f,g,s,w)),H<c.length()-1){const le=!((j=ee)<11904||!(Tt["Bopomofo Extended"](j)||Tt.Bopomofo(j)||Tt["CJK Compatibility Forms"](j)||Tt["CJK Compatibility Ideographs"](j)||Tt["CJK Compatibility"](j)||Tt["CJK Radicals Supplement"](j)||Tt["CJK Strokes"](j)||Tt["CJK Symbols and Punctuation"](j)||Tt["CJK Unified Ideographs Extension A"](j)||Tt["CJK Unified Ideographs"](j)||Tt["Enclosed CJK Letters and Months"](j)||Tt["Halfwidth and Fullwidth Forms"](j)||Tt.Hiragana(j)||Tt["Ideographic Description Characters"](j)||Tt["Kangxi Radicals"](j)||Tt["Katakana Phonetic Extensions"](j)||Tt.Katakana(j)||Tt["Vertical Forms"](j)||Tt["Yi Radicals"](j)||Tt["Yi Syllables"](j)));(dF[ee]||le||Y.imageName)&&S.push(y2(H+1,B,I,S,fF(ee,c.getCharCode(H+1),le&&k),!1))}}var j;return _2(y2(c.length(),B,I,S,0,!0))}function xx(c){let s=.5,u=.5;switch(c){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:s,verticalAlign:u}}function pF(c,s,u,f,g){if(!f&&!g)return;const x=c[u],w=(c[u].x+x.metrics.advance*x.scale)*f;for(let S=s;S<=u;S++)c[S].x-=w,c[S].y+=g}function mF(c,s,u){const{horizontalAlign:f,verticalAlign:g}=xx(u),x=s[0]-c.displaySize[0]*f,w=s[1]-c.displaySize[1]*g;return{image:c,top:w,bottom:w+c.displaySize[1],left:x,right:x+c.displaySize[0]}}function v2(c,s,u,f,g,x){const w=c.image;let S;if(w.content){const me=w.content,_e=w.pixelRatio||1;S=[me[0]/_e,me[1]/_e,w.displaySize[0]-me[2]/_e,w.displaySize[1]-me[3]/_e]}const I=s.left*x,k=s.right*x;let B,j,H,Y;u==="width"||u==="both"?(Y=g[0]+I-f[3],j=g[0]+k+f[1]):(Y=g[0]+(I+k-w.displaySize[0])/2,j=Y+w.displaySize[0]);const ee=s.top*x,le=s.bottom*x;return u==="height"||u==="both"?(B=g[1]+ee-f[0],H=g[1]+le+f[2]):(B=g[1]+(ee+le-w.displaySize[1])/2,H=B+w.displaySize[1]),{image:w,top:B,right:j,bottom:H,left:Y,collisionPadding:S}}const jf=255,ga=128,Nl=jf*ga;function x2(c,s){const{expression:u}=s;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new sr(c+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:g}=u;let x=0;for(;x<f.length&&f[x]<=c;)x++;x=Math.max(0,x-1);let w=x;for(;w<f.length&&f[w]<c+1;)w++;w=Math.min(f.length-1,w);const S=f[x],I=f[w];return u.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:I,interpolationType:g}:{kind:"camera",minZoom:S,maxZoom:I,minSize:u.evaluate(new sr(S)),maxSize:u.evaluate(new sr(I)),interpolationType:g}}}function bx(c,s,u){let f="never";const g=c.get(s);return g?f=g:c.get(u)&&(f="always"),f}const gF=Dl.VectorTileFeature.types,yF=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Wg(c,s,u,f,g,x,w,S,I,k,B,j,H){const Y=S?Math.min(Nl,Math.round(S[0])):0,ee=S?Math.min(Nl,Math.round(S[1])):0;c.emplaceBack(s,u,Math.round(32*f),Math.round(32*g),x,w,(Y<<1)+(I?1:0),ee,16*k,16*B,256*j,256*H)}function wx(c,s,u){c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u),c.emplaceBack(s.x,s.y,u)}function _F(c){for(const s of c.sections)if(Zv(s.text))return!0;return!1}class Ex{constructor(s){this.layoutVertexArray=new Pn,this.indexArray=new fi,this.programConfigurations=s,this.segments=new or,this.dynamicLayoutVertexArray=new _n,this.opacityVertexArray=new In,this.hasVisibleVertices=!1,this.placedSymbolArray=new Pe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,u,f,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,XD.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,YD.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,yF,!0),this.opacityVertexBuffer.itemSize=1),(f||g)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}kt("SymbolBuffers",Ex);class Tx{constructor(s,u,f){this.layoutVertexArray=new s,this.layoutAttributes=u,this.indexArray=new f,this.segments=new or,this.collisionVertexArray=new tr}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,KD.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}kt("CollisionBuffers",Tx);class mh{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(w=>w.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=tx([]),this.placementViewportMatrix=tx([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=x2(this.zoom,u["text-size"]),this.iconSizeData=x2(this.zoom,u["icon-size"]);const f=this.layers[0].layout,g=f.get("symbol-sort-key"),x=f.get("symbol-z-order");this.canOverlap=bx(f,"text-overlap","text-allow-overlap")!=="never"||bx(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(w=>l.WritingMode[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=s.sourceID}createArrays(){this.text=new Ex(new Wo(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new Ex(new Wo(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new Ie,this.lineVertexArray=new Ne,this.symbolInstances=new ge,this.textAnchorOffsets=new Ze}calculateGlyphDependencies(s,u,f,g,x){for(let w=0;w<s.length;w++)if(u[s.charCodeAt(w)]=!0,(f||g)&&x){const S=Bf[s.charAt(w)];S&&(u[S.charCodeAt(0)]=!0)}}populate(s,u,f){const g=this.layers[0],x=g.layout,w=x.get("text-font"),S=x.get("text-field"),I=x.get("icon-image"),k=(S.value.kind!=="constant"||S.value.value instanceof ir&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),B=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,j=x.get("symbol-sort-key");if(this.features=[],!k&&!B)return;const H=u.iconDependencies,Y=u.glyphDependencies,ee=u.availableImages,le=new sr(this.zoom);for(const{feature:me,id:_e,index:Me,sourceLayerIndex:Ee}of s){const Le=g._featureFilter.needGeometry,De=qc(me,Le);if(!g._featureFilter.filter(le,De,f))continue;let Xe,St;if(Le||(De.geometry=Hc(me)),k){const wt=g.getValueAndResolveTokens("text-field",De,f,ee),_t=ir.factory(wt);_F(_t)&&(this.hasRTLText=!0),(!this.hasRTLText||vf()==="unavailable"||this.hasRTLText&&fs.isParsed())&&(Xe=QD(_t,g,De))}if(B){const wt=g.getValueAndResolveTokens("icon-image",De,f,ee);St=wt instanceof Zn?wt:Zn.fromString(wt)}if(!Xe&&!St)continue;const jt=this.sortFeaturesByKey?j.evaluate(De,{},f):void 0;if(this.features.push({id:_e,text:Xe,icon:St,index:Me,sourceLayerIndex:Ee,geometry:De.geometry,properties:me.properties,type:gF[me.type],sortKey:jt}),St&&(H[St.name]=!0),Xe){const wt=w.evaluate(De,{},f).join(","),_t=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.WritingMode.vertical)>=0;for(const lt of Xe.sections)if(lt.image)H[lt.image.name]=!0;else{const zt=hf(Xe.toString()),ft=lt.fontStack||wt,rt=Y[ft]=Y[ft]||{};this.calculateGlyphDependencies(lt.text,rt,_t,this.allowVerticalPlacement,zt)}}}x.get("symbol-placement")==="line"&&(this.features=function(me){const _e={},Me={},Ee=[];let Le=0;function De(wt){Ee.push(me[wt]),Le++}function Xe(wt,_t,lt){const zt=Me[wt];return delete Me[wt],Me[_t]=zt,Ee[zt].geometry[0].pop(),Ee[zt].geometry[0]=Ee[zt].geometry[0].concat(lt[0]),zt}function St(wt,_t,lt){const zt=_e[_t];return delete _e[_t],_e[wt]=zt,Ee[zt].geometry[0].shift(),Ee[zt].geometry[0]=lt[0].concat(Ee[zt].geometry[0]),zt}function jt(wt,_t,lt){const zt=lt?_t[0][_t[0].length-1]:_t[0][0];return`${wt}:${zt.x}:${zt.y}`}for(let wt=0;wt<me.length;wt++){const _t=me[wt],lt=_t.geometry,zt=_t.text?_t.text.toString():null;if(!zt){De(wt);continue}const ft=jt(zt,lt),rt=jt(zt,lt,!0);if(ft in Me&&rt in _e&&Me[ft]!==_e[rt]){const tn=St(ft,rt,lt),Ht=Xe(ft,rt,Ee[tn].geometry);delete _e[ft],delete Me[rt],Me[jt(zt,Ee[Ht].geometry,!0)]=Ht,Ee[tn].geometry=null}else ft in Me?Xe(ft,rt,lt):rt in _e?St(ft,rt,lt):(De(wt),_e[ft]=Le-1,Me[rt]=Le-1)}return Ee.filter(wt=>wt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((me,_e)=>me.sortKey-_e.sortKey)}update(s,u,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,u,this.layers,f),this.icon.programConfigurations.updatePaintArrays(s,u,this.layers,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,u){const f=this.lineVertexArray.length;if(s.segment!==void 0){let g=s.dist(u[s.segment+1]),x=s.dist(u[s.segment]);const w={};for(let S=s.segment+1;S<u.length;S++)w[S]={x:u[S].x,y:u[S].y,tileUnitDistanceFromAnchor:g},S<u.length-1&&(g+=u[S+1].dist(u[S]));for(let S=s.segment||0;S>=0;S--)w[S]={x:u[S].x,y:u[S].y,tileUnitDistanceFromAnchor:x},S>0&&(x+=u[S-1].dist(u[S]));for(let S=0;S<u.length;S++){const I=w[S];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(s,u,f,g,x,w,S,I,k,B,j,H){const Y=s.indexArray,ee=s.layoutVertexArray,le=s.segments.prepareSegment(4*u.length,ee,Y,this.canOverlap?w.sortKey:void 0),me=this.glyphOffsetArray.length,_e=le.vertexLength,Me=this.allowVerticalPlacement&&S===l.WritingMode.vertical?Math.PI/2:0,Ee=w.text&&w.text.sections;for(let Le=0;Le<u.length;Le++){const{tl:De,tr:Xe,bl:St,br:jt,tex:wt,pixelOffsetTL:_t,pixelOffsetBR:lt,minFontScaleX:zt,minFontScaleY:ft,glyphOffset:rt,isSDF:tn,sectionIndex:Ht}=u[Le],Tn=le.vertexLength,ar=rt[1];Wg(ee,I.x,I.y,De.x,ar+De.y,wt.x,wt.y,f,tn,_t.x,_t.y,zt,ft),Wg(ee,I.x,I.y,Xe.x,ar+Xe.y,wt.x+wt.w,wt.y,f,tn,lt.x,_t.y,zt,ft),Wg(ee,I.x,I.y,St.x,ar+St.y,wt.x,wt.y+wt.h,f,tn,_t.x,lt.y,zt,ft),Wg(ee,I.x,I.y,jt.x,ar+jt.y,wt.x+wt.w,wt.y+wt.h,f,tn,lt.x,lt.y,zt,ft),wx(s.dynamicLayoutVertexArray,I,Me),Y.emplaceBack(Tn,Tn+1,Tn+2),Y.emplaceBack(Tn+1,Tn+2,Tn+3),le.vertexLength+=4,le.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(rt[0]),Le!==u.length-1&&Ht===u[Le+1].sectionIndex||s.programConfigurations.populatePaintArrays(ee.length,w,w.index,{},H,Ee&&Ee[Ht])}s.placedSymbolArray.emplaceBack(I.x,I.y,me,this.glyphOffsetArray.length-me,_e,k,B,I.segment,f?f[0]:0,f?f[1]:0,g[0],g[1],S,0,!1,0,j)}_addCollisionDebugVertex(s,u,f,g,x,w){return u.emplaceBack(0,0),s.emplaceBack(f.x,f.y,g,x,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(s,u,f,g,x,w,S){const I=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),k=I.vertexLength,B=x.layoutVertexArray,j=x.collisionVertexArray,H=S.anchorX,Y=S.anchorY;this._addCollisionDebugVertex(B,j,w,H,Y,new T(s,u)),this._addCollisionDebugVertex(B,j,w,H,Y,new T(f,u)),this._addCollisionDebugVertex(B,j,w,H,Y,new T(f,g)),this._addCollisionDebugVertex(B,j,w,H,Y,new T(s,g)),I.vertexLength+=4;const ee=x.indexArray;ee.emplaceBack(k,k+1),ee.emplaceBack(k+1,k+2),ee.emplaceBack(k+2,k+3),ee.emplaceBack(k+3,k),I.primitiveLength+=4}addDebugCollisionBoxes(s,u,f,g){for(let x=s;x<u;x++){const w=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,g?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Tx(Mr,i2.members,Qr),this.iconCollisionBox=new Tx(Mr,i2.members,Qr);for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}}_deserializeCollisionBoxesForSymbol(s,u,f,g,x,w,S,I,k){const B={};for(let j=u;j<f;j++){const H=s.get(j);B.textBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.textFeatureIndex=H.featureIndex;break}for(let j=g;j<x;j++){const H=s.get(j);B.verticalTextBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.verticalTextFeatureIndex=H.featureIndex;break}for(let j=w;j<S;j++){const H=s.get(j);B.iconBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.iconFeatureIndex=H.featureIndex;break}for(let j=I;j<k;j++){const H=s.get(j);B.verticalIconBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,anchorPointX:H.anchorPointX,anchorPointY:H.anchorPointY},B.verticalIconFeatureIndex=H.featureIndex;break}return B}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,u){const f=s.placedSymbolArray.get(u),g=f.vertexStartIndex+4*f.numGlyphs;for(let x=f.vertexStartIndex;x<g;x+=4)s.indexArray.emplaceBack(x,x+1,x+2),s.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(s),f=Math.cos(s),g=[],x=[],w=[];for(let S=0;S<this.symbolInstances.length;++S){w.push(S);const I=this.symbolInstances.get(S);g.push(0|Math.round(u*I.anchorX+f*I.anchorY)),x.push(I.featureIndex)}return w.sort((S,I)=>g[S]-g[I]||x[I]-x[S]),w}addToSortKeyRanges(s,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((g,x,w)=>{g>=0&&w.indexOf(g)===x&&this.addIndicesForPlacedSymbol(this.text,g)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let b2,w2;kt("SymbolBucket",mh,{omit:["layers","collisionBoxArray","features","compareText"]}),mh.MAX_GLYPHS=65535,mh.addDynamicAttributes=wx;var Sx={get paint(){return w2=w2||new zr({"icon-opacity":new on(Ae.paint_symbol["icon-opacity"]),"icon-color":new on(Ae.paint_symbol["icon-color"]),"icon-halo-color":new on(Ae.paint_symbol["icon-halo-color"]),"icon-halo-width":new on(Ae.paint_symbol["icon-halo-width"]),"icon-halo-blur":new on(Ae.paint_symbol["icon-halo-blur"]),"icon-translate":new Xt(Ae.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xt(Ae.paint_symbol["icon-translate-anchor"]),"text-opacity":new on(Ae.paint_symbol["text-opacity"]),"text-color":new on(Ae.paint_symbol["text-color"],{runtimeType:Cr,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new on(Ae.paint_symbol["text-halo-color"]),"text-halo-width":new on(Ae.paint_symbol["text-halo-width"]),"text-halo-blur":new on(Ae.paint_symbol["text-halo-blur"]),"text-translate":new Xt(Ae.paint_symbol["text-translate"]),"text-translate-anchor":new Xt(Ae.paint_symbol["text-translate-anchor"])})},get layout(){return b2=b2||new zr({"symbol-placement":new Xt(Ae.layout_symbol["symbol-placement"]),"symbol-spacing":new Xt(Ae.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xt(Ae.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new on(Ae.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xt(Ae.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Xt(Ae.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Xt(Ae.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Xt(Ae.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xt(Ae.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xt(Ae.layout_symbol["icon-rotation-alignment"]),"icon-size":new on(Ae.layout_symbol["icon-size"]),"icon-text-fit":new Xt(Ae.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Xt(Ae.layout_symbol["icon-text-fit-padding"]),"icon-image":new on(Ae.layout_symbol["icon-image"]),"icon-rotate":new on(Ae.layout_symbol["icon-rotate"]),"icon-padding":new on(Ae.layout_symbol["icon-padding"]),"icon-keep-upright":new Xt(Ae.layout_symbol["icon-keep-upright"]),"icon-offset":new on(Ae.layout_symbol["icon-offset"]),"icon-anchor":new on(Ae.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xt(Ae.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xt(Ae.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xt(Ae.layout_symbol["text-rotation-alignment"]),"text-field":new on(Ae.layout_symbol["text-field"]),"text-font":new on(Ae.layout_symbol["text-font"]),"text-size":new on(Ae.layout_symbol["text-size"]),"text-max-width":new on(Ae.layout_symbol["text-max-width"]),"text-line-height":new Xt(Ae.layout_symbol["text-line-height"]),"text-letter-spacing":new on(Ae.layout_symbol["text-letter-spacing"]),"text-justify":new on(Ae.layout_symbol["text-justify"]),"text-radial-offset":new on(Ae.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xt(Ae.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new on(Ae.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new on(Ae.layout_symbol["text-anchor"]),"text-max-angle":new Xt(Ae.layout_symbol["text-max-angle"]),"text-writing-mode":new Xt(Ae.layout_symbol["text-writing-mode"]),"text-rotate":new on(Ae.layout_symbol["text-rotate"]),"text-padding":new Xt(Ae.layout_symbol["text-padding"]),"text-keep-upright":new Xt(Ae.layout_symbol["text-keep-upright"]),"text-transform":new on(Ae.layout_symbol["text-transform"]),"text-offset":new on(Ae.layout_symbol["text-offset"]),"text-allow-overlap":new Xt(Ae.layout_symbol["text-allow-overlap"]),"text-overlap":new Xt(Ae.layout_symbol["text-overlap"]),"text-ignore-placement":new Xt(Ae.layout_symbol["text-ignore-placement"]),"text-optional":new Xt(Ae.layout_symbol["text-optional"])})}};class E2{constructor(s){if(s.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=s.property.overrides?s.property.overrides.runtimeType:Fn,this.defaultValue=s}evaluate(s){if(s.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(s.formattedSection))return u.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}kt("FormatSectionOverride",E2,{omit:["defaultValue"]});class Hg extends Is{constructor(s){super(s,Sx)}recalculate(s,u){if(super.recalculate(s,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const g=[];for(const x of f)g.indexOf(x)<0&&g.push(x);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(s,u,f,g){const x=this.layout.get(s).evaluate(u,{},f,g),w=this._unevaluatedLayout._values[s];return w.isDataDriven()||Xu(w.value)||!x?x:function(S,I){return I.replace(/{([^{}]+)}/g,(k,B)=>B in S?String(S[B]):"")}(u.properties,x)}createBucket(s){return new mh(s)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const s of Sx.paint.overridableProperties){if(!Hg.hasPaintOverride(this.layout,s))continue;const u=this.paint.get(s),f=new E2(u),g=new sf(f,u.property.specification);let x=null;x=u.value.kind==="constant"||u.value.kind==="source"?new of("source",g):new Ku("composite",g,u.value.zoomStops),this.paint._values[s]=new Li(u.property,x,u.parameters)}}_handleOverridablePaintPropertyUpdate(s,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&Hg.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,u){const f=s.get("text-field"),g=Sx.paint.properties[u];let x=!1;const w=S=>{for(const I of S)if(g.overrides&&g.overrides.hasOverride(I))return void(x=!0)};if(f.value.kind==="constant"&&f.value.value instanceof ir)w(f.value.value.sections);else if(f.value.kind==="source"){const S=k=>{x||(k instanceof js&&Jn(k.value)===xi?w(k.value.sections):k instanceof Zu?w(k.sections):k.eachChild(S))},I=f.value;I._styleExpression&&S(I._styleExpression.expression)}return x}}let T2;var vF={get paint(){return T2=T2||new zr({"background-color":new Xt(Ae.paint_background["background-color"]),"background-pattern":new bf(Ae.paint_background["background-pattern"]),"background-opacity":new Xt(Ae.paint_background["background-opacity"])})}};class xF extends Is{constructor(s){super(s,vF)}}let S2;var bF={get paint(){return S2=S2||new zr({"raster-opacity":new Xt(Ae.paint_raster["raster-opacity"]),"raster-hue-rotate":new Xt(Ae.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xt(Ae.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xt(Ae.paint_raster["raster-brightness-max"]),"raster-saturation":new Xt(Ae.paint_raster["raster-saturation"]),"raster-contrast":new Xt(Ae.paint_raster["raster-contrast"]),"raster-resampling":new Xt(Ae.paint_raster["raster-resampling"]),"raster-fade-duration":new Xt(Ae.paint_raster["raster-fade-duration"])})}};class wF extends Is{constructor(s){super(s,bF)}}class EF extends Is{constructor(s){super(s,{}),this.onAdd=u=>{this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},this.onRemove=u=>{this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class TF{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Px=63710088e-1;class Bl{constructor(s,u){if(isNaN(s)||isNaN(u))throw new Error(`Invalid LngLat object: (${s}, ${u})`);if(this.lng=+s,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Bl(ne(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const u=Math.PI/180,f=this.lat*u,g=s.lat*u,x=Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos((s.lng-this.lng)*u);return Px*Math.acos(Math.min(x,1))}static convert(s){if(s instanceof Bl)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Bl(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Bl(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const P2=2*Math.PI*Px;function C2(c){return P2*Math.cos(c*Math.PI/180)}function A2(c){return(180+c)/360}function I2(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function M2(c,s){return c/C2(s)}function Cx(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}class qg{constructor(s,u,f=0){this.x=+s,this.y=+u,this.z=+f}static fromLngLat(s,u=0){const f=Bl.convert(s);return new qg(A2(f.lng),I2(f.lat),M2(u,f.lat))}toLngLat(){return new Bl(360*this.x-180,Cx(this.y))}toAltitude(){return this.z*C2(Cx(this.y))}meterInMercatorCoordinateUnits(){return 1/P2*(s=Cx(this.y),1/Math.cos(s*Math.PI/180));var s}}function k2(c,s,u){var f=2*Math.PI*6378137/256/Math.pow(2,u);return[c*f-2*Math.PI*6378137/2,s*f-2*Math.PI*6378137/2]}class Ax{constructor(s,u,f){if(s<0||s>25||f<0||f>=Math.pow(2,s)||u<0||u>=Math.pow(2,s))throw new Error(`x=${u}, y=${f}, z=${s} outside of bounds. 0<=x<${Math.pow(2,s)}, 0<=y<${Math.pow(2,s)} 0<=z<=25 `);this.z=s,this.x=u,this.y=f,this.key=$f(0,s,s,u,f)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,u,f){const g=(w=this.y,S=this.z,I=k2(256*(x=this.x),256*(w=Math.pow(2,S)-w-1),S),k=k2(256*(x+1),256*(w+1),S),I[0]+","+I[1]+","+k[0]+","+k[1]);var x,w,S,I,k;const B=function(j,H,Y){let ee,le="";for(let me=j;me>0;me--)ee=1<<me-1,le+=(H&ee?1:0)+(Y&ee?2:0);return le}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,u>1?"@2x":"").replace(/{quadkey}/g,B).replace(/{bbox-epsg-3857}/g,g)}isChildOf(s){const u=this.z-s.z;return u>0&&s.x===this.x>>u&&s.y===this.y>>u}getTilePoint(s){const u=Math.pow(2,this.z);return new T((s.x*u-this.x)*$r,(s.y*u-this.y)*$r)}toString(){return`${this.z}/${this.x}/${this.y}`}}class L2{constructor(s,u){this.wrap=s,this.canonical=u,this.key=$f(s,u.z,u.z,u.x,u.y)}}class Gs{constructor(s,u,f,g,x){if(s<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${s}; z = ${f}`);this.overscaledZ=s,this.wrap=u,this.canonical=new Ax(f,+g,+x),this.key=$f(u,s,f,g,x)}clone(){return new Gs(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-s;return s>this.canonical.z?new Gs(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Gs(s,this.wrap,s,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(s,u){if(s>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${s}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-s;return s>this.canonical.z?$f(this.wrap*+u,s,this.canonical.z,this.canonical.x,this.canonical.y):$f(this.wrap*+u,s,s,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(s){if(s.wrap!==this.wrap)return!1;const u=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>u&&s.canonical.y===this.canonical.y>>u}children(s){if(this.overscaledZ>=s)return[new Gs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,g=2*this.canonical.y;return[new Gs(u,this.wrap,u,f,g),new Gs(u,this.wrap,u,f+1,g),new Gs(u,this.wrap,u,f,g+1),new Gs(u,this.wrap,u,f+1,g+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Gs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Gs(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new L2(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(s){return this.canonical.getTilePoint(new qg(s.x-this.wrap,s.y))}}function $f(c,s,u,f,g){(c*=2)<0&&(c=-1*c-1);const x=1<<u;return(x*x*c+x*g+f).toString(36)+u.toString(36)+s.toString(36)}kt("CanonicalTileID",Ax),kt("OverscaledTileID",Gs,{omit:["posMatrix"]});class R2{constructor(s,u,f,g=1,x=1,w=1,S=0){if(this.uid=s,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void Fe(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=u.height;const I=this.dim=u.height-2;switch(this.data=new Uint32Array(u.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=x,this.blueFactor=w,this.baseShift=S;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<I;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(I,k)]=this.data[this._idx(I-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,I)]=this.data[this._idx(k,I-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(I,-1)]=this.data[this._idx(I-1,0)],this.data[this._idx(-1,I)]=this.data[this._idx(0,I-1)],this.data[this._idx(I,I)]=this.data[this._idx(I-1,I-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<I;k++)for(let B=0;B<I;B++){const j=this.get(k,B);j>this.max&&(this.max=j),j<this.min&&(this.min=j)}}get(s,u){const f=new Uint8Array(this.data.buffer),g=4*this._idx(s,u);return this.unpack(f[g],f[g+1],f[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(s,u){if(s<-1||s>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(s+1)}unpack(s,u,f){return s*this.redFactor+u*this.greenFactor+f*this.blueFactor-this.baseShift}getPixels(){return new $s({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(s,u,f){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let g=u*this.dim,x=u*this.dim+this.dim,w=f*this.dim,S=f*this.dim+this.dim;switch(u){case-1:g=x-1;break;case 1:x=g+1}switch(f){case-1:w=S-1;break;case 1:S=w+1}const I=-u*this.dim,k=-f*this.dim;for(let B=w;B<S;B++)for(let j=g;j<x;j++)this.data[this._idx(j,B)]=s.data[this._idx(j+I,B+k)]}}kt("DEMData",R2);class O2{constructor(s){this._stringToNumber={},this._numberToString=[];for(let u=0;u<s.length;u++){const f=s[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(s){return this._stringToNumber[s]}decode(s){if(s>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${s} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[s]}}class z2{constructor(s,u,f,g,x){this.type="Feature",this._vectorTileFeature=s,s._z=u,s._x=f,s._y=g,this.properties=s.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={geometry:this.geometry};for(const u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(s[u]=this[u]);return s}}class D2{constructor(s,u){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new kl($r,16,0),this.grid3D=new kl($r,16,0),this.featureIndexArray=new Ke,this.promoteId=u}insert(s,u,f,g,x,w){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,g,x);const I=w?this.grid3D:this.grid;for(let k=0;k<u.length;k++){const B=u[k],j=[1/0,1/0,-1/0,-1/0];for(let H=0;H<B.length;H++){const Y=B[H];j[0]=Math.min(j[0],Y.x),j[1]=Math.min(j[1],Y.y),j[2]=Math.max(j[2],Y.x),j[3]=Math.max(j[3],Y.y)}j[0]<$r&&j[1]<$r&&j[2]>=0&&j[3]>=0&&I.insert(S,j[0],j[1],j[2],j[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Dl.VectorTile(new gx(this.rawTileData)).layers,this.sourceLayerCoder=new O2(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(s,u,f,g){this.loadVTLayers();const x=s.params||{},w=$r/s.tileSize/s.scale,S=lf(x.filter),I=s.queryGeometry,k=s.queryPadding*w,B=N2(I),j=this.grid.query(B.minX-k,B.minY-k,B.maxX+k,B.maxY+k),H=N2(s.cameraQueryGeometry),Y=this.grid3D.query(H.minX-k,H.minY-k,H.maxX+k,H.maxY+k,(me,_e,Me,Ee)=>function(Le,De,Xe,St,jt){for(const _t of Le)if(De<=_t.x&&Xe<=_t.y&&St>=_t.x&&jt>=_t.y)return!0;const wt=[new T(De,Xe),new T(De,jt),new T(St,jt),new T(St,Xe)];if(Le.length>2){for(const _t of wt)if(lh(Le,_t))return!0}for(let _t=0;_t<Le.length-1;_t++)if(nD(Le[_t],Le[_t+1],wt))return!0;return!1}(s.cameraQueryGeometry,me-k,_e-k,Me+k,Ee+k));for(const me of Y)j.push(me);j.sort(SF);const ee={};let le;for(let me=0;me<j.length;me++){const _e=j[me];if(_e===le)continue;le=_e;const Me=this.featureIndexArray.get(_e);let Ee=null;this.loadMatchingFeature(ee,Me.bucketIndex,Me.sourceLayerIndex,Me.featureIndex,S,x.layers,x.availableImages,u,f,g,(Le,De,Xe)=>(Ee||(Ee=Hc(Le)),De.queryIntersectsFeature(I,Le,Xe,Ee,this.z,s.transform,w,s.pixelPosMatrix)))}return ee}loadMatchingFeature(s,u,f,g,x,w,S,I,k,B,j){const H=this.bucketLayerIDs[u];if(w&&!function(me,_e){for(let Me=0;Me<me.length;Me++)if(_e.indexOf(me[Me])>=0)return!0;return!1}(w,H))return;const Y=this.sourceLayerCoder.decode(f),ee=this.vtLayers[Y].feature(g);if(x.needGeometry){const me=qc(ee,!0);if(!x.filter(new sr(this.tileID.overscaledZ),me,this.tileID.canonical))return}else if(!x.filter(new sr(this.tileID.overscaledZ),ee))return;const le=this.getId(ee,Y);for(let me=0;me<H.length;me++){const _e=H[me];if(w&&w.indexOf(_e)<0)continue;const Me=I[_e];if(!Me)continue;let Ee={};le&&B&&(Ee=B.getState(Me.sourceLayer||"_geojsonTileLayer",le));const Le=re({},k[_e]);Le.paint=F2(Le.paint,Me.paint,ee,Ee,S),Le.layout=F2(Le.layout,Me.layout,ee,Ee,S);const De=!j||j(ee,Me,Ee);if(!De)continue;const Xe=new z2(ee,this.z,this.x,this.y,le);Xe.layer=Le;let St=s[_e];St===void 0&&(St=s[_e]=[]),St.push({featureIndex:g,feature:Xe,intersectionZ:De})}}lookupSymbolFeatures(s,u,f,g,x,w,S,I){const k={};this.loadVTLayers();const B=lf(x);for(const j of s)this.loadMatchingFeature(k,f,g,j,B,w,S,I,u);return k}hasLayer(s){for(const u of this.bucketLayerIDs)for(const f of u)if(s===f)return!0;return!1}getId(s,u){let f=s.id;return this.promoteId&&(f=s.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]],typeof f=="boolean"&&(f=Number(f))),f}}function F2(c,s,u,f,g){return xe(c,(x,w)=>{const S=s instanceof oh?s.get(w):null;return S&&S.evaluate?S.evaluate(u,f,g):S})}function N2(c){let s=1/0,u=1/0,f=-1/0,g=-1/0;for(const x of c)s=Math.min(s,x.x),u=Math.min(u,x.y),f=Math.max(f,x.x),g=Math.max(g,x.y);return{minX:s,minY:u,maxX:f,maxY:g}}function SF(c,s){return s-c}function B2(c,s,u,f,g){const x=[];for(let w=0;w<c.length;w++){const S=c[w];let I;for(let k=0;k<S.length-1;k++){let B=S[k],j=S[k+1];B.x<s&&j.x<s||(B.x<s?B=new T(s,B.y+(s-B.x)/(j.x-B.x)*(j.y-B.y))._round():j.x<s&&(j=new T(s,B.y+(s-B.x)/(j.x-B.x)*(j.y-B.y))._round()),B.y<u&&j.y<u||(B.y<u?B=new T(B.x+(u-B.y)/(j.y-B.y)*(j.x-B.x),u)._round():j.y<u&&(j=new T(B.x+(u-B.y)/(j.y-B.y)*(j.x-B.x),u)._round()),B.x>=f&&j.x>=f||(B.x>=f?B=new T(f,B.y+(f-B.x)/(j.x-B.x)*(j.y-B.y))._round():j.x>=f&&(j=new T(f,B.y+(f-B.x)/(j.x-B.x)*(j.y-B.y))._round()),B.y>=g&&j.y>=g||(B.y>=g?B=new T(B.x+(g-B.y)/(j.y-B.y)*(j.x-B.x),g)._round():j.y>=g&&(j=new T(B.x+(g-B.y)/(j.y-B.y)*(j.x-B.x),g)._round()),I&&B.equals(I[I.length-1])||(I=[B],x.push(I)),I.push(j)))))}}return x}kt("FeatureIndex",D2,{omit:["rawTileData","sourceLayerCoder"]});class Ul extends T{constructor(s,u,f,g){super(s,u),this.angle=f,g!==void 0&&(this.segment=g)}clone(){return new Ul(this.x,this.y,this.angle,this.segment)}}function U2(c,s,u,f,g){if(s.segment===void 0||u===0)return!0;let x=s,w=s.segment+1,S=0;for(;S>-u/2;){if(w--,w<0)return!1;S-=c[w].dist(x),x=c[w]}S+=c[w].dist(c[w+1]),w++;const I=[];let k=0;for(;S<u/2;){const B=c[w],j=c[w+1];if(!j)return!1;let H=c[w-1].angleTo(B)-B.angleTo(j);for(H=Math.abs((H+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:S,angleDelta:H}),k+=H;S-I[0].distance>f;)k-=I.shift().angleDelta;if(k>g)return!1;w++,S+=B.dist(j)}return!0}function V2(c){let s=0;for(let u=0;u<c.length-1;u++)s+=c[u].dist(c[u+1]);return s}function j2(c,s,u){return c?.6*s*u:0}function $2(c,s){return Math.max(c?c.right-c.left:0,s?s.right-s.left:0)}function PF(c,s,u,f,g,x){const w=j2(u,g,x),S=$2(u,f)*x;let I=0;const k=V2(c)/2;for(let B=0;B<c.length-1;B++){const j=c[B],H=c[B+1],Y=j.dist(H);if(I+Y>k){const ee=(k-I)/Y,le=us.number(j.x,H.x,ee),me=us.number(j.y,H.y,ee),_e=new Ul(le,me,H.angleTo(j),B);return _e._round(),!w||U2(c,_e,S,w,s)?_e:void 0}I+=Y}}function CF(c,s,u,f,g,x,w,S,I){const k=j2(f,x,w),B=$2(f,g),j=B*w,H=c[0].x===0||c[0].x===I||c[0].y===0||c[0].y===I;return s-j<s/4&&(s=j+s/4),G2(c,H?s/2*S%s:(B/2+2*x)*w*S%s,s,k,u,j,H,!1,I)}function G2(c,s,u,f,g,x,w,S,I){const k=x/2,B=V2(c);let j=0,H=s-u,Y=[];for(let ee=0;ee<c.length-1;ee++){const le=c[ee],me=c[ee+1],_e=le.dist(me),Me=me.angleTo(le);for(;H+u<j+_e;){H+=u;const Ee=(H-j)/_e,Le=us.number(le.x,me.x,Ee),De=us.number(le.y,me.y,Ee);if(Le>=0&&Le<I&&De>=0&&De<I&&H-k>=0&&H+k<=B){const Xe=new Ul(Le,De,Me,ee);Xe._round(),f&&!U2(c,Xe,x,f,g)||Y.push(Xe)}}j+=_e}return S||Y.length||w||(Y=G2(c,j/2,u,f,g,x,w,!0,I)),Y}kt("Anchor",Ul);const gh=ms;function W2(c,s,u,f){const g=[],x=c.image,w=x.pixelRatio,S=x.paddedRect.w-2*gh,I=x.paddedRect.h-2*gh,k=c.right-c.left,B=c.bottom-c.top,j=x.stretchX||[[0,S]],H=x.stretchY||[[0,I]],Y=(lt,zt)=>lt+zt[1]-zt[0],ee=j.reduce(Y,0),le=H.reduce(Y,0),me=S-ee,_e=I-le;let Me=0,Ee=ee,Le=0,De=le,Xe=0,St=me,jt=0,wt=_e;if(x.content&&f){const lt=x.content;Me=Zg(j,0,lt[0]),Le=Zg(H,0,lt[1]),Ee=Zg(j,lt[0],lt[2]),De=Zg(H,lt[1],lt[3]),Xe=lt[0]-Me,jt=lt[1]-Le,St=lt[2]-lt[0]-Ee,wt=lt[3]-lt[1]-De}const _t=(lt,zt,ft,rt)=>{const tn=Xg(lt.stretch-Me,Ee,k,c.left),Ht=Yg(lt.fixed-Xe,St,lt.stretch,ee),Tn=Xg(zt.stretch-Le,De,B,c.top),ar=Yg(zt.fixed-jt,wt,zt.stretch,le),pr=Xg(ft.stretch-Me,Ee,k,c.left),ni=Yg(ft.fixed-Xe,St,ft.stretch,ee),ks=Xg(rt.stretch-Le,De,B,c.top),Yi=Yg(rt.fixed-jt,wt,rt.stretch,le),Gr=new T(tn,Tn),mi=new T(pr,Tn),Ti=new T(pr,ks),Ki=new T(tn,ks),Ji=new T(Ht/w,ar/w),ri=new T(ni/w,Yi/w),ii=s*Math.PI/180;if(ii){const zi=Math.sin(ii),gs=Math.cos(ii),ys=[gs,-zi,zi,gs];Gr._matMult(ys),mi._matMult(ys),Ki._matMult(ys),Ti._matMult(ys)}const Oi=lt.stretch+lt.fixed,Qi=zt.stretch+zt.fixed;return{tl:Gr,tr:mi,bl:Ki,br:Ti,tex:{x:x.paddedRect.x+gh+Oi,y:x.paddedRect.y+gh+Qi,w:ft.stretch+ft.fixed-Oi,h:rt.stretch+rt.fixed-Qi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ji,pixelOffsetBR:ri,minFontScaleX:St/w/k,minFontScaleY:wt/w/B,isSDF:u}};if(f&&(x.stretchX||x.stretchY)){const lt=H2(j,me,ee),zt=H2(H,_e,le);for(let ft=0;ft<lt.length-1;ft++){const rt=lt[ft],tn=lt[ft+1];for(let Ht=0;Ht<zt.length-1;Ht++)g.push(_t(rt,zt[Ht],tn,zt[Ht+1]))}}else g.push(_t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:I+1}));return g}function Zg(c,s,u){let f=0;for(const g of c)f+=Math.max(s,Math.min(u,g[1]))-Math.max(s,Math.min(u,g[0]));return f}function H2(c,s,u){const f=[{fixed:-gh,stretch:0}];for(const[g,x]of c){const w=f[f.length-1];f.push({fixed:g-w.stretch,stretch:w.stretch}),f.push({fixed:g-w.stretch,stretch:w.stretch+(x-g)})}return f.push({fixed:s+gh,stretch:u}),f}function Xg(c,s,u,f){return c/s*u+f}function Yg(c,s,u,f){return c-s*u/f}class Kg{constructor(s,u,f,g,x,w,S,I,k,B){if(this.boxStartIndex=s.length,k){let j=w.top,H=w.bottom;const Y=w.collisionPadding;Y&&(j-=Y[1],H+=Y[3]);let ee=H-j;ee>0&&(ee=Math.max(10,ee),this.circleDiameter=ee)}else{let j=w.top*S-I[0],H=w.bottom*S+I[2],Y=w.left*S-I[3],ee=w.right*S+I[1];const le=w.collisionPadding;if(le&&(Y-=le[0]*S,j-=le[1]*S,ee+=le[2]*S,H+=le[3]*S),B){const me=new T(Y,j),_e=new T(ee,j),Me=new T(Y,H),Ee=new T(ee,H),Le=B*Math.PI/180;me._rotate(Le),_e._rotate(Le),Me._rotate(Le),Ee._rotate(Le),Y=Math.min(me.x,_e.x,Me.x,Ee.x),ee=Math.max(me.x,_e.x,Me.x,Ee.x),j=Math.min(me.y,_e.y,Me.y,Ee.y),H=Math.max(me.y,_e.y,Me.y,Ee.y)}s.emplaceBack(u.x,u.y,Y,j,ee,H,f,g,x)}this.boxEndIndex=s.length}}class AF{constructor(s=[],u=IF){if(this.data=s,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:u,compare:f}=this,g=u[s];for(;s>0;){const x=s-1>>1,w=u[x];if(f(g,w)>=0)break;u[s]=w,s=x}u[s]=g}_down(s){const{data:u,compare:f}=this,g=this.length>>1,x=u[s];for(;s<g;){let w=1+(s<<1),S=u[w];const I=w+1;if(I<this.length&&f(u[I],S)<0&&(w=I,S=u[I]),f(S,x)>=0)break;u[s]=S,s=w}u[s]=x}}function IF(c,s){return c<s?-1:c>s?1:0}function MF(c,s=1,u=!1){let f=1/0,g=1/0,x=-1/0,w=-1/0;const S=c[0];for(let Y=0;Y<S.length;Y++){const ee=S[Y];(!Y||ee.x<f)&&(f=ee.x),(!Y||ee.y<g)&&(g=ee.y),(!Y||ee.x>x)&&(x=ee.x),(!Y||ee.y>w)&&(w=ee.y)}const I=Math.min(x-f,w-g);let k=I/2;const B=new AF([],kF);if(I===0)return new T(f,g);for(let Y=f;Y<x;Y+=I)for(let ee=g;ee<w;ee+=I)B.push(new yh(Y+k,ee+k,k,c));let j=function(Y){let ee=0,le=0,me=0;const _e=Y[0];for(let Me=0,Ee=_e.length,Le=Ee-1;Me<Ee;Le=Me++){const De=_e[Me],Xe=_e[Le],St=De.x*Xe.y-Xe.x*De.y;le+=(De.x+Xe.x)*St,me+=(De.y+Xe.y)*St,ee+=3*St}return new yh(le/ee,me/ee,0,Y)}(c),H=B.length;for(;B.length;){const Y=B.pop();(Y.d>j.d||!j.d)&&(j=Y,u&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,H)),Y.max-j.d<=s||(k=Y.h/2,B.push(new yh(Y.p.x-k,Y.p.y-k,k,c)),B.push(new yh(Y.p.x+k,Y.p.y-k,k,c)),B.push(new yh(Y.p.x-k,Y.p.y+k,k,c)),B.push(new yh(Y.p.x+k,Y.p.y+k,k,c)),H+=4)}return u&&(console.log(`num probes: ${H}`),console.log(`best distance: ${j.d}`)),j.p}function kF(c,s){return s.max-c.max}function yh(c,s,u,f){this.p=new T(c,s),this.h=u,this.d=function(g,x){let w=!1,S=1/0;for(let I=0;I<x.length;I++){const k=x[I];for(let B=0,j=k.length,H=j-1;B<j;H=B++){const Y=k[B],ee=k[H];Y.y>g.y!=ee.y>g.y&&g.x<(ee.x-Y.x)*(g.y-Y.y)/(ee.y-Y.y)+Y.x&&(w=!w),S=Math.min(S,IS(g,Y,ee))}}return(w?1:-1)*Math.sqrt(S)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var Ei;l.TextAnchorEnum=void 0,(Ei=l.TextAnchorEnum||(l.TextAnchorEnum={}))[Ei.center=1]="center",Ei[Ei.left=2]="left",Ei[Ei.right=3]="right",Ei[Ei.top=4]="top",Ei[Ei.bottom=5]="bottom",Ei[Ei["top-left"]=6]="top-left",Ei[Ei["top-right"]=7]="top-right",Ei[Ei["bottom-left"]=8]="bottom-left",Ei[Ei["bottom-right"]=9]="bottom-right";const Vl=7,Ix=Number.POSITIVE_INFINITY;function q2(c,s){return s[1]!==Ix?function(u,f,g){let x=0,w=0;switch(f=Math.abs(f),g=Math.abs(g),u){case"top-right":case"top-left":case"top":w=g-Vl;break;case"bottom-right":case"bottom-left":case"bottom":w=-g+Vl}switch(u){case"top-right":case"bottom-right":case"right":x=-f;break;case"top-left":case"bottom-left":case"left":x=f}return[x,w]}(c,s[0],s[1]):function(u,f){let g=0,x=0;f<0&&(f=0);const w=f/Math.SQRT2;switch(u){case"top-right":case"top-left":x=w-Vl;break;case"bottom-right":case"bottom-left":x=-w+Vl;break;case"bottom":x=-f+Vl;break;case"top":x=f-Vl}switch(u){case"top-right":case"bottom-right":g=-w;break;case"top-left":case"bottom-left":g=w;break;case"left":g=f;break;case"right":g=-f}return[g,x]}(c,s[0])}function Z2(c,s,u){var f;const g=c.layout,x=(f=g.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(s,{},u);if(x){const S=x.values,I=[];for(let k=0;k<S.length;k+=2){const B=I[k]=S[k],j=S[k+1].map(H=>H*ti);B.startsWith("top")?j[1]-=Vl:B.startsWith("bottom")&&(j[1]+=Vl),I[k+1]=j}return new hi(I)}const w=g.get("text-variable-anchor");if(w){let S;S=c._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(s,{},u)*ti,Ix]:g.get("text-offset").evaluate(s,{},u).map(k=>k*ti);const I=[];for(const k of w)I.push(k,q2(k,S));return new hi(I)}return null}function Mx(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function LF(c,s,u,f,g,x,w,S,I,k,B){let j=x.textMaxSize.evaluate(s,{});j===void 0&&(j=w);const H=c.layers[0].layout,Y=H.get("icon-offset").evaluate(s,{},B),ee=Y2(u.horizontal),le=w/24,me=c.tilePixelRatio*le,_e=c.tilePixelRatio*j/24,Me=c.tilePixelRatio*S,Ee=c.tilePixelRatio*H.get("symbol-spacing"),Le=H.get("text-padding")*c.tilePixelRatio,De=function(rt,tn,Ht,Tn=1){const ar=rt.get("icon-padding").evaluate(tn,{},Ht),pr=ar&&ar.values;return[pr[0]*Tn,pr[1]*Tn,pr[2]*Tn,pr[3]*Tn]}(H,s,B,c.tilePixelRatio),Xe=H.get("text-max-angle")/180*Math.PI,St=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",jt=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",wt=H.get("symbol-placement"),_t=Ee/2,lt=H.get("icon-text-fit");let zt;f&&lt!=="none"&&(c.allowVerticalPlacement&&u.vertical&&(zt=v2(f,u.vertical,lt,H.get("icon-text-fit-padding"),Y,le)),ee&&(f=v2(f,ee,lt,H.get("icon-text-fit-padding"),Y,le)));const ft=(rt,tn)=>{tn.x<0||tn.x>=$r||tn.y<0||tn.y>=$r||function(Ht,Tn,ar,pr,ni,ks,Yi,Gr,mi,Ti,Ki,Ji,ri,ii,Oi,Qi,zi,gs,ys,si,Mn,Di,Si,oi,wo){const Ho=Ht.addToLineVertexArray(Tn,ar);let qo,Ya,Eo,Ws,_s=0,Ka=0,Hf=0,eP=0,Nx=-1,Bx=-1;const Ja={};let tP=Ha("");if(Ht.allowVerticalPlacement&&pr.vertical){const Fi=Gr.layout.get("text-rotate").evaluate(Mn,{},oi)+90;Eo=new Kg(mi,Tn,Ti,Ki,Ji,pr.vertical,ri,ii,Oi,Fi),Yi&&(Ws=new Kg(mi,Tn,Ti,Ki,Ji,Yi,zi,gs,Oi,Fi))}if(ni){const Fi=Gr.layout.get("icon-rotate").evaluate(Mn,{}),Hs=Gr.layout.get("icon-text-fit")!=="none",Xc=W2(ni,Fi,Si,Hs),Xo=Yi?W2(Yi,Fi,Si,Hs):void 0;Ya=new Kg(mi,Tn,Ti,Ki,Ji,ni,zi,gs,!1,Fi),_s=4*Xc.length;const Yc=Ht.iconSizeData;let ya=null;Yc.kind==="source"?(ya=[ga*Gr.layout.get("icon-size").evaluate(Mn,{})],ya[0]>Nl&&Fe(`${Ht.layerIds[0]}: Value for "icon-size" is >= ${jf}. Reduce your "icon-size".`)):Yc.kind==="composite"&&(ya=[ga*Di.compositeIconSizes[0].evaluate(Mn,{},oi),ga*Di.compositeIconSizes[1].evaluate(Mn,{},oi)],(ya[0]>Nl||ya[1]>Nl)&&Fe(`${Ht.layerIds[0]}: Value for "icon-size" is >= ${jf}. Reduce your "icon-size".`)),Ht.addSymbols(Ht.icon,Xc,ya,si,ys,Mn,l.WritingMode.none,Tn,Ho.lineStartIndex,Ho.lineLength,-1,oi),Nx=Ht.icon.placedSymbolArray.length-1,Xo&&(Ka=4*Xo.length,Ht.addSymbols(Ht.icon,Xo,ya,si,ys,Mn,l.WritingMode.vertical,Tn,Ho.lineStartIndex,Ho.lineLength,-1,oi),Bx=Ht.icon.placedSymbolArray.length-1)}const nP=Object.keys(pr.horizontal);for(const Fi of nP){const Hs=pr.horizontal[Fi];if(!qo){tP=Ha(Hs.text);const Xo=Gr.layout.get("text-rotate").evaluate(Mn,{},oi);qo=new Kg(mi,Tn,Ti,Ki,Ji,Hs,ri,ii,Oi,Xo)}const Xc=Hs.positionedLines.length===1;if(Hf+=X2(Ht,Tn,Hs,ks,Gr,Oi,Mn,Qi,Ho,pr.vertical?l.WritingMode.horizontal:l.WritingMode.horizontalOnly,Xc?nP:[Fi],Ja,Nx,Di,oi),Xc)break}pr.vertical&&(eP+=X2(Ht,Tn,pr.vertical,ks,Gr,Oi,Mn,Qi,Ho,l.WritingMode.vertical,["vertical"],Ja,Bx,Di,oi));const zF=qo?qo.boxStartIndex:Ht.collisionBoxArray.length,DF=qo?qo.boxEndIndex:Ht.collisionBoxArray.length,FF=Eo?Eo.boxStartIndex:Ht.collisionBoxArray.length,NF=Eo?Eo.boxEndIndex:Ht.collisionBoxArray.length,BF=Ya?Ya.boxStartIndex:Ht.collisionBoxArray.length,UF=Ya?Ya.boxEndIndex:Ht.collisionBoxArray.length,VF=Ws?Ws.boxStartIndex:Ht.collisionBoxArray.length,jF=Ws?Ws.boxEndIndex:Ht.collisionBoxArray.length;let Zo=-1;const Qg=(Fi,Hs)=>Fi&&Fi.circleDiameter?Math.max(Fi.circleDiameter,Hs):Hs;Zo=Qg(qo,Zo),Zo=Qg(Eo,Zo),Zo=Qg(Ya,Zo),Zo=Qg(Ws,Zo);const rP=Zo>-1?1:0;rP&&(Zo*=wo/ti),Ht.glyphOffsetArray.length>=mh.MAX_GLYPHS&&Fe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mn.sortKey!==void 0&&Ht.addToSortKeyRanges(Ht.symbolInstances.length,Mn.sortKey);const $F=Z2(Gr,Mn,oi),[GF,WF]=function(Fi,Hs){const Xc=Fi.length,Xo=Hs==null?void 0:Hs.values;if((Xo==null?void 0:Xo.length)>0)for(let Yc=0;Yc<Xo.length;Yc+=2){const ya=Xo[Yc+1];Fi.emplaceBack(l.TextAnchorEnum[Xo[Yc]],ya[0],ya[1])}return[Xc,Fi.length]}(Ht.textAnchorOffsets,$F);Ht.symbolInstances.emplaceBack(Tn.x,Tn.y,Ja.right>=0?Ja.right:-1,Ja.center>=0?Ja.center:-1,Ja.left>=0?Ja.left:-1,Ja.vertical||-1,Nx,Bx,tP,zF,DF,FF,NF,BF,UF,VF,jF,Ti,Hf,eP,_s,Ka,rP,0,ri,Zo,GF,WF)}(c,tn,rt,u,f,g,zt,c.layers[0],c.collisionBoxArray,s.index,s.sourceLayerIndex,c.index,me,[Le,Le,Le,Le],St,I,Me,De,jt,Y,s,x,k,B,w)};if(wt==="line")for(const rt of B2(s.geometry,0,0,$r,$r)){const tn=CF(rt,Ee,Xe,u.vertical||ee,f,24,_e,c.overscaling,$r);for(const Ht of tn)ee&&RF(c,ee.text,_t,Ht)||ft(rt,Ht)}else if(wt==="line-center"){for(const rt of s.geometry)if(rt.length>1){const tn=PF(rt,Xe,u.vertical||ee,f,24,_e);tn&&ft(rt,tn)}}else if(s.type==="Polygon")for(const rt of lx(s.geometry,0)){const tn=MF(rt,16);ft(rt[0],new Ul(tn.x,tn.y,0))}else if(s.type==="LineString")for(const rt of s.geometry)ft(rt,new Ul(rt[0].x,rt[0].y,0));else if(s.type==="Point")for(const rt of s.geometry)for(const tn of rt)ft([tn],new Ul(tn.x,tn.y,0))}function X2(c,s,u,f,g,x,w,S,I,k,B,j,H,Y,ee){const le=function(Me,Ee,Le,De,Xe,St,jt,wt){const _t=De.layout.get("text-rotate").evaluate(St,{})*Math.PI/180,lt=[];for(const zt of Ee.positionedLines)for(const ft of zt.positionedGlyphs){if(!ft.rect)continue;const rt=ft.rect||{};let tn=d2+1,Ht=!0,Tn=1,ar=0;const pr=(Xe||wt)&&ft.vertical,ni=ft.metrics.advance*ft.scale/2;if(wt&&Ee.verticalizable&&(ar=zt.lineOffset/2-(ft.imageName?-(ti-ft.metrics.width*ft.scale)/2:(ft.scale-1)*ti)),ft.imageName){const si=jt[ft.imageName];Ht=si.sdf,Tn=si.pixelRatio,tn=ms/Tn}const ks=Xe?[ft.x+ni,ft.y]:[0,0];let Yi=Xe?[0,0]:[ft.x+ni+Le[0],ft.y+Le[1]-ar],Gr=[0,0];pr&&(Gr=Yi,Yi=[0,0]);const mi=ft.metrics.isDoubleResolution?2:1,Ti=(ft.metrics.left-tn)*ft.scale-ni+Yi[0],Ki=(-ft.metrics.top-tn)*ft.scale+Yi[1],Ji=Ti+rt.w/mi*ft.scale/Tn,ri=Ki+rt.h/mi*ft.scale/Tn,ii=new T(Ti,Ki),Oi=new T(Ji,Ki),Qi=new T(Ti,ri),zi=new T(Ji,ri);if(pr){const si=new T(-ni,ni-Uf),Mn=-Math.PI/2,Di=ti/2-ni,Si=new T(5-Uf-Di,-(ft.imageName?Di:0)),oi=new T(...Gr);ii._rotateAround(Mn,si)._add(Si)._add(oi),Oi._rotateAround(Mn,si)._add(Si)._add(oi),Qi._rotateAround(Mn,si)._add(Si)._add(oi),zi._rotateAround(Mn,si)._add(Si)._add(oi)}if(_t){const si=Math.sin(_t),Mn=Math.cos(_t),Di=[Mn,-si,si,Mn];ii._matMult(Di),Oi._matMult(Di),Qi._matMult(Di),zi._matMult(Di)}const gs=new T(0,0),ys=new T(0,0);lt.push({tl:ii,tr:Oi,bl:Qi,br:zi,tex:rt,writingMode:Ee.writingMode,glyphOffset:ks,sectionIndex:ft.sectionIndex,isSDF:Ht,pixelOffsetTL:gs,pixelOffsetBR:ys,minFontScaleX:0,minFontScaleY:0})}return lt}(0,u,S,g,x,w,f,c.allowVerticalPlacement),me=c.textSizeData;let _e=null;me.kind==="source"?(_e=[ga*g.layout.get("text-size").evaluate(w,{})],_e[0]>Nl&&Fe(`${c.layerIds[0]}: Value for "text-size" is >= ${jf}. Reduce your "text-size".`)):me.kind==="composite"&&(_e=[ga*Y.compositeTextSizes[0].evaluate(w,{},ee),ga*Y.compositeTextSizes[1].evaluate(w,{},ee)],(_e[0]>Nl||_e[1]>Nl)&&Fe(`${c.layerIds[0]}: Value for "text-size" is >= ${jf}. Reduce your "text-size".`)),c.addSymbols(c.text,le,_e,S,x,w,k,s,I.lineStartIndex,I.lineLength,H,ee);for(const Me of B)j[Me]=c.text.placedSymbolArray.length-1;return 4*le.length}function Y2(c){for(const s in c)return c[s];return null}function RF(c,s,u,f){const g=c.compareText;if(s in g){const x=g[s];for(let w=x.length-1;w>=0;w--)if(f.dist(x[w])<u)return!0}else g[s]=[];return g[s].push(f),!1}const K2=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class kx{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,f]=new Uint8Array(s,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=f>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const x=K2[15&f];if(!x)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(s,2,1),[S]=new Uint32Array(s,4,1);return new kx(S,w,x,s)}constructor(s,u=64,f=Float64Array,g){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=f,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const x=K2.indexOf(this.ArrayType),w=2*s*this.ArrayType.BYTES_PER_ELEMENT,S=s*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-S%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${f}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+S+I,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+w+S+I),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+S+I,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=s)}add(s,u){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=s,this.coords[this._pos++]=u,f}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return Lx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,u,f,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:w,nodeSize:S}=this,I=[0,x.length-1,0],k=[];for(;I.length;){const B=I.pop()||0,j=I.pop()||0,H=I.pop()||0;if(j-H<=S){for(let me=H;me<=j;me++){const _e=w[2*me],Me=w[2*me+1];_e>=s&&_e<=f&&Me>=u&&Me<=g&&k.push(x[me])}continue}const Y=H+j>>1,ee=w[2*Y],le=w[2*Y+1];ee>=s&&ee<=f&&le>=u&&le<=g&&k.push(x[Y]),(B===0?s<=ee:u<=le)&&(I.push(H),I.push(Y-1),I.push(1-B)),(B===0?f>=ee:g>=le)&&(I.push(Y+1),I.push(j),I.push(1-B))}return k}within(s,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:x,nodeSize:w}=this,S=[0,g.length-1,0],I=[],k=f*f;for(;S.length;){const B=S.pop()||0,j=S.pop()||0,H=S.pop()||0;if(j-H<=w){for(let me=H;me<=j;me++)Q2(x[2*me],x[2*me+1],s,u)<=k&&I.push(g[me]);continue}const Y=H+j>>1,ee=x[2*Y],le=x[2*Y+1];Q2(ee,le,s,u)<=k&&I.push(g[Y]),(B===0?s-f<=ee:u-f<=le)&&(S.push(H),S.push(Y-1),S.push(1-B)),(B===0?s+f>=ee:u+f>=le)&&(S.push(Y+1),S.push(j),S.push(1-B))}return I}}function Lx(c,s,u,f,g,x){if(g-f<=u)return;const w=f+g>>1;J2(c,s,w,f,g,x),Lx(c,s,u,f,w-1,1-x),Lx(c,s,u,w+1,g,1-x)}function J2(c,s,u,f,g,x){for(;g>f;){if(g-f>600){const k=g-f+1,B=u-f+1,j=Math.log(k),H=.5*Math.exp(2*j/3),Y=.5*Math.sqrt(j*H*(k-H)/k)*(B-k/2<0?-1:1);J2(c,s,u,Math.max(f,Math.floor(u-B*H/k+Y)),Math.min(g,Math.floor(u+(k-B)*H/k+Y)),x)}const w=s[2*u+x];let S=f,I=g;for(Gf(c,s,f,u),s[2*g+x]>w&&Gf(c,s,f,g);S<I;){for(Gf(c,s,S,I),S++,I--;s[2*S+x]<w;)S++;for(;s[2*I+x]>w;)I--}s[2*f+x]===w?Gf(c,s,f,I):(I++,Gf(c,s,I,g)),I<=u&&(f=I+1),u<=I&&(g=I-1)}}function Gf(c,s,u,f){Rx(c,u,f),Rx(s,2*u,2*f),Rx(s,2*u+1,2*f+1)}function Rx(c,s,u){const f=c[s];c[s]=c[u],c[u]=f}function Q2(c,s,u,f){const g=c-u,x=s-f;return g*g+x*x}var Ox;l.PerformanceMarkers=void 0,(Ox=l.PerformanceMarkers||(l.PerformanceMarkers={})).create="create",Ox.load="load",Ox.fullLoad="fullLoad";let Jg=null,Wf=[];const zx=1e3/60,Dx="loadTime",Fx="fullLoadTime",OF={mark(c){performance.mark(c)},frame(c){const s=c;Jg!=null&&Wf.push(s-Jg),Jg=s},clearMetrics(){Jg=null,Wf=[],performance.clearMeasures(Dx),performance.clearMeasures(Fx);for(const c in l.PerformanceMarkers)performance.clearMarks(l.PerformanceMarkers[c])},getPerformanceMetrics(){performance.measure(Dx,l.PerformanceMarkers.create,l.PerformanceMarkers.load),performance.measure(Fx,l.PerformanceMarkers.create,l.PerformanceMarkers.fullLoad);const c=performance.getEntriesByName(Dx)[0].duration,s=performance.getEntriesByName(Fx)[0].duration,u=Wf.length,f=1/(Wf.reduce((x,w)=>x+w,0)/u/1e3),g=Wf.filter(x=>x>zx).reduce((x,w)=>x+(w-zx)/zx,0);return{loadTime:c,fullLoadTime:s,fps:f,percentDroppedFrames:g/(u+g)*100,totalFrames:u}}};l.AJAXError=Je,l.ARRAY_TYPE=ch,l.Actor=class{constructor(c,s,u){this.receive=f=>{const g=f.data,x=g.id;if(x&&(!g.targetMapId||this.mapId===g.targetMapId))if(g.type==="<cancel>"){delete this.tasks[x];const w=this.cancelCallbacks[x];delete this.cancelCallbacks[x],w&&w()}else je()||g.mustQueue?(this.tasks[x]=g,this.taskQueue.push(x),this.invoker.trigger()):this.processTask(x,g)},this.process=()=>{if(!this.taskQueue.length)return;const f=this.taskQueue.shift(),g=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),g&&this.processTask(f,g)},this.target=c,this.parent=s,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new TF(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=je()?c:window}send(c,s,u,f,g=!1){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[x]=u);const w=ke(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:c,hasCallback:!!u,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:fa(s,w)},w),{cancel:()=>{u&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}processTask(c,s){if(s.type==="<response>"){const u=this.callbacks[c];delete this.callbacks[c],u&&(s.error?u(Ll(s.error)):u(null,Ll(s.data)))}else{let u=!1;const f=ke(this.globalScope)?void 0:[],g=s.hasCallback?(S,I)=>{u=!0,delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:S?fa(S):null,data:fa(I,f)},f)}:S=>{u=!0};let x=null;const w=Ll(s.data);if(this.parent[s.type])x=this.parent[s.type](s.sourceMapId,w,g);else if(this.parent.getWorkerSource){const S=s.type.split(".");x=this.parent.getWorkerSource(s.sourceMapId,S[0],w.source)[S[1]](w,g)}else g(new Error(`Could not find function ${s.type}`));!u&&x&&x.cancel&&(this.cancelCallbacks[c]=x.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.AlphaImage=Lf,l.CanonicalTileID=Ax,l.CollisionBoxArray=pe,l.CollisionCircleLayoutArray=class extends p{},l.Color=Cn,l.DEMData=R2,l.DataConstantProperty=Xt,l.DictionaryCoder=O2,l.EXTENT=$r,l.ErrorEvent=pt,l.EvaluationParameters=sr,l.Event=vn,l.Evented=dn,l.FeatureIndex=D2,l.FillBucket=hx,l.FillExtrusionBucket=fx,l.GeoJSONFeature=z2,l.ImageAtlas=p2,l.ImagePosition=_x,l.KDBush=kx,l.LineBucket=px,l.LineStripIndexArray=class extends X{},l.LngLat=Bl,l.MercatorCoordinate=qg,l.ONE_EM=ti,l.OverscaledTileID=Gs,l.PerformanceUtils=OF,l.Point=T,l.Pos3dArray=class extends Wc{},l.PosArray=at,l.Properties=zr,l.Protobuf=gx,l.QuadTriangleArray=class extends b{},l.RGBAImage=$s,l.RasterBoundsArray=class extends Ga{},l.RequestPerformance=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return c.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},l.SegmentVector=or,l.SymbolBucket=mh,l.Transitionable=Cg,l.TriangleIndexArray=fi,l.Uniform1f=ah,l.Uniform1i=class extends qa{constructor(c,s){super(c,s),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},l.Uniform2f=class extends qa{constructor(c,s){super(c,s),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},l.Uniform3f=class extends qa{constructor(c,s){super(c,s),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},l.Uniform4f=kg,l.UniformColor=Lg,l.UniformMatrix4f=class extends qa{constructor(c,s){super(c,s),this.current=Yv}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let s=1;s<16;s++)if(c[s]!==this.current[s]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},l.UnwrappedTileID=L2,l.ValidationError=He,l.ZoomHistory=wg,l.addDynamicAttributes=wx,l.arrayBufferToImage=function(c,s){const u=new Image;u.onload=()=>{s(null,u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=nt})},u.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(c)],{type:"image/png"});u.src=c.byteLength?URL.createObjectURL(f):nt},l.arrayBufferToImageBitmap=function(c,s){const u=new Blob([new Uint8Array(c)],{type:"image/png"});createImageBitmap(u).then(f=>{s(null,f)}).catch(f=>{s(new Error(`Could not load image because of ${f.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},l.asyncAll=function(c,s,u){if(!c.length)return u(null,[]);let f=c.length;const g=new Array(c.length);let x=null;c.forEach((w,S)=>{s(w,(I,k)=>{I&&(x=I),g[S]=k,--f==0&&u(x,g)})})},l.bezier=F,l.browser=bt,l.clamp=K,l.clipLine=B2,l.clone=function(c){var s=new ch(16);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s[3]=c[3],s[4]=c[4],s[5]=c[5],s[6]=c[6],s[7]=c[7],s[8]=c[8],s[9]=c[9],s[10]=c[10],s[11]=c[11],s[12]=c[12],s[13]=c[13],s[14]=c[14],s[15]=c[15],s},l.clone$1=Re,l.collisionCircleLayout=JD,l.config=Jt,l.copy=function(c,s){return c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[4]=s[4],c[5]=s[5],c[6]=s[6],c[7]=s[7],c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},l.create=function(){var c=new ch(16);return ch!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},l.createExpression=Yu,l.createFilter=lf,l.createLayout=yr,l.createStyleLayer=function(c){if(c.type==="custom")return new EF(c);switch(c.type){case"background":return new xF(c);case"circle":return new sD(c);case"fill":return new SD(c);case"fill-extrusion":return new UD(c);case"heatmap":return new aD(c);case"hillshade":return new cD(c);case"line":return new ZD(c);case"raster":return new wF(c);case"symbol":return new Hg(c)}},l.deepEqual=function c(s,u){if(Array.isArray(s)){if(!Array.isArray(u)||s.length!==u.length)return!1;for(let f=0;f<s.length;f++)if(!c(s[f],u[f]))return!1;return!0}if(typeof s=="object"&&s!==null&&u!==null){if(typeof u!="object"||Object.keys(s).length!==Object.keys(u).length)return!1;for(const f in s)if(!c(s[f],u[f]))return!1;return!0}return s===u},l.defaultEasing=$,l.derefLayers=function(c){c=c.slice();const s=Object.create(null);for(let u=0;u<c.length;u++)s[c[u].id]=c[u];for(let u=0;u<c.length;u++)"ref"in c[u]&&(c[u]=En(c[u],s[c[u].ref]));return c},l.diffStyles=function(c,s){if(!c)return[{command:It.setStyle,args:[s]}];let u=[];try{if(!en(c.version,s.version))return[{command:It.setStyle,args:[s]}];en(c.center,s.center)||u.push({command:It.setCenter,args:[s.center]}),en(c.zoom,s.zoom)||u.push({command:It.setZoom,args:[s.zoom]}),en(c.bearing,s.bearing)||u.push({command:It.setBearing,args:[s.bearing]}),en(c.pitch,s.pitch)||u.push({command:It.setPitch,args:[s.pitch]}),en(c.sprite,s.sprite)||u.push({command:It.setSprite,args:[s.sprite]}),en(c.glyphs,s.glyphs)||u.push({command:It.setGlyphs,args:[s.glyphs]}),en(c.transition,s.transition)||u.push({command:It.setTransition,args:[s.transition]}),en(c.light,s.light)||u.push({command:It.setLight,args:[s.light]});const f={},g=[];(function(w,S,I,k){let B;for(B in S=S||{},w=w||{})Object.prototype.hasOwnProperty.call(w,B)&&(Object.prototype.hasOwnProperty.call(S,B)||gt(B,I,k));for(B in S)Object.prototype.hasOwnProperty.call(S,B)&&(Object.prototype.hasOwnProperty.call(w,B)?en(w[B],S[B])||(w[B].type==="geojson"&&S[B].type==="geojson"&&Rt(w,S,B)?I.push({command:It.setGeoJSONSourceData,args:[B,S[B].data]}):Mt(B,S,I,k)):Qe(B,S,I))})(c.sources,s.sources,g,f);const x=[];c.layers&&c.layers.forEach(w=>{f[w.source]?u.push({command:It.removeLayer,args:[w.id]}):x.push(w)}),u=u.concat(g),function(w,S,I){S=S||[];const k=(w=w||[]).map(gn),B=S.map(gn),j=w.reduce(mn,{}),H=S.reduce(mn,{}),Y=k.slice(),ee=Object.create(null);let le,me,_e,Me,Ee,Le,De;for(le=0,me=0;le<k.length;le++)_e=k[le],Object.prototype.hasOwnProperty.call(H,_e)?me++:(I.push({command:It.removeLayer,args:[_e]}),Y.splice(Y.indexOf(_e,me),1));for(le=0,me=0;le<B.length;le++)_e=B[B.length-1-le],Y[Y.length-1-le]!==_e&&(Object.prototype.hasOwnProperty.call(j,_e)?(I.push({command:It.removeLayer,args:[_e]}),Y.splice(Y.lastIndexOf(_e,Y.length-me),1)):me++,Le=Y[Y.length-le],I.push({command:It.addLayer,args:[H[_e],Le]}),Y.splice(Y.length-le,0,_e),ee[_e]=!0);for(le=0;le<B.length;le++)if(_e=B[le],Me=j[_e],Ee=H[_e],!ee[_e]&&!en(Me,Ee))if(en(Me.source,Ee.source)&&en(Me["source-layer"],Ee["source-layer"])&&en(Me.type,Ee.type)){for(De in Pt(Me.layout,Ee.layout,I,_e,null,It.setLayoutProperty),Pt(Me.paint,Ee.paint,I,_e,null,It.setPaintProperty),en(Me.filter,Ee.filter)||I.push({command:It.setFilter,args:[_e,Ee.filter]}),en(Me.minzoom,Ee.minzoom)&&en(Me.maxzoom,Ee.maxzoom)||I.push({command:It.setLayerZoomRange,args:[_e,Ee.minzoom,Ee.maxzoom]}),Me)Object.prototype.hasOwnProperty.call(Me,De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?Pt(Me[De],Ee[De],I,_e,De.slice(6),It.setPaintProperty):en(Me[De],Ee[De])||I.push({command:It.setLayerProperty,args:[_e,De,Ee[De]]}));for(De in Ee)Object.prototype.hasOwnProperty.call(Ee,De)&&!Object.prototype.hasOwnProperty.call(Me,De)&&De!=="layout"&&De!=="paint"&&De!=="filter"&&De!=="metadata"&&De!=="minzoom"&&De!=="maxzoom"&&(De.indexOf("paint.")===0?Pt(Me[De],Ee[De],I,_e,De.slice(6),It.setPaintProperty):en(Me[De],Ee[De])||I.push({command:It.setLayerProperty,args:[_e,De,Ee[De]]}))}else I.push({command:It.removeLayer,args:[_e]}),Le=Y[Y.lastIndexOf(_e)+1],I.push({command:It.addLayer,args:[Ee,Le]})}(x,s.layers,u)}catch(f){console.warn("Unable to compute style diff:",f),u=[{command:It.setStyle,args:[s]}]}return u},l.dot=function(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]+c[3]*s[3]},l.earthRadius=Px,l.emitValidationErrors=rh,l.emptyStyle=function(){const c={},s=Ae.$version;for(const u in Ae.$root){const f=Ae.$root[u];if(f.required){let g=null;g=u==="version"?s:f.type==="array"?[]:{},g!=null&&(c[u]=g)}}return c},l.equals=function(c,s){var u=c[0],f=c[1],g=c[2],x=c[3],w=c[4],S=c[5],I=c[6],k=c[7],B=c[8],j=c[9],H=c[10],Y=c[11],ee=c[12],le=c[13],me=c[14],_e=c[15],Me=s[0],Ee=s[1],Le=s[2],De=s[3],Xe=s[4],St=s[5],jt=s[6],wt=s[7],_t=s[8],lt=s[9],zt=s[10],ft=s[11],rt=s[12],tn=s[13],Ht=s[14],Tn=s[15];return Math.abs(u-Me)<=Xi*Math.max(1,Math.abs(u),Math.abs(Me))&&Math.abs(f-Ee)<=Xi*Math.max(1,Math.abs(f),Math.abs(Ee))&&Math.abs(g-Le)<=Xi*Math.max(1,Math.abs(g),Math.abs(Le))&&Math.abs(x-De)<=Xi*Math.max(1,Math.abs(x),Math.abs(De))&&Math.abs(w-Xe)<=Xi*Math.max(1,Math.abs(w),Math.abs(Xe))&&Math.abs(S-St)<=Xi*Math.max(1,Math.abs(S),Math.abs(St))&&Math.abs(I-jt)<=Xi*Math.max(1,Math.abs(I),Math.abs(jt))&&Math.abs(k-wt)<=Xi*Math.max(1,Math.abs(k),Math.abs(wt))&&Math.abs(B-_t)<=Xi*Math.max(1,Math.abs(B),Math.abs(_t))&&Math.abs(j-lt)<=Xi*Math.max(1,Math.abs(j),Math.abs(lt))&&Math.abs(H-zt)<=Xi*Math.max(1,Math.abs(H),Math.abs(zt))&&Math.abs(Y-ft)<=Xi*Math.max(1,Math.abs(Y),Math.abs(ft))&&Math.abs(ee-rt)<=Xi*Math.max(1,Math.abs(ee),Math.abs(rt))&&Math.abs(le-tn)<=Xi*Math.max(1,Math.abs(le),Math.abs(tn))&&Math.abs(me-Ht)<=Xi*Math.max(1,Math.abs(me),Math.abs(Ht))&&Math.abs(_e-Tn)<=Xi*Math.max(1,Math.abs(_e),Math.abs(Tn))},l.evaluateSizeForFeature=function(c,{uSize:s,uSizeT:u},{lowerSize:f,upperSize:g}){return c.kind==="source"?f/ga:c.kind==="composite"?us.number(f/ga,g/ga,u):s},l.evaluateSizeForZoom=function(c,s){let u=0,f=0;if(c.kind==="constant")f=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:g,minZoom:x,maxZoom:w}=c,S=g?K(hs.interpolationFactor(g,s,x,w),0,1):0;c.kind==="camera"?f=us.number(c.minSize,c.maxSize,S):u=S}return{uSizeT:u,uSize:f}},l.evented=jc,l.extend=re,l.filterObject=fe,l.findLineIntersection=function(c,s,u,f){const g=s.y-c.y,x=s.x-c.x,w=f.y-u.y,S=f.x-u.x,I=w*x-S*g;if(I===0)return null;const k=(S*(c.y-u.y)-w*(c.x-u.x))/I;return new T(c.x+k*x,c.y+k*g)},l.fromScaling=function(c,s){return c[0]=s[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=s[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=s[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},l.getAnchorAlignment=xx,l.getAnchorJustification=Mx,l.getArrayBuffer=$t,l.getDefaultExportFromCjs=m,l.getImageData=async function(c,s,u,f,g){if(N())try{return await Dt(c,s,u,f,g)}catch{}return function(x,w,S,I,k){const B=x.width,j=x.height;ht&&ot||(ht=new OffscreenCanvas(B,j),ot=ht.getContext("2d",{willReadFrequently:!0})),ht.width=B,ht.height=j,ot.drawImage(x,0,0,B,j);const H=ot.getImageData(w,S,I,k);return ot.clearRect(0,0,B,j),H.data}(c,s,u,f,g)},l.getJSON=function(c,s){return hn(re(c,{type:"json"}),s)},l.getOverlapMode=bx,l.getProtocolAction=sn,l.getRTLTextPluginStatus=vf,l.getReferrer=Et,l.getVideo=function(c,s){const u=window.document.createElement("video");u.muted=!0,u.onloadstart=function(){s(null,u)};for(let f=0;f<c.length;f++){const g=window.document.createElement("source");Lt(c[f])||(u.crossOrigin="Anonymous"),g.src=c[f],u.appendChild(g)}return{cancel:()=>{}}},l.groupByLayout=function(c,s){const u={};for(let g=0;g<c.length;g++){const x=s&&s[c[g].id]||eh(c[g]);s&&(s[c[g].id]=x);let w=u[x];w||(w=u[x]=[]),w.push(c[g])}const f=[];for(const g in u)f.push(u[g]);return f},l.identity=tx,l.interpolate=us,l.invert=function(c,s){var u=s[0],f=s[1],g=s[2],x=s[3],w=s[4],S=s[5],I=s[6],k=s[7],B=s[8],j=s[9],H=s[10],Y=s[11],ee=s[12],le=s[13],me=s[14],_e=s[15],Me=u*S-f*w,Ee=u*I-g*w,Le=u*k-x*w,De=f*I-g*S,Xe=f*k-x*S,St=g*k-x*I,jt=B*le-j*ee,wt=B*me-H*ee,_t=B*_e-Y*ee,lt=j*me-H*le,zt=j*_e-Y*le,ft=H*_e-Y*me,rt=Me*ft-Ee*zt+Le*lt+De*_t-Xe*wt+St*jt;return rt?(c[0]=(S*ft-I*zt+k*lt)*(rt=1/rt),c[1]=(g*zt-f*ft-x*lt)*rt,c[2]=(le*St-me*Xe+_e*De)*rt,c[3]=(H*Xe-j*St-Y*De)*rt,c[4]=(I*_t-w*ft-k*wt)*rt,c[5]=(u*ft-g*_t+x*wt)*rt,c[6]=(me*Le-ee*St-_e*Ee)*rt,c[7]=(B*St-H*Le+Y*Ee)*rt,c[8]=(w*zt-S*_t+k*jt)*rt,c[9]=(f*_t-u*zt-x*jt)*rt,c[10]=(ee*Xe-le*Le+_e*Me)*rt,c[11]=(j*Le-B*Xe-Y*Me)*rt,c[12]=(S*wt-w*lt-I*jt)*rt,c[13]=(u*lt-f*wt+g*jt)*rt,c[14]=(le*Ee-ee*De-me*Me)*rt,c[15]=(B*De-j*Ee+H*Me)*rt,c):null},l.isImageBitmap=Ge,l.isOffscreenCanvasDistorted=N,l.isSafari=ke,l.isWorker=je,l.keysDifference=function(c,s){const u=[];for(const f in c)f in s||u.push(f);return u},l.lazyLoadRTLTextPlugin=function(){fs.isLoading()||fs.isLoaded()||vf()!=="deferred"||Pg()},l.makeRequest=hn,l.mapObject=xe,l.mercatorXfromLng=A2,l.mercatorYfromLat=I2,l.mercatorZfromAltitude=M2,l.mul=iD,l.mul$1=function(c,s,u){return c[0]=s[0]*u[0],c[1]=s[1]*u[1],c[2]=s[2]*u[2],c[3]=s[3]*u[3],c},l.multiply=RS,l.nextPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},l.offscreenCanvasSupported=z,l.operations=It,l.ortho=function(c,s,u,f,g,x,w){var S=1/(s-u),I=1/(f-g),k=1/(x-w);return c[0]=-2*S,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*I,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*k,c[11]=0,c[12]=(s+u)*S,c[13]=(g+f)*I,c[14]=(w+x)*k,c[15]=1,c},l.parseCacheControl=function(c){const s={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,g,x)=>{const w=g||x;return s[f]=!w||w.toLowerCase(),""}),s["max-age"]){const u=parseInt(s["max-age"],10);isNaN(u)?delete s["max-age"]:s["max-age"]=u}return s},l.parseGlyphPbf=function(c){return new gx(c).readFields(cF,[])},l.pbf=s2,l.performSymbolLayout=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=$r/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const s=c.bucket.layers[0],u=s.layout,f=s._unevaluatedLayout._values,g={layoutIconSize:f["icon-size"].possiblyEvaluate(new sr(c.bucket.zoom+1),c.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new sr(c.bucket.zoom+1),c.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new sr(18))};if(c.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:B}=c.bucket.textSizeData;g.compositeTextSizes=[f["text-size"].possiblyEvaluate(new sr(k),c.canonical),f["text-size"].possiblyEvaluate(new sr(B),c.canonical)]}if(c.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:B}=c.bucket.iconSizeData;g.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new sr(k),c.canonical),f["icon-size"].possiblyEvaluate(new sr(B),c.canonical)]}const x=u.get("text-line-height")*ti,w=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",S=u.get("text-keep-upright"),I=u.get("text-size");for(const k of c.bucket.features){const B=u.get("text-font").evaluate(k,{},c.canonical).join(","),j=I.evaluate(k,{},c.canonical),H=g.layoutTextSize.evaluate(k,{},c.canonical),Y=g.layoutIconSize.evaluate(k,{},c.canonical),ee={horizontal:{},vertical:void 0},le=k.text;let me,_e=[0,0];if(le){const Le=le.toString(),De=u.get("text-letter-spacing").evaluate(k,{},c.canonical)*ti,Xe=df(Le)?De:0,St=u.get("text-anchor").evaluate(k,{},c.canonical),jt=Z2(s,k,c.canonical);if(!jt){const ft=u.get("text-radial-offset").evaluate(k,{},c.canonical);_e=ft?q2(St,[ft*ti,Ix]):u.get("text-offset").evaluate(k,{},c.canonical).map(rt=>rt*ti)}let wt=w?"center":u.get("text-justify").evaluate(k,{},c.canonical);const _t=u.get("symbol-placement"),lt=_t==="point"?u.get("text-max-width").evaluate(k,{},c.canonical)*ti:0,zt=()=>{c.bucket.allowVerticalPlacement&&hf(Le)&&(ee.vertical=$g(le,c.glyphMap,c.glyphPositions,c.imagePositions,B,lt,x,St,"left",Xe,_e,l.WritingMode.vertical,!0,_t,H,j))};if(!w&&jt){const ft=new Set;if(wt==="auto")for(let tn=0;tn<jt.values.length;tn+=2)ft.add(Mx(jt.values[tn]));else ft.add(wt);let rt=!1;for(const tn of ft)if(!ee.horizontal[tn])if(rt)ee.horizontal[tn]=ee.horizontal[0];else{const Ht=$g(le,c.glyphMap,c.glyphPositions,c.imagePositions,B,lt,x,"center",tn,Xe,_e,l.WritingMode.horizontal,!1,_t,H,j);Ht&&(ee.horizontal[tn]=Ht,rt=Ht.positionedLines.length===1)}zt()}else{wt==="auto"&&(wt=Mx(St));const ft=$g(le,c.glyphMap,c.glyphPositions,c.imagePositions,B,lt,x,St,wt,Xe,_e,l.WritingMode.horizontal,!1,_t,H,j);ft&&(ee.horizontal[wt]=ft),zt(),hf(Le)&&w&&S&&(ee.vertical=$g(le,c.glyphMap,c.glyphPositions,c.imagePositions,B,lt,x,St,wt,Xe,_e,l.WritingMode.vertical,!1,_t,H,j))}}let Me=!1;if(k.icon&&k.icon.name){const Le=c.imageMap[k.icon.name];Le&&(me=mF(c.imagePositions[k.icon.name],u.get("icon-offset").evaluate(k,{},c.canonical),u.get("icon-anchor").evaluate(k,{},c.canonical)),Me=!!Le.sdf,c.bucket.sdfIcons===void 0?c.bucket.sdfIcons=Me:c.bucket.sdfIcons!==Me&&Fe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Le.pixelRatio!==c.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(c.bucket.iconsNeedLinear=!0))}const Ee=Y2(ee.horizontal)||ee.vertical;c.bucket.iconsInText=!!Ee&&Ee.iconsInText,(Ee||me)&&LF(c.bucket,k,ee,me,c.imageMap,g,H,Y,_e,Me,c.canonical)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},l.perspective=function(c,s,u,f,g){var x,w=1/Math.tan(s/2);return c[0]=w/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=w,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,g!=null&&g!==1/0?(c[10]=(g+f)*(x=1/(f-g)),c[14]=2*g*f*x):(c[10]=-1,c[14]=-2*f),c},l.pick=function(c,s){const u={};for(let f=0;f<s.length;f++){const g=s[f];g in c&&(u[g]=c[g])}return u},l.plugin=fs,l.pointGeometry=_,l.polygonIntersectsPolygon=CS,l.potpack=f2,l.readImageUsingVideoFrame=Dt,l.register=kt,l.registerForPluginStateChange=function(c){return c({pluginStatus:qi,pluginURL:pa}),jc.on("pluginStateChange",c),c},l.renderColorRamp=NS,l.rotateX=function(c,s,u){var f=Math.sin(u),g=Math.cos(u),x=s[4],w=s[5],S=s[6],I=s[7],k=s[8],B=s[9],j=s[10],H=s[11];return s!==c&&(c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[4]=x*g+k*f,c[5]=w*g+B*f,c[6]=S*g+j*f,c[7]=I*g+H*f,c[8]=k*g-x*f,c[9]=B*g-w*f,c[10]=j*g-S*f,c[11]=H*g-I*f,c},l.rotateZ=function(c,s,u){var f=Math.sin(u),g=Math.cos(u),x=s[0],w=s[1],S=s[2],I=s[3],k=s[4],B=s[5],j=s[6],H=s[7];return s!==c&&(c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=x*g+k*f,c[1]=w*g+B*f,c[2]=S*g+j*f,c[3]=I*g+H*f,c[4]=k*g-x*f,c[5]=B*g-w*f,c[6]=j*g-S*f,c[7]=H*g-I*f,c},l.sameOrigin=Lt,l.scale=function(c,s,u){var f=u[0],g=u[1],x=u[2];return c[0]=s[0]*f,c[1]=s[1]*f,c[2]=s[2]*f,c[3]=s[3]*f,c[4]=s[4]*g,c[5]=s[5]*g,c[6]=s[6]*g,c[7]=s[7]*g,c[8]=s[8]*x,c[9]=s[9]*x,c[10]=s[10]*x,c[11]=s[11]*x,c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c},l.setRTLTextPlugin=function(c,s,u=!1){if(qi===pf||qi===mf||qi===gf)throw new Error("setRTLTextPlugin cannot be called multiple times.");pa=bt.resolveURL(c),qi=pf,yf=s,_f(),u||Pg()},l.sphericalToCartesian=function([c,s,u]){return s+=90,s*=Math.PI/180,u*=Math.PI/180,{x:c*Math.cos(s)*Math.sin(u),y:c*Math.sin(s)*Math.sin(u),z:c*Math.cos(u)}},l.toEvaluationFeature=qc,l.transformMat4=Dg,l.translate=function(c,s,u){var f,g,x,w,S,I,k,B,j,H,Y,ee,le=u[0],me=u[1],_e=u[2];return s===c?(c[12]=s[0]*le+s[4]*me+s[8]*_e+s[12],c[13]=s[1]*le+s[5]*me+s[9]*_e+s[13],c[14]=s[2]*le+s[6]*me+s[10]*_e+s[14],c[15]=s[3]*le+s[7]*me+s[11]*_e+s[15]):(g=s[1],x=s[2],w=s[3],S=s[4],I=s[5],k=s[6],B=s[7],j=s[8],H=s[9],Y=s[10],ee=s[11],c[0]=f=s[0],c[1]=g,c[2]=x,c[3]=w,c[4]=S,c[5]=I,c[6]=k,c[7]=B,c[8]=j,c[9]=H,c[10]=Y,c[11]=ee,c[12]=f*le+S*me+j*_e+s[12],c[13]=g*le+I*me+H*_e+s[13],c[14]=x*le+k*me+Y*_e+s[14],c[15]=w*le+B*me+ee*_e+s[15]),c},l.triggerPluginCompletionEvent=Vc,l.unicodeBlockLookup=Tt,l.uniqueId=function(){return be++},l.v8Spec=Ae,l.validateCustomStyleLayer=function(c){const s=[],u=c.id;return u===void 0&&s.push({message:`layers.${u}: missing required property "id"`}),c.render===void 0&&s.push({message:`layers.${u}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&s.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),s},l.validateLight=Hv,l.validateStyle=$o,l.vectorTile=Dl,l.warnOnce=Fe,l.wrap=ne}),o(["./shared"],function(l){class m{constructor(G){this.keyCache={},G&&this.replace(G)}replace(G){this._layerConfigs={},this._layers={},this.update(G,[])}update(G,Z){for(const ue of G){this._layerConfigs[ue.id]=ue;const ve=this._layers[ue.id]=l.createStyleLayer(ue);ve._featureFilter=l.createFilter(ve.filter),this.keyCache[ue.id]&&delete this.keyCache[ue.id]}for(const ue of Z)delete this.keyCache[ue],delete this._layerConfigs[ue],delete this._layers[ue];this.familiesBySource={};const se=l.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const ue of se){const ve=ue.map(We=>this._layers[We.id]),Se=ve[0];if(Se.visibility==="none")continue;const Te=Se.source||"";let ye=this.familiesBySource[Te];ye||(ye=this.familiesBySource[Te]={});const Ce=Se.sourceLayer||"_geojsonTileLayer";let $e=ye[Ce];$e||($e=ye[Ce]=[]),$e.push(ve)}}}class _{constructor(G){const Z={},se=[];for(const Te in G){const ye=G[Te],Ce=Z[Te]={};for(const $e in ye){const We=ye[+$e];if(!We||We.bitmap.width===0||We.bitmap.height===0)continue;const qe={x:0,y:0,w:We.bitmap.width+2,h:We.bitmap.height+2};se.push(qe),Ce[$e]={rect:qe,metrics:We.metrics}}}const{w:ue,h:ve}=l.potpack(se),Se=new l.AlphaImage({width:ue||1,height:ve||1});for(const Te in G){const ye=G[Te];for(const Ce in ye){const $e=ye[+Ce];if(!$e||$e.bitmap.width===0||$e.bitmap.height===0)continue;const We=Z[Te][Ce].rect;l.AlphaImage.copy($e.bitmap,Se,{x:0,y:0},{x:We.x+1,y:We.y+1},$e.bitmap)}}this.image=Se,this.positions=Z}}l.register("GlyphAtlas",_);class E{constructor(G){this.tileID=new l.OverscaledTileID(G.tileID.overscaledZ,G.tileID.wrap,G.tileID.canonical.z,G.tileID.canonical.x,G.tileID.canonical.y),this.uid=G.uid,this.zoom=G.zoom,this.pixelRatio=G.pixelRatio,this.tileSize=G.tileSize,this.source=G.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=G.showCollisionBoxes,this.collectResourceTiming=!!G.collectResourceTiming,this.returnDependencies=!!G.returnDependencies,this.promoteId=G.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(G,Z,se,ue,ve){this.status="parsing",this.data=G,this.collisionBoxArray=new l.CollisionBoxArray;const Se=new l.DictionaryCoder(Object.keys(G.layers).sort()),Te=new l.FeatureIndex(this.tileID,this.promoteId);Te.bucketLayerIDs=[];const ye={},Ce={featureIndex:Te,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:se},$e=Z.familiesBySource[this.source];for(const pn in $e){const yn=G.layers[pn];if(!yn)continue;yn.version===1&&l.warnOnce(`Vector tile source "${this.source}" layer "${pn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ar=Se.encode(pn),Ut=[];for(let zn=0;zn<yn.length;zn++){const xr=yn.feature(zn),Vs=Te.getId(xr,pn);Ut.push({feature:xr,id:Vs,index:zn,sourceLayerIndex:Ar})}for(const zn of $e[pn]){const xr=zn[0];xr.source!==this.source&&l.warnOnce(`layer.source = ${xr.source} does not equal this.source = ${this.source}`),xr.minzoom&&this.zoom<Math.floor(xr.minzoom)||xr.maxzoom&&this.zoom>=xr.maxzoom||xr.visibility!=="none"&&(T(zn,this.zoom,se),(ye[xr.id]=xr.createBucket({index:Te.bucketLayerIDs.length,layers:zn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ar,sourceID:this.source})).populate(Ut,Ce,this.tileID.canonical),Te.bucketLayerIDs.push(zn.map(Vs=>Vs.id)))}}let We,qe,At,nn;const Ot=l.mapObject(Ce.glyphDependencies,pn=>Object.keys(pn).map(Number));this.inFlightDependencies.forEach(pn=>pn==null?void 0:pn.cancel()),this.inFlightDependencies=[];const dt=++this.dependencySentinel;Object.keys(Ot).length?this.inFlightDependencies.push(ue.send("getGlyphs",{uid:this.uid,stacks:Ot,source:this.source,tileID:this.tileID,type:"glyphs"},(pn,yn)=>{dt===this.dependencySentinel&&(We||(We=pn,qe=yn,bn.call(this)))})):qe={};const Nt=Object.keys(Ce.iconDependencies);Nt.length?this.inFlightDependencies.push(ue.send("getImages",{icons:Nt,source:this.source,tileID:this.tileID,type:"icons"},(pn,yn)=>{dt===this.dependencySentinel&&(We||(We=pn,At=yn,bn.call(this)))})):At={};const xn=Object.keys(Ce.patternDependencies);function bn(){if(We)return ve(We);if(qe&&At&&nn){const pn=new _(qe),yn=new l.ImageAtlas(At,nn);for(const Ar in ye){const Ut=ye[Ar];Ut instanceof l.SymbolBucket?(T(Ut.layers,this.zoom,se),l.performSymbolLayout({bucket:Ut,glyphMap:qe,glyphPositions:pn.positions,imageMap:At,imagePositions:yn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ut.hasPattern&&(Ut instanceof l.LineBucket||Ut instanceof l.FillBucket||Ut instanceof l.FillExtrusionBucket)&&(T(Ut.layers,this.zoom,se),Ut.addFeatures(Ce,this.tileID.canonical,yn.patternPositions))}this.status="done",ve(null,{buckets:Object.values(ye).filter(Ar=>!Ar.isEmpty()),featureIndex:Te,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:pn.image,imageAtlas:yn,glyphMap:this.returnDependencies?qe:null,iconMap:this.returnDependencies?At:null,glyphPositions:this.returnDependencies?pn.positions:null})}}xn.length?this.inFlightDependencies.push(ue.send("getImages",{icons:xn,source:this.source,tileID:this.tileID,type:"patterns"},(pn,yn)=>{dt===this.dependencySentinel&&(We||(We=pn,nn=yn,bn.call(this)))})):nn={},bn.call(this)}}function T(de,G,Z){const se=new l.EvaluationParameters(G);for(const ue of de)ue.recalculate(se,Z)}function A(de,G){const Z=l.getArrayBuffer(de.request,(se,ue,ve,Se)=>{if(se)G(se);else if(ue)try{const Te=new l.vectorTile.VectorTile(new l.Protobuf(ue));G(null,{vectorTile:Te,rawData:ue,cacheControl:ve,expires:Se})}catch(Te){const ye=new Uint8Array(ue);let Ce=`Unable to parse the tile at ${de.request.url}, `;Ce+=ye[0]===31&&ye[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Te.messge}`,G(new Error(Ce))}});return()=>{Z.cancel(),G()}}class L{constructor(G,Z,se,ue){this.actor=G,this.layerIndex=Z,this.availableImages=se,this.loadVectorData=ue||A,this.fetching={},this.loading={},this.loaded={}}loadTile(G,Z){const se=G.uid;this.loading||(this.loading={});const ue=!!(G&&G.request&&G.request.collectResourceTiming)&&new l.RequestPerformance(G.request),ve=this.loading[se]=new E(G);ve.abort=this.loadVectorData(G,(Se,Te)=>{if(delete this.loading[se],Se||!Te)return ve.status="done",this.loaded[se]=ve,Z(Se);const ye=Te.rawData,Ce={};Te.expires&&(Ce.expires=Te.expires),Te.cacheControl&&(Ce.cacheControl=Te.cacheControl);const $e={};if(ue){const We=ue.finish();We&&($e.resourceTiming=JSON.parse(JSON.stringify(We)))}ve.vectorTile=Te.vectorTile,ve.parse(Te.vectorTile,this.layerIndex,this.availableImages,this.actor,(We,qe)=>{if(delete this.fetching[se],We||!qe)return Z(We);Z(null,l.extend({rawTileData:ye.slice(0)},qe,Ce,$e))}),this.loaded=this.loaded||{},this.loaded[se]=ve,this.fetching[se]={rawTileData:ye,cacheControl:Ce,resourceTiming:$e}})}reloadTile(G,Z){const se=this.loaded,ue=G.uid;if(se&&se[ue]){const ve=se[ue];ve.showCollisionBoxes=G.showCollisionBoxes,ve.status==="parsing"?ve.parse(ve.vectorTile,this.layerIndex,this.availableImages,this.actor,(Se,Te)=>{if(Se||!Te)return Z(Se,Te);let ye;if(this.fetching[ue]){const{rawTileData:Ce,cacheControl:$e,resourceTiming:We}=this.fetching[ue];delete this.fetching[ue],ye=l.extend({rawTileData:Ce.slice(0)},Te,$e,We)}else ye=Te;Z(null,ye)}):ve.status==="done"&&(ve.vectorTile?ve.parse(ve.vectorTile,this.layerIndex,this.availableImages,this.actor,Z):Z())}}abortTile(G,Z){const se=this.loading,ue=G.uid;se&&se[ue]&&se[ue].abort&&(se[ue].abort(),delete se[ue]),Z()}removeTile(G,Z){const se=this.loaded,ue=G.uid;se&&se[ue]&&delete se[ue],Z()}}class R{constructor(){this.loaded={}}async loadTile(G,Z){const{uid:se,encoding:ue,rawImageData:ve,redFactor:Se,greenFactor:Te,blueFactor:ye,baseShift:Ce}=G,$e=ve.width+2,We=ve.height+2,qe=l.isImageBitmap(ve)?new l.RGBAImage({width:$e,height:We},await l.getImageData(ve,-1,-1,$e,We)):ve,At=new l.DEMData(se,qe,ue,Se,Te,ye,Ce);this.loaded=this.loaded||{},this.loaded[se]=At,Z(null,At)}removeTile(G){const Z=this.loaded,se=G.uid;Z&&Z[se]&&delete Z[se]}}function D(de,G){if(de.length!==0){W(de[0],G);for(var Z=1;Z<de.length;Z++)W(de[Z],!G)}}function W(de,G){for(var Z=0,se=0,ue=0,ve=de.length,Se=ve-1;ue<ve;Se=ue++){var Te=(de[ue][0]-de[Se][0])*(de[Se][1]+de[ue][1]),ye=Z+Te;se+=Math.abs(Z)>=Math.abs(Te)?Z-ye+Te:Te-ye+Z,Z=ye}Z+se>=0!=!!G&&de.reverse()}var z=l.getDefaultExportFromCjs(function de(G,Z){var se,ue=G&&G.type;if(ue==="FeatureCollection")for(se=0;se<G.features.length;se++)de(G.features[se],Z);else if(ue==="GeometryCollection")for(se=0;se<G.geometries.length;se++)de(G.geometries[se],Z);else if(ue==="Feature")de(G.geometry,Z);else if(ue==="Polygon")D(G.coordinates,Z);else if(ue==="MultiPolygon")for(se=0;se<G.coordinates.length;se++)D(G.coordinates[se],Z);return G});const N=l.vectorTile.VectorTileFeature.prototype.toGeoJSON;var F={exports:{}},$=l.pointGeometry,K=l.vectorTile.VectorTileFeature,ne=re;function re(de,G){this.options=G||{},this.features=de,this.length=de.length}function be(de,G){this.id=typeof de.id=="number"?de.id:void 0,this.type=de.type,this.rawGeometry=de.type===1?[de.geometry]:de.geometry,this.properties=de.tags,this.extent=G||4096}re.prototype.feature=function(de){return new be(this.features[de],this.options.extent)},be.prototype.loadGeometry=function(){var de=this.rawGeometry;this.geometry=[];for(var G=0;G<de.length;G++){for(var Z=de[G],se=[],ue=0;ue<Z.length;ue++)se.push(new $(Z[ue][0],Z[ue][1]));this.geometry.push(se)}return this.geometry},be.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var de=this.geometry,G=1/0,Z=-1/0,se=1/0,ue=-1/0,ve=0;ve<de.length;ve++)for(var Se=de[ve],Te=0;Te<Se.length;Te++){var ye=Se[Te];G=Math.min(G,ye.x),Z=Math.max(Z,ye.x),se=Math.min(se,ye.y),ue=Math.max(ue,ye.y)}return[G,se,Z,ue]},be.prototype.toGeoJSON=K.prototype.toGeoJSON;var xe=l.pbf,fe=ne;function Re(de){var G=new xe;return function(Z,se){for(var ue in Z.layers)se.writeMessage(3,Ve,Z.layers[ue])}(de,G),G.finish()}function Ve(de,G){var Z;G.writeVarintField(15,de.version||1),G.writeStringField(1,de.name||""),G.writeVarintField(5,de.extent||4096);var se={keys:[],values:[],keycache:{},valuecache:{}};for(Z=0;Z<de.length;Z++)se.feature=de.feature(Z),G.writeMessage(2,Fe,se);var ue=se.keys;for(Z=0;Z<ue.length;Z++)G.writeStringField(3,ue[Z]);var ve=se.values;for(Z=0;Z<ve.length;Z++)G.writeMessage(4,ke,ve[Z])}function Fe(de,G){var Z=de.feature;Z.id!==void 0&&G.writeVarintField(1,Z.id),G.writeMessage(2,ze,de),G.writeVarintField(3,Z.type),G.writeMessage(4,tt,Z)}function ze(de,G){var Z=de.feature,se=de.keys,ue=de.values,ve=de.keycache,Se=de.valuecache;for(var Te in Z.properties){var ye=Z.properties[Te],Ce=ve[Te];if(ye!==null){Ce===void 0&&(se.push(Te),ve[Te]=Ce=se.length-1),G.writeVarint(Ce);var $e=typeof ye;$e!=="string"&&$e!=="boolean"&&$e!=="number"&&(ye=JSON.stringify(ye));var We=$e+":"+ye,qe=Se[We];qe===void 0&&(ue.push(ye),Se[We]=qe=ue.length-1),G.writeVarint(qe)}}}function Ye(de,G){return(G<<3)+(7&de)}function je(de){return de<<1^de>>31}function tt(de,G){for(var Z=de.loadGeometry(),se=de.type,ue=0,ve=0,Se=Z.length,Te=0;Te<Se;Te++){var ye=Z[Te],Ce=1;se===1&&(Ce=ye.length),G.writeVarint(Ye(1,Ce));for(var $e=se===3?ye.length-1:ye.length,We=0;We<$e;We++){We===1&&se!==1&&G.writeVarint(Ye(2,$e-1));var qe=ye[We].x-ue,At=ye[We].y-ve;G.writeVarint(je(qe)),G.writeVarint(je(At)),ue+=qe,ve+=At}se===3&&G.writeVarint(Ye(7,1))}}function ke(de,G){var Z=typeof de;Z==="string"?G.writeStringField(1,de):Z==="boolean"?G.writeBooleanField(7,de):Z==="number"&&(de%1!=0?G.writeDoubleField(3,de):de<0?G.writeSVarintField(6,de):G.writeVarintField(5,de))}F.exports=Re,F.exports.fromVectorTileJs=Re,F.exports.fromGeojsonVt=function(de,G){G=G||{};var Z={};for(var se in de)Z[se]=new fe(de[se].features,G),Z[se].name=se,Z[se].version=G.version,Z[se].extent=G.extent;return Re({layers:Z})},F.exports.GeoJSONWrapper=fe;var Ge=l.getDefaultExportFromCjs(F.exports);const nt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:de=>de},Dt=Math.fround||(ht=new Float32Array(1),de=>(ht[0]=+de,ht[0]));var ht;const ot=3,ct=5,xt=6;class bt{constructor(G){this.options=Object.assign(Object.create(nt),G),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(G){const{log:Z,minZoom:se,maxZoom:ue}=this.options;Z&&console.time("total time");const ve=`prepare ${G.length} points`;Z&&console.time(ve),this.points=G;const Se=[];for(let ye=0;ye<G.length;ye++){const Ce=G[ye];if(!Ce.geometry)continue;const[$e,We]=Ce.geometry.coordinates,qe=Dt(Et($e)),At=Dt(sn(We));Se.push(qe,At,1/0,ye,-1,1),this.options.reduce&&Se.push(0)}let Te=this.trees[ue+1]=this._createTree(Se);Z&&console.timeEnd(ve);for(let ye=ue;ye>=se;ye--){const Ce=+Date.now();Te=this.trees[ye]=this._createTree(this._cluster(Te,ye)),Z&&console.log("z%d: %d clusters in %dms",ye,Te.numItems,+Date.now()-Ce)}return Z&&console.timeEnd("total time"),this}getClusters(G,Z){let se=((G[0]+180)%360+360)%360-180;const ue=Math.max(-90,Math.min(90,G[1]));let ve=G[2]===180?180:((G[2]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,G[3]));if(G[2]-G[0]>=360)se=-180,ve=180;else if(se>ve){const We=this.getClusters([se,ue,180,Se],Z),qe=this.getClusters([-180,ue,ve,Se],Z);return We.concat(qe)}const Te=this.trees[this._limitZoom(Z)],ye=Te.range(Et(se),sn(Se),Et(ve),sn(ue)),Ce=Te.data,$e=[];for(const We of ye){const qe=this.stride*We;$e.push(Ce[qe+ct]>1?Jt(Ce,qe,this.clusterProps):this.points[Ce[qe+ot]])}return $e}getChildren(G){const Z=this._getOriginId(G),se=this._getOriginZoom(G),ue="No cluster with the specified id.",ve=this.trees[se];if(!ve)throw new Error(ue);const Se=ve.data;if(Z*this.stride>=Se.length)throw new Error(ue);const Te=this.options.radius/(this.options.extent*Math.pow(2,se-1)),ye=ve.within(Se[Z*this.stride],Se[Z*this.stride+1],Te),Ce=[];for(const $e of ye){const We=$e*this.stride;Se[We+4]===G&&Ce.push(Se[We+ct]>1?Jt(Se,We,this.clusterProps):this.points[Se[We+ot]])}if(Ce.length===0)throw new Error(ue);return Ce}getLeaves(G,Z,se){const ue=[];return this._appendLeaves(ue,G,Z=Z||10,se=se||0,0),ue}getTile(G,Z,se){const ue=this.trees[this._limitZoom(G)],ve=Math.pow(2,G),{extent:Se,radius:Te}=this.options,ye=Te/Se,Ce=(se-ye)/ve,$e=(se+1+ye)/ve,We={features:[]};return this._addTileFeatures(ue.range((Z-ye)/ve,Ce,(Z+1+ye)/ve,$e),ue.data,Z,se,ve,We),Z===0&&this._addTileFeatures(ue.range(1-ye/ve,Ce,1,$e),ue.data,ve,se,ve,We),Z===ve-1&&this._addTileFeatures(ue.range(0,Ce,ye/ve,$e),ue.data,-1,se,ve,We),We.features.length?We:null}getClusterExpansionZoom(G){let Z=this._getOriginZoom(G)-1;for(;Z<=this.options.maxZoom;){const se=this.getChildren(G);if(Z++,se.length!==1)break;G=se[0].properties.cluster_id}return Z}_appendLeaves(G,Z,se,ue,ve){const Se=this.getChildren(Z);for(const Te of Se){const ye=Te.properties;if(ye&&ye.cluster?ve+ye.point_count<=ue?ve+=ye.point_count:ve=this._appendLeaves(G,ye.cluster_id,se,ue,ve):ve<ue?ve++:G.push(Te),G.length===se)break}return ve}_createTree(G){const Z=new l.KDBush(G.length/this.stride|0,this.options.nodeSize,Float32Array);for(let se=0;se<G.length;se+=this.stride)Z.add(G[se],G[se+1]);return Z.finish(),Z.data=G,Z}_addTileFeatures(G,Z,se,ue,ve,Se){for(const Te of G){const ye=Te*this.stride,Ce=Z[ye+ct]>1;let $e,We,qe;if(Ce)$e=Je(Z,ye,this.clusterProps),We=Z[ye],qe=Z[ye+1];else{const Ot=this.points[Z[ye+ot]];$e=Ot.properties;const[dt,Nt]=Ot.geometry.coordinates;We=Et(dt),qe=sn(Nt)}const At={type:1,geometry:[[Math.round(this.options.extent*(We*ve-se)),Math.round(this.options.extent*(qe*ve-ue))]],tags:$e};let nn;nn=Ce||this.options.generateId?Z[ye+ot]:this.points[Z[ye+ot]].id,nn!==void 0&&(At.id=nn),Se.features.push(At)}}_limitZoom(G){return Math.max(this.options.minZoom,Math.min(Math.floor(+G),this.options.maxZoom+1))}_cluster(G,Z){const{radius:se,extent:ue,reduce:ve,minPoints:Se}=this.options,Te=se/(ue*Math.pow(2,Z)),ye=G.data,Ce=[],$e=this.stride;for(let We=0;We<ye.length;We+=$e){if(ye[We+2]<=Z)continue;ye[We+2]=Z;const qe=ye[We],At=ye[We+1],nn=G.within(ye[We],ye[We+1],Te),Ot=ye[We+ct];let dt=Ot;for(const Nt of nn){const xn=Nt*$e;ye[xn+2]>Z&&(dt+=ye[xn+ct])}if(dt>Ot&&dt>=Se){let Nt,xn=qe*Ot,bn=At*Ot,pn=-1;const yn=((We/$e|0)<<5)+(Z+1)+this.points.length;for(const Ar of nn){const Ut=Ar*$e;if(ye[Ut+2]<=Z)continue;ye[Ut+2]=Z;const zn=ye[Ut+ct];xn+=ye[Ut]*zn,bn+=ye[Ut+1]*zn,ye[Ut+4]=yn,ve&&(Nt||(Nt=this._map(ye,We,!0),pn=this.clusterProps.length,this.clusterProps.push(Nt)),ve(Nt,this._map(ye,Ut)))}ye[We+4]=yn,Ce.push(xn/dt,bn/dt,1/0,yn,-1,dt),ve&&Ce.push(pn)}else{for(let Nt=0;Nt<$e;Nt++)Ce.push(ye[We+Nt]);if(dt>1)for(const Nt of nn){const xn=Nt*$e;if(!(ye[xn+2]<=Z)){ye[xn+2]=Z;for(let bn=0;bn<$e;bn++)Ce.push(ye[xn+bn])}}}}return Ce}_getOriginId(G){return G-this.points.length>>5}_getOriginZoom(G){return(G-this.points.length)%32}_map(G,Z,se){if(G[Z+ct]>1){const Se=this.clusterProps[G[Z+xt]];return se?Object.assign({},Se):Se}const ue=this.points[G[Z+ot]].properties,ve=this.options.map(ue);return se&&ve===ue?Object.assign({},ve):ve}}function Jt(de,G,Z){return{type:"Feature",id:de[G+ot],properties:Je(de,G,Z),geometry:{type:"Point",coordinates:[(se=de[G],360*(se-.5)),Qt(de[G+1])]}};var se}function Je(de,G,Z){const se=de[G+ct],ue=se>=1e4?`${Math.round(se/1e3)}k`:se>=1e3?Math.round(se/100)/10+"k":se,ve=de[G+xt],Se=ve===-1?{}:Object.assign({},Z[ve]);return Object.assign(Se,{cluster:!0,cluster_id:de[G+ot],point_count:se,point_count_abbreviated:ue})}function Et(de){return de/360+.5}function sn(de){const G=Math.sin(de*Math.PI/180),Z=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return Z<0?0:Z>1?1:Z}function Qt(de){const G=(180-360*de)*Math.PI/180;return 360*Math.atan(Math.exp(G))/Math.PI-90}function hn(de,G,Z,se){for(var ue,ve=se,Se=Z-G>>1,Te=Z-G,ye=de[G],Ce=de[G+1],$e=de[Z],We=de[Z+1],qe=G+3;qe<Z;qe+=3){var At=$t(de[qe],de[qe+1],ye,Ce,$e,We);if(At>ve)ue=qe,ve=At;else if(At===ve){var nn=Math.abs(qe-Se);nn<Te&&(ue=qe,Te=nn)}}ve>se&&(ue-G>3&&hn(de,G,ue,se),de[ue+2]=ve,Z-ue>3&&hn(de,ue,Z,se))}function $t(de,G,Z,se,ue,ve){var Se=ue-Z,Te=ve-se;if(Se!==0||Te!==0){var ye=((de-Z)*Se+(G-se)*Te)/(Se*Se+Te*Te);ye>1?(Z=ue,se=ve):ye>0&&(Z+=Se*ye,se+=Te*ye)}return(Se=de-Z)*Se+(Te=G-se)*Te}function Lt(de,G,Z,se){var ue={id:de===void 0?null:de,type:G,geometry:Z,tags:se,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ve){var Se=ve.geometry,Te=ve.type;if(Te==="Point"||Te==="MultiPoint"||Te==="LineString")Ft(ve,Se);else if(Te==="Polygon"||Te==="MultiLineString")for(var ye=0;ye<Se.length;ye++)Ft(ve,Se[ye]);else if(Te==="MultiPolygon")for(ye=0;ye<Se.length;ye++)for(var Ce=0;Ce<Se[ye].length;Ce++)Ft(ve,Se[ye][Ce])}(ue),ue}function Ft(de,G){for(var Z=0;Z<G.length;Z+=3)de.minX=Math.min(de.minX,G[Z]),de.minY=Math.min(de.minY,G[Z+1]),de.maxX=Math.max(de.maxX,G[Z]),de.maxY=Math.max(de.maxY,G[Z+1])}function wn(de,G,Z,se){if(G.geometry){var ue=G.geometry.coordinates,ve=G.geometry.type,Se=Math.pow(Z.tolerance/((1<<Z.maxZoom)*Z.extent),2),Te=[],ye=G.id;if(Z.promoteId?ye=G.properties[Z.promoteId]:Z.generateId&&(ye=se||0),ve==="Point")vn(ue,Te);else if(ve==="MultiPoint")for(var Ce=0;Ce<ue.length;Ce++)vn(ue[Ce],Te);else if(ve==="LineString")pt(ue,Te,Se,!1);else if(ve==="MultiLineString"){if(Z.lineMetrics){for(Ce=0;Ce<ue.length;Ce++)pt(ue[Ce],Te=[],Se,!1),de.push(Lt(ye,"LineString",Te,G.properties));return}dn(ue,Te,Se,!1)}else if(ve==="Polygon")dn(ue,Te,Se,!0);else{if(ve!=="MultiPolygon"){if(ve==="GeometryCollection"){for(Ce=0;Ce<G.geometry.geometries.length;Ce++)wn(de,{id:ye,geometry:G.geometry.geometries[Ce],properties:G.properties},Z,se);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ce=0;Ce<ue.length;Ce++){var $e=[];dn(ue[Ce],$e,Se,!0),Te.push($e)}}de.push(Lt(ye,ve,Te,G.properties))}}function vn(de,G){G.push(Ae(de[0])),G.push(Ct(de[1])),G.push(0)}function pt(de,G,Z,se){for(var ue,ve,Se=0,Te=0;Te<de.length;Te++){var ye=Ae(de[Te][0]),Ce=Ct(de[Te][1]);G.push(ye),G.push(Ce),G.push(0),Te>0&&(Se+=se?(ue*Ce-ye*ve)/2:Math.sqrt(Math.pow(ye-ue,2)+Math.pow(Ce-ve,2))),ue=ye,ve=Ce}var $e=G.length-3;G[2]=1,hn(G,0,$e,Z),G[$e+2]=1,G.size=Math.abs(Se),G.start=0,G.end=G.size}function dn(de,G,Z,se){for(var ue=0;ue<de.length;ue++){var ve=[];pt(de[ue],ve,Z,se),G.push(ve)}}function Ae(de){return de/360+.5}function Ct(de){var G=Math.sin(de*Math.PI/180),Z=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return Z<0?0:Z>1?1:Z}function En(de,G,Z,se,ue,ve,Se,Te){if(se/=G,ve>=(Z/=G)&&Se<se)return de;if(Se<Z||ve>=se)return null;for(var ye=[],Ce=0;Ce<de.length;Ce++){var $e=de[Ce],We=$e.geometry,qe=$e.type,At=ue===0?$e.minX:$e.minY,nn=ue===0?$e.maxX:$e.maxY;if(At>=Z&&nn<se)ye.push($e);else if(!(nn<Z||At>=se)){var Ot=[];if(qe==="Point"||qe==="MultiPoint")en(We,Ot,Z,se,ue);else if(qe==="LineString")It(We,Ot,Z,se,ue,!1,Te.lineMetrics);else if(qe==="MultiLineString")gt(We,Ot,Z,se,ue,!1);else if(qe==="Polygon")gt(We,Ot,Z,se,ue,!0);else if(qe==="MultiPolygon")for(var dt=0;dt<We.length;dt++){var Nt=[];gt(We[dt],Nt,Z,se,ue,!0),Nt.length&&Ot.push(Nt)}if(Ot.length){if(Te.lineMetrics&&qe==="LineString"){for(dt=0;dt<Ot.length;dt++)ye.push(Lt($e.id,qe,Ot[dt],$e.tags));continue}qe!=="LineString"&&qe!=="MultiLineString"||(Ot.length===1?(qe="LineString",Ot=Ot[0]):qe="MultiLineString"),qe!=="Point"&&qe!=="MultiPoint"||(qe=Ot.length===3?"Point":"MultiPoint"),ye.push(Lt($e.id,qe,Ot,$e.tags))}}}return ye.length?ye:null}function en(de,G,Z,se,ue){for(var ve=0;ve<de.length;ve+=3){var Se=de[ve+ue];Se>=Z&&Se<=se&&(G.push(de[ve]),G.push(de[ve+1]),G.push(de[ve+2]))}}function It(de,G,Z,se,ue,ve,Se){for(var Te,ye,Ce=Qe(de),$e=ue===0?Rt:Pt,We=de.start,qe=0;qe<de.length-3;qe+=3){var At=de[qe],nn=de[qe+1],Ot=de[qe+2],dt=de[qe+3],Nt=de[qe+4],xn=ue===0?At:nn,bn=ue===0?dt:Nt,pn=!1;Se&&(Te=Math.sqrt(Math.pow(At-dt,2)+Math.pow(nn-Nt,2))),xn<Z?bn>Z&&(ye=$e(Ce,At,nn,dt,Nt,Z),Se&&(Ce.start=We+Te*ye)):xn>se?bn<se&&(ye=$e(Ce,At,nn,dt,Nt,se),Se&&(Ce.start=We+Te*ye)):Mt(Ce,At,nn,Ot),bn<Z&&xn>=Z&&(ye=$e(Ce,At,nn,dt,Nt,Z),pn=!0),bn>se&&xn<=se&&(ye=$e(Ce,At,nn,dt,Nt,se),pn=!0),!ve&&pn&&(Se&&(Ce.end=We+Te*ye),G.push(Ce),Ce=Qe(de)),Se&&(We+=Te)}var yn=de.length-3;At=de[yn],nn=de[yn+1],Ot=de[yn+2],(xn=ue===0?At:nn)>=Z&&xn<=se&&Mt(Ce,At,nn,Ot),yn=Ce.length-3,ve&&yn>=3&&(Ce[yn]!==Ce[0]||Ce[yn+1]!==Ce[1])&&Mt(Ce,Ce[0],Ce[1],Ce[2]),Ce.length&&G.push(Ce)}function Qe(de){var G=[];return G.size=de.size,G.start=de.start,G.end=de.end,G}function gt(de,G,Z,se,ue,ve){for(var Se=0;Se<de.length;Se++)It(de[Se],G,Z,se,ue,ve,!1)}function Mt(de,G,Z,se){de.push(G),de.push(Z),de.push(se)}function Rt(de,G,Z,se,ue,ve){var Se=(ve-G)/(se-G);return de.push(ve),de.push(Z+(ue-Z)*Se),de.push(1),Se}function Pt(de,G,Z,se,ue,ve){var Se=(ve-Z)/(ue-Z);return de.push(G+(se-G)*Se),de.push(ve),de.push(1),Se}function gn(de,G){for(var Z=[],se=0;se<de.length;se++){var ue,ve=de[se],Se=ve.type;if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")ue=mn(ve.geometry,G);else if(Se==="MultiLineString"||Se==="Polygon"){ue=[];for(var Te=0;Te<ve.geometry.length;Te++)ue.push(mn(ve.geometry[Te],G))}else if(Se==="MultiPolygon")for(ue=[],Te=0;Te<ve.geometry.length;Te++){for(var ye=[],Ce=0;Ce<ve.geometry[Te].length;Ce++)ye.push(mn(ve.geometry[Te][Ce],G));ue.push(ye)}Z.push(Lt(ve.id,Se,ue,ve.tags))}return Z}function mn(de,G){var Z=[];Z.size=de.size,de.start!==void 0&&(Z.start=de.start,Z.end=de.end);for(var se=0;se<de.length;se+=3)Z.push(de[se]+G,de[se+1],de[se+2]);return Z}function He(de,G){if(de.transformed)return de;var Z,se,ue,ve=1<<de.z,Se=de.x,Te=de.y;for(Z=0;Z<de.features.length;Z++){var ye=de.features[Z],Ce=ye.geometry,$e=ye.type;if(ye.geometry=[],$e===1)for(se=0;se<Ce.length;se+=2)ye.geometry.push(mt(Ce[se],Ce[se+1],G,ve,Se,Te));else for(se=0;se<Ce.length;se++){var We=[];for(ue=0;ue<Ce[se].length;ue+=2)We.push(mt(Ce[se][ue],Ce[se][ue+1],G,ve,Se,Te));ye.geometry.push(We)}}return de.transformed=!0,de}function mt(de,G,Z,se,ue,ve){return[Math.round(Z*(de*se-ue)),Math.round(Z*(G*se-ve))]}function Zt(de,G,Z,se,ue){for(var ve=G===ue.maxZoom?0:ue.tolerance/((1<<G)*ue.extent),Se={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Z,y:se,z:G,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Te=0;Te<de.length;Te++){Se.numFeatures++,Ln(Se,de[Te],ve,ue);var ye=de[Te].minX,Ce=de[Te].minY,$e=de[Te].maxX,We=de[Te].maxY;ye<Se.minX&&(Se.minX=ye),Ce<Se.minY&&(Se.minY=Ce),$e>Se.maxX&&(Se.maxX=$e),We>Se.maxY&&(Se.maxY=We)}return Se}function Ln(de,G,Z,se){var ue=G.geometry,ve=G.type,Se=[];if(ve==="Point"||ve==="MultiPoint")for(var Te=0;Te<ue.length;Te+=3)Se.push(ue[Te]),Se.push(ue[Te+1]),de.numPoints++,de.numSimplified++;else if(ve==="LineString")Fn(Se,ue,de,Z,!1,!1);else if(ve==="MultiLineString"||ve==="Polygon")for(Te=0;Te<ue.length;Te++)Fn(Se,ue[Te],de,Z,ve==="Polygon",Te===0);else if(ve==="MultiPolygon")for(var ye=0;ye<ue.length;ye++){var Ce=ue[ye];for(Te=0;Te<Ce.length;Te++)Fn(Se,Ce[Te],de,Z,!0,Te===0)}if(Se.length){var $e=G.tags||null;if(ve==="LineString"&&se.lineMetrics){for(var We in $e={},G.tags)$e[We]=G.tags[We];$e.mapbox_clip_start=ue.start/ue.size,$e.mapbox_clip_end=ue.end/ue.size}var qe={geometry:Se,type:ve==="Polygon"||ve==="MultiPolygon"?3:ve==="LineString"||ve==="MultiLineString"?2:1,tags:$e};G.id!==null&&(qe.id=G.id),de.features.push(qe)}}function Fn(de,G,Z,se,ue,ve){var Se=se*se;if(se>0&&G.size<(ue?Se:se))Z.numPoints+=G.length/3;else{for(var Te=[],ye=0;ye<G.length;ye+=3)(se===0||G[ye+2]>Se)&&(Z.numSimplified++,Te.push(G[ye]),Te.push(G[ye+1])),Z.numPoints++;ue&&function(Ce,$e){for(var We=0,qe=0,At=Ce.length,nn=At-2;qe<At;nn=qe,qe+=2)We+=(Ce[qe]-Ce[nn])*(Ce[qe+1]+Ce[nn+1]);if(We>0===$e)for(qe=0,At=Ce.length;qe<At/2;qe+=2){var Ot=Ce[qe],dt=Ce[qe+1];Ce[qe]=Ce[At-2-qe],Ce[qe+1]=Ce[At-1-qe],Ce[At-2-qe]=Ot,Ce[At-1-qe]=dt}}(Te,ve),de.push(Te)}}function it(de,G){var Z=(G=this.options=function(ue,ve){for(var Se in ve)ue[Se]=ve[Se];return ue}(Object.create(this.options),G)).debug;if(Z&&console.time("preprocess data"),G.maxZoom<0||G.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(G.promoteId&&G.generateId)throw new Error("promoteId and generateId cannot be used together.");var se=function(ue,ve){var Se=[];if(ue.type==="FeatureCollection")for(var Te=0;Te<ue.features.length;Te++)wn(Se,ue.features[Te],ve,Te);else wn(Se,ue.type==="Feature"?ue:{geometry:ue},ve);return Se}(de,G);this.tiles={},this.tileCoords=[],Z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",G.indexMaxZoom,G.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),se=function(ue,ve){var Se=ve.buffer/ve.extent,Te=ue,ye=En(ue,1,-1-Se,Se,0,-1,2,ve),Ce=En(ue,1,1-Se,2+Se,0,-1,2,ve);return(ye||Ce)&&(Te=En(ue,1,-Se,1+Se,0,-1,2,ve)||[],ye&&(Te=gn(ye,1).concat(Te)),Ce&&(Te=Te.concat(gn(Ce,-1)))),Te}(se,G),se.length&&this.splitTile(se,0,0,0),Z&&(se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function fn(de,G,Z){return 32*((1<<de)*Z+G)+de}function ln(de,G){return G?de.properties[G]:de.id}function Cr(de,G){if(de==null)return!0;if(de.type==="Feature")return ln(de,G)!=null;if(de.type==="FeatureCollection"){const Z=new Set;for(const se of de.features){const ue=ln(se,G);if(ue==null||Z.has(ue))return!1;Z.add(ue)}return!0}return!1}function li(de,G){const Z=new Map;if(de!=null)if(de.type==="Feature")Z.set(ln(de,G),de);else for(const se of de.features)Z.set(ln(se,G),se);return Z}function cn(de,G){const Z=de.tileID.canonical;if(!this._geoJSONIndex)return G(null,null);const se=this._geoJSONIndex.getTile(Z.z,Z.x,Z.y);if(!se)return G(null,null);const ue=new class{constructor(Se){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=Se.length,this._features=Se}feature(Se){return new class{constructor(Te){this._feature=Te,this.extent=l.EXTENT,this.type=Te.type,this.properties=Te.tags,"id"in Te&&!isNaN(Te.id)&&(this.id=parseInt(Te.id,10))}loadGeometry(){if(this._feature.type===1){const Te=[];for(const ye of this._feature.geometry)Te.push([new l.Point(ye[0],ye[1])]);return Te}{const Te=[];for(const ye of this._feature.geometry){const Ce=[];for(const $e of ye)Ce.push(new l.Point($e[0],$e[1]));Te.push(Ce)}return Te}}toGeoJSON(Te,ye,Ce){return N.call(this,Te,ye,Ce)}}(this._features[Se])}}(se.features);let ve=Ge(ue);ve.byteOffset===0&&ve.byteLength===ve.buffer.byteLength||(ve=new Uint8Array(ve)),G(null,{vectorTile:ue,rawData:ve.buffer})}it.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},it.prototype.splitTile=function(de,G,Z,se,ue,ve,Se){for(var Te=[de,G,Z,se],ye=this.options,Ce=ye.debug;Te.length;){se=Te.pop(),Z=Te.pop(),G=Te.pop(),de=Te.pop();var $e=1<<G,We=fn(G,Z,se),qe=this.tiles[We];if(!qe&&(Ce>1&&console.time("creation"),qe=this.tiles[We]=Zt(de,G,Z,se,ye),this.tileCoords.push({z:G,x:Z,y:se}),Ce)){Ce>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",G,Z,se,qe.numFeatures,qe.numPoints,qe.numSimplified),console.timeEnd("creation"));var At="z"+G;this.stats[At]=(this.stats[At]||0)+1,this.total++}if(qe.source=de,ue){if(G===ye.maxZoom||G===ue)continue;var nn=1<<ue-G;if(Z!==Math.floor(ve/nn)||se!==Math.floor(Se/nn))continue}else if(G===ye.indexMaxZoom||qe.numPoints<=ye.indexMaxPoints)continue;if(qe.source=null,de.length!==0){Ce>1&&console.time("clipping");var Ot,dt,Nt,xn,bn,pn,yn=.5*ye.buffer/ye.extent,Ar=.5-yn,Ut=.5+yn,zn=1+yn;Ot=dt=Nt=xn=null,bn=En(de,$e,Z-yn,Z+Ut,0,qe.minX,qe.maxX,ye),pn=En(de,$e,Z+Ar,Z+zn,0,qe.minX,qe.maxX,ye),de=null,bn&&(Ot=En(bn,$e,se-yn,se+Ut,1,qe.minY,qe.maxY,ye),dt=En(bn,$e,se+Ar,se+zn,1,qe.minY,qe.maxY,ye),bn=null),pn&&(Nt=En(pn,$e,se-yn,se+Ut,1,qe.minY,qe.maxY,ye),xn=En(pn,$e,se+Ar,se+zn,1,qe.minY,qe.maxY,ye),pn=null),Ce>1&&console.timeEnd("clipping"),Te.push(Ot||[],G+1,2*Z,2*se),Te.push(dt||[],G+1,2*Z,2*se+1),Te.push(Nt||[],G+1,2*Z+1,2*se),Te.push(xn||[],G+1,2*Z+1,2*se+1)}}},it.prototype.getTile=function(de,G,Z){var se=this.options,ue=se.extent,ve=se.debug;if(de<0||de>24)return null;var Se=1<<de,Te=fn(de,G=(G%Se+Se)%Se,Z);if(this.tiles[Te])return He(this.tiles[Te],ue);ve>1&&console.log("drilling down to z%d-%d-%d",de,G,Z);for(var ye,Ce=de,$e=G,We=Z;!ye&&Ce>0;)Ce--,$e=Math.floor($e/2),We=Math.floor(We/2),ye=this.tiles[fn(Ce,$e,We)];return ye&&ye.source?(ve>1&&console.log("found parent tile z%d-%d-%d",Ce,$e,We),ve>1&&console.time("drilling down"),this.splitTile(ye.source,Ce,$e,We,de,G,Z),ve>1&&console.timeEnd("drilling down"),this.tiles[Te]?He(this.tiles[Te],ue):null):null};class Kr extends L{constructor(G,Z,se,ue){super(G,Z,se,cn),this._dataUpdateable=new Map,this.loadGeoJSON=(ve,Se)=>{const{promoteId:Te}=ve;if(ve.request)return l.getJSON(ve.request,(ye,Ce,$e,We)=>{this._dataUpdateable=Cr(Ce,Te)?li(Ce,Te):void 0,Se(ye,Ce,$e,We)});if(typeof ve.data=="string")try{const ye=JSON.parse(ve.data);this._dataUpdateable=Cr(ye,Te)?li(ye,Te):void 0,Se(null,ye)}catch{Se(new Error(`Input data given to '${ve.source}' is not a valid GeoJSON object.`))}else ve.dataDiff?this._dataUpdateable?(function(ye,Ce,$e){var We,qe,At,nn;if(Ce.removeAll&&ye.clear(),Ce.remove)for(const Ot of Ce.remove)ye.delete(Ot);if(Ce.add)for(const Ot of Ce.add){const dt=ln(Ot,$e);dt!=null&&ye.set(dt,Ot)}if(Ce.update)for(const Ot of Ce.update){let dt=ye.get(Ot.id);if(dt==null)continue;const Nt=!Ot.removeAllProperties&&(((We=Ot.removeProperties)===null||We===void 0?void 0:We.length)>0||((qe=Ot.addOrUpdateProperties)===null||qe===void 0?void 0:qe.length)>0);if((Ot.newGeometry||Ot.removeAllProperties||Nt)&&(dt={...dt},ye.set(Ot.id,dt),Nt&&(dt.properties={...dt.properties})),Ot.newGeometry&&(dt.geometry=Ot.newGeometry),Ot.removeAllProperties)dt.properties={};else if(((At=Ot.removeProperties)===null||At===void 0?void 0:At.length)>0)for(const xn of Ot.removeProperties)Object.prototype.hasOwnProperty.call(dt.properties,xn)&&delete dt.properties[xn];if(((nn=Ot.addOrUpdateProperties)===null||nn===void 0?void 0:nn.length)>0)for(const{key:xn,value:bn}of Ot.addOrUpdateProperties)dt.properties[xn]=bn}}(this._dataUpdateable,ve.dataDiff,Te),Se(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Se(new Error(`Cannot update existing geojson data in ${ve.source}`)):Se(new Error(`Input data given to '${ve.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},ue&&(this.loadGeoJSON=ue)}loadData(G,Z){var se;(se=this._pendingRequest)===null||se===void 0||se.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const ue=!!(G&&G.request&&G.request.collectResourceTiming)&&new l.RequestPerformance(G.request);this._pendingCallback=Z,this._pendingRequest=this.loadGeoJSON(G,(ve,Se)=>{if(delete this._pendingCallback,delete this._pendingRequest,ve||!Se)return Z(ve);if(typeof Se!="object")return Z(new Error(`Input data given to '${G.source}' is not a valid GeoJSON object.`));{z(Se,!0);try{if(G.filter){const ye=l.createExpression(G.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map($e=>`${$e.key}: ${$e.message}`).join(", "));Se={type:"FeatureCollection",features:Se.features.filter($e=>ye.value.evaluate({zoom:0},$e))}}this._geoJSONIndex=G.cluster?new bt(function({superclusterOptions:ye,clusterProperties:Ce}){if(!Ce||!ye)return ye;const $e={},We={},qe={accumulated:null,zoom:0},At={properties:null},nn=Object.keys(Ce);for(const Ot of nn){const[dt,Nt]=Ce[Ot],xn=l.createExpression(Nt),bn=l.createExpression(typeof dt=="string"?[dt,["accumulated"],["get",Ot]]:dt);$e[Ot]=xn.value,We[Ot]=bn.value}return ye.map=Ot=>{At.properties=Ot;const dt={};for(const Nt of nn)dt[Nt]=$e[Nt].evaluate(qe,At);return dt},ye.reduce=(Ot,dt)=>{At.properties=dt;for(const Nt of nn)qe.accumulated=Ot[Nt],Ot[Nt]=We[Nt].evaluate(qe,At)},ye}(G)).load(Se.features):function(ye,Ce){return new it(ye,Ce)}(Se,G.geojsonVtOptions)}catch(ye){return Z(ye)}this.loaded={};const Te={};if(ue){const ye=ue.finish();ye&&(Te.resourceTiming={},Te.resourceTiming[G.source]=JSON.parse(JSON.stringify(ye)))}Z(null,Te)}})}reloadTile(G,Z){const se=this.loaded;return se&&se[G.uid]?super.reloadTile(G,Z):this.loadTile(G,Z)}removeSource(G,Z){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Z()}getClusterExpansionZoom(G,Z){try{Z(null,this._geoJSONIndex.getClusterExpansionZoom(G.clusterId))}catch(se){Z(se)}}getClusterChildren(G,Z){try{Z(null,this._geoJSONIndex.getChildren(G.clusterId))}catch(se){Z(se)}}getClusterLeaves(G,Z){try{Z(null,this._geoJSONIndex.getLeaves(G.clusterId,G.limit,G.offset))}catch(se){Z(se)}}}class xi{constructor(G){this.self=G,this.actor=new l.Actor(G,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:L,geojson:Kr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Z,se)=>{if(this.workerSourceTypes[Z])throw new Error(`Worker source with name "${Z}" already registered.`);this.workerSourceTypes[Z]=se},this.self.registerRTLTextPlugin=Z=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=Z.applyArabicShaping,l.plugin.processBidirectionalText=Z.processBidirectionalText,l.plugin.processStyledBidirectionalText=Z.processStyledBidirectionalText}}setReferrer(G,Z){this.referrer=Z}setImages(G,Z,se){this.availableImages[G]=Z;for(const ue in this.workerSources[G]){const ve=this.workerSources[G][ue];for(const Se in ve)ve[Se].availableImages=Z}se()}setLayers(G,Z,se){this.getLayerIndex(G).replace(Z),se()}updateLayers(G,Z,se){this.getLayerIndex(G).update(Z.layers,Z.removedIds),se()}loadTile(G,Z,se){this.getWorkerSource(G,Z.type,Z.source).loadTile(Z,se)}loadDEMTile(G,Z,se){this.getDEMWorkerSource(G,Z.source).loadTile(Z,se)}reloadTile(G,Z,se){this.getWorkerSource(G,Z.type,Z.source).reloadTile(Z,se)}abortTile(G,Z,se){this.getWorkerSource(G,Z.type,Z.source).abortTile(Z,se)}removeTile(G,Z,se){this.getWorkerSource(G,Z.type,Z.source).removeTile(Z,se)}removeDEMTile(G,Z){this.getDEMWorkerSource(G,Z.source).removeTile(Z)}removeSource(G,Z,se){if(!this.workerSources[G]||!this.workerSources[G][Z.type]||!this.workerSources[G][Z.type][Z.source])return;const ue=this.workerSources[G][Z.type][Z.source];delete this.workerSources[G][Z.type][Z.source],ue.removeSource!==void 0?ue.removeSource(Z,se):se()}loadWorkerSource(G,Z,se){try{this.self.importScripts(Z.url),se()}catch(ue){se(ue.toString())}}syncRTLPluginState(G,Z,se){try{l.plugin.setState(Z);const ue=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&ue!=null){this.self.importScripts(ue);const ve=l.plugin.isParsed();se(ve?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ue}`),ve)}}catch(ue){se(ue.toString())}}getAvailableImages(G){let Z=this.availableImages[G];return Z||(Z=[]),Z}getLayerIndex(G){let Z=this.layerIndexes[G];return Z||(Z=this.layerIndexes[G]=new m),Z}getWorkerSource(G,Z,se){if(this.workerSources[G]||(this.workerSources[G]={}),this.workerSources[G][Z]||(this.workerSources[G][Z]={}),!this.workerSources[G][Z][se]){const ue={send:(ve,Se,Te)=>{this.actor.send(ve,Se,Te,G)}};this.workerSources[G][Z][se]=new this.workerSourceTypes[Z](ue,this.getLayerIndex(G),this.getAvailableImages(G))}return this.workerSources[G][Z][se]}getDEMWorkerSource(G,Z){return this.demWorkerSources[G]||(this.demWorkerSources[G]={}),this.demWorkerSources[G][Z]||(this.demWorkerSources[G][Z]=new R),this.demWorkerSources[G][Z]}}return l.isWorker()&&(self.worker=new xi(self)),xi}),o(["./shared"],function(l){var m="3.5.0";class _{static testProp(a){if(!_.docStyle)return a[0];for(let d=0;d<a.length;d++)if(a[d]in _.docStyle)return a[d];return a[0]}static create(a,d,p){const y=window.document.createElement(a);return d!==void 0&&(y.className=d),p&&p.appendChild(y),y}static createNS(a,d){return window.document.createElementNS(a,d)}static disableDrag(){_.docStyle&&_.selectProp&&(_.userSelect=_.docStyle[_.selectProp],_.docStyle[_.selectProp]="none")}static enableDrag(){_.docStyle&&_.selectProp&&(_.docStyle[_.selectProp]=_.userSelect)}static setTransform(a,d){a.style[_.transformProp]=d}static addEventListener(a,d,p,y={}){a.addEventListener(d,p,"passive"in y?y:y.capture)}static removeEventListener(a,d,p,y={}){a.removeEventListener(d,p,"passive"in y?y:y.capture)}static suppressClickInternal(a){a.preventDefault(),a.stopPropagation(),window.removeEventListener("click",_.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",_.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",_.suppressClickInternal,!0)},0)}static mousePos(a,d){const p=a.getBoundingClientRect();return new l.Point(d.clientX-p.left-a.clientLeft,d.clientY-p.top-a.clientTop)}static touchPos(a,d){const p=a.getBoundingClientRect(),y=[];for(let b=0;b<d.length;b++)y.push(new l.Point(d[b].clientX-p.left-a.clientLeft,d[b].clientY-p.top-a.clientTop));return y}static mouseButton(a){return a.button}static remove(a){a.parentNode&&a.parentNode.removeChild(a)}}_.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,_.selectProp=_.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),_.transformProp=_.testProp(["transform","WebkitTransform"]);const E={supported:!1,testSupport:function(v){!L&&A&&(R?D(v):T=v)}};let T,A,L=!1,R=!1;function D(v){const a=v.createTexture();v.bindTexture(v.TEXTURE_2D,a);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,A),v.isContextLost())return;E.supported=!0}catch{}v.deleteTexture(a),L=!0}var W,z;typeof document<"u"&&(A=document.createElement("img"),A.onload=function(){T&&D(T),T=null,R=!0},A.onerror=function(){L=!0,T=null},A.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(v){let a,d,p,y;v.resetRequestQueue=()=>{a=[],d=0,p=0,y={}},v.addThrottleControl=O=>{const U=p++;return y[U]=O,U},v.removeThrottleControl=O=>{delete y[O],C()},v.getImage=(O,U,V=!0)=>{E.supported&&(O.headers||(O.headers={}),O.headers.accept="image/webp,*/*");const X={requestParameters:O,supportImageRefresh:V,callback:U,cancelled:!1,completed:!1,cancel:()=>{X.completed||X.cancelled||(X.cancelled=!0,X.innerRequest&&(X.innerRequest.cancel(),d--),C())}};return a.push(X),C(),X};const b=O=>{const{requestParameters:U,supportImageRefresh:V,callback:X}=O;return l.extend(U,{type:"image"}),(V!==!1||l.isWorker()||l.getProtocolAction(U.url)||U.headers&&!Object.keys(U.headers).reduce((he,ce)=>he&&ce==="accept",!0)?l.makeRequest:M)(U,(he,ce,pe,ae)=>{P(O,X,he,ce,pe,ae)})},P=(O,U,V,X,he,ce)=>{V?U(V):X instanceof HTMLImageElement||l.isImageBitmap(X)?U(null,X):X&&((pe,ae)=>{typeof createImageBitmap=="function"?l.arrayBufferToImageBitmap(pe,ae):l.arrayBufferToImage(pe,ae)})(X,(pe,ae)=>{pe!=null?U(pe):ae!=null&&U(null,ae,{cacheControl:he,expires:ce})}),O.cancelled||(O.completed=!0,d--,C())},C=()=>{const O=(()=>{const U=Object.keys(y);let V=!1;if(U.length>0){for(const X of U)if(V=y[X](),V)break}return V})()?l.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let U=d;U<O&&a.length>0;U++){const V=a.shift();if(V.cancelled){U--;continue}const X=b(V);d++,V.innerRequest=X}},M=(O,U)=>{const V=new Image,X=O.url;let he=!1;const ce=O.credentials;return ce&&ce==="include"?V.crossOrigin="use-credentials":(ce&&ce==="same-origin"||!l.sameOrigin(X))&&(V.crossOrigin="anonymous"),V.fetchPriority="high",V.onload=()=>{U(null,V),V.onerror=V.onload=null},V.onerror=()=>{he||U(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),V.onerror=V.onload=null},V.src=X,{cancel:()=>{he=!0,V.src=""}}}}(W||(W={})),W.resetRequestQueue(),function(v){v.Glyphs="Glyphs",v.Image="Image",v.Source="Source",v.SpriteImage="SpriteImage",v.SpriteJSON="SpriteJSON",v.Style="Style",v.Tile="Tile",v.Unknown="Unknown"}(z||(z={}));class N{constructor(a){this._transformRequestFn=a}transformRequest(a,d){return this._transformRequestFn&&this._transformRequestFn(a,d)||{url:a}}normalizeSpriteURL(a,d,p){const y=function(b){const P=b.match(F);if(!P)throw new Error(`Unable to parse URL "${b}"`);return{protocol:P[1],authority:P[2],path:P[3]||"/",params:P[4]?P[4].split("&"):[]}}(a);return y.path+=`${d}${p}`,function(b){const P=b.params.length?`?${b.params.join("&")}`:"";return`${b.protocol}://${b.authority}${b.path}${P}`}(y)}setTransformRequest(a){this._transformRequestFn=a}}const F=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function $(v){var a=new l.ARRAY_TYPE(3);return a[0]=v[0],a[1]=v[1],a[2]=v[2],a}var K,ne=function(v,a,d){return v[0]=a[0]-d[0],v[1]=a[1]-d[1],v[2]=a[2]-d[2],v};K=new l.ARRAY_TYPE(3),l.ARRAY_TYPE!=Float32Array&&(K[0]=0,K[1]=0,K[2]=0);var re=function(v){var a=v[0],d=v[1];return a*a+d*d};function be(v){const a=[];if(typeof v=="string")a.push({id:"default",url:v});else if(v&&v.length>0){const d=[];for(const{id:p,url:y}of v){const b=`${p}${y}`;d.indexOf(b)===-1&&(d.push(b),a.push({id:p,url:y}))}}return a}function xe(v,a,d,p,y){if(p)return void v(p);if(y!==Object.values(a).length||y!==Object.values(d).length)return;const b={};for(const P in a){b[P]={};const C=l.browser.getImageCanvasContext(d[P]),M=a[P];for(const O in M){const{width:U,height:V,x:X,y:he,sdf:ce,pixelRatio:pe,stretchX:ae,stretchY:Pe,content:Oe}=M[O];b[P][O]={data:null,pixelRatio:pe,sdf:ce,stretchX:ae,stretchY:Pe,content:Oe,spriteData:{width:U,height:V,x:X,y:he,context:C}}}}v(null,b)}(function(){var v=new l.ARRAY_TYPE(2);l.ARRAY_TYPE!=Float32Array&&(v[0]=0,v[1]=0)})();class fe{constructor(a,d,p,y){this.context=a,this.format=p,this.texture=a.gl.createTexture(),this.update(d,y)}update(a,d,p){const{width:y,height:b}=a,P=!(this.size&&this.size[0]===y&&this.size[1]===b||p),{context:C}=this,{gl:M}=C;if(this.useMipmap=!!(d&&d.useMipmap),M.bindTexture(M.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!d||d.premultiply!==!1)),P)this.size=[y,b],a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||l.isImageBitmap(a)?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,a):M.texImage2D(M.TEXTURE_2D,0,this.format,y,b,0,this.format,M.UNSIGNED_BYTE,a.data);else{const{x:O,y:U}=p||{x:0,y:0};a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||l.isImageBitmap(a)?M.texSubImage2D(M.TEXTURE_2D,0,O,U,M.RGBA,M.UNSIGNED_BYTE,a):M.texSubImage2D(M.TEXTURE_2D,0,O,U,y,b,M.RGBA,M.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&M.generateMipmap(M.TEXTURE_2D)}bind(a,d,p){const{context:y}=this,{gl:b}=y;b.bindTexture(b.TEXTURE_2D,this.texture),p!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=b.LINEAR),a!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,p||a),this.filter=a),d!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,d),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}function Re(v){const{userImage:a}=v;return!!(a&&a.render&&a.render())&&(v.data.replace(new Uint8Array(a.data.buffer)),!0)}class Ve extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(a){if(this.loaded!==a&&(this.loaded=a,a)){for(const{ids:d,callback:p}of this.requestors)this._notify(d,p);this.requestors=[]}}getImage(a){const d=this.images[a];if(d&&!d.data&&d.spriteData){const p=d.spriteData;d.data=new l.RGBAImage({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),d.spriteData=null}return d}addImage(a,d){if(this.images[a])throw new Error(`Image id ${a} already exist, use updateImage instead`);this._validate(a,d)&&(this.images[a]=d)}_validate(a,d){let p=!0;const y=d.data||d.spriteData;return this._validateStretch(d.stretchX,y&&y.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${a}" has invalid "stretchX" value`))),p=!1),this._validateStretch(d.stretchY,y&&y.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${a}" has invalid "stretchY" value`))),p=!1),this._validateContent(d.content,d)||(this.fire(new l.ErrorEvent(new Error(`Image "${a}" has invalid "content" value`))),p=!1),p}_validateStretch(a,d){if(!a)return!0;let p=0;for(const y of a){if(y[0]<p||y[1]<y[0]||d<y[1])return!1;p=y[1]}return!0}_validateContent(a,d){if(!a)return!0;if(a.length!==4)return!1;const p=d.spriteData,y=p&&p.width||d.data.width,b=p&&p.height||d.data.height;return!(a[0]<0||y<a[0]||a[1]<0||b<a[1]||a[2]<0||y<a[2]||a[3]<0||b<a[3]||a[2]<a[0]||a[3]<a[1])}updateImage(a,d,p=!0){const y=this.getImage(a);if(p&&(y.data.width!==d.data.width||y.data.height!==d.data.height))throw new Error(`size mismatch between old image (${y.data.width}x${y.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=y.version+1,this.images[a]=d,this.updatedImages[a]=!0}removeImage(a){const d=this.images[a];delete this.images[a],delete this.patterns[a],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(a,d){let p=!0;if(!this.isLoaded())for(const y of a)this.images[y]||(p=!1);this.isLoaded()||p?this._notify(a,d):this.requestors.push({ids:a,callback:d})}_notify(a,d){const p={};for(const y of a){let b=this.getImage(y);b||(this.fire(new l.Event("styleimagemissing",{id:y})),b=this.getImage(y)),b?p[y]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:!!(b.userImage&&b.userImage.render)}:l.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,p)}getPixelSize(){const{width:a,height:d}=this.atlasImage;return{width:a,height:d}}getPattern(a){const d=this.patterns[a],p=this.getImage(a);if(!p)return null;if(d&&d.position.version===p.version)return d.position;if(d)d.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},b=new l.ImagePosition(y,p);this.patterns[a]={bin:y,position:b}}return this._updatePatternAtlas(),this.patterns[a].position}bind(a){const d=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new fe(a,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const a=[];for(const b in this.patterns)a.push(this.patterns[b].bin);const{w:d,h:p}=l.potpack(a),y=this.atlasImage;y.resize({width:d||1,height:p||1});for(const b in this.patterns){const{bin:P}=this.patterns[b],C=P.x+1,M=P.y+1,O=this.getImage(b).data,U=O.width,V=O.height;l.RGBAImage.copy(O,y,{x:0,y:0},{x:C,y:M},{width:U,height:V}),l.RGBAImage.copy(O,y,{x:0,y:V-1},{x:C,y:M-1},{width:U,height:1}),l.RGBAImage.copy(O,y,{x:0,y:0},{x:C,y:M+V},{width:U,height:1}),l.RGBAImage.copy(O,y,{x:U-1,y:0},{x:C-1,y:M},{width:1,height:V}),l.RGBAImage.copy(O,y,{x:0,y:0},{x:C+U,y:M},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(a){for(const d of a){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const p=this.getImage(d);p||l.warnOnce(`Image with ID: "${d}" was not found`),Re(p)&&this.updateImage(d,p)}}}const Fe=1e20;function ze(v,a,d,p,y,b,P,C,M){for(let O=a;O<a+p;O++)Ye(v,d*b+O,b,y,P,C,M);for(let O=d;O<d+y;O++)Ye(v,O*b+a,1,p,P,C,M)}function Ye(v,a,d,p,y,b,P){b[0]=0,P[0]=-Fe,P[1]=Fe,y[0]=v[a];for(let C=1,M=0,O=0;C<p;C++){y[C]=v[a+C*d];const U=C*C;do{const V=b[M];O=(y[C]-y[V]+U-V*V)/(C-V)/2}while(O<=P[M]&&--M>-1);M++,b[M]=C,P[M]=O,P[M+1]=Fe}for(let C=0,M=0;C<p;C++){for(;P[M+1]<C;)M++;const O=b[M],U=C-O;v[a+C*d]=y[O]+U*U}}class je{constructor(a,d){this.requestManager=a,this.localIdeographFontFamily=d,this.entries={}}setURL(a){this.url=a}getGlyphs(a,d){const p=[];for(const y in a)for(const b of a[y])p.push({stack:y,id:b});l.asyncAll(p,({stack:y,id:b},P)=>{let C=this.entries[y];C||(C=this.entries[y]={glyphs:{},requests:{},ranges:{}});let M=C.glyphs[b];if(M!==void 0)return void P(null,{stack:y,id:b,glyph:M});if(M=this._tinySDF(C,y,b),M)return C.glyphs[b]=M,void P(null,{stack:y,id:b,glyph:M});const O=Math.floor(b/256);if(256*O>65535)return void P(new Error("glyphs > 65535 not supported"));if(C.ranges[O])return void P(null,{stack:y,id:b,glyph:M});if(!this.url)return void P(new Error("glyphsUrl is not set"));let U=C.requests[O];U||(U=C.requests[O]=[],je.loadGlyphRange(y,O,this.url,this.requestManager,(V,X)=>{if(X){for(const he in X)this._doesCharSupportLocalGlyph(+he)||(C.glyphs[+he]=X[+he]);C.ranges[O]=!0}for(const he of U)he(V,X);delete C.requests[O]})),U.push((V,X)=>{V?P(V):X&&P(null,{stack:y,id:b,glyph:X[b]||null})})},(y,b)=>{if(y)d(y);else if(b){const P={};for(const{stack:C,id:M,glyph:O}of b)(P[C]||(P[C]={}))[M]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics};d(null,P)}})}_doesCharSupportLocalGlyph(a){return!!this.localIdeographFontFamily&&(l.unicodeBlockLookup["CJK Unified Ideographs"](a)||l.unicodeBlockLookup["Hangul Syllables"](a)||l.unicodeBlockLookup.Hiragana(a)||l.unicodeBlockLookup.Katakana(a))}_tinySDF(a,d,p){const y=this.localIdeographFontFamily;if(!y||!this._doesCharSupportLocalGlyph(p))return;let b=a.tinySDF;if(!b){let C="400";/bold/i.test(d)?C="900":/medium/i.test(d)?C="500":/light/i.test(d)&&(C="200"),b=a.tinySDF=new je.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:y,fontWeight:C})}const P=b.draw(String.fromCharCode(p));return{id:p,bitmap:new l.AlphaImage({width:P.width||60,height:P.height||60},P.data),metrics:{width:P.glyphWidth/2||24,height:P.glyphHeight/2||24,left:P.glyphLeft/2+.5||0,top:P.glyphTop/2-27.5||-8,advance:P.glyphAdvance/2||24,isDoubleResolution:!0}}}}je.loadGlyphRange=function(v,a,d,p,y){const b=256*a,P=b+255,C=p.transformRequest(d.replace("{fontstack}",v).replace("{range}",`${b}-${P}`),z.Glyphs);l.getArrayBuffer(C,(M,O)=>{if(M)y(M);else if(O){const U={};for(const V of l.parseGlyphPbf(O))U[V.id]=V;y(null,U)}})},je.TinySDF=class{constructor({fontSize:v=24,buffer:a=3,radius:d=8,cutoff:p=.25,fontFamily:y="sans-serif",fontWeight:b="normal",fontStyle:P="normal"}={}){this.buffer=a,this.cutoff=p,this.radius=d;const C=this.size=v+4*a,M=this._createCanvas(C),O=this.ctx=M.getContext("2d",{willReadFrequently:!0});O.font=`${P} ${b} ${v}px ${y}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(v){const a=document.createElement("canvas");return a.width=a.height=v,a}draw(v){const{width:a,actualBoundingBoxAscent:d,actualBoundingBoxDescent:p,actualBoundingBoxLeft:y,actualBoundingBoxRight:b}=this.ctx.measureText(v),P=Math.ceil(d),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-y))),M=Math.min(this.size-this.buffer,P+Math.ceil(p)),O=C+2*this.buffer,U=M+2*this.buffer,V=Math.max(O*U,0),X=new Uint8ClampedArray(V),he={data:X,width:O,height:U,glyphWidth:C,glyphHeight:M,glyphTop:P,glyphLeft:0,glyphAdvance:a};if(C===0||M===0)return he;const{ctx:ce,buffer:pe,gridInner:ae,gridOuter:Pe}=this;ce.clearRect(pe,pe,C,M),ce.fillText(v,pe,pe+P);const Oe=ce.getImageData(pe,pe,C,M);Pe.fill(Fe,0,V),ae.fill(0,0,V);for(let ge=0;ge<M;ge++)for(let Ie=0;Ie<C;Ie++){const Ne=Oe.data[4*(ge*C+Ie)+3]/255;if(Ne===0)continue;const Ue=(ge+pe)*O+Ie+pe;if(Ne===1)Pe[Ue]=0,ae[Ue]=Fe;else{const Ze=.5-Ne;Pe[Ue]=Ze>0?Ze*Ze:0,ae[Ue]=Ze<0?Ze*Ze:0}}ze(Pe,0,0,O,U,O,this.f,this.v,this.z),ze(ae,pe,pe,C,M,O,this.f,this.v,this.z);for(let ge=0;ge<V;ge++){const Ie=Math.sqrt(Pe[ge])-Math.sqrt(ae[ge]);X[ge]=Math.round(255-255*(Ie/this.radius+this.cutoff))}return he}};class tt{constructor(){this.specification=l.v8Spec.light.position}possiblyEvaluate(a,d){return l.sphericalToCartesian(a.expression.evaluate(d))}interpolate(a,d,p){return{x:l.interpolate.number(a.x,d.x,p),y:l.interpolate.number(a.y,d.y,p),z:l.interpolate.number(a.z,d.z,p)}}}let ke;class Ge extends l.Evented{constructor(a){super(),ke=ke||new l.Properties({anchor:new l.DataConstantProperty(l.v8Spec.light.anchor),position:new tt,color:new l.DataConstantProperty(l.v8Spec.light.color),intensity:new l.DataConstantProperty(l.v8Spec.light.intensity)}),this._transitionable=new l.Transitionable(ke),this.setLight(a),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,d={}){if(!this._validate(l.validateLight,a,d))for(const p in a){const y=a[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,d,p){return(!p||p.validate!==!1)&&l.emitValidationErrors(this,a.call(l.validateStyle,l.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:l.v8Spec})))}}class nt{constructor(a,d){this.width=a,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(a,d){const p=a.join(",")+String(d);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(a,d)),this.dashEntry[p]}getDashRanges(a,d,p){const y=[];let b=a.length%2==1?-a[a.length-1]*p:0,P=a[0]*p,C=!0;y.push({left:b,right:P,isDash:C,zeroLength:a[0]===0});let M=a[0];for(let O=1;O<a.length;O++){C=!C;const U=a[O];b=M*p,M+=U,P=M*p,y.push({left:b,right:P,isDash:C,zeroLength:U===0})}return y}addRoundDash(a,d,p){const y=d/2;for(let b=-p;b<=p;b++){const P=this.width*(this.nextRow+p+b);let C=0,M=a[C];for(let O=0;O<this.width;O++){O/M.right>1&&(M=a[++C]);const U=Math.abs(O-M.left),V=Math.abs(O-M.right),X=Math.min(U,V);let he;const ce=b/p*(y+1);if(M.isDash){const pe=y-Math.abs(ce);he=Math.sqrt(X*X+pe*pe)}else he=y-Math.sqrt(X*X+ce*ce);this.data[P+O]=Math.max(0,Math.min(255,he+128))}}}addRegularDash(a){for(let C=a.length-1;C>=0;--C){const M=a[C],O=a[C+1];M.zeroLength?a.splice(C,1):O&&O.isDash===M.isDash&&(O.left=M.left,a.splice(C,1))}const d=a[0],p=a[a.length-1];d.isDash===p.isDash&&(d.left=p.left-this.width,p.right=d.right+this.width);const y=this.width*this.nextRow;let b=0,P=a[b];for(let C=0;C<this.width;C++){C/P.right>1&&(P=a[++b]);const M=Math.abs(C-P.left),O=Math.abs(C-P.right),U=Math.min(M,O);this.data[y+C]=Math.max(0,Math.min(255,(P.isDash?U:-U)+128))}}addDash(a,d){const p=d?7:0,y=2*p+1;if(this.nextRow+y>this.height)return l.warnOnce("LineAtlas out of space"),null;let b=0;for(let C=0;C<a.length;C++)b+=a[C];if(b!==0){const C=this.width/b,M=this.getDashRanges(a,this.width,C);d?this.addRoundDash(M,C,p):this.addRegularDash(M)}const P={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:b};return this.nextRow+=y,this.dirty=!0,P}bind(a){const d=a.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}class Dt{constructor(a,d,p){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=p;const y=this.workerPool.acquire(p);for(let b=0;b<y.length;b++){const P=new Dt.Actor(y[b],d,p);P.name=`Worker ${b}`,this.actors.push(P)}if(!this.actors.length)throw new Error("No actors found")}broadcast(a,d,p){l.asyncAll(this.actors,(y,b)=>{y.send(a,d,b)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(a=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],a&&this.workerPool.release(this.id)}}function ht(v,a,d){const p=function(y,b){if(y)return d(y);if(b){const P=l.pick(l.extend(b,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);b.vector_layers&&(P.vectorLayers=b.vector_layers,P.vectorLayerIds=P.vectorLayers.map(C=>C.id)),d(null,P)}};return v.url?l.getJSON(a.transformRequest(v.url,z.Source),p):l.browser.frame(()=>p(null,v))}Dt.Actor=l.Actor;class ot{constructor(a,d){a&&(d?this.setSouthWest(a).setNorthEast(d):Array.isArray(a)&&(a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1])))}setNorthEast(a){return this._ne=a instanceof l.LngLat?new l.LngLat(a.lng,a.lat):l.LngLat.convert(a),this}setSouthWest(a){return this._sw=a instanceof l.LngLat?new l.LngLat(a.lng,a.lat):l.LngLat.convert(a),this}extend(a){const d=this._sw,p=this._ne;let y,b;if(a instanceof l.LngLat)y=a,b=a;else{if(!(a instanceof ot))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(ot.convert(a)):this.extend(l.LngLat.convert(a)):a&&("lng"in a||"lon"in a)&&"lat"in a?this.extend(l.LngLat.convert(a)):this;if(y=a._sw,b=a._ne,!y||!b)return this}return d||p?(d.lng=Math.min(y.lng,d.lng),d.lat=Math.min(y.lat,d.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new l.LngLat(y.lng,y.lat),this._ne=new l.LngLat(b.lng,b.lat)),this}getCenter(){return new l.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new l.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:d,lat:p}=l.LngLat.convert(a);let y=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&y}static convert(a){return a instanceof ot?a:a&&new ot(a)}static fromLngLat(a,d=0){const p=360*d/40075017,y=p/Math.cos(Math.PI/180*a.lat);return new ot(new l.LngLat(a.lng-y,a.lat-p),new l.LngLat(a.lng+y,a.lat+p))}}class ct{constructor(a,d,p){this.bounds=ot.convert(this.validateBounds(a)),this.minzoom=d||0,this.maxzoom=p||24}validateBounds(a){return Array.isArray(a)&&a.length===4?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}contains(a){const d=Math.pow(2,a.z),p=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*d),y=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*d),b=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*d),P=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*d);return a.x>=p&&a.x<b&&a.y>=y&&a.y<P}}class xt extends l.Evented{constructor(a,d,p,y){if(super(),this.load=()=>{this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ht(this._options,this.map._requestManager,(b,P)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),b?this.fire(new l.ErrorEvent(b)):P&&(l.extend(this,P),P.bounds&&(this.tileBounds=new ct(P.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>l.extend({},this._options),this.id=a,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(d,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}loaded(){return this._loaded}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}onAdd(a){this.map=a,this.load()}setSourceProperty(a){this._tileJSONRequest&&this._tileJSONRequest.cancel(),a(),this.load()}setTiles(a){return this.setSourceProperty(()=>{this._options.tiles=a}),this}setUrl(a){return this.setSourceProperty(()=>{this.url=a,this._options.url=a}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(a,d){const p=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y={request:this.map._requestManager.transformRequest(p,z.Tile),uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function b(P,C){return delete a.request,a.aborted?d(null):P&&P.status!==404?d(P):(C&&C.resourceTiming&&(a.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&a.setExpiryData(C),a.loadVectorData(C,this.map.painter),d(null),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}y.request.collectResourceTiming=this._collectResourceTiming,a.actor&&a.state!=="expired"?a.state==="loading"?a.reloadCallback=d:a.request=a.actor.send("reloadTile",y,b.bind(this)):(a.actor=this.dispatcher.getActor(),a.request=a.actor.send("loadTile",y,b.bind(this)))}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id},void 0)}unloadTile(a){a.unloadVectorData(),a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class bt extends l.Evented{constructor(a,d,p,y){super(),this.id=a,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},d),l.extend(this,l.pick(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ht(this._options,this.map._requestManager,(a,d)=>{this._tileJSONRequest=null,this._loaded=!0,a?this.fire(new l.ErrorEvent(a)):d&&(l.extend(this,d),d.bounds&&(this.tileBounds=new ct(d.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(a){this._tileJSONRequest&&this._tileJSONRequest.cancel(),a(),this.load()}setTiles(a){return this.setSourceProperty(()=>{this._options.tiles=a}),this}serialize(){return l.extend({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,d){const p=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);a.request=W.getImage(this.map._requestManager.transformRequest(p,z.Tile),(y,b,P)=>{if(delete a.request,a.aborted)a.state="unloaded",d(null);else if(y)a.state="errored",d(y);else if(b){this.map._refreshExpiredTiles&&P&&a.setExpiryData(P);const C=this.map.painter.context,M=C.gl;a.texture=this.map.painter.getTileTexture(b.width),a.texture?a.texture.update(b,{useMipmap:!0}):(a.texture=new fe(C,b,M.RGBA,{useMipmap:!0}),a.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),C.extTextureFilterAnisotropic&&M.texParameterf(M.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax)),a.state="loaded",d(null)}},this.map._refreshExpiredTiles)}abortTile(a,d){a.request&&(a.request.cancel(),delete a.request),d()}unloadTile(a,d){a.texture&&this.map.painter.saveTileTexture(a.texture),d()}hasTransition(){return!1}}class Jt extends bt{constructor(a,d,p,y){super(a,d,p,y),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(a,d){const p=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y=this.map._requestManager.transformRequest(p,z.Tile);function b(P,C){P&&(a.state="errored",d(P)),C&&(a.dem=C,a.needsHillshadePrepare=!0,a.needsTerrainPrepare=!0,a.state="loaded",d(null))}a.neighboringTiles=this._getNeighboringTiles(a.tileID),a.request=W.getImage(y,async(P,C,M)=>{if(delete a.request,a.aborted)a.state="unloaded",d(null);else if(P)a.state="errored",d(P);else if(C){this.map._refreshExpiredTiles&&a.setExpiryData(M);const O=l.isImageBitmap(C)&&l.offscreenCanvasSupported()?C:await async function(V){if(typeof VideoFrame<"u"&&l.isOffscreenCanvasDistorted()){const X=V.width+2,he=V.height+2;try{return new l.RGBAImage({width:X,height:he},await l.readImageUsingVideoFrame(V,-1,-1,X,he))}catch{}}return l.browser.getImageData(V,1)}(C),U={uid:a.uid,coord:a.tileID,source:this.id,rawImageData:O,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};a.actor&&a.state!=="expired"||(a.actor=this.dispatcher.getActor(),a.actor.send("loadDEMTile",U,b))}},this.map._refreshExpiredTiles)}_getNeighboringTiles(a){const d=a.canonical,p=Math.pow(2,d.z),y=(d.x-1+p)%p,b=d.x===0?a.wrap-1:a.wrap,P=(d.x+1+p)%p,C=d.x+1===p?a.wrap+1:a.wrap,M={};return M[new l.OverscaledTileID(a.overscaledZ,b,d.z,y,d.y).key]={backfilled:!1},M[new l.OverscaledTileID(a.overscaledZ,C,d.z,P,d.y).key]={backfilled:!1},d.y>0&&(M[new l.OverscaledTileID(a.overscaledZ,b,d.z,y,d.y-1).key]={backfilled:!1},M[new l.OverscaledTileID(a.overscaledZ,a.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},M[new l.OverscaledTileID(a.overscaledZ,C,d.z,P,d.y-1).key]={backfilled:!1}),d.y+1<p&&(M[new l.OverscaledTileID(a.overscaledZ,b,d.z,y,d.y+1).key]={backfilled:!1},M[new l.OverscaledTileID(a.overscaledZ,a.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},M[new l.OverscaledTileID(a.overscaledZ,C,d.z,P,d.y+1).key]={backfilled:!1}),M}unloadTile(a){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.fbo&&(a.fbo.destroy(),delete a.fbo),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded",a.actor&&a.actor.send("removeDEMTile",{uid:a.uid,source:this.id})}}class Je extends l.Evented{constructor(a,d,p,y){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>l.extend({},this._options,{type:this.type,data:this._data}),this.id=a,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(y),this._data=d.data,this._options=l.extend({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const b=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*b,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*b,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:l.EXTENT,radius:(d.clusterRadius||50)*b,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(a){this.map=a,this.load()}setData(a){return this._data=a,this._updateWorkerData(),this}updateData(a){return this._updateWorkerData(a),this}setClusterOptions(a){return this.workerOptions.cluster=a.cluster,a&&(a.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=a.clusterRadius),a.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=a.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(a,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},d),this}getClusterChildren(a,d){return this.actor.send("geojson.getClusterChildren",{clusterId:a,source:this.id},d),this}getClusterLeaves(a,d,p,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:d,offset:p},y),this}_updateWorkerData(a){const d=l.extend({},this.workerOptions);a?d.dataDiff=a:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(l.browser.resolveURL(this._data),z.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,d,(p,y)=>{if(this._pendingLoads--,this._removed||y&&y.abandoned)return void this.fire(new l.Event("dataabort",{dataType:"source"}));let b=null;if(y&&y.resourceTiming&&y.resourceTiming[this.id]&&(b=y.resourceTiming[this.id].slice(0)),p)return void this.fire(new l.ErrorEvent(p));const P={dataType:"source"};this._collectResourceTiming&&b&&b.length>0&&l.extend(P,{resourceTiming:b}),this.fire(new l.Event("data",{...P,sourceDataType:"metadata"})),this.fire(new l.Event("data",{...P,sourceDataType:"content"}))})}loaded(){return this._pendingLoads===0}loadTile(a,d){const p=a.actor?"reloadTile":"loadTile";a.actor=this.actor;const y={type:this.type,uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};a.request=this.actor.send(p,y,(b,P)=>(delete a.request,a.unloadVectorData(),a.aborted?d(null):b?d(b):(a.loadVectorData(P,this.map.painter,p==="reloadTile"),d(null))))}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.aborted=!0}unloadTile(a){a.unloadVectorData(),this.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Et=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class sn extends l.Evented{constructor(a,d,p,y){super(),this.load=(b,P)=>{this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=W.getImage(this.map._requestManager.transformRequest(this.url,z.Image),(C,M)=>{this._request=null,this._loaded=!0,C?this.fire(new l.ErrorEvent(C)):M&&(this.image=M,b&&(this.coordinates=b),P&&P(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const b=this.map.painter.context,P=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new fe(b,this.image,P.RGBA),this.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE));let C=!1;for(const M in this.tiles){const O=this.tiles[M];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture,C=!0)}C&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=a,this.dispatcher=p,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=d}loaded(){return this._loaded}updateImage(a){return a.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=a.url,this.load(a.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(a){this.map=a,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(a){this.coordinates=a;const d=a.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(y){let b=1/0,P=1/0,C=-1/0,M=-1/0;for(const X of y)b=Math.min(b,X.x),P=Math.min(P,X.y),C=Math.max(C,X.x),M=Math.max(M,X.y);const O=Math.max(C-b,M-P),U=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),V=Math.pow(2,U);return new l.CanonicalTileID(U,Math.floor((b+C)/2*V),Math.floor((P+M)/2*V))}(d),this.minzoom=this.maxzoom=this.tileID.z;const p=d.map(y=>this.tileID.getTilePoint(y)._round());return this._boundsArray=new l.RasterBoundsArray,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(p[2].x,p[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(a,d){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},d(null)):(a.state="errored",d(null))}hasTransition(){return!1}}class Qt extends sn{constructor(a,d,p,y){super(a,d,p,y),this.load=()=>{this._loaded=!1;const b=this.options;this.urls=[];for(const P of b.urls)this.urls.push(this.map._requestManager.transformRequest(P,z.Source).url);l.getVideo(this.urls,(P,C)=>{this._loaded=!0,P?this.fire(new l.ErrorEvent(P)):C&&(this.video=C,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const b=this.map.painter.context,P=b.gl;this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE),P.texSubImage2D(P.TEXTURE_2D,0,0,0,P.RGBA,P.UNSIGNED_BYTE,this.video)):(this.texture=new fe(b,this.video,P.RGBA),this.texture.bind(P.LINEAR,P.CLAMP_TO_EDGE));let C=!1;for(const M in this.tiles){const O=this.tiles[M];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture,C=!0)}C&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=d}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(a){if(this.video){const d=this.video.seekable;a<d.start(0)||a>d.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=a}}getVideo(){return this.video}onAdd(a){this.map||(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class hn extends sn{constructor(a,d,p,y){super(a,d,p,y),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const P=this.map.painter.context,C=P.gl;this.boundsBuffer||(this.boundsBuffer=P.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new fe(P,this.canvas,C.RGBA,{premultiply:!0});let M=!1;for(const O in this.tiles){const U=this.tiles[O];U.state!=="loaded"&&(U.state="loaded",U.texture=this.texture,M=!0)}M&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(P=>typeof P!="number"))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${a}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${a}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${a}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${a}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${a}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}getCanvas(){return this.canvas}onAdd(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const a of[this.canvas.width,this.canvas.height])if(isNaN(a)||a<=0)return!0;return!1}}const $t={},Lt=v=>{switch(v){case"geojson":return Je;case"image":return sn;case"raster":return bt;case"raster-dem":return Jt;case"vector":return xt;case"video":return Qt;case"canvas":return hn}return $t[v]};function Ft(v,a){const d=l.create();return l.translate(d,d,[1,1,0]),l.scale(d,d,[.5*v.width,.5*v.height,1]),l.multiply(d,d,v.calculatePosMatrix(a.toUnwrapped()))}function wn(v,a,d,p,y,b){const P=function(V,X,he){if(V)for(const ce of V){const pe=X[ce];if(pe&&pe.source===he&&pe.type==="fill-extrusion")return!0}else for(const ce in X){const pe=X[ce];if(pe.source===he&&pe.type==="fill-extrusion")return!0}return!1}(y&&y.layers,a,v.id),C=b.maxPitchScaleFactor(),M=v.tilesIn(p,C,P);M.sort(vn);const O=[];for(const V of M)O.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(a,d,v._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,y,b,C,Ft(v.transform,V.tileID))});const U=function(V){const X={},he={};for(const ce of V){const pe=ce.queryResults,ae=ce.wrappedTileID,Pe=he[ae]=he[ae]||{};for(const Oe in pe){const ge=pe[Oe],Ie=Pe[Oe]=Pe[Oe]||{},Ne=X[Oe]=X[Oe]||[];for(const Ue of ge)Ie[Ue.featureIndex]||(Ie[Ue.featureIndex]=!0,Ne.push(Ue))}}return X}(O);for(const V in U)U[V].forEach(X=>{const he=X.feature,ce=v.getFeatureState(he.layer["source-layer"],he.id);he.source=he.layer.source,he.layer["source-layer"]&&(he.sourceLayer=he.layer["source-layer"]),he.state=ce});return U}function vn(v,a){const d=v.tileID,p=a.tileID;return d.overscaledZ-p.overscaledZ||d.canonical.y-p.canonical.y||d.wrap-p.wrap||d.canonical.x-p.canonical.x}class pt{constructor(a,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=a,this.uid=l.uniqueId(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(a){const d=a+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(a){this.demTexture&&a.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(a,d,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(y,b){const P={};if(!b)return P;for(const C of y){const M=C.layerIds.map(O=>b.getLayer(O)).filter(Boolean);if(M.length!==0){C.layers=M,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(O=>M.filter(U=>U.id===O)[0]));for(const O of M)P[O.id]=C}}return P}(a.buckets,d.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const b=this.buckets[y];if(b instanceof l.SymbolBucket){if(this.hasSymbolBuckets=!0,!p)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const b=this.buckets[y];if(b instanceof l.SymbolBucket&&b.hasRTLText){this.hasRTLText=!0,l.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const y in this.buckets){const b=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(y).queryRadius(b))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new l.CollisionBoxArray}unloadVectorData(){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(a){return this.buckets[a.id]}upload(a){for(const p in this.buckets){const y=this.buckets[p];y.uploadPending()&&y.upload(a)}const d=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new fe(a,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new fe(a,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,d,p,y,b,P,C,M,O,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:b,scale:P,tileSize:this.tileSize,pixelPosMatrix:U,transform:M,params:C,queryPadding:this.queryPadding*O},a,d,p):{}}querySourceFeatures(a,d){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const y=p.loadVTLayers(),b=d&&d.sourceLayer?d.sourceLayer:"",P=y._geojsonTileLayer||y[b];if(!P)return;const C=l.createFilter(d&&d.filter),{z:M,x:O,y:U}=this.tileID.canonical,V={z:M,x:O,y:U};for(let X=0;X<P.length;X++){const he=P.feature(X);if(C.needGeometry){const ae=l.toEvaluationFeature(he,!0);if(!C.filter(new l.EvaluationParameters(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!C.filter(new l.EvaluationParameters(this.tileID.overscaledZ),he))continue;const ce=p.getId(he,b),pe=new l.GeoJSONFeature(he,M,O,U,ce);pe.tile=V,a.push(pe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const d=this.expirationTime;if(a.cacheControl){const p=l.parseCacheControl(a.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const p=Date.now();let y=!1;if(this.expirationTime>p)y=!1;else if(d)if(this.expirationTime<d)y=!0;else{const b=this.expirationTime-d;b?this.expirationTime=p+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(a,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(a).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!d.style.hasLayer(y))continue;const b=this.buckets[y],P=b.layers[0].sourceLayer||"_geojsonTileLayer",C=p[P],M=a[P];if(!C||!M||Object.keys(M).length===0)continue;b.update(M,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const O=d&&d.style&&d.style.getLayer(y);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.browser.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=l.browser.now()+a}setDependencies(a,d){const p={};for(const y of d)p[y]=!0;this.dependencies[a]=p}hasDependency(a,d){for(const p of a){const y=this.dependencies[p];if(y){for(const b of d)if(y[b])return!0}}return!1}}class dn{constructor(a,d){this.max=a,this.onRemove=d,this.reset()}reset(){for(const a in this.data)for(const d of this.data[a])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(a,d,p){const y=a.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const b={value:d,timeout:void 0};if(p!==void 0&&(b.timeout=setTimeout(()=>{this.remove(a,b)},p)),this.data[y].push(b),this.order.push(y),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const d=this.data[a].shift();return d.timeout&&clearTimeout(d.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),d.value}getByKey(a){const d=this.data[a];return d?d[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,d){if(!this.has(a))return this;const p=a.wrapped().key,y=d===void 0?0:this.data[p].indexOf(d),b=this.data[p][y];return this.data[p].splice(y,1),b.timeout&&clearTimeout(b.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(b.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(a){const d=[];for(const p in this.data)for(const y of this.data[p])a(y.value)||d.push(y);for(const p of d)this.remove(p.value.tileID,p)}}class Ae{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,d,p){const y=String(d);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][y]=this.stateChanges[a][y]||{},l.extend(this.stateChanges[a][y],p),this.deletedStates[a]===null){this.deletedStates[a]={};for(const b in this.state[a])b!==y&&(this.deletedStates[a][b]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][y]===null){this.deletedStates[a][y]={};for(const b in this.state[a][y])p[b]||(this.deletedStates[a][y][b]=null)}else for(const b in p)this.deletedStates[a]&&this.deletedStates[a][y]&&this.deletedStates[a][y][b]===null&&delete this.deletedStates[a][y][b]}removeFeatureState(a,d,p){if(this.deletedStates[a]===null)return;const y=String(d);if(this.deletedStates[a]=this.deletedStates[a]||{},p&&d!==void 0)this.deletedStates[a][y]!==null&&(this.deletedStates[a][y]=this.deletedStates[a][y]||{},this.deletedStates[a][y][p]=null);else if(d!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][y])for(p in this.deletedStates[a][y]={},this.stateChanges[a][y])this.deletedStates[a][y][p]=null;else this.deletedStates[a][y]=null;else this.deletedStates[a]=null}getState(a,d){const p=String(d),y=l.extend({},(this.state[a]||{})[p],(this.stateChanges[a]||{})[p]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){const b=this.deletedStates[a][d];if(b===null)return{};for(const P in b)delete y[P]}return y}initializeTileState(a,d){a.setFeatureState(this.state,d)}coalesceChanges(a,d){const p={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const b={};for(const P in this.stateChanges[y])this.state[y][P]||(this.state[y][P]={}),l.extend(this.state[y][P],this.stateChanges[y][P]),b[P]=this.state[y][P];p[y]=b}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const b={};if(this.deletedStates[y]===null)for(const P in this.state[y])b[P]={},this.state[y][P]={};else for(const P in this.deletedStates[y]){if(this.deletedStates[y][P]===null)this.state[y][P]={};else for(const C of Object.keys(this.deletedStates[y][P]))delete this.state[y][P][C];b[P]=this.state[y][P]}p[y]=p[y]||{},l.extend(p[y],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const y in a)a[y].setFeatureState(p,d)}}class Ct extends l.Evented{constructor(a,d,p){super(),this.id=a,this.dispatcher=p,this.on("data",y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((y,b,P,C)=>{const M=new(Lt(b.type))(y,b,P,C);if(M.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${M.id}`);return M})(a,d,p,this),this._tiles={},this._cache=new dn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ae,this._didEmitContent=!1,this._updated=!1}onAdd(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._maxTileCacheZoomLevels=a?a._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(a)}onRemove(a){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(a)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const a in this._tiles){const d=this._tiles[a];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(a,d){return this._source.loadTile(a,d)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){this._source.abortTile&&this._source.abortTile(a,()=>{}),this._source.fire(new l.Event("dataabort",{tile:a,coord:a.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const p=this._tiles[d];p.upload(a),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(a=>a.tileID).sort(En).map(a=>a.key)}getRenderableIds(a){const d=[];for(const p in this._tiles)this._isIdRenderable(p,a)&&d.push(this._tiles[p]);return a?d.sort((p,y)=>{const b=p.tileID,P=y.tileID,C=new l.Point(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),M=new l.Point(P.canonical.x,P.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-P.overscaledZ||M.y-C.y||M.x-C.x}).map(p=>p.tileID.key):d.map(p=>p.tileID).sort(En).map(p=>p.key)}hasRenderableParent(a){const d=this.findLoadedParent(a,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(a,d){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(d||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(a,"reloading")}}_reloadTile(a,d){const p=this._tiles[a];p&&(p.state!=="loading"&&(p.state=d),this._loadTile(p,this._tileLoaded.bind(this,p,a,d)))}_tileLoaded(a,d,p,y){if(y)return a.state="errored",void(y.status!==404?this._source.fire(new l.ErrorEvent(y,{tile:a})):this.update(this.transform,this.terrain));a.timeAdded=l.browser.now(),p==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(d,a),this.getSource().type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),a.aborted||this._source.fire(new l.Event("data",{dataType:"source",tile:a,coord:a.tileID}))}_backfillDEM(a){const d=this.getRenderableIds();for(let y=0;y<d.length;y++){const b=d[y];if(a.neighboringTiles&&a.neighboringTiles[b]){const P=this.getTileByID(b);p(a,P),p(P,a)}}function p(y,b){y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let P=b.tileID.canonical.x-y.tileID.canonical.x;const C=b.tileID.canonical.y-y.tileID.canonical.y,M=Math.pow(2,y.tileID.canonical.z),O=b.tileID.key;P===0&&C===0||Math.abs(C)>1||(Math.abs(P)>1&&(Math.abs(P+M)===1?P+=M:Math.abs(P-M)===1&&(P-=M)),b.dem&&y.dem&&(y.dem.backfillBorder(b.dem,P,C),y.neighboringTiles&&y.neighboringTiles[O]&&(y.neighboringTiles[O].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,d,p,y){for(const b in this._tiles){let P=this._tiles[b];if(y[b]||!P.hasData()||P.tileID.overscaledZ<=d||P.tileID.overscaledZ>p)continue;let C=P.tileID;for(;P&&P.tileID.overscaledZ>d+1;){const O=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[O.key],P&&P.hasData()&&(C=O)}let M=C;for(;M.overscaledZ>d;)if(M=M.scaledTo(M.overscaledZ-1),a[M.key]){y[C.key]=C;break}}}findLoadedParent(a,d){if(a.key in this._loadedParentTiles){const p=this._loadedParentTiles[a.key];return p&&p.tileID.overscaledZ>=d?p:null}for(let p=a.overscaledZ-1;p>=d;p--){const y=a.scaledTo(p),b=this._getLoadedTile(y);if(b)return b}}_getLoadedTile(a){const d=this._tiles[a.key];return d&&d.hasData()?d:this._cache.getByKey(a.wrapped().key)}updateCacheSize(a){const d=Math.ceil(a.width/this._source.tileSize)+1,p=Math.ceil(a.height/this._source.tileSize)+1,y=Math.floor(d*p*(this._maxTileCacheZoomLevels===null?l.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(b)}handleWrapJump(a){const d=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,d){const p={};for(const y in this._tiles){const b=this._tiles[y];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+d),p[b.tileID.key]=b}this._tiles=p;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(y,this._tiles[y])}}update(a,d){if(this.transform=a,this.terrain=d,!this._sourceLoaded||this._paused)return;let p;this.updateCacheSize(a),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(U=>new l.OverscaledTileID(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y)):(p=a.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(p=p.filter(U=>this._source.hasTile(U)))):p=[];const y=a.coveringZoomLevel(this._source),b=Math.max(y-Ct.maxOverzooming,this._source.minzoom),P=Math.max(y+Ct.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const U={};for(const V of p)if(V.canonical.z>this._source.minzoom){const X=V.scaledTo(V.canonical.z-1);U[X.key]=X;const he=V.scaledTo(Math.max(this._source.minzoom,Math.min(V.canonical.z,5)));U[he.key]=he}p=p.concat(Object.values(U))}const C=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,C&&this.fire(new l.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=this._updateRetainedTiles(p,y);if(en(this._source.type)){const U={},V={},X=Object.keys(M),he=l.browser.now();for(const ce of X){const pe=M[ce],ae=this._tiles[ce];if(!ae||ae.fadeEndTime!==0&&ae.fadeEndTime<=he)continue;const Pe=this.findLoadedParent(pe,b);Pe&&(this._addTile(Pe.tileID),U[Pe.tileID.key]=Pe.tileID),V[ce]=pe}this._retainLoadedChildren(V,y,P,M);for(const ce in U)M[ce]||(this._coveredTiles[ce]=!0,M[ce]=U[ce]);if(d){const ce={},pe={};for(const ae of p)this._tiles[ae.key].hasData()?ce[ae.key]=ae:pe[ae.key]=ae;for(const ae in pe){const Pe=pe[ae].children(this._source.maxzoom);this._tiles[Pe[0].key]&&this._tiles[Pe[1].key]&&this._tiles[Pe[2].key]&&this._tiles[Pe[3].key]&&(ce[Pe[0].key]=M[Pe[0].key]=Pe[0],ce[Pe[1].key]=M[Pe[1].key]=Pe[1],ce[Pe[2].key]=M[Pe[2].key]=Pe[2],ce[Pe[3].key]=M[Pe[3].key]=Pe[3],delete pe[ae])}for(const ae in pe){const Pe=this.findLoadedParent(pe[ae],this._source.minzoom);if(Pe){ce[Pe.tileID.key]=M[Pe.tileID.key]=Pe.tileID;for(const Oe in ce)ce[Oe].isChildOf(Pe.tileID)&&delete ce[Oe]}}for(const ae in this._tiles)ce[ae]||(this._coveredTiles[ae]=!0)}}for(const U in M)this._tiles[U].clearFadeHold();const O=l.keysDifference(this._tiles,M);for(const U of O){const V=this._tiles[U];V.hasSymbolBuckets&&!V.holdingForFade()?V.setHoldDuration(this.map._fadeDuration):V.hasSymbolBuckets&&!V.symbolFadeFinished()||this._removeTile(U)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)}_updateRetainedTiles(a,d){const p={},y={},b=Math.max(d-Ct.maxOverzooming,this._source.minzoom),P=Math.max(d+Ct.maxUnderzooming,this._source.minzoom),C={};for(const M of a){const O=this._addTile(M);p[M.key]=M,O.hasData()||d<this._source.maxzoom&&(C[M.key]=M)}this._retainLoadedChildren(C,d,P,p);for(const M of a){let O=this._tiles[M.key];if(O.hasData())continue;if(d+1>this._source.maxzoom){const V=M.children(this._source.maxzoom)[0],X=this.getTile(V);if(X&&X.hasData()){p[V.key]=V;continue}}else{const V=M.children(this._source.maxzoom);if(p[V[0].key]&&p[V[1].key]&&p[V[2].key]&&p[V[3].key])continue}let U=O.wasRequested();for(let V=M.overscaledZ-1;V>=b;--V){const X=M.scaledTo(V);if(y[X.key])break;if(y[X.key]=!0,O=this.getTile(X),!O&&U&&(O=this._addTile(X)),O){const he=O.hasData();if((U||he)&&(p[X.key]=X),U=O.wasRequested(),he)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const d=[];let p,y=this._tiles[a].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){p=this._loadedParentTiles[y.key];break}d.push(y.key);const b=y.scaledTo(y.overscaledZ-1);if(p=this._getLoadedTile(b),p)break;y=b}for(const b of d)this._loadedParentTiles[b]=p}}_addTile(a){let d=this._tiles[a.key];if(d)return d;d=this._cache.getAndRemove(a),d&&(this._setTileReloadTimer(a.key,d),d.tileID=a,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,d)));const p=d;return d||(d=new pt(a,this._source.tileSize*a.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,a.key,d.state))),d.uses++,this._tiles[a.key]=d,p||this._source.fire(new l.Event("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(a,d){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const p=d.getExpiryTimeout();p&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},p))}_removeTile(a){const d=this._tiles[a];d&&(d.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(a);this._cache.reset()}tilesIn(a,d,p){const y=[],b=this.transform;if(!b)return y;const P=p?b.getCameraQueryGeometry(a):a,C=a.map(ce=>b.pointCoordinate(ce,this.terrain)),M=P.map(ce=>b.pointCoordinate(ce,this.terrain)),O=this.getIds();let U=1/0,V=1/0,X=-1/0,he=-1/0;for(const ce of M)U=Math.min(U,ce.x),V=Math.min(V,ce.y),X=Math.max(X,ce.x),he=Math.max(he,ce.y);for(let ce=0;ce<O.length;ce++){const pe=this._tiles[O[ce]];if(pe.holdingForFade())continue;const ae=pe.tileID,Pe=Math.pow(2,b.zoom-pe.tileID.overscaledZ),Oe=d*pe.queryPadding*l.EXTENT/pe.tileSize/Pe,ge=[ae.getTilePoint(new l.MercatorCoordinate(U,V)),ae.getTilePoint(new l.MercatorCoordinate(X,he))];if(ge[0].x-Oe<l.EXTENT&&ge[0].y-Oe<l.EXTENT&&ge[1].x+Oe>=0&&ge[1].y+Oe>=0){const Ie=C.map(Ue=>ae.getTilePoint(Ue)),Ne=M.map(Ue=>ae.getTilePoint(Ue));y.push({tile:pe,tileID:ae,queryGeometry:Ie,cameraQueryGeometry:Ne,scale:Pe})}}return y}getVisibleCoordinates(a){const d=this.getRenderableIds(a).map(p=>this._tiles[p].tileID);for(const p of d)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(en(this._source.type)){const a=l.browser.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=a)return!0}return!1}setFeatureState(a,d,p){this._state.updateState(a=a||"_geojsonTileLayer",d,p)}removeFeatureState(a,d,p){this._state.removeFeatureState(a=a||"_geojsonTileLayer",d,p)}getFeatureState(a,d){return this._state.getState(a=a||"_geojsonTileLayer",d)}setDependencies(a,d,p){const y=this._tiles[a];y&&y.setDependencies(d,p)}reloadTilesForDependencies(a,d){for(const p in this._tiles)this._tiles[p].hasDependency(a,d)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(a,d))}}function En(v,a){const d=Math.abs(2*v.wrap)-+(v.wrap<0),p=Math.abs(2*a.wrap)-+(a.wrap<0);return v.overscaledZ-a.overscaledZ||p-d||a.canonical.y-v.canonical.y||a.canonical.x-v.canonical.x}function en(v){return v==="raster"||v==="image"||v==="video"}Ct.maxOverzooming=10,Ct.maxUnderzooming=3;const It="mapboxgl_preloaded_worker_pool";class Qe{constructor(){this.active={}}acquire(a){if(!this.workers)for(this.workers=[];this.workers.length<Qe.workerCount;)this.workers.push(new Worker(l.config.WORKER_URL));return this.active[a]=!0,this.workers.slice()}release(a){delete this.active[a],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[It]}numActive(){return Object.keys(this.active).length}}const gt=Math.floor(l.browser.hardwareConcurrency/2);let Mt;function Rt(){return Mt||(Mt=new Qe),Mt}Qe.workerCount=l.isSafari(globalThis)?Math.max(Math.min(gt,3),1):1;class Pt{constructor(a,d){this.reset(a,d)}reset(a,d){this.points=a||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(this.points.length===1)return this.points[0];a=l.clamp(a,0,1);let d=1,p=this._distances[d];const y=a*this.paddedLength+this.padding;for(;p<y&&d<this._distances.length;)p=this._distances[++d];const b=d-1,P=this._distances[b],C=p-P,M=C>0?(y-P)/C:0;return this.points[b].mult(1-M).add(this.points[d].mult(M))}}function gn(v,a){let d=!0;return v==="always"||v!=="never"&&a!=="never"||(d=!1),d}class mn{constructor(a,d,p){const y=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(a/p),this.yCellCount=Math.ceil(d/p);for(let P=0;P<this.xCellCount*this.yCellCount;P++)y.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=d,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,d,p,y,b){this._forEachCell(d,p,y,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(d),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(b)}insertCircle(a,d,p,y){this._forEachCell(d-y,p-y,d+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(d),this.circles.push(p),this.circles.push(y)}_insertBoxCell(a,d,p,y,b,P){this.boxCells[b].push(P)}_insertCircleCell(a,d,p,y,b,P){this.circleCells[b].push(P)}_query(a,d,p,y,b,P,C){if(p<0||a>this.width||y<0||d>this.height)return[];const M=[];if(a<=0&&d<=0&&this.width<=p&&this.height<=y){if(b)return[{key:null,x1:a,y1:d,x2:p,y2:y}];for(let O=0;O<this.boxKeys.length;O++)M.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const U=this.circles[3*O],V=this.circles[3*O+1],X=this.circles[3*O+2];M.push({key:this.circleKeys[O],x1:U-X,y1:V-X,x2:U+X,y2:V+X})}}else this._forEachCell(a,d,p,y,this._queryCell,M,{hitTest:b,overlapMode:P,seenUids:{box:{},circle:{}}},C);return M}query(a,d,p,y){return this._query(a,d,p,y,!1,null)}hitTest(a,d,p,y,b,P){return this._query(a,d,p,y,!0,b,P).length>0}hitTestCircle(a,d,p,y,b){const P=a-p,C=a+p,M=d-p,O=d+p;if(C<0||P>this.width||O<0||M>this.height)return!1;const U=[];return this._forEachCell(P,M,C,O,this._queryCellCircle,U,{hitTest:!0,overlapMode:y,circle:{x:a,y:d,radius:p},seenUids:{box:{},circle:{}}},b),U.length>0}_queryCell(a,d,p,y,b,P,C,M){const{seenUids:O,hitTest:U,overlapMode:V}=C,X=this.boxCells[b];if(X!==null){const ce=this.bboxes;for(const pe of X)if(!O.box[pe]){O.box[pe]=!0;const ae=4*pe,Pe=this.boxKeys[pe];if(a<=ce[ae+2]&&d<=ce[ae+3]&&p>=ce[ae+0]&&y>=ce[ae+1]&&(!M||M(Pe))&&(!U||!gn(V,Pe.overlapMode))&&(P.push({key:Pe,x1:ce[ae],y1:ce[ae+1],x2:ce[ae+2],y2:ce[ae+3]}),U))return!0}}const he=this.circleCells[b];if(he!==null){const ce=this.circles;for(const pe of he)if(!O.circle[pe]){O.circle[pe]=!0;const ae=3*pe,Pe=this.circleKeys[pe];if(this._circleAndRectCollide(ce[ae],ce[ae+1],ce[ae+2],a,d,p,y)&&(!M||M(Pe))&&(!U||!gn(V,Pe.overlapMode))){const Oe=ce[ae],ge=ce[ae+1],Ie=ce[ae+2];if(P.push({key:Pe,x1:Oe-Ie,y1:ge-Ie,x2:Oe+Ie,y2:ge+Ie}),U)return!0}}}return!1}_queryCellCircle(a,d,p,y,b,P,C,M){const{circle:O,seenUids:U,overlapMode:V}=C,X=this.boxCells[b];if(X!==null){const ce=this.bboxes;for(const pe of X)if(!U.box[pe]){U.box[pe]=!0;const ae=4*pe,Pe=this.boxKeys[pe];if(this._circleAndRectCollide(O.x,O.y,O.radius,ce[ae+0],ce[ae+1],ce[ae+2],ce[ae+3])&&(!M||M(Pe))&&!gn(V,Pe.overlapMode))return P.push(!0),!0}}const he=this.circleCells[b];if(he!==null){const ce=this.circles;for(const pe of he)if(!U.circle[pe]){U.circle[pe]=!0;const ae=3*pe,Pe=this.circleKeys[pe];if(this._circlesCollide(ce[ae],ce[ae+1],ce[ae+2],O.x,O.y,O.radius)&&(!M||M(Pe))&&!gn(V,Pe.overlapMode))return P.push(!0),!0}}}_forEachCell(a,d,p,y,b,P,C,M){const O=this._convertToXCellCoord(a),U=this._convertToYCellCoord(d),V=this._convertToXCellCoord(p),X=this._convertToYCellCoord(y);for(let he=O;he<=V;he++)for(let ce=U;ce<=X;ce++)if(b.call(this,a,d,p,y,this.xCellCount*ce+he,P,C,M))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,d,p,y,b,P){const C=y-a,M=b-d,O=p+P;return O*O>C*C+M*M}_circleAndRectCollide(a,d,p,y,b,P,C){const M=(P-y)/2,O=Math.abs(a-(y+M));if(O>M+p)return!1;const U=(C-b)/2,V=Math.abs(d-(b+U));if(V>U+p)return!1;if(O<=M||V<=U)return!0;const X=O-M,he=V-U;return X*X+he*he<=p*p}}function He(v,a,d,p,y){const b=l.create();return a?(l.scale(b,b,[1/y,1/y,1]),d||l.rotateZ(b,b,p.angle)):l.multiply(b,p.labelPlaneMatrix,v),b}function mt(v,a,d,p,y){if(a){const b=l.clone(v);return l.scale(b,b,[y,y,1]),d||l.rotateZ(b,b,-p.angle),b}return p.glCoordMatrix}function Zt(v,a,d){let p;d?(p=[v.x,v.y,d(v.x,v.y),1],l.transformMat4(p,p,a)):(p=[v.x,v.y,0,1],se(p,p,a));const y=p[3];return{point:new l.Point(p[0]/y,p[1]/y),signedDistanceFromCamera:y}}function Ln(v,a){return .5+v/a*.5}function Fn(v,a){const d=v[0]/v[3],p=v[1]/v[3];return d>=-a[0]&&d<=a[0]&&p>=-a[1]&&p<=a[1]}function it(v,a,d,p,y,b,P,C,M,O){const U=p?v.textSizeData:v.iconSizeData,V=l.evaluateSizeForZoom(U,d.transform.zoom),X=[256/d.width*2+1,256/d.height*2+1],he=p?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;he.clear();const ce=v.lineVertexArray,pe=p?v.text.placedSymbolArray:v.icon.placedSymbolArray,ae=d.transform.width/d.transform.height;let Pe=!1;for(let Oe=0;Oe<pe.length;Oe++){const ge=pe.get(Oe);if(ge.hidden||ge.writingMode===l.WritingMode.vertical&&!Pe){Z(ge.numGlyphs,he);continue}let Ie;if(Pe=!1,O?(Ie=[ge.anchorX,ge.anchorY,O(ge.anchorX,ge.anchorY),1],l.transformMat4(Ie,Ie,a)):(Ie=[ge.anchorX,ge.anchorY,0,1],se(Ie,Ie,a)),!Fn(Ie,X)){Z(ge.numGlyphs,he);continue}const Ne=Ln(d.transform.cameraToCenterDistance,Ie[3]),Ue=l.evaluateSizeForFeature(U,V,ge),Ze=P?Ue/Ne:Ue*Ne,et=new l.Point(ge.anchorX,ge.anchorY),Ke=Zt(et,y,O).point,at={projections:{},offsets:{}},Vt=Cr(ge,Ze,!1,C,a,y,b,v.glyphOffsetArray,ce,he,Ke,et,at,ae,M,O);Pe=Vt.useVertical,(Vt.notEnoughRoom||Pe||Vt.needsFlipping&&Cr(ge,Ze,!0,C,a,y,b,v.glyphOffsetArray,ce,he,Ke,et,at,ae,M,O).notEnoughRoom)&&Z(ge.numGlyphs,he)}p?v.text.dynamicLayoutVertexBuffer.updateData(he):v.icon.dynamicLayoutVertexBuffer.updateData(he)}function fn(v,a,d,p,y,b,P,C,M,O,U,V,X){const he=C.glyphStartIndex+C.numGlyphs,ce=C.lineStartIndex,pe=C.lineStartIndex+C.lineLength,ae=a.getoffsetX(C.glyphStartIndex),Pe=a.getoffsetX(he-1),Oe=de(v*ae,d,p,y,b,P,C.segment,ce,pe,M,O,U,V,X);if(!Oe)return null;const ge=de(v*Pe,d,p,y,b,P,C.segment,ce,pe,M,O,U,V,X);return ge?{first:Oe,last:ge}:null}function ln(v,a,d,p){return v===l.WritingMode.horizontal&&Math.abs(d.y-a.y)>Math.abs(d.x-a.x)*p?{useVertical:!0}:(v===l.WritingMode.vertical?a.y<d.y:a.x>d.x)?{needsFlipping:!0}:null}function Cr(v,a,d,p,y,b,P,C,M,O,U,V,X,he,ce,pe){const ae=a/24,Pe=v.lineOffsetX*ae,Oe=v.lineOffsetY*ae;let ge;if(v.numGlyphs>1){const Ie=v.glyphStartIndex+v.numGlyphs,Ne=v.lineStartIndex,Ue=v.lineStartIndex+v.lineLength,Ze=fn(ae,C,Pe,Oe,d,U,V,v,M,b,X,ce,pe);if(!Ze)return{notEnoughRoom:!0};const et=Zt(Ze.first.point,P,pe).point,Ke=Zt(Ze.last.point,P,pe).point;if(p&&!d){const at=ln(v.writingMode,et,Ke,he);if(at)return at}ge=[Ze.first];for(let at=v.glyphStartIndex+1;at<Ie-1;at++)ge.push(de(ae*C.getoffsetX(at),Pe,Oe,d,U,V,v.segment,Ne,Ue,M,b,X,ce,pe));ge.push(Ze.last)}else{if(p&&!d){const Ne=Zt(V,y,pe).point,Ue=v.lineStartIndex+v.segment+1,Ze=new l.Point(M.getx(Ue),M.gety(Ue)),et=Zt(Ze,y,pe),Ke=et.signedDistanceFromCamera>0?et.point:li(V,Ze,Ne,1,y,pe),at=ln(v.writingMode,Ne,Ke,he);if(at)return at}const Ie=de(ae*C.getoffsetX(v.glyphStartIndex),Pe,Oe,d,U,V,v.segment,v.lineStartIndex,v.lineStartIndex+v.lineLength,M,b,X,ce,pe);if(!Ie)return{notEnoughRoom:!0};ge=[Ie]}for(const Ie of ge)l.addDynamicAttributes(O,Ie.point,Ie.angle);return{}}function li(v,a,d,p,y,b){const P=Zt(v.add(v.sub(a)._unit()),y,b).point,C=d.sub(P);return d.add(C._mult(p/C.mag()))}function cn(v,a){const{projectionCache:d,lineVertexArray:p,labelPlaneMatrix:y,tileAnchorPoint:b,distanceFromAnchor:P,getElevation:C,previousVertex:M,direction:O,absOffsetX:U}=a;if(d.projections[v])return d.projections[v];const V=new l.Point(p.getx(v),p.gety(v)),X=Zt(V,y,C);if(X.signedDistanceFromCamera>0)return d.projections[v]=X.point,X.point;const he=v-O;return li(P===0?b:new l.Point(p.getx(he),p.gety(he)),V,M,U-P+1,y,C)}function Kr(v,a,d){return v._unit()._perp()._mult(a*d)}function xi(v,a,d,p,y,b,P,C){const{projectionCache:M,direction:O}=C;if(M.offsets[v])return M.offsets[v];const U=d.add(a);if(v+O<p||v+O>=y)return M.offsets[v]=U,U;const V=cn(v+O,C),X=Kr(V.sub(d),P,O),he=d.add(X),ce=V.add(X);return M.offsets[v]=l.findLineIntersection(b,U,he,ce)||U,M.offsets[v]}function de(v,a,d,p,y,b,P,C,M,O,U,V,X,he){const ce=p?v-a:v+a;let pe=ce>0?1:-1,ae=0;p&&(pe*=-1,ae=Math.PI),pe<0&&(ae+=Math.PI);let Pe,Oe,ge=pe>0?C+P:C+P+1,Ie=y,Ne=y,Ue=0,Ze=0;const et=Math.abs(ce),Ke=[];let at;for(;Ue+Ze<=et;){if(ge+=pe,ge<C||ge>=M)return null;Ue+=Ze,Ne=Ie,Oe=Pe;const yt={projectionCache:V,lineVertexArray:O,labelPlaneMatrix:U,tileAnchorPoint:b,distanceFromAnchor:Ue,getElevation:he,previousVertex:Ne,direction:pe,absOffsetX:et};if(Ie=cn(ge,yt),d===0)Ke.push(Ne),at=Ie.sub(Ne);else{let an;const Gt=Ie.sub(Ne);an=Gt.mag()===0?Kr(cn(ge+pe,yt).sub(Ie),d,pe):Kr(Gt,d,pe),Oe||(Oe=Ne.add(an)),Pe=xi(ge,an,Ie,C,M,Oe,d,yt),Ke.push(Oe),at=Pe.sub(Oe)}Ze=at.mag()}const Vt=at._mult((et-Ue)/Ze)._add(Oe||Ne),An=ae+Math.atan2(Ie.y-Ne.y,Ie.x-Ne.x);return Ke.push(Vt),{point:Vt,angle:X?An:0,path:Ke}}const G=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Z(v,a){for(let d=0;d<v;d++){const p=a.length;a.resize(p+4),a.float32.set(G,3*p)}}function se(v,a,d){const p=a[0],y=a[1];return v[0]=d[0]*p+d[4]*y+d[12],v[1]=d[1]*p+d[5]*y+d[13],v[3]=d[3]*p+d[7]*y+d[15],v}const ue=100;class ve{constructor(a,d=new mn(a.width+200,a.height+200,25),p=new mn(a.width+200,a.height+200,25)){this.transform=a,this.grid=d,this.ignoredGrid=p,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+ue,this.screenBottomBoundary=a.height+ue,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(a,d,p,y,b,P){const C=this.projectAndGetPerspectiveRatio(y,a.anchorPointX,a.anchorPointY,P),M=p*C.perspectiveRatio,O=a.x1*M+C.point.x,U=a.y1*M+C.point.y,V=a.x2*M+C.point.x,X=a.y2*M+C.point.y;return!this.isInsideGrid(O,U,V,X)||d!=="always"&&this.grid.hitTest(O,U,V,X,d,b)||C.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[O,U,V,X],offscreen:this.isOffscreen(O,U,V,X)}}placeCollisionCircles(a,d,p,y,b,P,C,M,O,U,V,X,he,ce){const pe=[],ae=new l.Point(d.anchorX,d.anchorY),Pe=Zt(ae,P,ce),Oe=Ln(this.transform.cameraToCenterDistance,Pe.signedDistanceFromCamera),ge=(U?b/Oe:b*Oe)/l.ONE_EM,Ie=Zt(ae,C,ce).point,Ne=fn(ge,y,d.lineOffsetX*ge,d.lineOffsetY*ge,!1,Ie,ae,d,p,C,{projections:{},offsets:{}},!1,ce);let Ue=!1,Ze=!1,et=!0;if(Ne){const Ke=.5*X*Oe+he,at=new l.Point(-100,-100),Vt=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),An=new Pt,yt=Ne.first,an=Ne.last;let Gt=[];for(let _n=yt.path.length-1;_n>=1;_n--)Gt.push(yt.path[_n]);for(let _n=1;_n<an.path.length;_n++)Gt.push(an.path[_n]);const Hn=2.5*Ke;if(M){const _n=Gt.map(In=>Zt(In,M,ce));Gt=_n.some(In=>In.signedDistanceFromCamera<=0)?[]:_n.map(In=>In.point)}let Pn=[];if(Gt.length>0){const _n=Gt[0].clone(),In=Gt[0].clone();for(let Mr=1;Mr<Gt.length;Mr++)_n.x=Math.min(_n.x,Gt[Mr].x),_n.y=Math.min(_n.y,Gt[Mr].y),In.x=Math.max(In.x,Gt[Mr].x),In.y=Math.max(In.y,Gt[Mr].y);Pn=_n.x>=at.x&&In.x<=Vt.x&&_n.y>=at.y&&In.y<=Vt.y?[Gt]:In.x<at.x||_n.x>Vt.x||In.y<at.y||_n.y>Vt.y?[]:l.clipLine([Gt],at.x,at.y,Vt.x,Vt.y)}for(const _n of Pn){An.reset(_n,.25*Ke);let In=0;In=An.length<=.5*Ke?1:Math.ceil(An.paddedLength/Hn)+1;for(let Mr=0;Mr<In;Mr++){const tr=Mr/Math.max(In-1,1),fi=An.lerp(tr),Qr=fi.x+ue,Dr=fi.y+ue;pe.push(Qr,Dr,Ke,0);const ps=Qr-Ke,or=Dr-Ke,yo=Qr+Ke,_o=Dr+Ke;if(et=et&&this.isOffscreen(ps,or,yo,_o),Ze=Ze||this.isInsideGrid(ps,or,yo,_o),a!=="always"&&this.grid.hitTestCircle(Qr,Dr,Ke,a,V)&&(Ue=!0,!O))return{circles:[],offscreen:!1,collisionDetected:Ue}}}}return{circles:!O&&Ue||!Ze||Oe<this.perspectiveRatioCutoff?[]:pe,offscreen:et,collisionDetected:Ue}}queryRenderedSymbols(a){if(a.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let p=1/0,y=1/0,b=-1/0,P=-1/0;for(const U of a){const V=new l.Point(U.x+ue,U.y+ue);p=Math.min(p,V.x),y=Math.min(y,V.y),b=Math.max(b,V.x),P=Math.max(P,V.y),d.push(V)}const C=this.grid.query(p,y,b,P).concat(this.ignoredGrid.query(p,y,b,P)),M={},O={};for(const U of C){const V=U.key;if(M[V.bucketInstanceId]===void 0&&(M[V.bucketInstanceId]={}),M[V.bucketInstanceId][V.featureIndex])continue;const X=[new l.Point(U.x1,U.y1),new l.Point(U.x2,U.y1),new l.Point(U.x2,U.y2),new l.Point(U.x1,U.y2)];l.polygonIntersectsPolygon(d,X)&&(M[V.bucketInstanceId][V.featureIndex]=!0,O[V.bucketInstanceId]===void 0&&(O[V.bucketInstanceId]=[]),O[V.bucketInstanceId].push(V.featureIndex))}return O}insertCollisionBox(a,d,p,y,b,P){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:b,collisionGroupID:P,overlapMode:d},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,d,p,y,b,P){const C=p?this.ignoredGrid:this.grid,M={bucketInstanceId:y,featureIndex:b,collisionGroupID:P,overlapMode:d};for(let O=0;O<a.length;O+=4)C.insertCircle(M,a[O],a[O+1],a[O+2])}projectAndGetPerspectiveRatio(a,d,p,y){let b;return y?(b=[d,p,y(d,p),1],l.transformMat4(b,b,a)):(b=[d,p,0,1],se(b,b,a)),{point:new l.Point((b[0]/b[3]+1)/2*this.transform.width+ue,(-b[1]/b[3]+1)/2*this.transform.height+ue),perspectiveRatio:.5+this.transform.cameraToCenterDistance/b[3]*.5}}isOffscreen(a,d,p,y){return p<ue||a>=this.screenRightBoundary||y<ue||d>this.screenBottomBoundary}isInsideGrid(a,d,p,y){return p>=0&&a<this.gridRightBoundary&&y>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const a=l.identity([]);return l.translate(a,a,[-100,-100,0]),a}}function Se(v,a,d){return a*(l.EXTENT/(v.tileSize*Math.pow(2,d-v.tileID.overscaledZ)))}class Te{constructor(a,d,p,y){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?d:-d))):y&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ye{constructor(a,d,p,y,b){this.text=new Te(a?a.text:null,d,p,b),this.icon=new Te(a?a.icon:null,d,y,b)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ce{constructor(a,d,p){this.text=a,this.icon=d,this.skipFade=p}}class $e{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class We{constructor(a,d,p,y,b){this.bucketInstanceId=a,this.featureIndex=d,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=b}}class qe{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const d=++this.maxGroupID;this.collisionGroups[a]={ID:d,predicate:p=>p.collisionGroupID===d}}return this.collisionGroups[a]}}function At(v,a,d,p,y){const{horizontalAlign:b,verticalAlign:P}=l.getAnchorAlignment(v);return new l.Point(-(b-.5)*a+p[0]*y,-(P-.5)*d+p[1]*y)}function nn(v,a,d,p,y,b){const{x1:P,x2:C,y1:M,y2:O,anchorPointX:U,anchorPointY:V}=v,X=new l.Point(a,d);return p&&X._rotate(y?b:-b),{x1:P+X.x,y1:M+X.y,x2:C+X.x,y2:O+X.y,anchorPointX:U,anchorPointY:V}}class Ot{constructor(a,d,p,y,b){this.transform=a.clone(),this.terrain=d,this.collisionIndex=new ve(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new qe(y),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,d,p,y){const b=p.getBucket(d),P=p.latestFeatureIndex;if(!b||!P||d.id!==b.layerIds[0])return;const C=p.collisionBoxArray,M=b.layers[0].layout,O=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),U=p.tileSize/l.EXTENT,V=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),X=M.get("text-pitch-alignment")==="map",he=M.get("text-rotation-alignment")==="map",ce=Se(p,1,this.transform.zoom),pe=He(V,X,he,this.transform,ce);let ae=null;if(X){const Oe=mt(V,X,he,this.transform,ce);ae=l.multiply([],this.transform.labelPlaneMatrix,Oe)}this.retainedQueryData[b.bucketInstanceId]=new We(b.bucketInstanceId,P,b.sourceLayerIndex,b.index,p.tileID);const Pe={bucket:b,layout:M,posMatrix:V,textLabelPlaneMatrix:pe,labelToScreenMatrix:ae,scale:O,textPixelRatio:U,holdingForFade:p.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(y)for(const Oe of b.sortKeyRanges){const{sortKey:ge,symbolInstanceStart:Ie,symbolInstanceEnd:Ne}=Oe;a.push({sortKey:ge,symbolInstanceStart:Ie,symbolInstanceEnd:Ne,parameters:Pe})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Pe})}attemptAnchorPlacement(a,d,p,y,b,P,C,M,O,U,V,X,he,ce,pe,ae){const Pe=l.TextAnchorEnum[a.textAnchor],Oe=[a.textOffset0,a.textOffset1],ge=At(Pe,p,y,Oe,b),Ie=this.collisionIndex.placeCollisionBox(nn(d,ge.x,ge.y,P,C,this.transform.angle),V,M,O,U.predicate,ae);if((!pe||this.collisionIndex.placeCollisionBox(nn(pe,ge.x,ge.y,P,C,this.transform.angle),V,M,O,U.predicate,ae).box.length!==0)&&Ie.box.length>0){let Ne;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(Ne=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:Oe,width:p,height:y,anchor:Pe,textBoxScale:b,prevAnchor:Ne},this.markUsedJustification(he,Pe,X,ce),he.allowVerticalPlacement&&(this.markUsedOrientation(he,ce,X),this.placedOrientations[X.crossTileID]=ce),{shift:ge,placedGlyphBoxes:Ie}}}placeLayerBucketPart(a,d,p){const{bucket:y,layout:b,posMatrix:P,textLabelPlaneMatrix:C,labelToScreenMatrix:M,textPixelRatio:O,holdingForFade:U,collisionBoxArray:V,partiallyEvaluatedTextSize:X,collisionGroup:he}=a.parameters,ce=b.get("text-optional"),pe=b.get("icon-optional"),ae=l.getOverlapMode(b,"text-overlap","text-allow-overlap"),Pe=ae==="always",Oe=l.getOverlapMode(b,"icon-overlap","icon-allow-overlap"),ge=Oe==="always",Ie=b.get("text-rotation-alignment")==="map",Ne=b.get("text-pitch-alignment")==="map",Ue=b.get("icon-text-fit")!=="none",Ze=b.get("symbol-z-order")==="viewport-y",et=Pe&&(ge||!y.hasIconData()||pe),Ke=ge&&(Pe||!y.hasTextData()||ce);!y.collisionArrays&&V&&y.deserializeCollisionBoxes(V);const at=this.retainedQueryData[y.bucketInstanceId].tileID,Vt=this.terrain?(yt,an)=>this.terrain.getElevation(at,yt,an):null,An=(yt,an)=>{var Gt,Hn;if(d[yt.crossTileID])return;if(U)return void(this.placements[yt.crossTileID]=new Ce(!1,!1,!1));let Pn=!1,_n=!1,In=!0,Mr=null,tr={box:null,offscreen:null},fi={box:null,offscreen:null},Qr=null,Dr=null,ps=null,or=0,yo=0,_o=0;an.textFeatureIndex?or=an.textFeatureIndex:yt.useRuntimeCollisionCircles&&(or=yt.featureIndex),an.verticalTextFeatureIndex&&(yo=an.verticalTextFeatureIndex);const ma=an.textBox;if(ma){const wi=kr=>{let ei=l.WritingMode.horizontal;if(y.allowVerticalPlacement&&!kr&&this.prevPlacement){const Zi=this.prevPlacement.placedOrientations[yt.crossTileID];Zi&&(this.placedOrientations[yt.crossTileID]=Zi,ei=Zi,this.markUsedOrientation(y,ei,yt))}return ei},pi=(kr,ei)=>{if(y.allowVerticalPlacement&&yt.numVerticalGlyphVertices>0&&an.verticalTextBox){for(const Zi of y.writingModes)if(Zi===l.WritingMode.vertical?(tr=ei(),fi=tr):tr=kr(),tr&&tr.box&&tr.box.length)break}else tr=kr()},Ri=yt.textAnchorOffsetStartIndex,Ha=yt.textAnchorOffsetEndIndex;if(Ha===Ri){const kr=(ei,Zi)=>{const Lr=this.collisionIndex.placeCollisionBox(ei,ae,O,P,he.predicate,Vt);return Lr&&Lr.box&&Lr.box.length&&(this.markUsedOrientation(y,Zi,yt),this.placedOrientations[yt.crossTileID]=Zi),Lr};pi(()=>kr(ma,l.WritingMode.horizontal),()=>{const ei=an.verticalTextBox;return y.allowVerticalPlacement&&yt.numVerticalGlyphVertices>0&&ei?kr(ei,l.WritingMode.vertical):{box:null,offscreen:null}}),wi(tr&&tr.box&&tr.box.length)}else{let kr=l.TextAnchorEnum[(Hn=(Gt=this.prevPlacement)===null||Gt===void 0?void 0:Gt.variableOffsets[yt.crossTileID])===null||Hn===void 0?void 0:Hn.anchor];const ei=(Lr,qa,ah)=>{const kg=Lr.x2-Lr.x1,Lg=Lr.y2-Lr.y1,Yv=yt.textBoxScale,Af=Ue&&Oe==="never"?qa:null;let vo={box:[],offscreen:!1},Za=ae==="never"?1:2,xo="never";kr&&Za++;for(let Ms=0;Ms<Za;Ms++){for(let bo=Ri;bo<Ha;bo++){const If=y.textAnchorOffsets.get(bo);if(kr&&If.textAnchor!==kr)continue;const Wo=this.attemptAnchorPlacement(If,Lr,kg,Lg,Yv,Ie,Ne,O,P,he,xo,yt,y,ah,Af,Vt);if(Wo&&(vo=Wo.placedGlyphBoxes,vo&&vo.box&&vo.box.length))return Pn=!0,Mr=Wo.shift,vo}kr?kr=null:xo=ae}return vo};pi(()=>ei(ma,an.iconBox,l.WritingMode.horizontal),()=>{const Lr=an.verticalTextBox;return y.allowVerticalPlacement&&!(tr&&tr.box&&tr.box.length)&&yt.numVerticalGlyphVertices>0&&Lr?ei(Lr,an.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),tr&&(Pn=tr.box,In=tr.offscreen);const Zi=wi(tr&&tr.box);if(!Pn&&this.prevPlacement){const Lr=this.prevPlacement.variableOffsets[yt.crossTileID];Lr&&(this.variableOffsets[yt.crossTileID]=Lr,this.markUsedJustification(y,Lr.anchor,yt,Zi))}}}if(Qr=tr,Pn=Qr&&Qr.box&&Qr.box.length>0,In=Qr&&Qr.offscreen,yt.useRuntimeCollisionCircles){const wi=y.text.placedSymbolArray.get(yt.centerJustifiedTextSymbolIndex),pi=l.evaluateSizeForFeature(y.textSizeData,X,wi),Ri=b.get("text-padding");Dr=this.collisionIndex.placeCollisionCircles(ae,wi,y.lineVertexArray,y.glyphOffsetArray,pi,P,C,M,p,Ne,he.predicate,yt.collisionCircleDiameter,Ri,Vt),Dr.circles.length&&Dr.collisionDetected&&!p&&l.warnOnce("Collisions detected, but collision boxes are not shown"),Pn=Pe||Dr.circles.length>0&&!Dr.collisionDetected,In=In&&Dr.offscreen}if(an.iconFeatureIndex&&(_o=an.iconFeatureIndex),an.iconBox){const wi=pi=>{const Ri=Ue&&Mr?nn(pi,Mr.x,Mr.y,Ie,Ne,this.transform.angle):pi;return this.collisionIndex.placeCollisionBox(Ri,Oe,O,P,he.predicate,Vt)};fi&&fi.box&&fi.box.length&&an.verticalIconBox?(ps=wi(an.verticalIconBox),_n=ps.box.length>0):(ps=wi(an.iconBox),_n=ps.box.length>0),In=In&&ps.offscreen}const Wa=ce||yt.numHorizontalGlyphVertices===0&&yt.numVerticalGlyphVertices===0,zl=pe||yt.numIconVertices===0;if(Wa||zl?zl?Wa||(_n=_n&&Pn):Pn=_n&&Pn:_n=Pn=_n&&Pn,Pn&&Qr&&Qr.box&&this.collisionIndex.insertCollisionBox(Qr.box,ae,b.get("text-ignore-placement"),y.bucketInstanceId,fi&&fi.box&&yo?yo:or,he.ID),_n&&ps&&this.collisionIndex.insertCollisionBox(ps.box,Oe,b.get("icon-ignore-placement"),y.bucketInstanceId,_o,he.ID),Dr&&(Pn&&this.collisionIndex.insertCollisionCircles(Dr.circles,ae,b.get("text-ignore-placement"),y.bucketInstanceId,or,he.ID),p)){const wi=y.bucketInstanceId;let pi=this.collisionCircleArrays[wi];pi===void 0&&(pi=this.collisionCircleArrays[wi]=new $e);for(let Ri=0;Ri<Dr.circles.length;Ri+=4)pi.circles.push(Dr.circles[Ri+0]),pi.circles.push(Dr.circles[Ri+1]),pi.circles.push(Dr.circles[Ri+2]),pi.circles.push(Dr.collisionDetected?1:0)}if(yt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[yt.crossTileID]=new Ce(Pn||et,_n||Ke,In||y.justReloaded),d[yt.crossTileID]=!0};if(Ze){if(a.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const yt=y.getSortedSymbolIndexes(this.transform.angle);for(let an=yt.length-1;an>=0;--an){const Gt=yt[an];An(y.symbolInstances.get(Gt),y.collisionArrays[Gt])}}else for(let yt=a.symbolInstanceStart;yt<a.symbolInstanceEnd;yt++)An(y.symbolInstances.get(yt),y.collisionArrays[yt]);if(p&&y.bucketInstanceId in this.collisionCircleArrays){const yt=this.collisionCircleArrays[y.bucketInstanceId];l.invert(yt.invProjMatrix,P),yt.viewportMatrix=this.collisionIndex.getViewportMatrix()}y.justReloaded=!1}markUsedJustification(a,d,p,y){let b;b=y===l.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(d)];const P=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const C of P)C>=0&&(a.text.placedSymbolArray.get(C).crossTileID=b>=0&&C!==b?0:p.crossTileID)}markUsedOrientation(a,d,p){const y=d===l.WritingMode.horizontal||d===l.WritingMode.horizontalOnly?d:0,b=d===l.WritingMode.vertical?d:0,P=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const C of P)a.text.placedSymbolArray.get(C).placedOrientation=y;p.verticalPlacedTextSymbolIndex&&(a.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let p=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const y=d?d.symbolFadeChange(a):1,b=d?d.opacities:{},P=d?d.variableOffsets:{},C=d?d.placedOrientations:{};for(const M in this.placements){const O=this.placements[M],U=b[M];U?(this.opacities[M]=new ye(U,y,O.text,O.icon),p=p||O.text!==U.text.placed||O.icon!==U.icon.placed):(this.opacities[M]=new ye(null,y,O.text,O.icon,O.skipFade),p=p||O.text||O.icon)}for(const M in b){const O=b[M];if(!this.opacities[M]){const U=new ye(O,y,!1,!1);U.isHidden()||(this.opacities[M]=U,p=p||O.text.placed||O.icon.placed)}}for(const M in P)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=P[M]);for(const M in C)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=C[M]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=a:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:a)}updateLayerOpacities(a,d){const p={};for(const y of d){const b=y.getBucket(a);b&&y.latestFeatureIndex&&a.id===b.layerIds[0]&&this.updateBucketOpacities(b,p,y.collisionBoxArray)}}updateBucketOpacities(a,d,p){a.hasTextData()&&(a.text.opacityVertexArray.clear(),a.text.hasVisibleVertices=!1),a.hasIconData()&&(a.icon.opacityVertexArray.clear(),a.icon.hasVisibleVertices=!1),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const y=a.layers[0],b=y.layout,P=new ye(null,0,!1,!1,!0),C=b.get("text-allow-overlap"),M=b.get("icon-allow-overlap"),O=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),U=b.get("text-rotation-alignment")==="map",V=b.get("text-pitch-alignment")==="map",X=b.get("icon-text-fit")!=="none",he=new ye(null,0,C&&(M||!a.hasIconData()||b.get("icon-optional")),M&&(C||!a.hasTextData()||b.get("text-optional")),!0);!a.collisionArrays&&p&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(p);const ce=(pe,ae,Pe)=>{for(let Oe=0;Oe<ae/4;Oe++)pe.opacityVertexArray.emplaceBack(Pe);pe.hasVisibleVertices=pe.hasVisibleVertices||Pe!==xr};for(let pe=0;pe<a.symbolInstances.length;pe++){const ae=a.symbolInstances.get(pe),{numHorizontalGlyphVertices:Pe,numVerticalGlyphVertices:Oe,crossTileID:ge}=ae;let Ie=this.opacities[ge];d[ge]?Ie=P:Ie||(Ie=he,this.opacities[ge]=Ie),d[ge]=!0;const Ne=ae.numIconVertices>0,Ue=this.placedOrientations[ae.crossTileID],Ze=Ue===l.WritingMode.vertical,et=Ue===l.WritingMode.horizontal||Ue===l.WritingMode.horizontalOnly;if(Pe>0||Oe>0){const Ke=zn(Ie.text);ce(a.text,Pe,Ze?xr:Ke),ce(a.text,Oe,et?xr:Ke);const at=Ie.text.isHidden();[ae.rightJustifiedTextSymbolIndex,ae.centerJustifiedTextSymbolIndex,ae.leftJustifiedTextSymbolIndex].forEach(yt=>{yt>=0&&(a.text.placedSymbolArray.get(yt).hidden=at||Ze?1:0)}),ae.verticalPlacedTextSymbolIndex>=0&&(a.text.placedSymbolArray.get(ae.verticalPlacedTextSymbolIndex).hidden=at||et?1:0);const Vt=this.variableOffsets[ae.crossTileID];Vt&&this.markUsedJustification(a,Vt.anchor,ae,Ue);const An=this.placedOrientations[ae.crossTileID];An&&(this.markUsedJustification(a,"left",ae,An),this.markUsedOrientation(a,An,ae))}if(Ne){const Ke=zn(Ie.icon),at=!(X&&ae.verticalPlacedIconSymbolIndex&&Ze);ae.placedIconSymbolIndex>=0&&(ce(a.icon,ae.numIconVertices,at?Ke:xr),a.icon.placedSymbolArray.get(ae.placedIconSymbolIndex).hidden=Ie.icon.isHidden()),ae.verticalPlacedIconSymbolIndex>=0&&(ce(a.icon,ae.numVerticalIconVertices,at?xr:Ke),a.icon.placedSymbolArray.get(ae.verticalPlacedIconSymbolIndex).hidden=Ie.icon.isHidden())}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const Ke=a.collisionArrays[pe];if(Ke){let at=new l.Point(0,0);if(Ke.textBox||Ke.verticalTextBox){let An=!0;if(O){const yt=this.variableOffsets[ge];yt?(at=At(yt.anchor,yt.width,yt.height,yt.textOffset,yt.textBoxScale),U&&at._rotate(V?this.transform.angle:-this.transform.angle)):An=!1}Ke.textBox&&dt(a.textCollisionBox.collisionVertexArray,Ie.text.placed,!An||Ze,at.x,at.y),Ke.verticalTextBox&&dt(a.textCollisionBox.collisionVertexArray,Ie.text.placed,!An||et,at.x,at.y)}const Vt=!!(!et&&Ke.verticalIconBox);Ke.iconBox&&dt(a.iconCollisionBox.collisionVertexArray,Ie.icon.placed,Vt,X?at.x:0,X?at.y:0),Ke.verticalIconBox&&dt(a.iconCollisionBox.collisionVertexArray,Ie.icon.placed,!Vt,X?at.x:0,X?at.y:0)}}}if(a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.text.opacityVertexArray.length!==a.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${a.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${a.text.layoutVertexArray.length}) / 4`);if(a.icon.opacityVertexArray.length!==a.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${a.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${a.icon.layoutVertexArray.length}) / 4`);if(a.bucketInstanceId in this.collisionCircleArrays){const pe=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=pe.invProjMatrix,a.placementViewportMatrix=pe.viewportMatrix,a.collisionCircleArray=pe.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return this.fadeDuration===0?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,d){const p=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*p>a}setStale(){this.stale=!0}}function dt(v,a,d,p,y){v.emplaceBack(a?1:0,d?1:0,p||0,y||0),v.emplaceBack(a?1:0,d?1:0,p||0,y||0),v.emplaceBack(a?1:0,d?1:0,p||0,y||0),v.emplaceBack(a?1:0,d?1:0,p||0,y||0)}const Nt=Math.pow(2,25),xn=Math.pow(2,24),bn=Math.pow(2,17),pn=Math.pow(2,16),yn=Math.pow(2,9),Ar=Math.pow(2,8),Ut=Math.pow(2,1);function zn(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const a=v.placed?1:0,d=Math.floor(127*v.opacity);return d*Nt+a*xn+d*bn+a*pn+d*yn+a*Ar+d*Ut+a}const xr=0;class Vs{constructor(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&!a.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(a,d,p,y,b){const P=this._bucketParts;for(;this._currentTileIndex<a.length;)if(d.getBucketParts(P,y,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((C,M)=>C.sortKey-M.sortKey));this._currentPartIndex<P.length;)if(d.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,b())return!0;return!1}}class Jr{constructor(a,d,p,y,b,P,C,M){this.placement=new Ot(a,d,P,C,M),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(a,d,p){const y=l.browser.now(),b=()=>!this._forceFullPlacement&&l.browser.now()-y>2;for(;this._currentPlacementIndex>=0;){const P=d[a[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=C)&&(!P.maxzoom||P.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new Vs(P)),this._inProgressLayer.continuePlacement(p[P.source],this.placement,this._showCollisionBoxes,P,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const ls=512/l.EXTENT/2;class po{constructor(a,d,p){this.tileID=a,this.bucketInstanceId=p,this._symbolsByKey={};const y=new Map;for(let b=0;b<d.length;b++){const P=d.get(b),C=P.key,M=y.get(C);M?M.push(P):y.set(C,[P])}for(const[b,P]of y){const C={positions:P.map(M=>({x:Math.floor(M.anchorX*ls),y:Math.floor(M.anchorY*ls)})),crossTileIDs:P.map(M=>M.crossTileID)};if(C.positions.length>128){const M=new l.KDBush(C.positions.length,16,Uint16Array);for(const{x:O,y:U}of C.positions)M.add(O,U);M.finish(),delete C.positions,C.index=M}this._symbolsByKey[b]=C}}getScaledCoordinates(a,d){const{x:p,y,z:b}=this.tileID.canonical,{x:P,y:C,z:M}=d.canonical,O=ls/Math.pow(2,M-b),U=(C*l.EXTENT+a.anchorY)*O,V=y*l.EXTENT*ls;return{x:Math.floor((P*l.EXTENT+a.anchorX)*O-p*l.EXTENT*ls),y:Math.floor(U-V)}}findMatches(a,d,p){const y=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let b=0;b<a.length;b++){const P=a.get(b);if(P.crossTileID)continue;const C=this._symbolsByKey[P.key];if(!C)continue;const M=this.getScaledCoordinates(P,d);if(C.index){const O=C.index.range(M.x-y,M.y-y,M.x+y,M.y+y).sort();for(const U of O){const V=C.crossTileIDs[U];if(!p[V]){p[V]=!0,P.crossTileID=V;break}}}else if(C.positions)for(let O=0;O<C.positions.length;O++){const U=C.positions[O],V=C.crossTileIDs[O];if(Math.abs(U.x-M.x)<=y&&Math.abs(U.y-M.y)<=y&&!p[V]){p[V]=!0,P.crossTileID=V;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:a})=>a)}}class Cn{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class No{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const d=Math.round((a-this.lng)/360);if(d!==0)for(const p in this.indexes){const y=this.indexes[p],b={};for(const P in y){const C=y[P];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+d),b[C.tileID.key]=C}this.indexes[p]=b}this.lng=a}addBucket(a,d,p){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let b=0;b<d.symbolInstances.length;b++)d.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});const y=this.usedCrossTileIDs[a.overscaledZ];for(const b in this.indexes){const P=this.indexes[b];if(Number(b)>a.overscaledZ)for(const C in P){const M=P[C];M.tileID.isChildOf(a)&&M.findMatches(d.symbolInstances,a,y)}else{const C=P[a.scaledTo(Number(b)).key];C&&C.findMatches(d.symbolInstances,a,y)}}for(let b=0;b<d.symbolInstances.length;b++){const P=d.symbolInstances.get(b);P.crossTileID||(P.crossTileID=p.generate(),y[P.crossTileID]=!0)}return this.indexes[a.overscaledZ]===void 0&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new po(a,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(a,d){for(const p of d.getCrossTileIDsLists())for(const y of p)delete this.usedCrossTileIDs[a][y]}removeStaleBuckets(a){let d=!1;for(const p in this.indexes){const y=this.indexes[p];for(const b in y)a[y[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[b]),delete y[b],d=!0)}return d}}class ki{constructor(){this.layerIndexes={},this.crossTileIDs=new Cn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,d,p){let y=this.layerIndexes[a.id];y===void 0&&(y=this.layerIndexes[a.id]=new No);let b=!1;const P={};y.handleWrapJump(p);for(const C of d){const M=C.getBucket(a);M&&a.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(C.tileID,M,this.crossTileIDs)&&(b=!0),P[M.bucketInstanceId]=!0)}return y.removeStaleBuckets(P)&&(b=!0),b}pruneUnusedLayers(a){const d={};a.forEach(p=>{d[p]=!0});for(const p in this.layerIndexes)d[p]||delete this.layerIndexes[p]}}const ir=(v,a)=>l.emitValidationErrors(v,a&&a.filter(d=>d.identifier!=="source.canvas")),bi=l.pick(l.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Fu=l.pick(l.operations,["setCenter","setZoom","setBearing","setPitch"]),hi=l.emptyStyle();class Zn extends l.Evented{constructor(a,d={}){super(),this.map=a,this.dispatcher=new Dt(Rt(),this,a._getMapId()),this.imageManager=new Ve,this.imageManager.setEventedParent(this),this.glyphManager=new je(a._requestManager,d.localIdeographFontFamily),this.lineAtlas=new nt(256,512),this.crossTileSymbolIndex=new ki,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const p=this;this._rtlTextPluginCallback=Zn.registerForPluginStateChange(y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(b,P)=>{if(l.triggerPluginCompletionEvent(b),P&&P.every(C=>C))for(const C in p.sourceCaches){const M=p.sourceCaches[C].getSource().type;M!=="vector"&&M!=="geojson"||p.sourceCaches[C].reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const b=this.sourceCaches[y.sourceId];if(!b)return;const P=b.getSource();if(P&&P.vectorLayerIds)for(const C in this._layers){const M=this._layers[C];M.source===P.id&&this._validateLayer(M)}})}loadURL(a,d={},p){this.fire(new l.Event("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const y=this.map._requestManager.transformRequest(a,z.Style);this._request=l.getJSON(y,(b,P)=>{this._request=null,b?this.fire(new l.ErrorEvent(b)):P&&this._load(P,d,p)})}loadJSON(a,d={},p){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.browser.frame(()=>{this._request=null,d.validate=d.validate!==!1,this._load(a,d,p)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(hi,{validate:!1})}_load(a,d,p){var y;const b=d.transformStyle?d.transformStyle(p,a):a;if(!d.validate||!ir(this,l.validateStyle(b))){this._loaded=!0,this.stylesheet=b;for(const P in b.sources)this.addSource(P,b.sources[P],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs),this._createLayers(),this.light=new Ge(this.stylesheet.light),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}}_createLayers(){const a=l.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",a),this._order=a.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of a){const p=l.createStyleLayer(d);p.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=p}}_loadSprite(a,d=!1,p=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(y,b,P,C){const M=be(y),O=M.length,U=P>1?"@2x":"",V={},X={},he={};for(const{id:ce,url:pe}of M){const ae=b.transformRequest(b.normalizeSpriteURL(pe,U,".json"),z.SpriteJSON),Pe=`${ce}_${ae.url}`;V[Pe]=l.getJSON(ae,(Ie,Ne)=>{delete V[Pe],X[ce]=Ne,xe(C,X,he,Ie,O)});const Oe=b.transformRequest(b.normalizeSpriteURL(pe,U,".png"),z.SpriteImage),ge=`${ce}_${Oe.url}`;V[ge]=W.getImage(Oe,(Ie,Ne)=>{delete V[ge],he[ce]=Ne,xe(C,X,he,Ie,O)})}return{cancel(){for(const ce of Object.values(V))ce.cancel()}}}(a,this.map._requestManager,this.map.getPixelRatio(),(y,b)=>{if(this._spriteRequest=null,y)this.fire(new l.ErrorEvent(y));else if(b)for(const P in b){this._spritesImagesIds[P]=[];const C=this._spritesImagesIds[P]?this._spritesImagesIds[P].filter(M=>!(M in b)):[];for(const M of C)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in b[P]){const O=P==="default"?M:`${P}:${M}`;this._spritesImagesIds[P].push(O),O in this.imageManager.images?this.imageManager.updateImage(O,b[P][M],!1):this.imageManager.addImage(O,b[P][M]),d&&(this._changedImages[O]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"})),p&&p(y)})}_unloadSprite(){for(const a of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(a),this._changedImages[a]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}_validateLayer(a){const d=this.sourceCaches[a.source];if(!d)return;const p=a.sourceLayer;if(!p)return;const y=d.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(p)===-1)&&this.fire(new l.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${y.id}" as specified by style layer "${a.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(a){const d=this._serializedAllLayers();if(!a||a.length===0)return Object.values(d);const p=[];for(const y of a)d[y]&&p.push(d[y]);return p}_serializedAllLayers(){let a=this._serializedLayers;if(a)return a;a=this._serializedLayers={};const d=Object.keys(this._layers);for(const p of d){const y=this._layers[p];y.type!=="custom"&&(a[p]=y.serialize())}return a}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(a){if(!this._loaded)return;const d=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(y.length||b.length)&&this._updateWorkerLayers(y,b);for(const P in this._updatedSources){const C=this._updatedSources[P];if(C==="reload")this._reloadSource(P);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(P)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(a);this.light.updateTransitions(a),this._resetUpdates()}const p={};for(const y in this.sourceCaches){const b=this.sourceCaches[y];p[y]=b.used,b.used=!1}for(const y of this._order){const b=this._layers[y];b.recalculate(a,this._availableImages),!b.isHidden(a.zoom)&&b.source&&(this.sourceCaches[b.source].used=!0)}for(const y in p){const b=this.sourceCaches[y];p[y]!==b.used&&b.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(a),this.z=a.zoom,d&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const a=Object.keys(this._changedImages);if(a.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(a,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(a),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(a,d={}){this._checkLoaded();const p=this.serialize();if(a=d.transformStyle?d.transformStyle(p,a):a,ir(this,l.validateStyle(a)))return!1;(a=l.clone$1(a)).layers=l.derefLayers(a.layers);const y=l.diffStyles(p,a).filter(P=>!(P.command in Fu));if(y.length===0)return!1;const b=y.filter(P=>!(P.command in bi));if(b.length>0)throw new Error(`Unimplemented: ${b.map(P=>P.command).join(", ")}.`);for(const P of y)P.command!=="setTransition"&&this[P.command].apply(this,P.args);return this.stylesheet=a,this._serializedLayers=null,!0}addImage(a,d){if(this.getImage(a))return this.fire(new l.ErrorEvent(new Error(`An image named "${a}" already exists.`)));this.imageManager.addImage(a,d),this._afterImageUpdated(a)}updateImage(a,d){this.imageManager.updateImage(a,d)}getImage(a){return this.imageManager.getImage(a)}removeImage(a){if(!this.getImage(a))return this.fire(new l.ErrorEvent(new Error(`An image named "${a}" does not exist.`)));this.imageManager.removeImage(a),this._afterImageUpdated(a)}_afterImageUpdated(a){this._availableImages=this.imageManager.listImages(),this._changedImages[a]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(a,d,p={}){if(this._checkLoaded(),this.sourceCaches[a]!==void 0)throw new Error(`Source "${a}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(l.validateStyle.source,`sources.${a}`,d,null,p))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const y=this.sourceCaches[a]=new Ct(a,d,this.dispatcher);y.style=this,y.setEventedParent(this,()=>({isSourceLoaded:y.loaded(),source:y.serialize(),sourceId:a})),y.onAdd(this.map),this._changed=!0}removeSource(a){if(this._checkLoaded(),this.sourceCaches[a]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===a)return this.fire(new l.ErrorEvent(new Error(`Source "${a}" cannot be removed while layer "${p}" is using it.`)));const d=this.sourceCaches[a];delete this.sourceCaches[a],delete this._updatedSources[a],d.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:a})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(a,d){if(this._checkLoaded(),this.sourceCaches[a]===void 0)throw new Error(`There is no source with this ID=${a}`);const p=this.sourceCaches[a].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(d),this._changed=!0}getSource(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()}addLayer(a,d,p={}){this._checkLoaded();const y=a.id;if(this.getLayer(y))return void this.fire(new l.ErrorEvent(new Error(`Layer "${y}" already exists on this map.`)));let b;if(a.type==="custom"){if(ir(this,l.validateCustomStyleLayer(a)))return;b=l.createStyleLayer(a)}else{if("source"in a&&typeof a.source=="object"&&(this.addSource(y,a.source),a=l.clone$1(a),a=l.extend(a,{source:y})),this._validate(l.validateStyle.layer,`layers.${y}`,a,{arrayIndex:-1},p))return;b=l.createStyleLayer(a),this._validateLayer(b),b.setEventedParent(this,{layer:{id:y}})}const P=d?this._order.indexOf(d):this._order.length;if(d&&P===-1)this.fire(new l.ErrorEvent(new Error(`Cannot add layer "${y}" before non-existing layer "${d}".`)));else{if(this._order.splice(P,0,y),this._layerOrderChanged=!0,this._layers[y]=b,this._removedLayers[y]&&b.source&&b.type!=="custom"){const C=this._removedLayers[y];delete this._removedLayers[y],C.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map)}}moveLayer(a,d){if(this._checkLoaded(),this._changed=!0,!this._layers[a])return void this.fire(new l.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be moved.`)));if(a===d)return;const p=this._order.indexOf(a);this._order.splice(p,1);const y=d?this._order.indexOf(d):this._order.length;d&&y===-1?this.fire(new l.ErrorEvent(new Error(`Cannot move layer "${a}" before non-existing layer "${d}".`))):(this._order.splice(y,0,a),this._layerOrderChanged=!0)}removeLayer(a){this._checkLoaded();const d=this._layers[a];if(!d)return void this.fire(new l.ErrorEvent(new Error(`Cannot remove non-existing layer "${a}".`)));d.setEventedParent(null);const p=this._order.indexOf(a);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[a]=d,delete this._layers[a],this._serializedLayers&&delete this._serializedLayers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a],d.onRemove&&d.onRemove(this.map)}getLayer(a){return this._layers[a]}hasLayer(a){return a in this._layers}setLayerZoomRange(a,d,p){this._checkLoaded();const y=this.getLayer(a);y?y.minzoom===d&&y.maxzoom===p||(d!=null&&(y.minzoom=d),p!=null&&(y.maxzoom=p),this._updateLayer(y)):this.fire(new l.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${a}".`)))}setFilter(a,d,p={}){this._checkLoaded();const y=this.getLayer(a);if(y){if(!l.deepEqual(y.filter,d))return d==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(l.validateStyle.filter,`layers.${y.id}.filter`,d,null,p)||(y.filter=l.clone$1(d),this._updateLayer(y)))}else this.fire(new l.ErrorEvent(new Error(`Cannot filter non-existing layer "${a}".`)))}getFilter(a){return l.clone$1(this.getLayer(a).filter)}setLayoutProperty(a,d,p,y={}){this._checkLoaded();const b=this.getLayer(a);b?l.deepEqual(b.getLayoutProperty(d),p)||(b.setLayoutProperty(d,p,y),this._updateLayer(b)):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${a}".`)))}getLayoutProperty(a,d){const p=this.getLayer(a);if(p)return p.getLayoutProperty(d);this.fire(new l.ErrorEvent(new Error(`Cannot get style of non-existing layer "${a}".`)))}setPaintProperty(a,d,p,y={}){this._checkLoaded();const b=this.getLayer(a);b?l.deepEqual(b.getPaintProperty(d),p)||(b.setPaintProperty(d,p,y)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[a]=!0):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${a}".`)))}getPaintProperty(a,d){return this.getLayer(a).getPaintProperty(d)}setFeatureState(a,d){this._checkLoaded();const p=a.source,y=a.sourceLayer,b=this.sourceCaches[p];if(b===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const P=b.getSource().type;P==="geojson"&&y?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||y?(a.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),b.setFeatureState(y,a.id,d)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(a,d){this._checkLoaded();const p=a.source,y=this.sourceCaches[p];if(y===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const b=y.getSource().type,P=b==="vector"?a.sourceLayer:void 0;b!=="vector"||P?d&&typeof a.id!="string"&&typeof a.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(P,a.id,d):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(a){this._checkLoaded();const d=a.source,p=a.sourceLayer,y=this.sourceCaches[d];if(y!==void 0)return y.getSource().type!=="vector"||p?(a.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),y.getFeatureState(p,a.id)):void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const a=l.mapObject(this.sourceCaches,y=>y.serialize()),d=this._serializeByIds(this._order),p=this.stylesheet;return l.filterObject({version:p.version,name:p.name,metadata:p.metadata,light:p.light,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,sources:a,layers:d},y=>y!==void 0)}_updateLayer(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&this.sourceCaches[a.source].getSource().type!=="raster"&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(a){const d=P=>this._layers[P].type==="fill-extrusion",p={},y=[];for(let P=this._order.length-1;P>=0;P--){const C=this._order[P];if(d(C)){p[C]=P;for(const M of a){const O=M[C];if(O)for(const U of O)y.push(U)}}}y.sort((P,C)=>C.intersectionZ-P.intersectionZ);const b=[];for(let P=this._order.length-1;P>=0;P--){const C=this._order[P];if(d(C))for(let M=y.length-1;M>=0;M--){const O=y[M].feature;if(p[O.layer.id]<P)break;b.push(O),y.pop()}else for(const M of a){const O=M[C];if(O)for(const U of O)b.push(U.feature)}}return b}queryRenderedFeatures(a,d,p){d&&d.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",d.filter,null,d);const y={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const C of d.layers){const M=this._layers[C];if(!M)return this.fire(new l.ErrorEvent(new Error(`The layer '${C}' does not exist in the map's style and cannot be queried for features.`))),[];y[M.source]=!0}}const b=[];d.availableImages=this._availableImages;const P=this._serializedAllLayers();for(const C in this.sourceCaches)d.layers&&!y[C]||b.push(wn(this.sourceCaches[C],this._layers,P,a,d,p));return this.placement&&b.push(function(C,M,O,U,V,X,he){const ce={},pe=X.queryRenderedSymbols(U),ae=[];for(const Pe of Object.keys(pe).map(Number))ae.push(he[Pe]);ae.sort(vn);for(const Pe of ae){const Oe=Pe.featureIndex.lookupSymbolFeatures(pe[Pe.bucketInstanceId],M,Pe.bucketIndex,Pe.sourceLayerIndex,V.filter,V.layers,V.availableImages,C);for(const ge in Oe){const Ie=ce[ge]=ce[ge]||[],Ne=Oe[ge];Ne.sort((Ue,Ze)=>{const et=Pe.featureSortOrder;if(et){const Ke=et.indexOf(Ue.featureIndex);return et.indexOf(Ze.featureIndex)-Ke}return Ze.featureIndex-Ue.featureIndex});for(const Ue of Ne)Ie.push(Ue)}}for(const Pe in ce)ce[Pe].forEach(Oe=>{const ge=Oe.feature,Ie=O[C[Pe].source].getFeatureState(ge.layer["source-layer"],ge.id);ge.source=ge.layer.source,ge.layer["source-layer"]&&(ge.sourceLayer=ge.layer["source-layer"]),ge.state=Ie});return ce}(this._layers,P,this.sourceCaches,a,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(a,d){d&&d.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",d.filter,null,d);const p=this.sourceCaches[a];return p?function(y,b){const P=y.getRenderableIds().map(O=>y.getTileByID(O)),C=[],M={};for(let O=0;O<P.length;O++){const U=P[O],V=U.tileID.canonical.key;M[V]||(M[V]=!0,U.querySourceFeatures(C,b))}return C}(p,d):[]}addSourceType(a,d,p){return Lt(a)?p(new Error(`A source type called "${a}" already exists.`)):(((y,b)=>{$t[y]=b})(a,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:d.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(a,d={}){this._checkLoaded();const p=this.light.getLight();let y=!1;for(const P in a)if(!l.deepEqual(a[P],p[P])){y=!0;break}if(!y)return;const b={now:l.browser.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(a,d),this.light.updateTransitions(b)}_validate(a,d,p,y,b={}){return(!b||b.validate!==!1)&&ir(this,a.call(l.validateStyle,l.extend({key:d,style:this.serialize(),value:p,styleSpec:l.v8Spec},y)))}_remove(a=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const p=this.sourceCaches[d];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(a)}_clearSource(a){this.sourceCaches[a].clearTiles()}_reloadSource(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()}_updateSources(a){for(const d in this.sourceCaches)this.sourceCaches[d].update(a,this.map.terrain)}_generateCollisionBoxes(){for(const a in this.sourceCaches)this._reloadSource(a)}_updatePlacement(a,d,p,y,b=!1){let P=!1,C=!1;const M={};for(const O of this._order){const U=this._layers[O];if(U.type!=="symbol")continue;if(!M[U.source]){const X=this.sourceCaches[U.source];M[U.source]=X.getRenderableIds(!0).map(he=>X.getTileByID(he)).sort((he,ce)=>ce.tileID.overscaledZ-he.tileID.overscaledZ||(he.tileID.isLessThan(ce.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(U,M[U.source],a.center.lng);P=P||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((b=b||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.browser.now(),a.zoom))&&(this.pauseablePlacement=new Jr(a,this.map.terrain,this._order,b,d,p,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.browser.now()),C=!0),P&&this.pauseablePlacement.placement.setStale()),C||P)for(const O of this._order){const U=this._layers[O];U.type==="symbol"&&this.placement.updateLayerOpacities(U,M[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.browser.now())}_releaseSymbolFadeTiles(){for(const a in this.sourceCaches)this.sourceCaches[a].releaseSymbolFadeTiles()}getImages(a,d,p){this.imageManager.getImages(d.icons,p),this._updateTilesForChangedImages();const y=this.sourceCaches[d.source];y&&y.setDependencies(d.tileID.key,d.type,d.icons)}getGlyphs(a,d,p){this.glyphManager.getGlyphs(d.stacks,p);const y=this.sourceCaches[d.source];y&&y.setDependencies(d.tileID.key,d.type,[""])}getResource(a,d,p){return l.makeRequest(d,p)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(a,d={}){this._checkLoaded(),a&&this._validate(l.validateStyle.glyphs,"glyphs",a,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=a,this.glyphManager.entries={},this.glyphManager.setURL(a))}addSprite(a,d,p={},y){this._checkLoaded();const b=[{id:a,url:d}],P=[...be(this.stylesheet.sprite),...b];this._validate(l.validateStyle.sprite,"sprite",P,null,p)||(this.stylesheet.sprite=P,this._loadSprite(b,!0,y))}removeSprite(a){this._checkLoaded();const d=be(this.stylesheet.sprite);if(d.find(p=>p.id===a)){if(this._spritesImagesIds[a])for(const p of this._spritesImagesIds[a])this.imageManager.removeImage(p),this._changedImages[p]=!0;d.splice(d.findIndex(p=>p.id===a),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[a],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}else this.fire(new l.ErrorEvent(new Error(`Sprite "${a}" doesn't exists on this map.`)))}getSprite(){return be(this.stylesheet.sprite)}setSprite(a,d={},p){this._checkLoaded(),a&&this._validate(l.validateStyle.sprite,"sprite",a,null,d)||(this.stylesheet.sprite=a,a?this._loadSprite(a,!0,p):(this._unloadSprite(),p&&p(null)))}}Zn.registerForPluginStateChange=l.registerForPluginStateChange;var Bo=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),mo="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Jn={prelude:Dn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Dn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Dn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Dn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Dn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Dn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Dn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Dn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Dn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Dn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Dn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Dn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Dn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Dn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Dn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Dn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Dn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Dn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Dn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Dn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Dn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Dn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Dn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Dn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Dn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Dn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Dn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",mo),terrainDepth:Dn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",mo),terrainCoords:Dn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",mo)};function Dn(v,a){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=a.match(/attribute ([\w]+) ([\w]+)/g),y=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=b?b.concat(y):y,C={};return{fragmentSource:v=v.replace(d,(M,O,U,V,X)=>(C[X]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
varying ${U} ${V} ${X};
#else
uniform ${U} ${V} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${U} ${V} ${X} = u_${X};
#endif
`)),vertexSource:a=a.replace(d,(M,O,U,V,X)=>{const he=V==="float"?"vec2":"vec4",ce=X.match(/color/)?"color":he;return C[X]?O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${U} ${he} a_${X};
varying ${U} ${V} ${X};
#else
uniform ${U} ${V} u_${X};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${U} ${V} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${ce}(a_${X}, u_${X}_t);
#else
    ${U} ${V} ${X} = u_${X};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${U} ${he} a_${X};
#else
uniform ${U} ${V} u_${X};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${U} ${V} ${X} = a_${X};
#else
    ${U} ${V} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${U} ${V} ${X} = unpack_mix_${ce}(a_${X}, u_${X}_t);
#else
    ${U} ${V} ${X} = u_${X};
#endif
`}),staticAttributes:p,staticUniforms:P}}class js{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(a,d,p,y,b,P,C,M,O){this.context=a;let U=this.boundPaintVertexBuffers.length!==y.length;for(let V=0;!U&&V<y.length;V++)this.boundPaintVertexBuffers[V]!==y[V]&&(U=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==p||U||this.boundIndexBuffer!==b||this.boundVertexOffset!==P||this.boundDynamicVertexBuffer!==C||this.boundDynamicVertexBuffer2!==M||this.boundDynamicVertexBuffer3!==O?this.freshBind(d,p,y,b,P,C,M,O):(a.bindVertexArray.set(this.vao),C&&C.bind(),b&&b.dynamicDraw&&b.bind(),M&&M.bind(),O&&O.bind())}freshBind(a,d,p,y,b,P,C,M){const O=a.numAttributes,U=this.context,V=U.gl;this.vao&&this.destroy(),this.vao=U.createVertexArray(),U.bindVertexArray.set(this.vao),this.boundProgram=a,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=M,d.enableAttributes(V,a);for(const X of p)X.enableAttributes(V,a);P&&P.enableAttributes(V,a),C&&C.enableAttributes(V,a),M&&M.enableAttributes(V,a),d.bind(),d.setVertexAttribPointers(V,a,b);for(const X of p)X.bind(),X.setVertexAttribPointers(V,a,b);P&&(P.bind(),P.setVertexAttribPointers(V,a,b)),y&&y.bind(),C&&(C.bind(),C.setVertexAttribPointers(V,a,b)),M&&(M.bind(),M.setVertexAttribPointers(V,a,b)),U.currentNumAttributes=O}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Qn(v){const a=[];for(let d=0;d<v.length;d++){if(v[d]===null)continue;const p=v[d].split(" ");a.push(p.pop())}return a}class Gi{constructor(a,d,p,y,b,P){const C=a.gl;this.program=C.createProgram();const M=Qn(d.staticAttributes),O=p?p.getBinderAttributes():[],U=M.concat(O),V=Jn.prelude.staticUniforms?Qn(Jn.prelude.staticUniforms):[],X=d.staticUniforms?Qn(d.staticUniforms):[],he=p?p.getBinderUniforms():[],ce=V.concat(X).concat(he),pe=[];for(const Ue of ce)pe.indexOf(Ue)<0&&pe.push(Ue);const ae=p?p.defines():[];b&&ae.push("#define OVERDRAW_INSPECTOR;"),P&&ae.push("#define TERRAIN3D;");const Pe=ae.concat(Jn.prelude.fragmentSource,d.fragmentSource).join(`
`),Oe=ae.concat(Jn.prelude.vertexSource,d.vertexSource).join(`
`),ge=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(ge,Pe),C.compileShader(ge),!C.getShaderParameter(ge,C.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${C.getShaderInfoLog(ge)}`);C.attachShader(this.program,ge);const Ie=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(Ie,Oe),C.compileShader(Ie),!C.getShaderParameter(Ie,C.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${C.getShaderInfoLog(Ie)}`);C.attachShader(this.program,Ie),this.attributes={};const Ne={};this.numAttributes=U.length;for(let Ue=0;Ue<this.numAttributes;Ue++)U[Ue]&&(C.bindAttribLocation(this.program,Ue,U[Ue]),this.attributes[U[Ue]]=Ue);if(C.linkProgram(this.program),!C.getProgramParameter(this.program,C.LINK_STATUS))throw new Error(`Program failed to link: ${C.getProgramInfoLog(this.program)}`);C.deleteShader(Ie),C.deleteShader(ge);for(let Ue=0;Ue<pe.length;Ue++){const Ze=pe[Ue];if(Ze&&!Ne[Ze]){const et=C.getUniformLocation(this.program,Ze);et&&(Ne[Ze]=et)}}this.fixedUniforms=y(a,Ne),this.terrainUniforms=((Ue,Ze)=>({u_depth:new l.Uniform1i(Ue,Ze.u_depth),u_terrain:new l.Uniform1i(Ue,Ze.u_terrain),u_terrain_dim:new l.Uniform1f(Ue,Ze.u_terrain_dim),u_terrain_matrix:new l.UniformMatrix4f(Ue,Ze.u_terrain_matrix),u_terrain_unpack:new l.Uniform4f(Ue,Ze.u_terrain_unpack),u_terrain_exaggeration:new l.Uniform1f(Ue,Ze.u_terrain_exaggeration)}))(a,Ne),this.binderUniforms=p?p.getUniforms(a,Ne):[]}draw(a,d,p,y,b,P,C,M,O,U,V,X,he,ce,pe,ae,Pe,Oe){const ge=a.gl;if(this.failedToCreate)return;if(a.program.set(this.program),a.setDepthMode(p),a.setStencilMode(y),a.setColorMode(b),a.setCullFace(P),M){a.activeTexture.set(ge.TEXTURE2),ge.bindTexture(ge.TEXTURE_2D,M.depthTexture),a.activeTexture.set(ge.TEXTURE3),ge.bindTexture(ge.TEXTURE_2D,M.texture);for(const Ne in this.terrainUniforms)this.terrainUniforms[Ne].set(M[Ne])}for(const Ne in this.fixedUniforms)this.fixedUniforms[Ne].set(C[Ne]);pe&&pe.setUniforms(a,this.binderUniforms,he,{zoom:ce});let Ie=0;switch(d){case ge.LINES:Ie=2;break;case ge.TRIANGLES:Ie=3;break;case ge.LINE_STRIP:Ie=1}for(const Ne of X.get()){const Ue=Ne.vaos||(Ne.vaos={});(Ue[O]||(Ue[O]=new js)).bind(a,this,U,pe?pe.getPaintVertexBuffers():[],V,Ne.vertexOffset,ae,Pe,Oe),ge.drawElements(d,Ne.primitiveLength*Ie,ge.UNSIGNED_SHORT,Ne.primitiveOffset*Ie*2)}}}function Wi(v,a,d){const p=1/Se(d,1,a.transform.tileZoom),y=Math.pow(2,d.tileID.overscaledZ),b=d.tileSize*Math.pow(2,a.transform.tileZoom)/y,P=b*(d.tileID.canonical.x+d.tileID.wrap*y),C=b*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[p,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[P>>16,C>>16],u_pixel_coord_lower:[65535&P,65535&C]}}const El=(v,a,d,p)=>{const y=a.style.light,b=y.properties.get("position"),P=[b.x,b.y,b.z],C=function(){var O=new l.ARRAY_TYPE(9);return l.ARRAY_TYPE!=Float32Array&&(O[1]=0,O[2]=0,O[3]=0,O[5]=0,O[6]=0,O[7]=0),O[0]=1,O[4]=1,O[8]=1,O}();y.properties.get("anchor")==="viewport"&&function(O,U){var V=Math.sin(U),X=Math.cos(U);O[0]=X,O[1]=V,O[2]=0,O[3]=-V,O[4]=X,O[5]=0,O[6]=0,O[7]=0,O[8]=1}(C,-a.transform.angle),function(O,U,V){var X=U[0],he=U[1],ce=U[2];O[0]=X*V[0]+he*V[3]+ce*V[6],O[1]=X*V[1]+he*V[4]+ce*V[7],O[2]=X*V[2]+he*V[5]+ce*V[8]}(P,P,C);const M=y.properties.get("color");return{u_matrix:v,u_lightpos:P,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[M.r,M.g,M.b],u_vertical_gradient:+d,u_opacity:p}},Ps=(v,a,d,p,y,b,P)=>l.extend(El(v,a,d,p),Wi(b,a,P),{u_height_factor:-Math.pow(2,y.overscaledZ)/P.tileSize/8}),Ic=v=>({u_matrix:v}),Mc=(v,a,d,p)=>l.extend(Ic(v),Wi(d,a,p)),Tl=(v,a)=>({u_matrix:v,u_world:a}),te=(v,a,d,p,y)=>l.extend(Mc(v,a,d,p),{u_world:y}),oe=(v,a,d,p)=>{const y=v.transform;let b,P;if(p.paint.get("circle-pitch-alignment")==="map"){const C=Se(d,1,y.zoom);b=!0,P=[C,C]}else b=!1,P=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:v.translatePosMatrix(a.posMatrix,d,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+b,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:P}},we=(v,a,d)=>{const p=Se(d,1,a.zoom),y=Math.pow(2,a.zoom-d.tileID.overscaledZ),b=d.tileID.overscaleFactor();return{u_matrix:v,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[a.pixelsToGLUnits[0]/(p*y),a.pixelsToGLUnits[1]/(p*y)],u_overscale_factor:b}},Be=(v,a,d=1)=>({u_matrix:v,u_color:a,u_overlay:0,u_overlay_scale:d}),st=v=>({u_matrix:v}),Bt=(v,a,d,p)=>({u_matrix:v,u_extrude_scale:Se(a,1,d),u_intensity:p});function Sn(v,a){const d=Math.pow(2,a.canonical.z),p=a.canonical.y;return[new l.MercatorCoordinate(0,p/d).toLngLat().lat,new l.MercatorCoordinate(0,(p+1)/d).toLngLat().lat]}const Ir=(v,a,d,p)=>{const y=v.transform;return{u_matrix:Nu(v,a,d,p),u_ratio:1/Se(a,1,y.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},jr=(v,a,d,p,y)=>l.extend(Ir(v,a,d,y),{u_image:0,u_image_height:p}),di=(v,a,d,p,y)=>{const b=v.transform,P=Jm(a,b);return{u_matrix:Nu(v,a,d,y),u_texsize:a.imageAtlasTexture.size,u_ratio:1/Se(a,1,b.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[P,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},cs=(v,a,d,p,y,b)=>{const P=v.lineAtlas,C=Jm(a,v.transform),M=d.layout.get("line-cap")==="round",O=P.getDash(p.from,M),U=P.getDash(p.to,M),V=O.width*y.fromScale,X=U.width*y.toScale;return l.extend(Ir(v,a,d,b),{u_patternscale_a:[C/V,-O.height/2],u_patternscale_b:[C/X,-U.height/2],u_sdfgamma:P.width/(256*Math.min(V,X)*v.pixelRatio)/2,u_image:0,u_tex_y_a:O.y,u_tex_y_b:U.y,u_mix:y.t})};function Jm(v,a){return 1/Se(v,1,a.tileZoom)}function Nu(v,a,d,p){return v.translatePosMatrix(p?p.posMatrix:a.tileID.posMatrix,a,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const Qm=(v,a,d,p,y)=>{return{u_matrix:v,u_tl_parent:a,u_scale_parent:d,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(P=y.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(b=y.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:eg(y.paint.get("raster-hue-rotate"))};var b,P};function eg(v){v*=Math.PI/180;const a=Math.sin(v),d=Math.cos(v);return[(2*d+1)/3,(-Math.sqrt(3)*a-d+1)/3,(Math.sqrt(3)*a-d+1)/3]}const Hd=(v,a,d,p,y,b,P,C,M,O)=>{const U=y.transform;return{u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:U.cameraToCenterDistance,u_pitch:U.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:U.width/U.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:P,u_coord_matrix:C,u_is_text:+M,u_pitch_with_map:+p,u_texsize:O,u_texture:0}},qd=(v,a,d,p,y,b,P,C,M,O,U)=>{const V=y.transform;return l.extend(Hd(v,a,d,p,y,b,P,C,M,O),{u_gamma_scale:p?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:+U})},Na=(v,a,d,p,y,b,P,C,M,O)=>l.extend(qd(v,a,d,p,y,b,P,C,!0,M,!0),{u_texsize_icon:O,u_texture_icon:1}),Bu=(v,a,d)=>({u_matrix:v,u_opacity:a,u_color:d}),Cs=(v,a,d,p,y,b)=>l.extend(function(P,C,M,O){const U=M.imageManager.getPattern(P.from.toString()),V=M.imageManager.getPattern(P.to.toString()),{width:X,height:he}=M.imageManager.getPixelSize(),ce=Math.pow(2,O.tileID.overscaledZ),pe=O.tileSize*Math.pow(2,M.transform.tileZoom)/ce,ae=pe*(O.tileID.canonical.x+O.tileID.wrap*ce),Pe=pe*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:U.tl,u_pattern_br_a:U.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[X,he],u_mix:C.t,u_pattern_size_a:U.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/Se(O,1,M.transform.tileZoom),u_pixel_coord_upper:[ae>>16,Pe>>16],u_pixel_coord_lower:[65535&ae,65535&Pe]}}(p,b,d,y),{u_matrix:v,u_opacity:a}),Uu={fillExtrusion:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_lightpos:new l.Uniform3f(v,a.u_lightpos),u_lightintensity:new l.Uniform1f(v,a.u_lightintensity),u_lightcolor:new l.Uniform3f(v,a.u_lightcolor),u_vertical_gradient:new l.Uniform1f(v,a.u_vertical_gradient),u_opacity:new l.Uniform1f(v,a.u_opacity)}),fillExtrusionPattern:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_lightpos:new l.Uniform3f(v,a.u_lightpos),u_lightintensity:new l.Uniform1f(v,a.u_lightintensity),u_lightcolor:new l.Uniform3f(v,a.u_lightcolor),u_vertical_gradient:new l.Uniform1f(v,a.u_vertical_gradient),u_height_factor:new l.Uniform1f(v,a.u_height_factor),u_image:new l.Uniform1i(v,a.u_image),u_texsize:new l.Uniform2f(v,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(v,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(v,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(v,a.u_scale),u_fade:new l.Uniform1f(v,a.u_fade),u_opacity:new l.Uniform1f(v,a.u_opacity)}),fill:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix)}),fillPattern:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_image:new l.Uniform1i(v,a.u_image),u_texsize:new l.Uniform2f(v,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(v,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(v,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(v,a.u_scale),u_fade:new l.Uniform1f(v,a.u_fade)}),fillOutline:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_world:new l.Uniform2f(v,a.u_world)}),fillOutlinePattern:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_world:new l.Uniform2f(v,a.u_world),u_image:new l.Uniform1i(v,a.u_image),u_texsize:new l.Uniform2f(v,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(v,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(v,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(v,a.u_scale),u_fade:new l.Uniform1f(v,a.u_fade)}),circle:(v,a)=>({u_camera_to_center_distance:new l.Uniform1f(v,a.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(v,a.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(v,a.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(v,a.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(v,a.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(v,a.u_matrix)}),collisionBox:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_camera_to_center_distance:new l.Uniform1f(v,a.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(v,a.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(v,a.u_extrude_scale),u_overscale_factor:new l.Uniform1f(v,a.u_overscale_factor)}),collisionCircle:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_inv_matrix:new l.UniformMatrix4f(v,a.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(v,a.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(v,a.u_viewport_size)}),debug:(v,a)=>({u_color:new l.UniformColor(v,a.u_color),u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_overlay:new l.Uniform1i(v,a.u_overlay),u_overlay_scale:new l.Uniform1f(v,a.u_overlay_scale)}),clippingMask:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix)}),heatmap:(v,a)=>({u_extrude_scale:new l.Uniform1f(v,a.u_extrude_scale),u_intensity:new l.Uniform1f(v,a.u_intensity),u_matrix:new l.UniformMatrix4f(v,a.u_matrix)}),heatmapTexture:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_world:new l.Uniform2f(v,a.u_world),u_image:new l.Uniform1i(v,a.u_image),u_color_ramp:new l.Uniform1i(v,a.u_color_ramp),u_opacity:new l.Uniform1f(v,a.u_opacity)}),hillshade:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_image:new l.Uniform1i(v,a.u_image),u_latrange:new l.Uniform2f(v,a.u_latrange),u_light:new l.Uniform2f(v,a.u_light),u_shadow:new l.UniformColor(v,a.u_shadow),u_highlight:new l.UniformColor(v,a.u_highlight),u_accent:new l.UniformColor(v,a.u_accent)}),hillshadePrepare:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_image:new l.Uniform1i(v,a.u_image),u_dimension:new l.Uniform2f(v,a.u_dimension),u_zoom:new l.Uniform1f(v,a.u_zoom),u_unpack:new l.Uniform4f(v,a.u_unpack)}),line:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_ratio:new l.Uniform1f(v,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(v,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(v,a.u_units_to_pixels)}),lineGradient:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_ratio:new l.Uniform1f(v,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(v,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(v,a.u_units_to_pixels),u_image:new l.Uniform1i(v,a.u_image),u_image_height:new l.Uniform1f(v,a.u_image_height)}),linePattern:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_texsize:new l.Uniform2f(v,a.u_texsize),u_ratio:new l.Uniform1f(v,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(v,a.u_device_pixel_ratio),u_image:new l.Uniform1i(v,a.u_image),u_units_to_pixels:new l.Uniform2f(v,a.u_units_to_pixels),u_scale:new l.Uniform3f(v,a.u_scale),u_fade:new l.Uniform1f(v,a.u_fade)}),lineSDF:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_ratio:new l.Uniform1f(v,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(v,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(v,a.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(v,a.u_patternscale_a),u_patternscale_b:new l.Uniform2f(v,a.u_patternscale_b),u_sdfgamma:new l.Uniform1f(v,a.u_sdfgamma),u_image:new l.Uniform1i(v,a.u_image),u_tex_y_a:new l.Uniform1f(v,a.u_tex_y_a),u_tex_y_b:new l.Uniform1f(v,a.u_tex_y_b),u_mix:new l.Uniform1f(v,a.u_mix)}),raster:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_tl_parent:new l.Uniform2f(v,a.u_tl_parent),u_scale_parent:new l.Uniform1f(v,a.u_scale_parent),u_buffer_scale:new l.Uniform1f(v,a.u_buffer_scale),u_fade_t:new l.Uniform1f(v,a.u_fade_t),u_opacity:new l.Uniform1f(v,a.u_opacity),u_image0:new l.Uniform1i(v,a.u_image0),u_image1:new l.Uniform1i(v,a.u_image1),u_brightness_low:new l.Uniform1f(v,a.u_brightness_low),u_brightness_high:new l.Uniform1f(v,a.u_brightness_high),u_saturation_factor:new l.Uniform1f(v,a.u_saturation_factor),u_contrast_factor:new l.Uniform1f(v,a.u_contrast_factor),u_spin_weights:new l.Uniform3f(v,a.u_spin_weights)}),symbolIcon:(v,a)=>({u_is_size_zoom_constant:new l.Uniform1i(v,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(v,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(v,a.u_size_t),u_size:new l.Uniform1f(v,a.u_size),u_camera_to_center_distance:new l.Uniform1f(v,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(v,a.u_pitch),u_rotate_symbol:new l.Uniform1i(v,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(v,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(v,a.u_fade_change),u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(v,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(v,a.u_coord_matrix),u_is_text:new l.Uniform1i(v,a.u_is_text),u_pitch_with_map:new l.Uniform1i(v,a.u_pitch_with_map),u_texsize:new l.Uniform2f(v,a.u_texsize),u_texture:new l.Uniform1i(v,a.u_texture)}),symbolSDF:(v,a)=>({u_is_size_zoom_constant:new l.Uniform1i(v,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(v,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(v,a.u_size_t),u_size:new l.Uniform1f(v,a.u_size),u_camera_to_center_distance:new l.Uniform1f(v,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(v,a.u_pitch),u_rotate_symbol:new l.Uniform1i(v,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(v,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(v,a.u_fade_change),u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(v,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(v,a.u_coord_matrix),u_is_text:new l.Uniform1i(v,a.u_is_text),u_pitch_with_map:new l.Uniform1i(v,a.u_pitch_with_map),u_texsize:new l.Uniform2f(v,a.u_texsize),u_texture:new l.Uniform1i(v,a.u_texture),u_gamma_scale:new l.Uniform1f(v,a.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(v,a.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(v,a.u_is_halo)}),symbolTextAndIcon:(v,a)=>({u_is_size_zoom_constant:new l.Uniform1i(v,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(v,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(v,a.u_size_t),u_size:new l.Uniform1f(v,a.u_size),u_camera_to_center_distance:new l.Uniform1f(v,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(v,a.u_pitch),u_rotate_symbol:new l.Uniform1i(v,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(v,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(v,a.u_fade_change),u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(v,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(v,a.u_coord_matrix),u_is_text:new l.Uniform1i(v,a.u_is_text),u_pitch_with_map:new l.Uniform1i(v,a.u_pitch_with_map),u_texsize:new l.Uniform2f(v,a.u_texsize),u_texsize_icon:new l.Uniform2f(v,a.u_texsize_icon),u_texture:new l.Uniform1i(v,a.u_texture),u_texture_icon:new l.Uniform1i(v,a.u_texture_icon),u_gamma_scale:new l.Uniform1f(v,a.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(v,a.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(v,a.u_is_halo)}),background:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_opacity:new l.Uniform1f(v,a.u_opacity),u_color:new l.UniformColor(v,a.u_color)}),backgroundPattern:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_opacity:new l.Uniform1f(v,a.u_opacity),u_image:new l.Uniform1i(v,a.u_image),u_pattern_tl_a:new l.Uniform2f(v,a.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(v,a.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(v,a.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(v,a.u_pattern_br_b),u_texsize:new l.Uniform2f(v,a.u_texsize),u_mix:new l.Uniform1f(v,a.u_mix),u_pattern_size_a:new l.Uniform2f(v,a.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(v,a.u_pattern_size_b),u_scale_a:new l.Uniform1f(v,a.u_scale_a),u_scale_b:new l.Uniform1f(v,a.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(v,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(v,a.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(v,a.u_tile_units_to_pixels)}),terrain:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_texture:new l.Uniform1i(v,a.u_texture),u_ele_delta:new l.Uniform1f(v,a.u_ele_delta)}),terrainDepth:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_ele_delta:new l.Uniform1f(v,a.u_ele_delta)}),terrainCoords:(v,a)=>({u_matrix:new l.UniformMatrix4f(v,a.u_matrix),u_texture:new l.Uniform1i(v,a.u_texture),u_terrain_coords_id:new l.Uniform1f(v,a.u_terrain_coords_id),u_ele_delta:new l.Uniform1f(v,a.u_ele_delta)})};class Vu{constructor(a,d,p){this.context=a;const y=a.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const kc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ju{constructor(a,d,p,y){this.length=d.length,this.attributes=p,this.itemSize=d.bytesPerElement,this.dynamicDraw=y,this.context=a;const b=a.gl;this.buffer=b.createBuffer(),a.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){if(a.length!==this.length)throw new Error(`Length of new data is ${a.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,d){for(let p=0;p<this.attributes.length;p++){const y=d.attributes[this.attributes[p].name];y!==void 0&&a.enableVertexAttribArray(y)}}setVertexAttribPointers(a,d,p){for(let y=0;y<this.attributes.length;y++){const b=this.attributes[y],P=d.attributes[b.name];P!==void 0&&a.vertexAttribPointer(P,b.components,a[kc[b.type]],!1,this.itemSize,b.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Sl=new WeakMap;function ha(v){if(Sl.has(v))return Sl.get(v);{const a=v.getParameter(v.VERSION).startsWith("WebGL 2.0");return Sl.set(v,a),a}}class Rn{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class $u extends Rn{getDefault(){return l.Color.transparent}set(a){const d=this.current;(a.r!==d.r||a.g!==d.g||a.b!==d.b||a.a!==d.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class us extends Rn{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class hs extends Rn{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class Zd extends Rn{getDefault(){return[!0,!0,!0,!0]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||a[3]!==d[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class Gu extends Rn{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class Wu extends Rn{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class Xd extends Rn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const d=this.current;(a.func!==d.func||a.ref!==d.ref||a.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class Yd extends Rn{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class Hu extends Rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=a,this.dirty=!1}}class Kd extends Rn{getDefault(){return[0,1]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class Jd extends Rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=a,this.dirty=!1}}class qu extends Rn{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class tg extends Rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.BLEND):d.disable(d.BLEND),this.current=a,this.dirty=!1}}class ng extends Rn{getDefault(){const a=this.gl;return[a.ONE,a.ZERO]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)}}class Pl extends Rn{getDefault(){return l.Color.transparent}set(a){const d=this.current;(a.r!==d.r||a.g!==d.g||a.b!==d.b||a.a!==d.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Fv extends Rn{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)}}class Nv extends Rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=a,this.dirty=!1}}class Bv extends Rn{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class Uv extends Rn{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}class Vv extends Rn{getDefault(){return null}set(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)}}class jv extends Rn{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class Qd extends Rn{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||a[3]!==d[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class Zu extends Rn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class ef extends Rn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class tf extends Rn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class Cl extends Rn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class rg extends Rn{getDefault(){return null}set(a){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class ig extends Rn{getDefault(){return null}set(a){var d;if(a===this.current&&!this.dirty)return;const p=this.gl;ha(p)?p.bindVertexArray(a):(d=p.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(a),this.current=a,this.dirty=!1}}class nf extends Rn{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class Ba extends Rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class sg extends Rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class da extends Rn{constructor(a,d){super(a),this.context=a,this.parent=d}getDefault(){return null}}class Al extends da{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class og extends da{set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class rf extends da{set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class $n{constructor(a,d,p,y,b){this.context=a,this.width=d,this.height=p;const P=a.gl,C=this.framebuffer=P.createFramebuffer();if(this.colorAttachment=new Al(a,C),y)this.depthAttachment=b?new rf(a,C):new og(a,C);else if(b)throw new Error("Stencil cannot be setted without depth");if(P.checkFramebufferStatus(P.FRAMEBUFFER)!==P.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const a=this.context.gl,d=this.colorAttachment.get();if(d&&a.deleteTexture(d),this.depthAttachment){const p=this.depthAttachment.get();p&&a.deleteRenderbuffer(p)}a.deleteFramebuffer(this.framebuffer)}}class mr{constructor(a,d,p){this.blendFunction=a,this.blendColor=d,this.mask=p}}mr.Replace=[1,0],mr.disabled=new mr(mr.Replace,l.Color.transparent,[!1,!1,!1,!1]),mr.unblended=new mr(mr.Replace,l.Color.transparent,[!0,!0,!0,!0]),mr.alphaBlended=new mr([1,771],l.Color.transparent,[!0,!0,!0,!0]);class $v{constructor(a){var d,p;if(this.gl=a,this.clearColor=new $u(this),this.clearDepth=new us(this),this.clearStencil=new hs(this),this.colorMask=new Zd(this),this.depthMask=new Gu(this),this.stencilMask=new Wu(this),this.stencilFunc=new Xd(this),this.stencilOp=new Yd(this),this.stencilTest=new Hu(this),this.depthRange=new Kd(this),this.depthTest=new Jd(this),this.depthFunc=new qu(this),this.blend=new tg(this),this.blendFunc=new ng(this),this.blendColor=new Pl(this),this.blendEquation=new Fv(this),this.cullFace=new Nv(this),this.cullFaceSide=new Bv(this),this.frontFace=new Uv(this),this.program=new Vv(this),this.activeTexture=new jv(this),this.viewport=new Qd(this),this.bindFramebuffer=new Zu(this),this.bindRenderbuffer=new ef(this),this.bindTexture=new tf(this),this.bindVertexBuffer=new Cl(this),this.bindElementBuffer=new rg(this),this.bindVertexArray=new ig(this),this.pixelStoreUnpack=new nf(this),this.pixelStoreUnpackPremultiplyAlpha=new Ba(this),this.pixelStoreUnpackFlipY=new sg(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE),ha(a)){this.HALF_FLOAT=a.HALF_FLOAT;const y=a.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=a.RGBA16F)!==null&&d!==void 0?d:y==null?void 0:y.RGBA16F_EXT,this.RGB16F=(p=a.RGB16F)!==null&&p!==void 0?p:y==null?void 0:y.RGB16F_EXT,a.getExtension("EXT_color_buffer_float")}else{a.getExtension("EXT_color_buffer_half_float"),a.getExtension("OES_texture_half_float_linear");const y=a.getExtension("OES_texture_half_float");this.HALF_FLOAT=y==null?void 0:y.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,d){return new Vu(this,a,d)}createVertexBuffer(a,d,p){return new ju(this,a,d,p)}createRenderbuffer(a,d,p){const y=this.gl,b=y.createRenderbuffer();return this.bindRenderbuffer.set(b),y.renderbufferStorage(y.RENDERBUFFER,a,d,p),this.bindRenderbuffer.set(null),b}createFramebuffer(a,d,p,y){return new $n(this,a,d,p,y)}clear({color:a,depth:d,stencil:p}){const y=this.gl;let b=0;a&&(b|=y.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(b|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),p!==void 0&&(b|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),y.clear(b)}setCullFace(a){a.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){l.deepEqual(a.blendFunction,mr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)}createVertexArray(){var a;return ha(this.gl)?this.gl.createVertexArray():(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.createVertexArrayOES()}deleteVertexArray(a){var d;return ha(this.gl)?this.gl.deleteVertexArray(a):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(a)}unbindVAO(){this.bindVertexArray.set(null)}}class On{constructor(a,d,p){this.func=a,this.mask=d,this.range=p}}On.ReadOnly=!1,On.ReadWrite=!0,On.disabled=new On(519,On.ReadOnly,[0,1]);const Ua=7680;class gr{constructor(a,d,p,y,b,P){this.test=a,this.ref=d,this.mask=p,this.fail=y,this.depthFail=b,this.pass=P}}gr.disabled=new gr({func:519,mask:0},0,0,Ua,Ua,Ua);class fr{constructor(a,d,p){this.enable=a,this.mode=d,this.frontFace=p}}let Lc;function ag(v,a,d,p,y,b,P){const C=v.context,M=C.gl,O=v.useProgram("collisionBox"),U=[];let V=0,X=0;for(let ge=0;ge<p.length;ge++){const Ie=p[ge],Ne=a.getTile(Ie),Ue=Ne.getBucket(d);if(!Ue)continue;let Ze=Ie.posMatrix;y[0]===0&&y[1]===0||(Ze=v.translatePosMatrix(Ie.posMatrix,Ne,y,b));const et=P?Ue.textCollisionBox:Ue.iconCollisionBox,Ke=Ue.collisionCircleArray;if(Ke.length>0){const at=l.create(),Vt=Ze;l.mul(at,Ue.placementInvProjMatrix,v.transform.glCoordMatrix),l.mul(at,at,Ue.placementViewportMatrix),U.push({circleArray:Ke,circleOffset:X,transform:Vt,invTransform:at,coord:Ie}),V+=Ke.length/4,X=V}et&&O.draw(C,M.LINES,On.disabled,gr.disabled,v.colorModeForRenderPass(),fr.disabled,we(Ze,v.transform,Ne),v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ie),d.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,null,v.transform.zoom,null,null,et.collisionVertexBuffer)}if(!P||!U.length)return;const he=v.useProgram("collisionCircle"),ce=new l.CollisionCircleLayoutArray;ce.resize(4*V),ce._trim();let pe=0;for(const ge of U)for(let Ie=0;Ie<ge.circleArray.length/4;Ie++){const Ne=4*Ie,Ue=ge.circleArray[Ne+0],Ze=ge.circleArray[Ne+1],et=ge.circleArray[Ne+2],Ke=ge.circleArray[Ne+3];ce.emplace(pe++,Ue,Ze,et,Ke,0),ce.emplace(pe++,Ue,Ze,et,Ke,1),ce.emplace(pe++,Ue,Ze,et,Ke,2),ce.emplace(pe++,Ue,Ze,et,Ke,3)}(!Lc||Lc.length<2*V)&&(Lc=function(ge){const Ie=2*ge,Ne=new l.QuadTriangleArray;Ne.resize(Ie),Ne._trim();for(let Ue=0;Ue<Ie;Ue++){const Ze=6*Ue;Ne.uint16[Ze+0]=4*Ue+0,Ne.uint16[Ze+1]=4*Ue+1,Ne.uint16[Ze+2]=4*Ue+2,Ne.uint16[Ze+3]=4*Ue+2,Ne.uint16[Ze+4]=4*Ue+3,Ne.uint16[Ze+5]=4*Ue+0}return Ne}(V));const ae=C.createIndexBuffer(Lc,!0),Pe=C.createVertexBuffer(ce,l.collisionCircleLayout.members,!0);for(const ge of U){const Ie={u_matrix:ge.transform,u_inv_matrix:ge.invTransform,u_camera_to_center_distance:(Oe=v.transform).cameraToCenterDistance,u_viewport_size:[Oe.width,Oe.height]};he.draw(C,M.TRIANGLES,On.disabled,gr.disabled,v.colorModeForRenderPass(),fr.disabled,Ie,v.style.map.terrain&&v.style.map.terrain.getTerrainData(ge.coord),d.id,Pe,ae,l.SegmentVector.simpleSegment(0,2*ge.circleOffset,ge.circleArray.length,ge.circleArray.length/2),null,v.transform.zoom,null,null,null)}var Oe;Pe.destroy(),ae.destroy()}fr.disabled=new fr(!1,1029,2305),fr.backCCW=new fr(!0,1029,2305);const sf=l.identity(new Float32Array(16));function Xu(v,a,d,p,y,b){const{horizontalAlign:P,verticalAlign:C}=l.getAnchorAlignment(v);return new l.Point((-(P-.5)*a/y+p[0])*b,(-(C-.5)*d/y+p[1])*b)}function Yu(v,a,d,p,y,b,P,C,M,O,U){const V=v.text.placedSymbolArray,X=v.text.dynamicLayoutVertexArray,he=v.icon.dynamicLayoutVertexArray,ce={};X.clear();for(let pe=0;pe<V.length;pe++){const ae=V.get(pe),Pe=ae.hidden||!ae.crossTileID||v.allowVerticalPlacement&&!ae.placedOrientation?null:p[ae.crossTileID];if(Pe){const Oe=new l.Point(ae.anchorX,ae.anchorY),ge=Zt(Oe,d?P:b,U),Ie=Ln(y.cameraToCenterDistance,ge.signedDistanceFromCamera);let Ne=l.evaluateSizeForFeature(v.textSizeData,M,ae)*Ie/l.ONE_EM;d&&(Ne*=v.tilePixelRatio/C);const{width:Ue,height:Ze,anchor:et,textOffset:Ke,textBoxScale:at}=Pe,Vt=Xu(et,Ue,Ze,Ke,at,Ne),An=d?Zt(Oe.add(Vt),b,U).point:ge.point.add(a?Vt.rotate(-y.angle):Vt),yt=v.allowVerticalPlacement&&ae.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let an=0;an<ae.numGlyphs;an++)l.addDynamicAttributes(X,An,yt);O&&ae.associatedIconIndex>=0&&(ce[ae.associatedIconIndex]={shiftedAnchor:An,angle:yt})}else Z(ae.numGlyphs,X)}if(O){he.clear();const pe=v.icon.placedSymbolArray;for(let ae=0;ae<pe.length;ae++){const Pe=pe.get(ae);if(Pe.hidden)Z(Pe.numGlyphs,he);else{const Oe=ce[ae];if(Oe)for(let ge=0;ge<Pe.numGlyphs;ge++)l.addDynamicAttributes(he,Oe.shiftedAnchor,Oe.angle);else Z(Pe.numGlyphs,he)}}v.icon.dynamicLayoutVertexBuffer.updateData(he)}v.text.dynamicLayoutVertexBuffer.updateData(X)}function of(v,a,d){return d.iconsInText&&a?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function Ku(v,a,d,p,y,b,P,C,M,O,U,V){const X=v.context,he=X.gl,ce=v.transform,pe=C==="map",ae=M==="map",Pe=C!=="viewport"&&d.layout.get("symbol-placement")!=="point",Oe=pe&&!ae&&!Pe,ge=!d.layout.get("symbol-sort-key").isConstant();let Ie=!1;const Ne=v.depthModeForSublayer(0,On.ReadOnly),Ue=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ze=[];for(const et of p){const Ke=a.getTile(et),at=Ke.getBucket(d);if(!at)continue;const Vt=y?at.text:at.icon;if(!Vt||!Vt.segments.get().length||!Vt.hasVisibleVertices)continue;const An=Vt.programConfigurations.get(d.id),yt=y||at.sdfIcons,an=y?at.textSizeData:at.iconSizeData,Gt=ae||ce.pitch!==0,Hn=v.useProgram(of(yt,y,at),An),Pn=l.evaluateSizeForZoom(an,ce.zoom),_n=v.style.map.terrain&&v.style.map.terrain.getTerrainData(et);let In,Mr,tr,fi,Qr=[0,0],Dr=null;if(y)Mr=Ke.glyphAtlasTexture,tr=he.LINEAR,In=Ke.glyphAtlasTexture.size,at.iconsInText&&(Qr=Ke.imageAtlasTexture.size,Dr=Ke.imageAtlasTexture,fi=Gt||v.options.rotating||v.options.zooming||an.kind==="composite"||an.kind==="camera"?he.LINEAR:he.NEAREST);else{const kr=d.layout.get("icon-size").constantOr(0)!==1||at.iconsNeedLinear;Mr=Ke.imageAtlasTexture,tr=yt||v.options.rotating||v.options.zooming||kr||Gt?he.LINEAR:he.NEAREST,In=Ke.imageAtlasTexture.size}const ps=Se(Ke,1,v.transform.zoom),or=He(et.posMatrix,ae,pe,v.transform,ps),yo=mt(et.posMatrix,ae,pe,v.transform,ps),_o=Ue&&at.hasTextData(),ma=d.layout.get("icon-text-fit")!=="none"&&_o&&at.hasIconData();if(Pe){const kr=v.style.map.terrain?(Zi,Lr)=>v.style.map.terrain.getElevation(et,Zi,Lr):null,ei=d.layout.get("text-rotation-alignment")==="map";it(at,et.posMatrix,v,y,or,yo,ae,O,ei,kr)}const Wa=v.translatePosMatrix(et.posMatrix,Ke,b,P),zl=Pe||y&&Ue||ma?sf:or,wi=v.translatePosMatrix(yo,Ke,b,P,!0),pi=yt&&d.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ri;Ri=yt?at.iconsInText?Na(an.kind,Pn,Oe,ae,v,Wa,zl,wi,In,Qr):qd(an.kind,Pn,Oe,ae,v,Wa,zl,wi,y,In,!0):Hd(an.kind,Pn,Oe,ae,v,Wa,zl,wi,y,In);const Ha={program:Hn,buffers:Vt,uniformValues:Ri,atlasTexture:Mr,atlasTextureIcon:Dr,atlasInterpolation:tr,atlasInterpolationIcon:fi,isSDF:yt,hasHalo:pi};if(ge&&at.canOverlap){Ie=!0;const kr=Vt.segments.get();for(const ei of kr)Ze.push({segments:new l.SegmentVector([ei]),sortKey:ei.sortKey,state:Ha,terrainData:_n})}else Ze.push({segments:Vt.segments,sortKey:0,state:Ha,terrainData:_n})}Ie&&Ze.sort((et,Ke)=>et.sortKey-Ke.sortKey);for(const et of Ze){const Ke=et.state;if(X.activeTexture.set(he.TEXTURE0),Ke.atlasTexture.bind(Ke.atlasInterpolation,he.CLAMP_TO_EDGE),Ke.atlasTextureIcon&&(X.activeTexture.set(he.TEXTURE1),Ke.atlasTextureIcon&&Ke.atlasTextureIcon.bind(Ke.atlasInterpolationIcon,he.CLAMP_TO_EDGE)),Ke.isSDF){const at=Ke.uniformValues;Ke.hasHalo&&(at.u_is_halo=1,af(Ke.buffers,et.segments,d,v,Ke.program,Ne,U,V,at,et.terrainData)),at.u_is_halo=0}af(Ke.buffers,et.segments,d,v,Ke.program,Ne,U,V,Ke.uniformValues,et.terrainData)}}function af(v,a,d,p,y,b,P,C,M,O){const U=p.context;y.draw(U,U.gl.TRIANGLES,b,P,C,fr.disabled,M,O,d.id,v.layoutVertexBuffer,v.indexBuffer,a,d.paint,p.transform.zoom,v.programConfigurations.get(d.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function Rc(v,a,d,p,y){if(!d||!p||!p.imageAtlas)return;const b=p.imageAtlas.patternPositions;let P=b[d.to.toString()],C=b[d.from.toString()];if(!P||!C){const M=y.getPaintProperty(a);P=b[M],C=b[M]}P&&C&&v.setConstantPatternPositions(P,C)}function Oc(v,a,d,p,y,b,P){const C=v.context.gl,M="fill-pattern",O=d.paint.get(M),U=O&&O.constantOr(1),V=d.getCrossfadeParameters();let X,he,ce,pe,ae;P?(he=U&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=C.LINES):(he=U?"fillPattern":"fill",X=C.TRIANGLES);const Pe=O.constantOr(null);for(const Oe of p){const ge=a.getTile(Oe);if(U&&!ge.patternsLoaded())continue;const Ie=ge.getBucket(d);if(!Ie)continue;const Ne=Ie.programConfigurations.get(d.id),Ue=v.useProgram(he,Ne),Ze=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Oe);U&&(v.context.activeTexture.set(C.TEXTURE0),ge.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),Ne.updatePaintBuffers(V)),Rc(Ne,M,Pe,ge,d);const et=Ze?Oe:null,Ke=v.translatePosMatrix(et?et.posMatrix:Oe.posMatrix,ge,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(P){pe=Ie.indexBuffer2,ae=Ie.segments2;const at=[C.drawingBufferWidth,C.drawingBufferHeight];ce=he==="fillOutlinePattern"&&U?te(Ke,v,V,ge,at):Tl(Ke,at)}else pe=Ie.indexBuffer,ae=Ie.segments,ce=U?Mc(Ke,v,V,ge):Ic(Ke);Ue.draw(v.context,X,y,v.stencilModeForClipping(Oe),b,fr.disabled,ce,Ze,d.id,Ie.layoutVertexBuffer,pe,ae,d.paint,v.transform.zoom,Ne)}}function zc(v,a,d,p,y,b,P){const C=v.context,M=C.gl,O="fill-extrusion-pattern",U=d.paint.get(O),V=U.constantOr(1),X=d.getCrossfadeParameters(),he=d.paint.get("fill-extrusion-opacity"),ce=U.constantOr(null);for(const pe of p){const ae=a.getTile(pe),Pe=ae.getBucket(d);if(!Pe)continue;const Oe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(pe),ge=Pe.programConfigurations.get(d.id),Ie=v.useProgram(V?"fillExtrusionPattern":"fillExtrusion",ge);V&&(v.context.activeTexture.set(M.TEXTURE0),ae.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),ge.updatePaintBuffers(X)),Rc(ge,O,ce,ae,d);const Ne=v.translatePosMatrix(pe.posMatrix,ae,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Ue=d.paint.get("fill-extrusion-vertical-gradient"),Ze=V?Ps(Ne,v,Ue,he,pe,X,ae):El(Ne,v,Ue,he);Ie.draw(C,C.gl.TRIANGLES,y,b,P,fr.backCCW,Ze,Oe,d.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,d.paint,v.transform.zoom,ge,v.style.map.terrain&&Pe.centroidVertexBuffer)}}function Gv(v,a,d,p,y,b,P){const C=v.context,M=C.gl,O=d.fbo;if(!O)return;const U=v.useProgram("hillshade"),V=v.style.map.terrain&&v.style.map.terrain.getTerrainData(a);C.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,O.colorAttachment.get()),U.draw(C,M.TRIANGLES,y,b,P,fr.disabled,((X,he,ce,pe)=>{const ae=ce.paint.get("hillshade-shadow-color"),Pe=ce.paint.get("hillshade-highlight-color"),Oe=ce.paint.get("hillshade-accent-color");let ge=ce.paint.get("hillshade-illumination-direction")*(Math.PI/180);ce.paint.get("hillshade-illumination-anchor")==="viewport"&&(ge-=X.transform.angle);const Ie=!X.options.moving;return{u_matrix:pe?pe.posMatrix:X.transform.calculatePosMatrix(he.tileID.toUnwrapped(),Ie),u_image:0,u_latrange:Sn(0,he.tileID),u_light:[ce.paint.get("hillshade-exaggeration"),ge],u_shadow:ae,u_highlight:Pe,u_accent:Oe}})(v,d,p,V?a:null),V,p.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}function lf(v,a,d,p,y,b){const P=v.context,C=P.gl,M=a.dem;if(M&&M.data){const O=M.dim,U=M.stride,V=M.getPixels();if(P.activeTexture.set(C.TEXTURE1),P.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||v.getTileTexture(U),a.demTexture){const he=a.demTexture;he.update(V,{premultiply:!1}),he.bind(C.NEAREST,C.CLAMP_TO_EDGE)}else a.demTexture=new fe(P,V,C.RGBA,{premultiply:!1}),a.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);P.activeTexture.set(C.TEXTURE0);let X=a.fbo;if(!X){const he=new fe(P,{width:O,height:O,data:null},C.RGBA);he.bind(C.LINEAR,C.CLAMP_TO_EDGE),X=a.fbo=P.createFramebuffer(O,O,!0,!1),X.colorAttachment.set(he.texture)}P.bindFramebuffer.set(X.framebuffer),P.viewport.set([0,0,O,O]),v.useProgram("hillshadePrepare").draw(P,C.TRIANGLES,p,y,b,fr.disabled,((he,ce)=>{const pe=ce.stride,ae=l.create();return l.ortho(ae,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(ae,ae,[0,-l.EXTENT,0]),{u_matrix:ae,u_image:1,u_dimension:[pe,pe],u_zoom:he.overscaledZ,u_unpack:ce.getUnpackVector()}})(a.tileID,M),null,d.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function Wv(v,a,d,p,y,b){const P=p.paint.get("raster-fade-duration");if(!b&&P>0){const C=l.browser.now(),M=(C-v.timeAdded)/P,O=a?(C-a.timeAdded)/P:-1,U=d.getSource(),V=y.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),X=!a||Math.abs(a.tileID.overscaledZ-V)>Math.abs(v.tileID.overscaledZ-V),he=X&&v.refreshedUponExpiration?1:l.clamp(X?M:1-O,0,1);return v.refreshedUponExpiration&&M>=1&&(v.refreshedUponExpiration=!1),a?{opacity:1,mix:1-he}:{opacity:he,mix:0}}return{opacity:1,mix:0}}const lg=new l.Color(1,0,0,1),Ju=new l.Color(0,1,0,1),cf=new l.Color(0,0,1,1),cg=new l.Color(1,0,1,1),ug=new l.Color(0,1,1,1);function Dc(v,a,d,p){eh(v,0,a+d/2,v.transform.width,d,p)}function Qu(v,a,d,p){eh(v,a-d/2,0,d,v.transform.height,p)}function eh(v,a,d,p,y,b){const P=v.context,C=P.gl;C.enable(C.SCISSOR_TEST),C.scissor(a*v.pixelRatio,d*v.pixelRatio,p*v.pixelRatio,y*v.pixelRatio),P.clear({color:b}),C.disable(C.SCISSOR_TEST)}function hg(v,a,d){const p=v.context,y=p.gl,b=d.posMatrix,P=v.useProgram("debug"),C=On.disabled,M=gr.disabled,O=v.colorModeForRenderPass(),U="$debug",V=v.style.map.terrain&&v.style.map.terrain.getTerrainData(d);p.activeTexture.set(y.TEXTURE0);const X=a.getTileByID(d.key).latestRawTileData,he=Math.floor((X&&X.byteLength||0)/1024),ce=a.getTile(d).tileSize,pe=512/Math.min(ce,512)*(d.overscaledZ/v.transform.zoom)*.5;let ae=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(ae+=` => ${d.overscaledZ}`),function(Pe,Oe){Pe.initDebugOverlayCanvas();const ge=Pe.debugOverlayCanvas,Ie=Pe.context.gl,Ne=Pe.debugOverlayCanvas.getContext("2d");Ne.clearRect(0,0,ge.width,ge.height),Ne.shadowColor="white",Ne.shadowBlur=2,Ne.lineWidth=1.5,Ne.strokeStyle="white",Ne.textBaseline="top",Ne.font="bold 36px Open Sans, sans-serif",Ne.fillText(Oe,5,5),Ne.strokeText(Oe,5,5),Pe.debugOverlayTexture.update(ge),Pe.debugOverlayTexture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE)}(v,`${ae} ${he}kB`),P.draw(p,y.TRIANGLES,C,M,mr.alphaBlended,fr.disabled,Be(b,l.Color.transparent,pe),null,U,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),P.draw(p,y.LINE_STRIP,C,M,O,fr.disabled,Be(b,l.Color.red),V,U,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function br(v,a,d){const p=v.context,y=p.gl,b=v.colorModeForRenderPass(),P=new On(y.LEQUAL,On.ReadWrite,v.depthRangeFor3D),C=v.useProgram("terrain"),M=a.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,v.width,v.height]);for(const O of d){const U=v.renderToTexture.getTexture(O),V=a.getTerrainData(O.tileID);p.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,U.texture);const X={u_matrix:v.transform.calculatePosMatrix(O.tileID.toUnwrapped()),u_texture:0,u_ele_delta:a.getMeshFrameDelta(v.transform.zoom)};C.draw(p,y.TRIANGLES,P,gr.disabled,b,fr.backCCW,X,V,"terrain",M.vertexBuffer,M.indexBuffer,M.segments)}}class Va{constructor(a,d){this.context=new $v(a),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.create(),renderTime:0},this.setup(),this.numSublayers=Ct.maxUnderzooming+Ct.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ki}resize(a,d,p){if(this.width=Math.floor(a*p),this.height=Math.floor(d*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const a=this.context,d=new l.PosArray;d.emplaceBack(0,0),d.emplaceBack(l.EXTENT,0),d.emplaceBack(0,l.EXTENT),d.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=a.createVertexBuffer(d,Bo.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const p=new l.PosArray;p.emplaceBack(0,0),p.emplaceBack(l.EXTENT,0),p.emplaceBack(0,l.EXTENT),p.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=a.createVertexBuffer(p,Bo.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const y=new l.RasterBoundsArray;y.emplaceBack(0,0,0,0),y.emplaceBack(l.EXTENT,0,l.EXTENT,0),y.emplaceBack(0,l.EXTENT,0,l.EXTENT),y.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=a.createVertexBuffer(y,Et.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const b=new l.PosArray;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(b,Bo.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const P=new l.LineStripIndexArray;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=a.createIndexBuffer(P);const C=new l.TriangleIndexArray;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(C);const M=this.context.gl;this.stencilClearMode=new gr({func:M.ALWAYS,mask:0},0,255,M.ZERO,M.ZERO,M.ZERO)}clearStencil(){const a=this.context,d=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=l.create();l.ortho(p,0,this.width,this.height,0,0,1),l.scale(p,p,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(a,d.TRIANGLES,On.disabled,this.stencilClearMode,mr.disabled,fr.disabled,st(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(a,d){if(this.currentStencilSource===a.source||!a.isTileClipped()||!d||!d.length)return;this.currentStencilSource=a.source;const p=this.context,y=p.gl;this.nextStencilID+d.length>256&&this.clearStencil(),p.setColorMode(mr.disabled),p.setDepthMode(On.disabled);const b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of d){const C=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,M=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P);b.draw(p,y.TRIANGLES,On.disabled,new gr({func:y.ALWAYS,mask:0},C,255,y.KEEP,y.KEEP,y.REPLACE),mr.disabled,fr.disabled,st(P.posMatrix),M,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,d=this.context.gl;return new gr({func:d.NOTEQUAL,mask:255},a,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(a){const d=this.context.gl;return new gr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(a){const d=this.context.gl,p=a.sort((P,C)=>C.overscaledZ-P.overscaledZ),y=p[p.length-1].overscaledZ,b=p[0].overscaledZ-y+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const P={};for(let C=0;C<b;C++)P[C+y]=new gr({func:d.GEQUAL,mask:255},C+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=b,[P,p]}return[{[y]:gr.disabled},p]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new mr([a.CONSTANT_COLOR,a.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?mr.unblended:mr.alphaBlended}depthModeForSublayer(a,d,p){if(!this.opaquePassEnabledForLayer())return On.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new On(p||this.context.gl.LEQUAL,d,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(a,d){this.style=a,this.options=d,this.lineAtlas=a.lineAtlas,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(l.browser.now()),this.imageManager.beginFrame();const p=this.style._order,y=this.style.sourceCaches,b={},P={},C={};for(const M in y){const O=y[M];O.used&&O.prepare(this.context),b[M]=O.getVisibleCoordinates(),P[M]=b[M].slice().reverse(),C[M]=O.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<p.length;M++)if(this.style._layers[p[M]].is3D()){this.opaquePassCutoff=M;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const M=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||M.length)&&(l.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(O,U){const V=O.context,X=V.gl,he=mr.unblended,ce=new On(X.LEQUAL,On.ReadWrite,[0,1]),pe=U.getTerrainMesh(),ae=U.sourceCache.getRenderableTiles(),Pe=O.useProgram("terrainDepth");V.bindFramebuffer.set(U.getFramebuffer("depth").framebuffer),V.viewport.set([0,0,O.width/devicePixelRatio,O.height/devicePixelRatio]),V.clear({color:l.Color.transparent,depth:1});for(const Oe of ae){const ge=U.getTerrainData(Oe.tileID),Ie={u_matrix:O.transform.calculatePosMatrix(Oe.tileID.toUnwrapped()),u_ele_delta:U.getMeshFrameDelta(O.transform.zoom)};Pe.draw(V,X.TRIANGLES,ce,gr.disabled,he,fr.backCCW,Ie,ge,"terrain",pe.vertexBuffer,pe.indexBuffer,pe.segments)}V.bindFramebuffer.set(null),V.viewport.set([0,0,O.width,O.height])}(this,this.style.map.terrain),function(O,U){const V=O.context,X=V.gl,he=mr.unblended,ce=new On(X.LEQUAL,On.ReadWrite,[0,1]),pe=U.getTerrainMesh(),ae=U.getCoordsTexture(),Pe=U.sourceCache.getRenderableTiles(),Oe=O.useProgram("terrainCoords");V.bindFramebuffer.set(U.getFramebuffer("coords").framebuffer),V.viewport.set([0,0,O.width/devicePixelRatio,O.height/devicePixelRatio]),V.clear({color:l.Color.transparent,depth:1}),U.coordsIndex=[];for(const ge of Pe){const Ie=U.getTerrainData(ge.tileID);V.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,ae.texture);const Ne={u_matrix:O.transform.calculatePosMatrix(ge.tileID.toUnwrapped()),u_terrain_coords_id:(255-U.coordsIndex.length)/255,u_texture:0,u_ele_delta:U.getMeshFrameDelta(O.transform.zoom)};Oe.draw(V,X.TRIANGLES,ce,gr.disabled,he,fr.backCCW,Ne,Ie,"terrain",pe.vertexBuffer,pe.indexBuffer,pe.segments),U.coordsIndex.push(ge.tileID.key)}V.bindFramebuffer.set(null),V.viewport.set([0,0,O.width,O.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const M of p){const O=this.style._layers[M];if(!O.hasOffscreenPass()||O.isHidden(this.transform.zoom))continue;const U=P[O.source];(O.type==="custom"||U.length)&&this.renderLayer(this,y[O.source],O,U)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(a._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[p[this.currentLayer]],O=y[M.source],U=b[M.source];this._renderTileClippingMasks(M,U),this.renderLayer(this,O,M,U)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const M=this.style._layers[p[this.currentLayer]],O=y[M.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(M))continue;const U=(M.type==="symbol"?C:P)[M.source];this._renderTileClippingMasks(M,b[M.source]),this.renderLayer(this,O,M,U)}if(this.options.showTileBoundaries){const M=function(O,U){let V=null;const X=Object.values(O._layers).flatMap(ae=>ae.source&&!ae.isHidden(U)?[O.sourceCaches[ae.source]]:[]),he=X.filter(ae=>ae.getSource().type==="vector"),ce=X.filter(ae=>ae.getSource().type!=="vector"),pe=ae=>{(!V||V.getSource().maxzoom<ae.getSource().maxzoom)&&(V=ae)};return he.forEach(ae=>pe(ae)),V||ce.forEach(ae=>pe(ae)),V}(this.style,this.transform.zoom);M&&function(O,U,V){for(let X=0;X<V.length;X++)hg(O,U,V[X])}(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const O=M.transform.padding;Dc(M,M.transform.height-(O.top||0),3,lg),Dc(M,O.bottom||0,3,Ju),Qu(M,O.left||0,3,cf),Qu(M,M.transform.width-(O.right||0),3,cg);const U=M.transform.centerPoint;(function(V,X,he,ce){eh(V,X-1,he-10,2,20,ce),eh(V,X-10,he-1,20,2,ce)})(M,U.x,M.transform.height-U.y,ug)}(this),this.context.setDefault()}renderLayer(a,d,p,y){if(!p.isHidden(this.transform.zoom)&&(p.type==="background"||p.type==="custom"||(y||[]).length))switch(this.id=p.id,p.type){case"symbol":(function(b,P,C,M,O){if(b.renderPass!=="translucent")return;const U=gr.disabled,V=b.colorModeForRenderPass();(C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(X,he,ce,pe,ae,Pe,Oe){const ge=he.transform,Ie=ae==="map",Ne=Pe==="map";for(const Ue of X){const Ze=pe.getTile(Ue),et=Ze.getBucket(ce);if(!et||!et.text||!et.text.segments.get().length)continue;const Ke=l.evaluateSizeForZoom(et.textSizeData,ge.zoom),at=Se(Ze,1,he.transform.zoom),Vt=He(Ue.posMatrix,Ne,Ie,he.transform,at),An=ce.layout.get("icon-text-fit")!=="none"&&et.hasIconData();if(Ke){const yt=Math.pow(2,ge.zoom-Ze.tileID.overscaledZ);Yu(et,Ie,Ne,Oe,ge,Vt,Ue.posMatrix,yt,Ke,An,he.style.map.terrain?(an,Gt)=>he.style.map.terrain.getElevation(Ue,an,Gt):null)}}}(M,b,C,P,C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),O),C.paint.get("icon-opacity").constantOr(1)!==0&&Ku(b,P,C,M,!1,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),C.layout.get("icon-rotation-alignment"),C.layout.get("icon-pitch-alignment"),C.layout.get("icon-keep-upright"),U,V),C.paint.get("text-opacity").constantOr(1)!==0&&Ku(b,P,C,M,!0,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),C.layout.get("text-rotation-alignment"),C.layout.get("text-pitch-alignment"),C.layout.get("text-keep-upright"),U,V),P.map.showCollisionBoxes&&(ag(b,P,C,M,C.paint.get("text-translate"),C.paint.get("text-translate-anchor"),!0),ag(b,P,C,M,C.paint.get("icon-translate"),C.paint.get("icon-translate-anchor"),!1))})(a,d,p,y,this.style.placement.variableOffsets);break;case"circle":(function(b,P,C,M){if(b.renderPass!=="translucent")return;const O=C.paint.get("circle-opacity"),U=C.paint.get("circle-stroke-width"),V=C.paint.get("circle-stroke-opacity"),X=!C.layout.get("circle-sort-key").isConstant();if(O.constantOr(1)===0&&(U.constantOr(1)===0||V.constantOr(1)===0))return;const he=b.context,ce=he.gl,pe=b.depthModeForSublayer(0,On.ReadOnly),ae=gr.disabled,Pe=b.colorModeForRenderPass(),Oe=[];for(let ge=0;ge<M.length;ge++){const Ie=M[ge],Ne=P.getTile(Ie),Ue=Ne.getBucket(C);if(!Ue)continue;const Ze=Ue.programConfigurations.get(C.id),et=b.useProgram("circle",Ze),Ke=Ue.layoutVertexBuffer,at=Ue.indexBuffer,Vt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ie),An={programConfiguration:Ze,program:et,layoutVertexBuffer:Ke,indexBuffer:at,uniformValues:oe(b,Ie,Ne,C),terrainData:Vt};if(X){const yt=Ue.segments.get();for(const an of yt)Oe.push({segments:new l.SegmentVector([an]),sortKey:an.sortKey,state:An})}else Oe.push({segments:Ue.segments,sortKey:0,state:An})}X&&Oe.sort((ge,Ie)=>ge.sortKey-Ie.sortKey);for(const ge of Oe){const{programConfiguration:Ie,program:Ne,layoutVertexBuffer:Ue,indexBuffer:Ze,uniformValues:et,terrainData:Ke}=ge.state;Ne.draw(he,ce.TRIANGLES,pe,ae,Pe,fr.disabled,et,Ke,C.id,Ue,Ze,ge.segments,C.paint,b.transform.zoom,Ie)}})(a,d,p,y);break;case"heatmap":(function(b,P,C,M){if(C.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){const O=b.context,U=O.gl,V=gr.disabled,X=new mr([U.ONE,U.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(he,ce,pe){const ae=he.gl;he.activeTexture.set(ae.TEXTURE1),he.viewport.set([0,0,ce.width/4,ce.height/4]);let Pe=pe.heatmapFbo;if(Pe)ae.bindTexture(ae.TEXTURE_2D,Pe.colorAttachment.get()),he.bindFramebuffer.set(Pe.framebuffer);else{const Oe=ae.createTexture();ae.bindTexture(ae.TEXTURE_2D,Oe),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_S,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_T,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,ae.LINEAR),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,ae.LINEAR),Pe=pe.heatmapFbo=he.createFramebuffer(ce.width/4,ce.height/4,!1,!1),function(ge,Ie,Ne,Ue){var Ze,et;const Ke=ge.gl,at=(Ze=ge.HALF_FLOAT)!==null&&Ze!==void 0?Ze:Ke.UNSIGNED_BYTE,Vt=(et=ge.RGBA16F)!==null&&et!==void 0?et:Ke.RGBA;Ke.texImage2D(Ke.TEXTURE_2D,0,Vt,Ie.width/4,Ie.height/4,0,Ke.RGBA,at,null),Ue.colorAttachment.set(Ne)}(he,ce,Oe,Pe)}})(O,b,C),O.clear({color:l.Color.transparent});for(let he=0;he<M.length;he++){const ce=M[he];if(P.hasRenderableParent(ce))continue;const pe=P.getTile(ce),ae=pe.getBucket(C);if(!ae)continue;const Pe=ae.programConfigurations.get(C.id),Oe=b.useProgram("heatmap",Pe),{zoom:ge}=b.transform;Oe.draw(O,U.TRIANGLES,On.disabled,V,X,fr.disabled,Bt(ce.posMatrix,pe,ge,C.paint.get("heatmap-intensity")),null,C.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,C.paint,b.transform.zoom,Pe)}O.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(O,U){const V=O.context,X=V.gl,he=U.heatmapFbo;if(!he)return;V.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,he.colorAttachment.get()),V.activeTexture.set(X.TEXTURE1);let ce=U.colorRampTexture;ce||(ce=U.colorRampTexture=new fe(V,U.colorRamp,X.RGBA)),ce.bind(X.LINEAR,X.CLAMP_TO_EDGE),O.useProgram("heatmapTexture").draw(V,X.TRIANGLES,On.disabled,gr.disabled,O.colorModeForRenderPass(),fr.disabled,((pe,ae,Pe,Oe)=>{const ge=l.create();l.ortho(ge,0,pe.width,pe.height,0,0,1);const Ie=pe.context.gl;return{u_matrix:ge,u_world:[Ie.drawingBufferWidth,Ie.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ae.paint.get("heatmap-opacity")}})(O,U),null,U.id,O.viewportBuffer,O.quadTriangleIndexBuffer,O.viewportSegments,U.paint,O.transform.zoom)}(b,C))})(a,d,p,y);break;case"line":(function(b,P,C,M){if(b.renderPass!=="translucent")return;const O=C.paint.get("line-opacity"),U=C.paint.get("line-width");if(O.constantOr(1)===0||U.constantOr(1)===0)return;const V=b.depthModeForSublayer(0,On.ReadOnly),X=b.colorModeForRenderPass(),he=C.paint.get("line-dasharray"),ce=C.paint.get("line-pattern"),pe=ce.constantOr(1),ae=C.paint.get("line-gradient"),Pe=C.getCrossfadeParameters(),Oe=pe?"linePattern":he?"lineSDF":ae?"lineGradient":"line",ge=b.context,Ie=ge.gl;let Ne=!0;for(const Ue of M){const Ze=P.getTile(Ue);if(pe&&!Ze.patternsLoaded())continue;const et=Ze.getBucket(C);if(!et)continue;const Ke=et.programConfigurations.get(C.id),at=b.context.program.get(),Vt=b.useProgram(Oe,Ke),An=Ne||Vt.program!==at,yt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ue),an=ce.constantOr(null);if(an&&Ze.imageAtlas){const Pn=Ze.imageAtlas,_n=Pn.patternPositions[an.to.toString()],In=Pn.patternPositions[an.from.toString()];_n&&In&&Ke.setConstantPatternPositions(_n,In)}const Gt=yt?Ue:null,Hn=pe?di(b,Ze,C,Pe,Gt):he?cs(b,Ze,C,he,Pe,Gt):ae?jr(b,Ze,C,et.lineClipsArray.length,Gt):Ir(b,Ze,C,Gt);if(pe)ge.activeTexture.set(Ie.TEXTURE0),Ze.imageAtlasTexture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE),Ke.updatePaintBuffers(Pe);else if(he&&(An||b.lineAtlas.dirty))ge.activeTexture.set(Ie.TEXTURE0),b.lineAtlas.bind(ge);else if(ae){const Pn=et.gradients[C.id];let _n=Pn.texture;if(C.gradientVersion!==Pn.version){let In=256;if(C.stepInterpolant){const Mr=P.getSource().maxzoom,tr=Ue.canonical.z===Mr?Math.ceil(1<<b.transform.maxZoom-Ue.canonical.z):1;In=l.clamp(l.nextPowerOfTwo(et.maxLineLength/l.EXTENT*1024*tr),256,ge.maxTextureSize)}Pn.gradient=l.renderColorRamp({expression:C.gradientExpression(),evaluationKey:"lineProgress",resolution:In,image:Pn.gradient||void 0,clips:et.lineClipsArray}),Pn.texture?Pn.texture.update(Pn.gradient):Pn.texture=new fe(ge,Pn.gradient,Ie.RGBA),Pn.version=C.gradientVersion,_n=Pn.texture}ge.activeTexture.set(Ie.TEXTURE0),_n.bind(C.stepInterpolant?Ie.NEAREST:Ie.LINEAR,Ie.CLAMP_TO_EDGE)}Vt.draw(ge,Ie.TRIANGLES,V,b.stencilModeForClipping(Ue),X,fr.disabled,Hn,yt,C.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,C.paint,b.transform.zoom,Ke,et.layoutVertexBuffer2),Ne=!1}})(a,d,p,y);break;case"fill":(function(b,P,C,M){const O=C.paint.get("fill-color"),U=C.paint.get("fill-opacity");if(U.constantOr(1)===0)return;const V=b.colorModeForRenderPass(),X=C.paint.get("fill-pattern"),he=b.opaquePassEnabledForLayer()&&!X.constantOr(1)&&O.constantOr(l.Color.transparent).a===1&&U.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===he){const ce=b.depthModeForSublayer(1,b.renderPass==="opaque"?On.ReadWrite:On.ReadOnly);Oc(b,P,C,M,ce,V,!1)}if(b.renderPass==="translucent"&&C.paint.get("fill-antialias")){const ce=b.depthModeForSublayer(C.getPaintProperty("fill-outline-color")?2:0,On.ReadOnly);Oc(b,P,C,M,ce,V,!0)}})(a,d,p,y);break;case"fill-extrusion":(function(b,P,C,M){const O=C.paint.get("fill-extrusion-opacity");if(O!==0&&b.renderPass==="translucent"){const U=new On(b.context.gl.LEQUAL,On.ReadWrite,b.depthRangeFor3D);if(O!==1||C.paint.get("fill-extrusion-pattern").constantOr(1))zc(b,P,C,M,U,gr.disabled,mr.disabled),zc(b,P,C,M,U,b.stencilModeFor3D(),b.colorModeForRenderPass());else{const V=b.colorModeForRenderPass();zc(b,P,C,M,U,gr.disabled,V)}}})(a,d,p,y);break;case"hillshade":(function(b,P,C,M){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;const O=b.context,U=b.depthModeForSublayer(0,On.ReadOnly),V=b.colorModeForRenderPass(),[X,he]=b.renderPass==="translucent"?b.stencilConfigForOverlap(M):[{},M];for(const ce of he){const pe=P.getTile(ce);pe.needsHillshadePrepare!==void 0&&pe.needsHillshadePrepare&&b.renderPass==="offscreen"?lf(b,pe,C,U,gr.disabled,V):b.renderPass==="translucent"&&Gv(b,ce,pe,C,U,X[ce.overscaledZ],V)}O.viewport.set([0,0,b.width,b.height])})(a,d,p,y);break;case"raster":(function(b,P,C,M){if(b.renderPass!=="translucent"||C.paint.get("raster-opacity")===0||!M.length)return;const O=b.context,U=O.gl,V=P.getSource(),X=b.useProgram("raster"),he=b.colorModeForRenderPass(),[ce,pe]=V instanceof sn?[{},M]:b.stencilConfigForOverlap(M),ae=pe[pe.length-1].overscaledZ,Pe=!b.options.moving;for(const Oe of pe){const ge=b.depthModeForSublayer(Oe.overscaledZ-ae,C.paint.get("raster-opacity")===1?On.ReadWrite:On.ReadOnly,U.LESS),Ie=P.getTile(Oe);Ie.registerFadeDuration(C.paint.get("raster-fade-duration"));const Ne=P.findLoadedParent(Oe,0),Ue=Wv(Ie,Ne,P,C,b.transform,b.style.map.terrain);let Ze,et;const Ke=C.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;O.activeTexture.set(U.TEXTURE0),Ie.texture.bind(Ke,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(U.TEXTURE1),Ne?(Ne.texture.bind(Ke,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),Ze=Math.pow(2,Ne.tileID.overscaledZ-Ie.tileID.overscaledZ),et=[Ie.tileID.canonical.x*Ze%1,Ie.tileID.canonical.y*Ze%1]):Ie.texture.bind(Ke,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST);const at=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Oe),Vt=at?Oe:null,An=Vt?Vt.posMatrix:b.transform.calculatePosMatrix(Oe.toUnwrapped(),Pe),yt=Qm(An,et||[0,0],Ze||1,Ue,C);V instanceof sn?X.draw(O,U.TRIANGLES,ge,gr.disabled,he,fr.disabled,yt,at,C.id,V.boundsBuffer,b.quadTriangleIndexBuffer,V.boundsSegments):X.draw(O,U.TRIANGLES,ge,ce[Oe.overscaledZ],he,fr.disabled,yt,at,C.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}})(a,d,p,y);break;case"background":(function(b,P,C,M){const O=C.paint.get("background-color"),U=C.paint.get("background-opacity");if(U===0)return;const V=b.context,X=V.gl,he=b.transform,ce=he.tileSize,pe=C.paint.get("background-pattern");if(b.isPatternMissing(pe))return;const ae=!pe&&O.a===1&&U===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==ae)return;const Pe=gr.disabled,Oe=b.depthModeForSublayer(0,ae==="opaque"?On.ReadWrite:On.ReadOnly),ge=b.colorModeForRenderPass(),Ie=b.useProgram(pe?"backgroundPattern":"background"),Ne=M||he.coveringTiles({tileSize:ce,terrain:b.style.map.terrain});pe&&(V.activeTexture.set(X.TEXTURE0),b.imageManager.bind(b.context));const Ue=C.getCrossfadeParameters();for(const Ze of Ne){const et=M?Ze.posMatrix:b.transform.calculatePosMatrix(Ze.toUnwrapped()),Ke=pe?Cs(et,U,b,pe,{tileID:Ze,tileSize:ce},Ue):Bu(et,U,O),at=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ze);Ie.draw(V,X.TRIANGLES,Oe,Pe,ge,fr.disabled,Ke,at,C.id,b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}})(a,0,p,y);break;case"custom":(function(b,P,C){const M=b.context,O=C.implementation;if(b.renderPass==="offscreen"){const U=O.prerender;U&&(b.setCustomLayerDefaults(),M.setColorMode(b.colorModeForRenderPass()),U.call(O,M.gl,b.transform.customLayerMatrix()),M.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),M.setColorMode(b.colorModeForRenderPass()),M.setStencilMode(gr.disabled);const U=O.renderingMode==="3d"?new On(b.context.gl.LEQUAL,On.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,On.ReadOnly);M.setDepthMode(U),O.render(M.gl,b.transform.customLayerMatrix()),M.setDirty(),b.setBaseState(),M.bindFramebuffer.set(null)}})(a,0,p)}}translatePosMatrix(a,d,p,y,b){if(!p[0]&&!p[1])return a;const P=b?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(P){const O=Math.sin(P),U=Math.cos(P);p=[p[0]*U-p[1]*O,p[0]*O+p[1]*U]}const C=[b?p[0]:Se(d,p[0],this.transform.zoom),b?p[1]:Se(d,p[1],this.transform.zoom),0],M=new Float32Array(16);return l.translate(M,a,C),M}saveTileTexture(a){const d=this._tileTextures[a.size[0]];d?d.push(a):this._tileTextures[a.size[0]]=[a]}getTileTexture(a){const d=this._tileTextures[a];return d&&d.length>0?d.pop():null}isPatternMissing(a){if(!a)return!1;if(!a.from||!a.to)return!0;const d=this.imageManager.getPattern(a.from.toString()),p=this.imageManager.getPattern(a.to.toString());return!d||!p}useProgram(a,d){this.cache=this.cache||{};const p=a+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new Gi(this.context,Jn[a],d,Uu[a],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new fe(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:a,drawingBufferHeight:d}=this.context.gl;return this.width!==a||this.height!==d}}class Hi{constructor(a,d){this.points=a,this.planes=d}static fromInvProjectionMatrix(a,d,p){const y=Math.pow(2,p),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const M=1/(C=l.transformMat4([],C,a))[3]/d*y;return l.mul$1(C,C,[M,M,1/C[3],M])}),P=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const M=function(X,he){var ce=he[0],pe=he[1],ae=he[2],Pe=ce*ce+pe*pe+ae*ae;return Pe>0&&(Pe=1/Math.sqrt(Pe)),X[0]=he[0]*Pe,X[1]=he[1]*Pe,X[2]=he[2]*Pe,X}([],function(X,he,ce){var pe=he[0],ae=he[1],Pe=he[2],Oe=ce[0],ge=ce[1],Ie=ce[2];return X[0]=ae*Ie-Pe*ge,X[1]=Pe*Oe-pe*Ie,X[2]=pe*ge-ae*Oe,X}([],ne([],b[C[0]],b[C[1]]),ne([],b[C[2]],b[C[1]]))),O=-((U=M)[0]*(V=b[C[1]])[0]+U[1]*V[1]+U[2]*V[2]);var U,V;return M.concat(O)});return new Hi(b,P)}}class Il{constructor(a,d){this.min=a,this.max=d,this.center=function(p,y,b){return p[0]=.5*y[0],p[1]=.5*y[1],p[2]=.5*y[2],p}([],function(p,y,b){return p[0]=y[0]+b[0],p[1]=y[1]+b[1],p[2]=y[2]+b[2],p}([],this.min,this.max))}quadrant(a){const d=[a%2==0,a<2],p=$(this.min),y=$(this.max);for(let b=0;b<d.length;b++)p[b]=d[b]?this.min[b]:this.center[b],y[b]=d[b]?this.center[b]:this.max[b];return y[2]=this.max[2],new Il(p,y)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}intersects(a){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let y=0;y<a.planes.length;y++){const b=a.planes[y];let P=0;for(let C=0;C<d.length;C++)l.dot(b,d[C])>=0&&P++;if(P===0)return 0;P!==d.length&&(p=!1)}if(p)return 2;for(let y=0;y<3;y++){let b=Number.MAX_VALUE,P=-Number.MAX_VALUE;for(let C=0;C<a.points.length;C++){const M=a.points[C][y]-this.min[y];b=Math.min(b,M),P=Math.max(P,M)}if(P<0||b>this.max[y]-this.min[y])return 0}return 1}}class Fc{constructor(a=0,d=0,p=0,y=0){if(isNaN(a)||a<0||isNaN(d)||d<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=d,this.left=p,this.right=y}interpolate(a,d,p){return d.top!=null&&a.top!=null&&(this.top=l.interpolate.number(a.top,d.top,p)),d.bottom!=null&&a.bottom!=null&&(this.bottom=l.interpolate.number(a.bottom,d.bottom,p)),d.left!=null&&a.left!=null&&(this.left=l.interpolate.number(a.left,d.left,p)),d.right!=null&&a.right!=null&&(this.right=l.interpolate.number(a.right,d.right,p)),this}getCenter(a,d){const p=l.clamp((this.left+a-this.right)/2,0,a),y=l.clamp((this.top+d-this.bottom)/2,0,d);return new l.Point(p,y)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new Fc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class th{constructor(a,d,p,y,b){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=b===void 0||!!b,this._minZoom=a||0,this._maxZoom=d||22,this._minPitch=p??0,this._maxPitch=y??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Fc,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const a=new th(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return a.apply(this),a}apply(a){this.tileSize=a.tileSize,this.latRange=a.latRange,this.width=a.width,this.height=a.height,this._center=a._center,this._elevation=a._elevation,this._minEleveationForCurrentTile=a._minEleveationForCurrentTile,this.zoom=a.zoom,this.angle=a.angle,this._fov=a._fov,this._pitch=a._pitch,this._unmodified=a._unmodified,this._edgeInsets=a._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(a){a===void 0?a=!0:a===null&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(a){const d=-l.wrap(a,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var p=new l.ARRAY_TYPE(4);return l.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}(),function(p,y,b){var P=y[0],C=y[1],M=y[2],O=y[3],U=Math.sin(b),V=Math.cos(b);p[0]=P*V+M*U,p[1]=C*V+O*U,p[2]=P*-U+M*V,p[3]=C*-U+O*V}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const d=l.clamp(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(a){const d=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(a){a!==this._elevation&&(this._elevation=a,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,d,p){this._unmodified=!1,this._edgeInsets.interpolate(a,d,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const d=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(a){const d=[new l.UnwrappedTileID(0,a)];if(this._renderWorldCopies){const p=this.pointCoordinate(new l.Point(0,0)),y=this.pointCoordinate(new l.Point(this.width,0)),b=this.pointCoordinate(new l.Point(this.width,this.height)),P=this.pointCoordinate(new l.Point(0,this.height)),C=Math.floor(Math.min(p.x,y.x,b.x,P.x)),M=Math.floor(Math.max(p.x,y.x,b.x,P.x)),O=1;for(let U=C-O;U<=M+O;U++)U!==0&&d.push(new l.UnwrappedTileID(U,a))}return d}coveringTiles(a){var d,p;let y=this.coveringZoomLevel(a);const b=y;if(a.minzoom!==void 0&&y<a.minzoom)return[];a.maxzoom!==void 0&&y>a.maxzoom&&(y=a.maxzoom);const P=this.pointCoordinate(this.getCameraPoint()),C=l.MercatorCoordinate.fromLngLat(this.center),M=Math.pow(2,y),O=[M*P.x,M*P.y,0],U=[M*C.x,M*C.y,0],V=Hi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,y);let X=a.minzoom||0;!a.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(X=y);const he=a.terrain?2/Math.min(this.tileSize,a.tileSize)*this.tileSize:3,ce=ge=>({aabb:new Il([ge*M,0,0],[(ge+1)*M,M,0]),zoom:0,x:0,y:0,wrap:ge,fullyVisible:!1}),pe=[],ae=[],Pe=y,Oe=a.reparseOverscaled?b:y;if(this._renderWorldCopies)for(let ge=1;ge<=3;ge++)pe.push(ce(-ge)),pe.push(ce(ge));for(pe.push(ce(0));pe.length>0;){const ge=pe.pop(),Ie=ge.x,Ne=ge.y;let Ue=ge.fullyVisible;if(!Ue){const Vt=ge.aabb.intersects(V);if(Vt===0)continue;Ue=Vt===2}const Ze=a.terrain?O:U,et=ge.aabb.distanceX(Ze),Ke=ge.aabb.distanceY(Ze),at=Math.max(Math.abs(et),Math.abs(Ke));if(ge.zoom===Pe||at>he+(1<<Pe-ge.zoom)-2&&ge.zoom>=X){const Vt=Pe-ge.zoom,An=O[0]-.5-(Ie<<Vt),yt=O[1]-.5-(Ne<<Vt);ae.push({tileID:new l.OverscaledTileID(ge.zoom===Pe?Oe:ge.zoom,ge.wrap,ge.zoom,Ie,Ne),distanceSq:re([U[0]-.5-Ie,U[1]-.5-Ne]),tileDistanceToCamera:Math.sqrt(An*An+yt*yt)})}else for(let Vt=0;Vt<4;Vt++){const An=(Ie<<1)+Vt%2,yt=(Ne<<1)+(Vt>>1),an=ge.zoom+1;let Gt=ge.aabb.quadrant(Vt);if(a.terrain){const Hn=new l.OverscaledTileID(an,ge.wrap,an,An,yt),Pn=a.terrain.getMinMaxElevation(Hn),_n=(d=Pn.minElevation)!==null&&d!==void 0?d:this.elevation,In=(p=Pn.maxElevation)!==null&&p!==void 0?p:this.elevation;Gt=new Il([Gt.min[0],Gt.min[1],_n],[Gt.max[0],Gt.max[1],In])}pe.push({aabb:Gt,zoom:an,x:An,y:yt,wrap:ge.wrap,fullyVisible:Ue})}}return ae.sort((ge,Ie)=>ge.distanceSq-Ie.distanceSq).map(ge=>ge.tileID)}resize(a,d){this.width=a,this.height=d,this.pixelsToGLUnits=[2/a,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){const d=l.clamp(a.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.Point(l.mercatorXfromLng(a.lng)*this.worldSize,l.mercatorYfromLat(d)*this.worldSize)}unproject(a){return new l.MercatorCoordinate(a.x/this.worldSize,a.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(a){const d=this.pointLocation(this.centerPoint,a),p=a.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-p))return;const y=this.getCameraPosition(),b=l.MercatorCoordinate.fromLngLat(y.lngLat,y.altitude),P=l.MercatorCoordinate.fromLngLat(d,p),C=b.x-P.x,M=b.y-P.y,O=b.z-P.z,U=Math.sqrt(C*C+M*M+O*O),V=this.scaleZoom(this.cameraToCenterDistance/U/this.tileSize);this._elevation=p,this._center=d,this.zoom=V}setLocationAtPoint(a,d){const p=this.pointCoordinate(d),y=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(a),P=new l.MercatorCoordinate(b.x-(p.x-y.x),b.y-(p.y-y.y));this.center=this.coordinateLocation(P),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(a,d){return d?this.coordinatePoint(this.locationCoordinate(a),d.getElevationForLngLatZoom(a,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(a))}pointLocation(a,d){return this.coordinateLocation(this.pointCoordinate(a,d))}locationCoordinate(a){return l.MercatorCoordinate.fromLngLat(a)}coordinateLocation(a){return a&&a.toLngLat()}pointCoordinate(a,d){if(d){const X=d.pointCoordinate(a);if(X!=null)return X}const p=[a.x,a.y,0,1],y=[a.x,a.y,1,1];l.transformMat4(p,p,this.pixelMatrixInverse),l.transformMat4(y,y,this.pixelMatrixInverse);const b=p[3],P=y[3],C=p[1]/b,M=y[1]/P,O=p[2]/b,U=y[2]/P,V=O===U?0:(0-O)/(U-O);return new l.MercatorCoordinate(l.interpolate.number(p[0]/b,y[0]/P,V)/this.worldSize,l.interpolate.number(C,M,V)/this.worldSize)}coordinatePoint(a,d=0,p=this.pixelMatrix){const y=[a.x*this.worldSize,a.y*this.worldSize,d,1];return l.transformMat4(y,y,p),new l.Point(y[0]/y[3],y[1]/y[3])}getBounds(){const a=Math.max(0,this.height/2-this.getHorizon());return new ot().extend(this.pointLocation(new l.Point(0,a))).extend(this.pointLocation(new l.Point(this.width,a))).extend(this.pointLocation(new l.Point(this.width,this.height))).extend(this.pointLocation(new l.Point(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ot([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(a,d=!1){const p=a.key,y=d?this._alignedPosMatrixCache:this._posMatrixCache;if(y[p])return y[p];const b=a.canonical,P=this.worldSize/this.zoomScale(b.z),C=b.x+Math.pow(2,b.z)*a.wrap,M=l.identity(new Float64Array(16));return l.translate(M,M,[C*P,b.y*P,0]),l.scale(M,M,[P/l.EXTENT,P/l.EXTENT,1]),l.multiply(M,d?this.alignedProjMatrix:this.projMatrix,M),y[p]=new Float32Array(M),y[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let a,d,p,y,b=-90,P=90,C=-180,M=180;const O=this.size,U=this._unmodified;if(this.latRange){const he=this.latRange;b=l.mercatorYfromLat(he[1])*this.worldSize,P=l.mercatorYfromLat(he[0])*this.worldSize,a=P-b<O.y?O.y/(P-b):0}if(this.lngRange){const he=this.lngRange;C=l.wrap(l.mercatorXfromLng(he[0])*this.worldSize,0,this.worldSize),M=l.wrap(l.mercatorXfromLng(he[1])*this.worldSize,0,this.worldSize),M<C&&(M+=this.worldSize),d=M-C<O.x?O.x/(M-C):0}const V=this.point,X=Math.max(d||0,a||0);if(X)return this.center=this.unproject(new l.Point(d?(M+C)/2:V.x,a?(P+b)/2:V.y)),this.zoom+=this.scaleZoom(X),this._unmodified=U,void(this._constraining=!1);if(this.latRange){const he=V.y,ce=O.y/2;he-ce<b&&(y=b+ce),he+ce>P&&(y=P-ce)}if(this.lngRange){const he=(C+M)/2,ce=l.wrap(V.x,he-this.worldSize/2,he+this.worldSize/2),pe=O.x/2;ce-pe<C&&(p=C+pe),ce+pe>M&&(p=M-pe)}p===void 0&&y===void 0||(this.center=this.unproject(new l.Point(p!==void 0?p:V.x,y!==void 0?y:V.y)).wrap()),this._unmodified=U,this._constraining=!1}_calcMatrices(){if(!this.height)return;const a=this.centerOffset,d=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let y=l.identity(new Float64Array(16));l.scale(y,y,[this.width/2,-this.height/2,1]),l.translate(y,y,[1,-1,0]),this.labelPlaneMatrix=y,y=l.identity(new Float64Array(16)),l.scale(y,y,[1,-1,1]),l.translate(y,y,[-1,-1,0]),l.scale(y,y,[2/this.width,2/this.height,1]),this.glCoordMatrix=y;const b=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),P=Math.min(this.elevation,this._minEleveationForCurrentTile),C=b-P*this._pixelPerMeter/Math.cos(this._pitch),M=P<0?C:b,O=Math.PI/2+this._pitch,U=this._fov*(.5+a.y/this.height),V=Math.sin(U)*M/Math.sin(l.clamp(Math.PI-O-U,.01,Math.PI-.01)),X=this.getHorizon(),he=2*Math.atan(X/this.cameraToCenterDistance)*(.5+a.y/(2*X)),ce=Math.sin(he)*M/Math.sin(l.clamp(Math.PI-O-he,.01,Math.PI-.01)),pe=Math.min(V,ce),ae=1.01*(Math.cos(Math.PI/2-this._pitch)*pe+M),Pe=this.height/50;y=new Float64Array(16),l.perspective(y,this._fov,this.width/this.height,Pe,ae),y[8]=2*-a.x/this.width,y[9]=2*a.y/this.height,l.scale(y,y,[1,-1,1]),l.translate(y,y,[0,0,-this.cameraToCenterDistance]),l.rotateX(y,y,this._pitch),l.rotateZ(y,y,this.angle),l.translate(y,y,[-d,-p,0]),this.mercatorMatrix=l.scale([],y,[this.worldSize,this.worldSize,this.worldSize]),l.scale(y,y,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,y),l.translate(y,y,[0,0,-this.elevation]),this.projMatrix=y,this.invProjMatrix=l.invert([],y),this.pixelMatrix3D=l.multiply(new Float64Array(16),this.labelPlaneMatrix,y);const Oe=this.width%2/2,ge=this.height%2/2,Ie=Math.cos(this.angle),Ne=Math.sin(this.angle),Ue=d-Math.round(d)+Ie*Oe+Ne*ge,Ze=p-Math.round(p)+Ie*ge+Ne*Oe,et=new Float64Array(y);if(l.translate(et,et,[Ue>.5?Ue-1:Ue,Ze>.5?Ze-1:Ze,0]),this.alignedProjMatrix=et,y=l.invert(new Float64Array(16),this.pixelMatrix),!y)throw new Error("failed to invert matrix");this.pixelMatrixInverse=y,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const a=this.pointCoordinate(new l.Point(0,0)),d=[a.x*this.worldSize,a.y*this.worldSize,0,1];return l.transformMat4(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,a))}getCameraQueryGeometry(a){const d=this.getCameraPoint();if(a.length===1)return[a[0],d];{let p=d.x,y=d.y,b=d.x,P=d.y;for(const C of a)p=Math.min(p,C.x),y=Math.min(y,C.y),b=Math.max(b,C.x),P=Math.max(P,C.y);return[new l.Point(p,y),new l.Point(b,y),new l.Point(b,P),new l.Point(p,P),new l.Point(p,y)]}}}function ja(v,a){let d,p=!1,y=null,b=null;const P=()=>{y=null,p&&(v.apply(b,d),y=setTimeout(P,a),p=!1)};return(...C)=>(p=!0,b=this,d=C,y||P(),y)}class Nc{constructor(a){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let p;return d.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(p=y)}),(p&&p[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:p,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,d)}catch{}},this._updateHash=ja(this._updateHashUnthrottled,300),this._hashName=a&&encodeURIComponent(a)}addTo(a){return this._map=a,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(a){const d=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,y),P=Math.round(d.lng*b)/b,C=Math.round(d.lat*b)/b,M=this._map.getBearing(),O=this._map.getPitch();let U="";if(U+=a?`/${P}/${C}/${p}`:`${p}/${C}/${P}`,(M||O)&&(U+="/"+Math.round(10*M)/10),O&&(U+=`/${Math.round(O)}`),this._hashName){const V=this._hashName;let X=!1;const he=window.location.hash.slice(1).split("&").map(ce=>{const pe=ce.split("=")[0];return pe===V?(X=!0,`${pe}=${U}`):ce}).filter(ce=>ce);return X||he.push(`${V}=${U}`),`#${he.join("&")}`}return`#${U}`}}const Ml={linearity:.3,easing:l.bezier(0,0,.3,1)},dg=l.extend({deceleration:2500,maxSpeed:1400},Ml),fg=l.extend({deceleration:20,maxSpeed:1400},Ml),pg=l.extend({deceleration:1e3,maxSpeed:360},Ml),mg=l.extend({deceleration:1e3,maxSpeed:90},Ml);class gg{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.browser.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,d=l.browser.now();for(;a.length>0&&d-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)d.zoom+=b.zoomDelta||0,d.bearing+=b.bearingDelta||0,d.pitch+=b.pitchDelta||0,b.panDelta&&d.pan._add(b.panDelta),b.around&&(d.around=b.around),b.pinchAround&&(d.pinchAround=b.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(d.pan.mag()){const b=Bc(d.pan.mag(),p,l.extend({},dg,a||{}));y.offset=d.pan.mult(b.amount/d.pan.mag()),y.center=this._map.transform.center,go(y,b)}if(d.zoom){const b=Bc(d.zoom,p,fg);y.zoom=this._map.transform.zoom+b.amount,go(y,b)}if(d.bearing){const b=Bc(d.bearing,p,pg);y.bearing=this._map.transform.bearing+l.clamp(b.amount,-179,179),go(y,b)}if(d.pitch){const b=Bc(d.pitch,p,mg);y.pitch=this._map.transform.pitch+b.amount,go(y,b)}if(y.zoom||y.bearing){const b=d.pinchAround===void 0?d.around:d.pinchAround;y.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),l.extend(y,{noMoveStart:!0})}}function go(v,a){(!v.duration||v.duration<a.duration)&&(v.duration=a.duration,v.easing=a.easing)}function Bc(v,a,d){const{maxSpeed:p,linearity:y,deceleration:b}=d,P=l.clamp(v*y/(a/1e3),-p,p),C=Math.abs(P)/(b*y);return{easing:d.easing,duration:1e3*C,amount:P*(C/2)}}class ds extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,p,y={}){const b=_.mousePos(d.getCanvasContainer(),p),P=d.unproject(b);super(a,l.extend({point:b,lngLat:P,originalEvent:p},y)),this._defaultPrevented=!1,this.target=d}}class Uc extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,p){const y=a==="touchend"?p.changedTouches:p.touches,b=_.touchPos(d.getCanvasContainer(),y),P=b.map(M=>d.unproject(M)),C=b.reduce((M,O,U,V)=>M.add(O.div(V.length)),new l.Point(0,0));super(a,{points:b,point:C,lngLats:P,lngLat:d.unproject(C),originalEvent:p}),this._defaultPrevented=!1}}class yg extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,p){super(a,{originalEvent:p}),this._defaultPrevented=!1}}class _g{constructor(a,d){this._map=a,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(a){return this._firePreventable(new yg(a.type,this._map,a))}mousedown(a,d){return this._mousedownPos=d,this._firePreventable(new ds(a.type,this._map,a))}mouseup(a){this._map.fire(new ds(a.type,this._map,a))}click(a,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new ds(a.type,this._map,a))}dblclick(a){return this._firePreventable(new ds(a.type,this._map,a))}mouseover(a){this._map.fire(new ds(a.type,this._map,a))}mouseout(a){this._map.fire(new ds(a.type,this._map,a))}touchstart(a){return this._firePreventable(new Uc(a.type,this._map,a))}touchmove(a){this._map.fire(new Uc(a.type,this._map,a))}touchend(a){this._map.fire(new Uc(a.type,this._map,a))}touchcancel(a){this._map.fire(new Uc(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vg{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(a){this._map.fire(new ds(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ds("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._ignoreContextMenu||this._map.fire(new ds(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Uo{constructor(a){this._map=a}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(a){return this.transform.pointLocation(l.Point.convert(a),this._map.terrain)}}class xg{constructor(a,d){this._map=a,this._tr=new Uo(a),this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,d){this.isEnabled()&&a.shiftKey&&a.button===0&&(_.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(a,d){if(!this._active)return;const p=d;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=p,this._box||(this._box=_.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",a));const b=Math.min(y.x,p.x),P=Math.max(y.x,p.x),C=Math.min(y.y,p.y),M=Math.max(y.y,p.y);_.setTransform(this._box,`translate(${b}px,${C}px)`),this._box.style.width=P-b+"px",this._box.style.height=M-C+"px"}mouseupWindow(a,d){if(!this._active||a.button!==0)return;const p=this._startPos,y=d;if(this.reset(),_.suppressClick(),p.x!==y.x||p.y!==y.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:a})),{cameraAnimation:b=>b.fitScreenCoordinates(p,y,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",a)}keydown(a){this._active&&a.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",a))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(_.remove(this._box),this._box=null),_.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(a,d){return this._map.fire(new l.Event(a,{originalEvent:d}))}}function As(v,a){if(v.length!==a.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${a.length}`);const d={};for(let p=0;p<v.length;p++)d[v[p].identifier]=a[p];return d}class Vo{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(a,d,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=a.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const b=new l.Point(0,0);for(const P of y)b._add(P);return b.div(y.length)}(d),this.touches=As(p,d)))}touchmove(a,d,p){if(this.aborted||!this.centroid)return;const y=As(p,d);for(const b in this.touches){const P=y[b];(!P||P.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(a,d,p){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class nh{constructor(a){this.singleTap=new Vo(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(a,d,p){this.singleTap.touchstart(a,d,p)}touchmove(a,d,p){this.singleTap.touchmove(a,d,p)}touchend(a,d,p){const y=this.singleTap.touchend(a,d,p);if(y){const b=a.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(y)<30;if(b&&P||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class jo{constructor(a){this._tr=new Uo(a),this._zoomIn=new nh({numTouches:1,numTaps:2}),this._zoomOut=new nh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,d,p){this._zoomIn.touchstart(a,d,p),this._zoomOut.touchstart(a,d,p)}touchmove(a,d,p){this._zoomIn.touchmove(a,d,p),this._zoomOut.touchmove(a,d,p)}touchend(a,d,p){const y=this._zoomIn.touchend(a,d,p),b=this._zoomOut.touchend(a,d,p),P=this._tr;return y?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:P.zoom+1,around:P.unproject(y)},{originalEvent:a})}):b?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:P.zoom-1,around:P.unproject(b)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $o{constructor(a){this._enabled=!!a.enable,this._moveStateManager=a.moveStateManager,this._clickTolerance=a.clickTolerance||1,this._moveFunction=a.move,this._activateOnStart=!!a.activateOnStart,a.assignEvents(this),this.reset()}reset(a){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(a)}_move(...a){const d=this._moveFunction(...a);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(a,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(a)&&(this._moveStateManager.startMove(a),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(a,d){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(a.preventDefault(),!this._moveStateManager.isValidMoveEvent(a))return void this.reset(a);const y=d.length?d[0]:d;return!this._moved&&y.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=y,this._move(p,y))}dragEnd(a){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(a)&&(this._moved&&_.suppressClick(),this.reset(a))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Hv={0:1,2:2};class uf{constructor(a){this._correctEvent=a.checkCorrectEvent}startMove(a){const d=_.mouseButton(a);this._eventButton=d}endMove(a){delete this._eventButton}isValidStartEvent(a){return this._correctEvent(a)}isValidMoveEvent(a){return!function(d,p){const y=Hv[p];return d.buttons===void 0||(d.buttons&y)!==y}(a,this._eventButton)}isValidEndEvent(a){return _.mouseButton(a)===this._eventButton}}class bg{constructor(){this._firstTouch=void 0}_isOneFingerTouch(a){return a.targetTouches.length===1}_isSameTouchEvent(a){return a.targetTouches[0].identifier===this._firstTouch}startMove(a){this._firstTouch=a.targetTouches[0].identifier}endMove(a){delete this._firstTouch}isValidStartEvent(a){return this._isOneFingerTouch(a)}isValidMoveEvent(a){return this._isOneFingerTouch(a)&&this._isSameTouchEvent(a)}isValidEndEvent(a){return this._isOneFingerTouch(a)&&this._isSameTouchEvent(a)}}const rh=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=function(a){a.preventDefault()}},kl=({enable:v,clickTolerance:a,bearingDegreesPerPixelMoved:d=.8})=>{const p=new uf({checkCorrectEvent:y=>_.mouseButton(y)===0&&y.ctrlKey||_.mouseButton(y)===2});return new $o({clickTolerance:a,move:(y,b)=>({bearingDelta:(b.x-y.x)*d}),moveStateManager:p,enable:v,assignEvents:rh})},Go=({enable:v,clickTolerance:a,pitchDegreesPerPixelMoved:d=-.5})=>{const p=new uf({checkCorrectEvent:y=>_.mouseButton(y)===0&&y.ctrlKey||_.mouseButton(y)===2});return new $o({clickTolerance:a,move:(y,b)=>({pitchDelta:(b.y-y.y)*d}),moveStateManager:p,enable:v,assignEvents:rh})};class kt{constructor(a,d){this._minTouches=a.cooperativeGestures?2:1,this._clickTolerance=a.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(a,d,p){return this._calculateTransform(a,d,p)}touchmove(a,d,p){if(this._map._cooperativeGestures&&(this._minTouches===2&&p.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(a,!1,p.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(p.length<this._minTouches))return a.preventDefault(),this._calculateTransform(a,d,p)}touchend(a,d,p){this._calculateTransform(a,d,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,d,p){p.length>0&&(this._active=!0);const y=As(p,d),b=new l.Point(0,0),P=new l.Point(0,0);let C=0;for(const O in y){const U=y[O],V=this._touches[O];V&&(b._add(U),P._add(U.sub(V)),C++,y[O]=U)}if(this._touches=y,C<this._minTouches||!P.mag())return;const M=P.div(C);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(C),panDelta:M}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ih{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(a,d,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([d[0],d[1]]))}touchmove(a,d,p){if(!this._firstTwoTouches)return;a.preventDefault();const[y,b]=this._firstTwoTouches,P=fa(p,d,y),C=fa(p,d,b);if(!P||!C)return;const M=this._aroundCenter?null:P.add(C).div(2);return this._move([P,C],M,a)}touchend(a,d,p){if(!this._firstTwoTouches)return;const[y,b]=this._firstTwoTouches,P=fa(p,d,y),C=fa(p,d,b);P&&C||(this._active&&_.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&a.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function fa(v,a,d){for(let p=0;p<v.length;p++)if(v[p].identifier===d)return a[p]}function Ll(v,a){return Math.log(v/a)/Math.LN2}class wg extends ih{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,d){const p=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(Ll(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ll(this._distance,p),pinchAround:d}}}function Tt(v,a){return 180*v.angleWith(a)/Math.PI}class hf extends ih{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,d){const p=this._vector;if(this._vector=a[0].sub(a[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Tt(this._vector,p),pinchAround:d}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const d=25/(Math.PI*this._minDiameter)*360,p=Tt(a,this._startVector);return Math.abs(p)<d}}function df(v){return Math.abs(v.y)>Math.abs(v.x)}class qv extends ih{constructor(a){super(),this._map=a}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(a,d,p){super.touchstart(a,d,p),this._currentTouchCount=p.length}_start(a){this._lastPoints=a,df(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,d,p){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const y=a[0].sub(this._lastPoints[0]),b=a[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,b,p.timeStamp),this._valid?(this._lastPoints=a,this._active=!0,{pitchDelta:(y.y+b.y)/2*-.5}):void 0}gestureBeginsVertically(a,d,p){if(this._valid!==void 0)return this._valid;const y=a.mag()>=2,b=d.mag()>=2;if(!y&&!b)return;if(!y||!b)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const P=a.y>0==d.y>0;return df(a)&&df(d)&&P}}const ff={panStep:100,bearingStep:15,pitchStep:10};class Eg{constructor(a){this._tr=new Uo(a);const d=ff;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let d=0,p=0,y=0,b=0,P=0;switch(a.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:a.shiftKey?p=-1:(a.preventDefault(),b=-1);break;case 39:a.shiftKey?p=1:(a.preventDefault(),b=1);break;case 38:a.shiftKey?y=1:(a.preventDefault(),P=-1);break;case 40:a.shiftKey?y=-1:(a.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:C=>{const M=this._tr;C.easeTo({duration:300,easeId:"keyboardHandler",easing:Tg,zoom:d?Math.round(M.zoom)+d*(a.shiftKey?2:1):M.zoom,bearing:M.bearing+p*this._bearingStep,pitch:M.pitch+y*this._pitchStep,offset:[-b*this._panStep,-P*this._panStep],center:M.center},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Tg(v){return v*(2-v)}const Sg=4.000244140625;class Zv{constructor(a,d){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=a,this._tr=new Uo(a),this._el=a.getCanvasContainer(),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&a.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(a){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!a[this._map._metaKey])return;a.preventDefault()}let d=a.deltaMode===WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const p=l.browser.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,d!==0&&d%Sg==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(y*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),a.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=a,this._delta-=d,this._active||this._start(a)),a.preventDefault()}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=_.mousePos(this._el,a),p=this._tr;this._around=l.LngLat.convert(this._aroundCenter?p.center:p.unproject(d)),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._tr.transform;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>Sg?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&M!==0&&(M=1/M);const O=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(O*M))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,p=this._startZoom,y=this._easing;let b,P=!1;if(this._type==="wheel"&&p&&y){const C=Math.min((l.browser.now()-this._lastWheelEventTime)/200,1),M=y(C);b=l.interpolate.number(p,d,M),C<1?this._frameId||(this._frameId=!0):P=!0}else b=d,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!P,zoomDelta:b-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let d=l.defaultEasing;if(this._prevEase){const p=this._prevEase,y=(l.browser.now()-p.start)/p.duration,b=p.easing(y+.01)-p.easing(y),P=.27/Math.sqrt(b*b+1e-4)*.01,C=Math.sqrt(.0729-P*P);d=l.bezier(P,C,.25,1)}return this._prevEase={start:l.browser.now(),duration:a,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class pf{constructor(a,d){this._clickZoom=a,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class mf{constructor(a){this._tr=new Uo(a),this.reset()}reset(){this._active=!1}dblclick(a,d){return a.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(a.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gf{constructor(){this._tap=new nh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(a,d,p){if(!this._swipePoint)if(this._tapTime){const y=d[0],b=a.timeStamp-this._tapTime<500,P=this._tapPoint.dist(y)<30;b&&P?p.length>0&&(this._swipePoint=y,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(a,d,p)}touchmove(a,d,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=d[0],b=y.y-this._swipePoint.y;return this._swipePoint=y,a.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(a,d,p)}touchend(a,d,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const y=this._tap.touchend(a,d,p);y&&(this._tapTime=a.timeStamp,this._tapPoint=y)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yf{constructor(a,d,p){this._el=a,this._mousePan=d,this._touchPan=p}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qi{constructor(a,d,p){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=d,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class pa{constructor(a,d,p,y){this._el=a,this._touchZoom=d,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Vc=v=>v.zoom||v.drag||v.pitch||v.rotate;class _f extends l.Event{}function jc(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class vf{constructor(a,d){this.handleWindowEvent=y=>{this.handleEvent(y,`${y.type}Window`)},this.handleEvent=(y,b)=>{if(y.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const P=y.type==="renderFrame"?void 0:y,C={needsRenderFrame:!1},M={},O={},U=y.touches,V=U?this._getMapTouches(U):void 0,X=V?_.touchPos(this._el,V):_.mousePos(this._el,y);for(const{handlerName:pe,handler:ae,allowed:Pe}of this._handlers){if(!ae.isEnabled())continue;let Oe;this._blockedByActive(O,Pe,pe)?ae.reset():ae[b||y.type]&&(Oe=ae[b||y.type](y,X,V),this.mergeHandlerResult(C,M,Oe,pe,P),Oe&&Oe.needsRenderFrame&&this._triggerRenderFrame()),(Oe||ae.isActive())&&(O[pe]=ae)}const he={};for(const pe in this._previousActiveHandlers)O[pe]||(he[pe]=P);this._previousActiveHandlers=O,(Object.keys(he).length||jc(C))&&(this._changes.push([C,M,he]),this._triggerRenderFrame()),(Object.keys(O).length||jc(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ce}=C;ce&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ce(this._map))},this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new gg(a),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,b,P]of this._listeners)_.addEventListener(y,b,y===document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[a,d,p]of this._listeners)_.removeEventListener(a,d,a===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(a){const d=this._map,p=d.getCanvasContainer();this._add("mapEvent",new _g(d,a));const y=d.boxZoom=new xg(d,a);this._add("boxZoom",y),a.interactive&&a.boxZoom&&y.enable();const b=new jo(d),P=new mf(d);d.doubleClickZoom=new pf(P,b),this._add("tapZoom",b),this._add("clickZoom",P),a.interactive&&a.doubleClickZoom&&d.doubleClickZoom.enable();const C=new gf;this._add("tapDragZoom",C);const M=d.touchPitch=new qv(d);this._add("touchPitch",M),a.interactive&&a.touchPitch&&d.touchPitch.enable(a.touchPitch);const O=kl(a),U=Go(a);d.dragRotate=new qi(a,O,U),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",U,["mouseRotate"]),a.interactive&&a.dragRotate&&d.dragRotate.enable();const V=(({enable:Pe,clickTolerance:Oe})=>{const ge=new uf({checkCorrectEvent:Ie=>_.mouseButton(Ie)===0&&!Ie.ctrlKey});return new $o({clickTolerance:Oe,move:(Ie,Ne)=>({around:Ne,panDelta:Ne.sub(Ie)}),activateOnStart:!0,moveStateManager:ge,enable:Pe,assignEvents:rh})})(a),X=new kt(a,d);d.dragPan=new yf(p,V,X),this._add("mousePan",V),this._add("touchPan",X,["touchZoom","touchRotate"]),a.interactive&&a.dragPan&&d.dragPan.enable(a.dragPan);const he=new hf,ce=new wg;d.touchZoomRotate=new pa(p,ce,he,C),this._add("touchRotate",he,["touchPan","touchZoom"]),this._add("touchZoom",ce,["touchPan","touchRotate"]),a.interactive&&a.touchZoomRotate&&d.touchZoomRotate.enable(a.touchZoomRotate);const pe=d.scrollZoom=new Zv(d,()=>this._triggerRenderFrame());this._add("scrollZoom",pe,["mousePan"]),a.interactive&&a.scrollZoom&&d.scrollZoom.enable(a.scrollZoom);const ae=d.keyboard=new Eg(d);this._add("keyboard",ae),a.interactive&&a.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new vg(d))}_add(a,d,p){this._handlers.push({handlerName:a,handler:d,allowed:p}),this._handlersById[a]=d}stop(a){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Vc(this._eventsInProgress)||this.isZooming()}_blockedByActive(a,d,p){for(const y in a)if(y!==p&&(!d||d.indexOf(y)<0))return!0;return!1}_getMapTouches(a){const d=[];for(const p of a)this._el.contains(p.target)&&d.push(p);return d}mergeHandlerResult(a,d,p,y,b){if(!p)return;l.extend(a,p);const P={handlerName:y,originalEvent:p.originalEvent||b};p.zoomDelta!==void 0&&(d.zoom=P),p.panDelta!==void 0&&(d.drag=P),p.pitchDelta!==void 0&&(d.pitch=P),p.bearingDelta!==void 0&&(d.rotate=P)}_applyChanges(){const a={},d={},p={};for(const[y,b,P]of this._changes)y.panDelta&&(a.panDelta=(a.panDelta||new l.Point(0,0))._add(y.panDelta)),y.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(a.around=y.around),y.pinchAround!==void 0&&(a.pinchAround=y.pinchAround),y.noInertia&&(a.noInertia=y.noInertia),l.extend(d,b),l.extend(p,P);this._updateMapTransform(a,d,p),this._changes=[]}_updateMapTransform(a,d,p){const y=this._map,b=y._getTransformForUpdate(),P=y.terrain;if(!(jc(a)||P&&this._terrainMovement))return this._fireEvents(d,p,!0);let{panDelta:C,zoomDelta:M,bearingDelta:O,pitchDelta:U,around:V,pinchAround:X}=a;X!==void 0&&(V=X),y._stop(!0),V=V||y.transform.centerPoint;const he=b.pointLocation(C?V.sub(C):V);O&&(b.bearing+=O),U&&(b.pitch+=U),M&&(b.zoom+=M),P?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?b.center=b.pointLocation(b.centerPoint.sub(C)):b.setLocationAtPoint(he,V):(this._terrainMovement=!0,this._map._elevationFreeze=!0,b.setLocationAtPoint(he,V),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,b.recalculateZoom(y.terrain)})):b.setLocationAtPoint(he,V),y._applyUpdatedTransform(b),this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(d,p,!0)}_fireEvents(a,d,p){const y=Vc(this._eventsInProgress),b=Vc(a),P={};for(const U in a){const{originalEvent:V}=a[U];this._eventsInProgress[U]||(P[`${U}start`]=V),this._eventsInProgress[U]=a[U]}!y&&b&&this._fireEvent("movestart",b.originalEvent);for(const U in P)this._fireEvent(U,P[U]);b&&this._fireEvent("move",b.originalEvent);for(const U in a){const{originalEvent:V}=a[U];this._fireEvent(U,V)}const C={};let M;for(const U in this._eventsInProgress){const{handlerName:V,originalEvent:X}=this._eventsInProgress[U];this._handlersById[V].isActive()||(delete this._eventsInProgress[U],M=d[V]||X,C[`${U}end`]=M)}for(const U in C)this._fireEvent(U,C[U]);const O=Vc(this._eventsInProgress);if(p&&(y||b)&&!O){this._updatingCamera=!0;const U=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!U||!U.essential&&l.browser.prefersReducedMotion?(this._map.fire(new l.Event("moveend",{originalEvent:M})),V(this._map.getBearing())&&this._map.resetNorth()):(V(U.bearing||this._map.getBearing())&&(U.bearing=0),U.freezeElevation=!0,this._map.easeTo(U,{originalEvent:M})),this._updatingCamera=!1}}_fireEvent(a,d){this._map.fire(new l.Event(a,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{delete this._frameId,this.handleEvent(new _f("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Pg extends l.Evented{constructor(a,d){super(),this._renderFrameCallback=()=>{const p=Math.min((l.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(a,d){return this.jumpTo({center:a},d)}panBy(a,d,p){return a=l.Point.convert(a).mult(-1),this.panTo(this.transform.center,l.extend({offset:a},d),p)}panTo(a,d,p){return this.easeTo(l.extend({center:a},d),p)}getZoom(){return this.transform.zoom}setZoom(a,d){return this.jumpTo({zoom:a},d),this}zoomTo(a,d,p){return this.easeTo(l.extend({zoom:a},d),p)}zoomIn(a,d){return this.zoomTo(this.getZoom()+1,a,d),this}zoomOut(a,d){return this.zoomTo(this.getZoom()-1,a,d),this}getBearing(){return this.transform.bearing}setBearing(a,d){return this.jumpTo({bearing:a},d),this}getPadding(){return this.transform.padding}setPadding(a,d){return this.jumpTo({padding:a},d),this}rotateTo(a,d,p){return this.easeTo(l.extend({bearing:a},d),p)}resetNorth(a,d){return this.rotateTo(0,l.extend({duration:1e3},a),d),this}resetNorthPitch(a,d){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},a),d),this}snapToNorth(a,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,d):this}getPitch(){return this.transform.pitch}setPitch(a,d){return this.jumpTo({pitch:a},d),this}cameraForBounds(a,d){a=ot.convert(a);const p=d&&d.bearing||0;return this._cameraForBoxAndBearing(a.getNorthWest(),a.getSouthEast(),p,d)}_cameraForBoxAndBearing(a,d,p,y){const b={top:0,bottom:0,right:0,left:0};if(typeof(y=l.extend({padding:b,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const Ne=y.padding;y.padding={top:Ne,bottom:Ne,right:Ne,left:Ne}}y.padding=l.extend(b,y.padding);const P=this.transform,C=P.padding,M=P.project(l.LngLat.convert(a)),O=P.project(l.LngLat.convert(d)),U=M.rotate(-p*Math.PI/180),V=O.rotate(-p*Math.PI/180),X=new l.Point(Math.max(U.x,V.x),Math.max(U.y,V.y)),he=new l.Point(Math.min(U.x,V.x),Math.min(U.y,V.y)),ce=X.sub(he),pe=(P.width-(C.left+C.right+y.padding.left+y.padding.right))/ce.x,ae=(P.height-(C.top+C.bottom+y.padding.top+y.padding.bottom))/ce.y;if(ae<0||pe<0)return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Pe=Math.min(P.scaleZoom(P.scale*Math.min(pe,ae)),y.maxZoom),Oe=l.Point.convert(y.offset),ge=new l.Point((y.padding.left-y.padding.right)/2,(y.padding.top-y.padding.bottom)/2).rotate(p*Math.PI/180),Ie=Oe.add(ge).mult(P.scale/P.zoomScale(Pe));return{center:P.unproject(M.add(O).div(2).sub(Ie)),zoom:Pe,bearing:p}}fitBounds(a,d,p){return this._fitInternal(this.cameraForBounds(a,d),d,p)}fitScreenCoordinates(a,d,p,y,b){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.Point.convert(a)),this.transform.pointLocation(l.Point.convert(d)),p,y),y,b)}_fitInternal(a,d,p){return a?(delete(d=l.extend(a,d)).padding,d.linear?this.easeTo(d,p):this.flyTo(d,p)):this}jumpTo(a,d){this.stop();const p=this._getTransformForUpdate();let y=!1,b=!1,P=!1;return"zoom"in a&&p.zoom!==+a.zoom&&(y=!0,p.zoom=+a.zoom),a.center!==void 0&&(p.center=l.LngLat.convert(a.center)),"bearing"in a&&p.bearing!==+a.bearing&&(b=!0,p.bearing=+a.bearing),"pitch"in a&&p.pitch!==+a.pitch&&(P=!0,p.pitch=+a.pitch),a.padding==null||p.isPaddingEqual(a.padding)||(p.padding=a.padding),this._applyUpdatedTransform(p),this.fire(new l.Event("movestart",d)).fire(new l.Event("move",d)),y&&this.fire(new l.Event("zoomstart",d)).fire(new l.Event("zoom",d)).fire(new l.Event("zoomend",d)),b&&this.fire(new l.Event("rotatestart",d)).fire(new l.Event("rotate",d)).fire(new l.Event("rotateend",d)),P&&this.fire(new l.Event("pitchstart",d)).fire(new l.Event("pitch",d)).fire(new l.Event("pitchend",d)),this.fire(new l.Event("moveend",d))}calculateCameraOptionsFromTo(a,d,p,y=0){const b=l.MercatorCoordinate.fromLngLat(a,d),P=l.MercatorCoordinate.fromLngLat(p,y),C=P.x-b.x,M=P.y-b.y,O=P.z-b.z,U=Math.hypot(C,M,O);if(U===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(C,M),X=this.transform.scaleZoom(this.transform.cameraToCenterDistance/U/this.transform.tileSize),he=180*Math.atan2(C,-M)/Math.PI;let ce=180*Math.acos(V/U)/Math.PI;return ce=O<0?90-ce:90+ce,{center:P.toLngLat(),zoom:X,pitch:ce,bearing:he}}easeTo(a,d){this._stop(!1,a.easeId),((a=l.extend({offset:[0,0],duration:500,easing:l.defaultEasing},a)).animate===!1||!a.essential&&l.browser.prefersReducedMotion)&&(a.duration=0);const p=this._getTransformForUpdate(),y=this.getZoom(),b=this.getBearing(),P=this.getPitch(),C=this.getPadding(),M="zoom"in a?+a.zoom:y,O="bearing"in a?this._normalizeBearing(a.bearing,b):b,U="pitch"in a?+a.pitch:P,V="padding"in a?a.padding:p.padding,X=l.Point.convert(a.offset);let he=p.centerPoint.add(X);const ce=p.pointLocation(he),pe=l.LngLat.convert(a.center||ce);this._normalizeCenter(pe);const ae=p.project(ce),Pe=p.project(pe).sub(ae),Oe=p.zoomScale(M-y);let ge,Ie;a.around&&(ge=l.LngLat.convert(a.around),Ie=p.locationPoint(ge));const Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||M!==y,this._rotating=this._rotating||b!==O,this._pitching=this._pitching||U!==P,this._padding=!p.isPaddingEqual(V),this._easeId=a.easeId,this._prepareEase(d,a.noMoveStart,Ne),this.terrain&&this._prepareElevation(pe),this._ease(Ue=>{if(this._zooming&&(p.zoom=l.interpolate.number(y,M,Ue)),this._rotating&&(p.bearing=l.interpolate.number(b,O,Ue)),this._pitching&&(p.pitch=l.interpolate.number(P,U,Ue)),this._padding&&(p.interpolatePadding(C,V,Ue),he=p.centerPoint.add(X)),this.terrain&&!a.freezeElevation&&this._updateElevation(Ue),ge)p.setLocationAtPoint(ge,Ie);else{const Ze=p.zoomScale(p.zoom-y),et=M>y?Math.min(2,Oe):Math.max(.5,Oe),Ke=Math.pow(et,1-Ue),at=p.unproject(ae.add(Pe.mult(Ue*Ke)).mult(Ze));p.setLocationAtPoint(p.renderWorldCopies?at.wrap():at,he)}this._applyUpdatedTransform(p),this._fireMoveEvents(d)},Ue=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,Ue)},a),this}_prepareEase(a,d,p={}){this._moving=!0,d||p.moving||this.fire(new l.Event("movestart",a)),this._zooming&&!p.zooming&&this.fire(new l.Event("zoomstart",a)),this._rotating&&!p.rotating&&this.fire(new l.Event("rotatestart",a)),this._pitching&&!p.pitching&&this.fire(new l.Event("pitchstart",a))}_prepareElevation(a){this._elevationCenter=a,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(a){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(a<1&&d!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=a*(p-(d-(p*a+this._elevationStart))/(1-a)),this._elevationTarget=d}this.transform.elevation=l.interpolate.number(this._elevationStart,this._elevationTarget,a)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(a){if(!this.transformCameraUpdate)return;const d=a.clone(),{center:p,zoom:y,pitch:b,bearing:P,elevation:C}=this.transformCameraUpdate(d);p&&(d.center=p),y!==void 0&&(d.zoom=y),b!==void 0&&(d.pitch=b),P!==void 0&&(d.bearing=P),C!==void 0&&(d.elevation=C),this.transform.apply(d)}_fireMoveEvents(a){this.fire(new l.Event("move",a)),this._zooming&&this.fire(new l.Event("zoom",a)),this._rotating&&this.fire(new l.Event("rotate",a)),this._pitching&&this.fire(new l.Event("pitch",a))}_afterEase(a,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const p=this._zooming,y=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new l.Event("zoomend",a)),y&&this.fire(new l.Event("rotateend",a)),b&&this.fire(new l.Event("pitchend",a)),this.fire(new l.Event("moveend",a))}flyTo(a,d){if(!a.essential&&l.browser.prefersReducedMotion){const Gt=l.pick(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Gt,d)}this.stop(),a=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.defaultEasing},a);const p=this._getTransformForUpdate(),y=this.getZoom(),b=this.getBearing(),P=this.getPitch(),C=this.getPadding(),M="zoom"in a?l.clamp(+a.zoom,p.minZoom,p.maxZoom):y,O="bearing"in a?this._normalizeBearing(a.bearing,b):b,U="pitch"in a?+a.pitch:P,V="padding"in a?a.padding:p.padding,X=p.zoomScale(M-y),he=l.Point.convert(a.offset);let ce=p.centerPoint.add(he);const pe=p.pointLocation(ce),ae=l.LngLat.convert(a.center||pe);this._normalizeCenter(ae);const Pe=p.project(pe),Oe=p.project(ae).sub(Pe);let ge=a.curve;const Ie=Math.max(p.width,p.height),Ne=Ie/X,Ue=Oe.mag();if("minZoom"in a){const Gt=l.clamp(Math.min(a.minZoom,y,M),p.minZoom,p.maxZoom),Hn=Ie/p.zoomScale(Gt-y);ge=Math.sqrt(Hn/Ue*2)}const Ze=ge*ge;function et(Gt){const Hn=(Ne*Ne-Ie*Ie+(Gt?-1:1)*Ze*Ze*Ue*Ue)/(2*(Gt?Ne:Ie)*Ze*Ue);return Math.log(Math.sqrt(Hn*Hn+1)-Hn)}function Ke(Gt){return(Math.exp(Gt)-Math.exp(-Gt))/2}function at(Gt){return(Math.exp(Gt)+Math.exp(-Gt))/2}const Vt=et(!1);let An=function(Gt){return at(Vt)/at(Vt+ge*Gt)},yt=function(Gt){return Ie*((at(Vt)*(Ke(Hn=Vt+ge*Gt)/at(Hn))-Ke(Vt))/Ze)/Ue;var Hn},an=(et(!0)-Vt)/ge;if(Math.abs(Ue)<1e-6||!isFinite(an)){if(Math.abs(Ie-Ne)<1e-6)return this.easeTo(a,d);const Gt=Ne<Ie?-1:1;an=Math.abs(Math.log(Ne/Ie))/ge,yt=function(){return 0},An=function(Hn){return Math.exp(Gt*ge*Hn)}}return a.duration="duration"in a?+a.duration:1e3*an/("screenSpeed"in a?+a.screenSpeed/ge:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0),this._zooming=!0,this._rotating=b!==O,this._pitching=U!==P,this._padding=!p.isPaddingEqual(V),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(ae),this._ease(Gt=>{const Hn=Gt*an,Pn=1/An(Hn);p.zoom=Gt===1?M:y+p.scaleZoom(Pn),this._rotating&&(p.bearing=l.interpolate.number(b,O,Gt)),this._pitching&&(p.pitch=l.interpolate.number(P,U,Gt)),this._padding&&(p.interpolatePadding(C,V,Gt),ce=p.centerPoint.add(he)),this.terrain&&!a.freezeElevation&&this._updateElevation(Gt);const _n=Gt===1?ae:p.unproject(Pe.add(Oe.mult(yt(Hn))).mult(Pn));p.setLocationAtPoint(p.renderWorldCopies?_n.wrap():_n,ce),this._applyUpdatedTransform(p),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(a,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,d)}if(!a){const p=this.handlers;p&&p.stop(!1)}return this}_ease(a,d,p){p.animate===!1||p.duration===0?(a(1),d()):(this._easeStart=l.browser.now(),this._easeOptions=p,this._onEaseFrame=a,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(a,d){a=l.wrap(a,-180,180);const p=Math.abs(a-d);return Math.abs(a-360-d)<p&&(a-=360),Math.abs(a+360-d)<p&&(a+=360),a}_normalizeCenter(a){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const p=a.lng-d.center.lng;a.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(a){return this.terrain?this.terrain.getElevationForLngLatZoom(l.LngLat.convert(a),this.transform.tileZoom)-this.transform.elevation:null}}class fs{constructor(a={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=a}getDefaultPosition(){return"bottom-right"}onAdd(a){return this._map=a,this._compact=this.options&&this.options.compact,this._container=_.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=_.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=_.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){_.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(a,d){const p=this._map._getUIString(`AttributionControl.${d}`);a.title=p,a.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(y=>typeof y!="string"?"":y)):typeof this.options.customAttribution=="string"&&a.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const d=this._map.style.sourceCaches;for(const y in d){const b=d[y];if(b.used||b.usedForTerrain){const P=b.getSource();P.attribution&&a.indexOf(P.attribution)<0&&a.push(P.attribution)}}a=a.filter(y=>String(y).trim()),a.sort((y,b)=>y.length-b.length),a=a.filter((y,b)=>{for(let P=b+1;P<a.length;P++)if(a[P].indexOf(y)>=0)return!1;return!0});const p=a.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,a.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class sr{constructor(a={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const p=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=a}getDefaultPosition(){return"bottom-left"}onAdd(a){this._map=a,this._compact=this.options&&this.options.compact,this._container=_.create("div","maplibregl-ctrl");const d=_.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){_.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class sh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const d=++this._id;return this._queue.push({callback:a,id:d,cancelled:!1}),d}remove(a){const d=this._currentlyRunning,p=d?this._queue.concat(d):this._queue;for(const y of p)if(y.id===a)return void(y.cancelled=!0)}run(a=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const p of d)if(!p.cancelled&&(p.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const xf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Cg=l.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class Ag extends l.Evented{constructor(a){super(),this.sourceCache=a,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,a.usedForTerrain=!0,a.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(a,d){this.sourceCache.update(a,d),this._renderableTilesKeys=[];const p={};for(const y of a.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))p[y.key]=!0,this._renderableTilesKeys.push(y.key),this._tiles[y.key]||(y.posMatrix=new Float64Array(16),l.ortho(y.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),this._tiles[y.key]=new pt(y,this.tileSize));for(const y in this._tiles)p[y]||delete this._tiles[y]}freeRtt(a){for(const d in this._tiles){const p=this._tiles[d];(!a||p.tileID.equals(a)||p.tileID.isChildOf(a)||a.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(a=>this.getTileByID(a))}getTileByID(a){return this._tiles[a]}getTerrainCoords(a){const d={};for(const p of this._renderableTilesKeys){const y=this._tiles[p].tileID;if(y.canonical.equals(a.canonical)){const b=a.clone();b.posMatrix=new Float64Array(16),l.ortho(b.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),d[p]=b}else if(y.canonical.isChildOf(a.canonical)){const b=a.clone();b.posMatrix=new Float64Array(16);const P=y.canonical.z-a.canonical.z,C=y.canonical.x-(y.canonical.x>>P<<P),M=y.canonical.y-(y.canonical.y>>P<<P),O=l.EXTENT>>P;l.ortho(b.posMatrix,0,O,0,O,0,1),l.translate(b.posMatrix,b.posMatrix,[-C*O,-M*O,0]),d[p]=b}else if(a.canonical.isChildOf(y.canonical)){const b=a.clone();b.posMatrix=new Float64Array(16);const P=a.canonical.z-y.canonical.z,C=a.canonical.x-(a.canonical.x>>P<<P),M=a.canonical.y-(a.canonical.y>>P<<P),O=l.EXTENT>>P;l.ortho(b.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),l.translate(b.posMatrix,b.posMatrix,[C*O,M*O,0]),l.scale(b.posMatrix,b.posMatrix,[1/2**P,1/2**P,0]),d[p]=b}}return d}getSourceTile(a,d){const p=this.sourceCache._source;let y=a.overscaledZ-this.deltaZoom;if(y>p.maxzoom&&(y=p.maxzoom),y<p.minzoom)return null;this._sourceTileCache[a.key]||(this._sourceTileCache[a.key]=a.scaledTo(y).key);let b=this.sourceCache.getTileByID(this._sourceTileCache[a.key]);if((!b||!b.dem)&&d)for(;y>=p.minzoom&&(!b||!b.dem);)b=this.sourceCache.getTileByID(a.scaledTo(y--).key);return b}tilesAfterTime(a=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=a)}}class Ig{constructor(a,d,p){this.painter=a,this.sourceCache=new Ag(d),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(a,d,p,y=l.EXTENT){var b;if(!(d>=0&&d<y&&p>=0&&p<y))return 0;const P=this.getTerrainData(a),C=(b=P.tile)===null||b===void 0?void 0:b.dem;if(!C)return 0;const M=function(ce,pe,ae){var Pe=pe[0],Oe=pe[1];return ce[0]=ae[0]*Pe+ae[4]*Oe+ae[12],ce[1]=ae[1]*Pe+ae[5]*Oe+ae[13],ce}([],[d/y*l.EXTENT,p/y*l.EXTENT],P.u_terrain_matrix),O=[M[0]*C.dim,M[1]*C.dim],U=Math.floor(O[0]),V=Math.floor(O[1]),X=O[0]-U,he=O[1]-V;return C.get(U,V)*(1-X)*(1-he)+C.get(U+1,V)*X*(1-he)+C.get(U,V+1)*(1-X)*he+C.get(U+1,V+1)*X*he}getElevationForLngLatZoom(a,d){const{tileID:p,mercatorX:y,mercatorY:b}=this._getOverscaledTileIDFromLngLatZoom(a,d);return this.getElevation(p,y%l.EXTENT,b%l.EXTENT,l.EXTENT)}getElevation(a,d,p,y=l.EXTENT){return this.getDEMElevation(a,d,p,y)*this.exaggeration}getTerrainData(a){if(!this._emptyDemTexture){const y=this.painter.context,b=new l.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new fe(y,b,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new fe(y,new l.RGBAImage({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.identity([])}const d=this.sourceCache.getSourceTile(a,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const y=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new fe(y,d.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),d.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const p=d&&d+d.tileID.key+a.key;if(p&&!this._demMatrixCache[p]){const y=this.sourceCache.sourceCache._source.maxzoom;let b=a.canonical.z-d.tileID.canonical.z;a.overscaledZ>a.canonical.z&&(a.canonical.z>=y?b=a.canonical.z-y:l.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const P=a.canonical.x-(a.canonical.x>>b<<b),C=a.canonical.y-(a.canonical.y>>b<<b),M=l.fromScaling(new Float64Array(16),[1/(l.EXTENT<<b),1/(l.EXTENT<<b),0]);l.translate(M,M,[P*l.EXTENT,C*l.EXTENT,0]),this._demMatrixCache[a.key]={matrix:M,coord:a}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[a.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(a){const d=this.painter,p=d.width/devicePixelRatio,y=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new fe(d.context,{width:p,height:y,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new fe(d.context,{width:p,height:y,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(p,y,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,p,y))),this._fbo.colorAttachment.set(a==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const a=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let b=0,P=0;b<this._coordsTextureSize;b++)for(let C=0;C<this._coordsTextureSize;C++,P+=4)d[P+0]=255&C,d[P+1]=255&b,d[P+2]=C>>8<<4|b>>8,d[P+3]=0;const p=new l.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),y=new fe(a,p,a.gl.RGBA,{premultiply:!1});return y.bind(a.gl.NEAREST,a.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(a){const d=new Uint8Array(4),p=this.painter.context,y=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),y.readPixels(a.x,this.painter.height/devicePixelRatio-a.y-1,1,1,y.RGBA,y.UNSIGNED_BYTE,d),p.bindFramebuffer.set(null);const b=d[0]+(d[2]>>4<<8),P=d[1]+((15&d[2])<<8),C=this.coordsIndex[255-d[3]],M=C&&this.sourceCache.getTileByID(C);if(!M)return null;const O=this._coordsTextureSize,U=(1<<M.tileID.canonical.z)*O;return new l.MercatorCoordinate((M.tileID.canonical.x*O+b)/U,(M.tileID.canonical.y*O+P)/U,this.getElevation(M.tileID,b,P,O))}getTerrainMesh(){if(this._mesh)return this._mesh;const a=this.painter.context,d=new l.Pos3dArray,p=new l.TriangleIndexArray,y=this.meshSize,b=l.EXTENT/y,P=y*y;for(let V=0;V<=y;V++)for(let X=0;X<=y;X++)d.emplaceBack(X*b,V*b,0);for(let V=0;V<P;V+=y+1)for(let X=0;X<y;X++)p.emplaceBack(X+V,y+X+V+1,y+X+V+2),p.emplaceBack(X+V,y+X+V+2,X+V+1);const C=d.length,M=C+2*(y+1);for(const V of[0,1])for(let X=0;X<=y;X++)for(const he of[0,1])d.emplaceBack(X*b,V*l.EXTENT,he);for(let V=0;V<2*y;V+=2)p.emplaceBack(M+V,M+V+1,M+V+3),p.emplaceBack(M+V,M+V+3,M+V+2),p.emplaceBack(C+V,C+V+3,C+V+1),p.emplaceBack(C+V,C+V+2,C+V+3);const O=d.length,U=O+2*(y+1);for(const V of[0,1])for(let X=0;X<=y;X++)for(const he of[0,1])d.emplaceBack(V*l.EXTENT,X*b,he);for(let V=0;V<2*y;V+=2)p.emplaceBack(O+V,O+V+1,O+V+3),p.emplaceBack(O+V,O+V+3,O+V+2),p.emplaceBack(U+V,U+V+3,U+V+1),p.emplaceBack(U+V,U+V+2,U+V+3);return this._mesh={indexBuffer:a.createIndexBuffer(p),vertexBuffer:a.createVertexBuffer(d,Cg.members),segments:l.SegmentVector.simpleSegment(0,0,d.length,p.length)},this._mesh}getMeshFrameDelta(a){return 2*Math.PI*l.earthRadius/Math.pow(2,a)/5}getMinTileElevationForLngLatZoom(a,d){var p;const{tileID:y}=this._getOverscaledTileIDFromLngLatZoom(a,d);return(p=this.getMinMaxElevation(y).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(a){const d=this.getTerrainData(a).tile,p={minElevation:null,maxElevation:null};return d&&d.dem&&(p.minElevation=d.dem.min*this.exaggeration,p.maxElevation=d.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(a,d){const p=l.MercatorCoordinate.fromLngLat(a.wrap()),y=(1<<d)*l.EXTENT,b=p.x*y,P=p.y*y,C=Math.floor(b/l.EXTENT),M=Math.floor(P/l.EXTENT);return{tileID:new l.OverscaledTileID(d,0,d,C,M),mercatorX:b,mercatorY:P}}}class Xv{constructor(a,d,p){this._context=a,this._size=d,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const a of this._objects)a.texture.destroy(),a.fbo.destroy()}_createObject(a){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new fe(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(p.texture),{id:a,fbo:d,texture:p,stamp:-1,inUse:!1}}getObjectForId(a){return this._objects[a]}useObject(a){a.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>a.id!==d),this._recentlyUsed.push(a.id)}stampObject(a){a.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const a=this._createObject(this._objects.length);return this._objects.push(a),a}freeObject(a){a.inUse=!1}freeAllObjects(){for(const a of this._objects)this.freeObject(a)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(a=>!a.inUse)===!1}}const Li={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class oh{constructor(a,d){this.painter=a,this.terrain=d,this.pool=new Xv(a.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(a){return this.pool.getObjectForId(a.rtt[this._stacks.length-1].id).texture}prepareForRender(a,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=a._order.filter(p=>!a._layers[p].isHidden(d)),this._coordsDescendingInv={};for(const p in a.sourceCaches){this._coordsDescendingInv[p]={};const y=a.sourceCaches[p].getVisibleCoordinates();for(const b of y){const P=this.terrain.sourceCache.getTerrainCoords(b);for(const C in P)this._coordsDescendingInv[p][C]||(this._coordsDescendingInv[p][C]=[]),this._coordsDescendingInv[p][C].push(P[C])}}this._coordsDescendingInvStr={};for(const p of a._order){const y=a._layers[p],b=y.source;if(Li[y.type]&&!this._coordsDescendingInvStr[b]){this._coordsDescendingInvStr[b]={};for(const P in this._coordsDescendingInv[b])this._coordsDescendingInvStr[b][P]=this._coordsDescendingInv[b][P].map(C=>C.key).sort().join()}}for(const p of this._renderableTiles)for(const y in this._coordsDescendingInvStr){const b=this._coordsDescendingInvStr[y][p.tileID.key];b&&b!==p.rttCoords[y]&&(p.rtt=[])}}renderLayer(a){if(a.isHidden(this.painter.transform.zoom))return!1;const d=a.type,p=this.painter,y=this._renderableLayerIds[this._renderableLayerIds.length-1]===a.id;if(Li[d]&&(this._prevType&&Li[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(a.id),!y))return!0;if(Li[this._prevType]||Li[d]&&y){this._prevType=d;const b=this._stacks.length-1,P=this._stacks[b]||[];for(const C of this._renderableTiles){if(this.pool.isFull()&&(br(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(C),C.rtt[b]){const O=this.pool.getObjectForId(C.rtt[b].id);if(O.stamp===C.rtt[b].stamp){this.pool.useObject(O);continue}}const M=this.pool.getOrCreateFreeObject();this.pool.useObject(M),this.pool.stampObject(M),C.rtt[b]={id:M.id,stamp:M.stamp},p.context.bindFramebuffer.set(M.fbo.framebuffer),p.context.clear({color:l.Color.transparent,stencil:0}),p.currentStencilSource=void 0;for(let O=0;O<P.length;O++){const U=p.style._layers[P[O]],V=U.source?this._coordsDescendingInv[U.source][C.tileID.key]:[C.tileID];p.context.viewport.set([0,0,M.fbo.width,M.fbo.height]),p._renderTileClippingMasks(U,V),p.renderLayer(p,p.style.sourceCaches[U.source],U,V),U.source&&(C.rttCoords[U.source]=this._coordsDescendingInvStr[U.source][C.tileID.key])}}return br(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Li[d]}return!1}}const Xt=m,on={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},$c=v=>{v.touchstart=v.dragStart,v.touchmoveWindow=v.dragMove,v.touchend=v.dragEnd},bf={showCompass:!0,showZoom:!0,visualizePitch:!1};class wf{constructor(a,d,p=!1){this.mousedown=P=>{this.startMouse(l.extend({},P,{ctrlKey:!0,preventDefault:()=>P.preventDefault()}),_.mousePos(this.element,P)),_.addEventListener(window,"mousemove",this.mousemove),_.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=P=>{this.moveMouse(P,_.mousePos(this.element,P))},this.mouseup=P=>{this.mouseRotate.dragEnd(P),this.mousePitch&&this.mousePitch.dragEnd(P),this.offTemp()},this.touchstart=P=>{P.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=_.touchPos(this.element,P.targetTouches)[0],this.startTouch(P,this._startPos),_.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.addEventListener(window,"touchend",this.touchend))},this.touchmove=P=>{P.targetTouches.length!==1?this.reset():(this._lastPos=_.touchPos(this.element,P.targetTouches)[0],this.moveTouch(P,this._lastPos))},this.touchend=P=>{P.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const y=a.dragRotate._mouseRotate.getClickTolerance(),b=a.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=kl({clickTolerance:y,enable:!0}),this.touchRotate=(({enable:P,clickTolerance:C,bearingDegreesPerPixelMoved:M=.8})=>{const O=new bg;return new $o({clickTolerance:C,move:(U,V)=>({bearingDelta:(V.x-U.x)*M}),moveStateManager:O,enable:P,assignEvents:$c})})({clickTolerance:y,enable:!0}),this.map=a,p&&(this.mousePitch=Go({clickTolerance:b,enable:!0}),this.touchPitch=(({enable:P,clickTolerance:C,pitchDegreesPerPixelMoved:M=-.5})=>{const O=new bg;return new $o({clickTolerance:C,move:(U,V)=>({pitchDelta:(V.y-U.y)*M}),moveStateManager:O,enable:P,assignEvents:$c})})({clickTolerance:b,enable:!0})),_.addEventListener(d,"mousedown",this.mousedown),_.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),_.addEventListener(d,"touchcancel",this.reset)}startMouse(a,d){this.mouseRotate.dragStart(a,d),this.mousePitch&&this.mousePitch.dragStart(a,d),_.disableDrag()}startTouch(a,d){this.touchRotate.dragStart(a,d),this.touchPitch&&this.touchPitch.dragStart(a,d),_.disableDrag()}moveMouse(a,d){const p=this.map,{bearingDelta:y}=this.mouseRotate.dragMove(a,d)||{};if(y&&p.setBearing(p.getBearing()+y),this.mousePitch){const{pitchDelta:b}=this.mousePitch.dragMove(a,d)||{};b&&p.setPitch(p.getPitch()+b)}}moveTouch(a,d){const p=this.map,{bearingDelta:y}=this.touchRotate.dragMove(a,d)||{};if(y&&p.setBearing(p.getBearing()+y),this.touchPitch){const{pitchDelta:b}=this.touchPitch.dragMove(a,d)||{};b&&p.setPitch(p.getPitch()+b)}}off(){const a=this.element;_.removeEventListener(a,"mousedown",this.mousedown),_.removeEventListener(a,"touchstart",this.touchstart,{passive:!1}),_.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.removeEventListener(window,"touchend",this.touchend),_.removeEventListener(a,"touchcancel",this.reset),this.offTemp()}offTemp(){_.enableDrag(),_.removeEventListener(window,"mousemove",this.mousemove),_.removeEventListener(window,"mouseup",this.mouseup),_.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_.removeEventListener(window,"touchend",this.touchend)}}let zr;function Ef(v,a,d){if(v=new l.LngLat(v.lng,v.lat),a){const p=new l.LngLat(v.lng-360,v.lat),y=new l.LngLat(v.lng+360,v.lat),b=d.locationPoint(v).distSqr(a);d.locationPoint(p).distSqr(a)<b?v=p:d.locationPoint(y).distSqr(a)<b&&(v=y)}for(;Math.abs(v.lng-d.center.lng)>180;){const p=d.locationPoint(v);if(p.x>=0&&p.y>=0&&p.x<=d.width&&p.y<=d.height)break;v.lng>d.center.lng?v.lng-=360:v.lng+=360}return v}const Is={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Mg(v,a,d){const p=v.classList;for(const y in Is)p.remove(`maplibregl-${d}-anchor-${y}`);p.add(`maplibregl-${d}-anchor-${a}`)}class $a extends l.Evented{constructor(a){if(super(),this._onKeyPress=d=>{const p=d.code,y=d.charCode||d.keyCode;p!=="Space"&&p!=="Enter"&&y!==32&&y!==13||this.togglePopup()},this._onMapClick=d=>{const p=d.originalEvent.target,y=this._element;this._popup&&(p===y||y.contains(p))&&this.togglePopup()},this._update=d=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!p)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Ef(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b=`rotateX(${this._map.getPitch()}deg)`),d&&d.type!=="moveend"||(this._pos=this._pos.round()),_.setTransform(this._element,`${Is[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${b} ${y}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const P=this._map.unproject(this._pos),C=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=P.distanceTo(this._lngLat)>20*C?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=d=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._clickTolerance=a&&a.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment!=="auto"?a.pitchAlignment:this._rotationAlignment,a&&a.element)this._element=a.element,this._offset=l.Point.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=_.create("div"),this._element.setAttribute("aria-label","Map marker");const d=_.createNS("http://www.w3.org/2000/svg","svg"),p=41,y=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${p}px`),d.setAttributeNS(null,"width",`${y}px`),d.setAttributeNS(null,"viewBox",`0 0 ${y} ${p}`);const b=_.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"stroke","none"),b.setAttributeNS(null,"stroke-width","1"),b.setAttributeNS(null,"fill","none"),b.setAttributeNS(null,"fill-rule","evenodd");const P=_.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill-rule","nonzero");const C=_.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Pe of M){const Oe=_.createNS("http://www.w3.org/2000/svg","ellipse");Oe.setAttributeNS(null,"opacity","0.04"),Oe.setAttributeNS(null,"cx","10.5"),Oe.setAttributeNS(null,"cy","5.80029008"),Oe.setAttributeNS(null,"rx",Pe.rx),Oe.setAttributeNS(null,"ry",Pe.ry),C.appendChild(Oe)}const O=_.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);const U=_.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(U);const V=_.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"opacity","0.25"),V.setAttributeNS(null,"fill","#000000");const X=_.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),V.appendChild(X);const he=_.createNS("http://www.w3.org/2000/svg","g");he.setAttributeNS(null,"transform","translate(6.0, 7.0)"),he.setAttributeNS(null,"fill","#FFFFFF");const ce=_.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"transform","translate(8.0, 8.0)");const pe=_.createNS("http://www.w3.org/2000/svg","circle");pe.setAttributeNS(null,"fill","#000000"),pe.setAttributeNS(null,"opacity","0.25"),pe.setAttributeNS(null,"cx","5.5"),pe.setAttributeNS(null,"cy","5.5"),pe.setAttributeNS(null,"r","5.4999962");const ae=_.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#FFFFFF"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962"),ce.appendChild(pe),ce.appendChild(ae),P.appendChild(C),P.appendChild(O),P.appendChild(V),P.appendChild(he),P.appendChild(ce),d.appendChild(P),d.setAttributeNS(null,"height",p*this._scale+"px"),d.setAttributeNS(null,"width",y*this._scale+"px"),this._element.appendChild(d),this._offset=l.Point.convert(a&&a.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),Mg(this._element,this._anchor,"marker"),a&&a.className)for(const d of a.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),a.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),_.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=l.LngLat.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const y=Math.abs(13.5)/Math.SQRT2;a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const a=this._popup;return a?(a.isOpen()?a.remove():a.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(a){return this._offset=l.Point.convert(a),this._update(),this}addClassName(a){this._element.classList.add(a)}removeClassName(a){this._element.classList.remove(a)}toggleClassName(a){return this._element.classList.toggle(a)}setDraggable(a){return this._draggable=!!a,this._map&&(a?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a&&a!=="auto"?a:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const wr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let yr=0,Rl=!1;const Gc={maxWidth:100,unit:"metric"};function Wc(v,a,d){const p=d&&d.maxWidth||100,y=v._container.clientHeight/2,b=v.unproject([0,y]),P=v.unproject([p,y]),C=b.distanceTo(P);if(d&&d.unit==="imperial"){const M=3.2808*C;M>5280?Ga(a,p,M/5280,v._getUIString("ScaleControl.Miles")):Ga(a,p,M,v._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?Ga(a,p,C/1852,v._getUIString("ScaleControl.NauticalMiles")):C>=1e3?Ga(a,p,C/1e3,v._getUIString("ScaleControl.Kilometers")):Ga(a,p,C,v._getUIString("ScaleControl.Meters"))}function Ga(v,a,d,p){const y=function(b){const P=Math.pow(10,`${Math.floor(b)}`.length-1);let C=b/P;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(M){const O=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*O)/O}(C),P*C}(d);v.style.width=a*(y/d)+"px",v.innerHTML=`${y}&nbsp;${p}`}const Tf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Sf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ol(v){if(v){if(typeof v=="number"){const a=Math.round(Math.abs(v)/Math.SQRT2);return{center:new l.Point(0,0),top:new l.Point(0,v),"top-left":new l.Point(a,a),"top-right":new l.Point(-a,a),bottom:new l.Point(0,-v),"bottom-left":new l.Point(a,-a),"bottom-right":new l.Point(-a,-a),left:new l.Point(v,0),right:new l.Point(-v,0)}}if(v instanceof l.Point||Array.isArray(v)){const a=l.Point.convert(v);return{center:a,top:a,"top-left":a,"top-right":a,bottom:a,"bottom-left":a,"bottom-right":a,left:a,right:a}}return{center:l.Point.convert(v.center||[0,0]),top:l.Point.convert(v.top||[0,0]),"top-left":l.Point.convert(v["top-left"]||[0,0]),"top-right":l.Point.convert(v["top-right"]||[0,0]),bottom:l.Point.convert(v.bottom||[0,0]),"bottom-left":l.Point.convert(v["bottom-left"]||[0,0]),"bottom-right":l.Point.convert(v["bottom-right"]||[0,0]),left:l.Point.convert(v.left||[0,0]),right:l.Point.convert(v.right||[0,0])}}return Ol(new l.Point(0,0))}const Pf={extend:(v,...a)=>l.extend(v,...a),run(v){v()},logToElement(v,a=!1,d="log"){const p=window.document.getElementById(d);p&&(a&&(p.innerHTML=""),p.innerHTML+=`<br>${v}`)}},Cf=m;class Gn{static get version(){return Cf}static get workerCount(){return Qe.workerCount}static set workerCount(a){Qe.workerCount=a}static get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(a){l.config.MAX_PARALLEL_IMAGE_REQUESTS=a}static get workerUrl(){return l.config.WORKER_URL}static set workerUrl(a){l.config.WORKER_URL=a}static addProtocol(a,d){l.config.REGISTERED_PROTOCOLS[a]=d}static removeProtocol(a){delete l.config.REGISTERED_PROTOCOLS[a]}}return Gn.Map=class extends Pg{constructor(v){if(l.PerformanceUtils.mark(l.PerformanceMarkers.create),(v=l.extend({},on,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new th(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),{bearingSnap:v.bearingSnap}),this._cooperativeGesturesOnWheel=a=>{this._onCooperativeGesture(a,a[this._metaKey],1)},this._contextLost=a=>{a.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=v.interactive,this._cooperativeGestures=v.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=v.maxTileCacheSize,this._maxTileCacheZoomLevels=v.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._crossSourceCollisions=v.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=v.collectResourceTiming,this._renderTaskQueue=new sh,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},xf,v.locale),this._clickTolerance=v.clickTolerance,this._overridePixelRatio=v.pixelRatio,this._maxCanvasSize=v.maxCanvasSize,this.transformCameraUpdate=v.transformCameraUpdate,this._imageQueueHandle=W.addThrottleControl(()=>this.isMoving()),this._requestManager=new N(v.transformRequest),typeof v.container=="string"){if(this._container=document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(v.maxBounds&&this.setMaxBounds(v.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const d=ja(p=>{this._trackResize&&!this._removed&&this.resize(p)._update()},50);this._resizeObserver=new ResizeObserver(p=>{a?d(p):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new vf(this,v),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=v.hash&&new Nc(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,l.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=v.localIdeographFontFamily,this._validateStyle=v.validateStyle,v.style&&this.setStyle(v.style,{localIdeographFontFamily:v.localIdeographFontFamily}),v.attributionControl&&this.addControl(new fs({customAttribution:v.customAttribution})),v.maplibreLogo&&this.addControl(new sr,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new l.Event(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new l.Event(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new l.Event("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(v,a){if(a===void 0&&(a=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=v.onAdd(this);this._controls.push(v);const p=this._controlPositions[a];return a.indexOf("bottom")!==-1?p.insertBefore(d,p.firstChild):p.appendChild(d),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(v);return a>-1&&this._controls.splice(a,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}calculateCameraOptionsFromTo(v,a,d,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,a,d,p)}resize(v){var a;const d=this._containerDimensions(),p=d[0],y=d[1],b=this._getClampedPixelRatio(p,y);if(this._resizeCanvas(p,y,b),this.painter.resize(p,y,b),this.painter.overLimit()){const C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const M=this._getClampedPixelRatio(p,y);this._resizeCanvas(p,y,M),this.painter.resize(p,y,M)}this.transform.resize(p,y),(a=this._requestedCameraState)===null||a===void 0||a.resize(p,y);const P=!this._moving;return P&&(this.stop(),this.fire(new l.Event("movestart",v)).fire(new l.Event("move",v))),this.fire(new l.Event("resize",v)),P&&this.fire(new l.Event("moveend",v)),this}_getClampedPixelRatio(v,a){const{0:d,1:p}=this._maxCanvasSize,y=this.getPixelRatio(),b=v*y,P=a*y;return Math.min(b>d?d/b:1,P>p?p/P:1)*y}getPixelRatio(){var v;return(v=this._overridePixelRatio)!==null&&v!==void 0?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(ot.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(v){return this._cooperativeGestures=v,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(v){return this.transform.locationPoint(l.LngLat.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.pointLocation(l.Point.convert(v),this.terrain)}isMoving(){var v;return this._moving||((v=this.handlers)===null||v===void 0?void 0:v.isMoving())}isZooming(){var v;return this._zooming||((v=this.handlers)===null||v===void 0?void 0:v.isZooming())}isRotating(){var v;return this._rotating||((v=this.handlers)===null||v===void 0?void 0:v.isRotating())}_createDelegatedListener(v,a,d){if(v==="mouseenter"||v==="mouseover"){let p=!1;return{layer:a,listener:d,delegates:{mousemove:b=>{const P=this.getLayer(a)?this.queryRenderedFeatures(b.point,{layers:[a]}):[];P.length?p||(p=!0,d.call(this,new ds(v,this,b.originalEvent,{features:P}))):p=!1},mouseout:()=>{p=!1}}}}if(v==="mouseleave"||v==="mouseout"){let p=!1;return{layer:a,listener:d,delegates:{mousemove:P=>{(this.getLayer(a)?this.queryRenderedFeatures(P.point,{layers:[a]}):[]).length?p=!0:p&&(p=!1,d.call(this,new ds(v,this,P.originalEvent)))},mouseout:P=>{p&&(p=!1,d.call(this,new ds(v,this,P.originalEvent)))}}}}{const p=y=>{const b=this.getLayer(a)?this.queryRenderedFeatures(y.point,{layers:[a]}):[];b.length&&(y.features=b,d.call(this,y),delete y.features)};return{layer:a,listener:d,delegates:{[v]:p}}}}on(v,a,d){if(d===void 0)return super.on(v,a);const p=this._createDelegatedListener(v,a,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(v,a,d){if(d===void 0)return super.once(v,a);const p=this._createDelegatedListener(v,a,d);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(v,a,d){return d===void 0?super.off(v,a):(this._delegatedListeners&&this._delegatedListeners[v]&&(p=>{const y=this._delegatedListeners[v];for(let b=0;b<y.length;b++){const P=y[b];if(P.layer===a&&P.listener===d){for(const C in P.delegates)this.off(C,P.delegates[C]);return y.splice(b,1),this}}})(),this)}queryRenderedFeatures(v,a){if(!this.style)return[];let d;const p=v instanceof l.Point||Array.isArray(v),y=p?v:[[0,0],[this.transform.width,this.transform.height]];if(a=a||(p?{}:v)||{},y instanceof l.Point||typeof y[0]=="number")d=[l.Point.convert(y)];else{const b=l.Point.convert(y[0]),P=l.Point.convert(y[1]);d=[b,new l.Point(P.x,b.y),P,new l.Point(b.x,P.y),b]}return this.style.queryRenderedFeatures(d,a,this.transform)}querySourceFeatures(v,a){return this.style.querySourceFeatures(v,a)}setStyle(v,a){return(a=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},a)).diff!==!1&&a.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,a),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._updateStyle(v,a))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const a=this._locale[v];if(a==null)throw new Error(`Missing UI string '${v}'`);return a}_updateStyle(v,a){if(a.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(v,a));const d=this.style&&a.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new Zn(this,a||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v,a,d):this.style.loadJSON(v,a,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Zn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,a){if(typeof v=="string"){const d=this._requestManager.transformRequest(v,z.Style);l.getJSON(d,(p,y)=>{p?this.fire(new l.ErrorEvent(p)):y&&this._updateDiff(y,a)})}else typeof v=="object"&&this._updateDiff(v,a)}_updateDiff(v,a){try{this.style.setState(v,a)&&this._update(!0)}catch(d){l.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(v,a)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")}addSource(v,a){return this._lazyInitEmptyStyle(),this.style.addSource(v,a),this._update(!0)}isSourceLoaded(v){const a=this.style&&this.style.sourceCaches[v];if(a!==void 0)return a.loaded();this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const a=this.style.sourceCaches[v.source];if(!a)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);for(const d in this.style._layers){const p=this.style._layers[d];p.type==="hillshade"&&p.source===v.source&&l.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ig(this.painter,a,v),this.painter.renderToTexture=new oh(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==v.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new l.Event("terrain",{terrain:v})),this}getTerrain(){var v,a;return(a=(v=this.terrain)===null||v===void 0?void 0:v.options)!==null&&a!==void 0?a:null}areTilesLoaded(){const v=this.style&&this.style.sourceCaches;for(const a in v){const d=v[a]._tiles;for(const p in d){const y=d[p];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}addSourceType(v,a,d){return this._lazyInitEmptyStyle(),this.style.addSourceType(v,a,d)}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,a,d={}){const{pixelRatio:p=1,sdf:y=!1,stretchX:b,stretchY:P,content:C}=d;if(this._lazyInitEmptyStyle(),!(a instanceof HTMLImageElement||l.isImageBitmap(a))){if(a.width===void 0||a.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:M,height:O,data:U}=a,V=a;return this.style.addImage(v,{data:new l.RGBAImage({width:M,height:O},new Uint8Array(U)),pixelRatio:p,stretchX:b,stretchY:P,content:C,sdf:y,version:0,userImage:V}),V.onAdd&&V.onAdd(this,v),this}}{const{width:M,height:O,data:U}=l.browser.getImageData(a);this.style.addImage(v,{data:new l.RGBAImage({width:M,height:O},U),pixelRatio:p,stretchX:b,stretchY:P,content:C,sdf:y,version:0})}}updateImage(v,a){const d=this.style.getImage(v);if(!d)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=a instanceof HTMLImageElement||l.isImageBitmap(a)?l.browser.getImageData(a):a,{width:y,height:b,data:P}=p;if(y===void 0||b===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==d.data.width||b!==d.data.height)return this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(a instanceof HTMLImageElement||l.isImageBitmap(a));return d.data.replace(P,C),this.style.updateImage(v,d),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,a){W.getImage(this._requestManager.transformRequest(v,z.Image),a)}listImages(){return this.style.listImages()}addLayer(v,a){return this._lazyInitEmptyStyle(),this.style.addLayer(v,a),this._update(!0)}moveLayer(v,a){return this.style.moveLayer(v,a),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,a,d){return this.style.setLayerZoomRange(v,a,d),this._update(!0)}setFilter(v,a,d={}){return this.style.setFilter(v,a,d),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,a,d,p={}){return this.style.setPaintProperty(v,a,d,p),this._update(!0)}getPaintProperty(v,a){return this.style.getPaintProperty(v,a)}setLayoutProperty(v,a,d,p={}){return this.style.setLayoutProperty(v,a,d,p),this._update(!0)}getLayoutProperty(v,a){return this.style.getLayoutProperty(v,a)}setGlyphs(v,a={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,a),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,a,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,a,d,p=>{p||this._update(!0)}),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,a={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,a,d=>{d||this._update(!0)}),this}setLight(v,a={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,a),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(v,a){return this.style.setFeatureState(v,a),this._update()}removeFeatureState(v,a){return this.style.removeFeatureState(v,a),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,a=0;return this._container&&(v=this._container.clientWidth||400,a=this._container.clientHeight||300),[v,a]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const a=this._canvasContainer=_.create("div","maplibregl-canvas-container",v);this._interactive&&a.classList.add("maplibregl-interactive"),this._canvas=_.create("canvas","maplibregl-canvas",a),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),p=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],p);const y=this._controlContainer=_.create("div","maplibregl-control-container",v),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(P=>{b[P]=_.create("div",`maplibregl-ctrl-${P} `,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=_.create("div","maplibregl-cooperative-gesture-screen",this._container);let v=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(v=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${v}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){_.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(v,a,d){this._canvas.width=Math.floor(d*v),this._canvas.height=Math.floor(d*a),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${a}px`}_setupPainter(){const v={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let a=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{a={requestedAttributes:v},p&&(a.statusMessage=p.statusMessage,a.type=p.type)},{once:!0});const d=this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v);if(!d){const p="Failed to initialize WebGL";throw a?(a.message=p,new Error(JSON.stringify(a))):new Error(p)}this.painter=new Va(d,this.transform),E.testSupport(d)}_onCooperativeGesture(v,a,d){return!a&&d<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){const a=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const y=this.transform.zoom,b=l.browser.now();this.style.zoomHistory.update(y,b);const P=new l.EvaluationParameters(y,{now:b,fadeDuration:a,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),C=P.crossFadingFactor();C===1&&C===this._crossFadingFactor||(d=!0,this._crossFadingFactor=C),this.style.update(P)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,a,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:a,showPadding:this.showPadding}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.load),this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),W.removeThrottleControl(this._imageQueueHandle),(v=this._resizeObserver)===null||v===void 0||v.disconnect();const a=this.painter.context.gl.getExtension("WEBGL_lose_context");a&&a.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),_.remove(this._canvasContainer),_.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),l.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.browser.frame(v=>{l.PerformanceUtils.frame(v),this._frame=null,this._render(v)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return Xt}getCameraTargetElevation(){return this.transform.elevation}},Gn.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const a=this._map.getZoom(),d=a===this._map.getMaxZoom(),p=a===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{const a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=a},this._setButtonTitle=(a,d)=>{const p=this._map._getUIString(`NavigationControl.${d}`);a.title=p,a.setAttribute("aria-label",p)},this.options=l.extend({},bf,v),this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",a=>this._map.zoomIn({},{originalEvent:a})),_.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",a=>this._map.zoomOut({},{originalEvent:a})),_.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",a=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:a}):this._map.resetNorth({},{originalEvent:a})}),this._compassIcon=_.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new wf(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){_.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,a){const d=_.create("button",v,this._container);return d.type="button",d.addEventListener("click",a),d}},Gn.GeolocateControl=class extends l.Evented{constructor(v){super(),this._onSuccess=a=>{if(this._map){if(this._isOutOfMapMaxBounds(a))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",a)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=a,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(a),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(a),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.Event("geolocate",a)),this._finish()}},this._updateCamera=a=>{const d=new l.LngLat(a.coords.longitude,a.coords.latitude),p=a.coords.accuracy,y=this._map.getBearing(),b=l.extend({bearing:y},this.options.fitBoundsOptions),P=ot.fromLngLat(d,p);this._map.fitBounds(P,b,{geolocateSource:!0})},this._updateMarker=a=>{if(a){const d=new l.LngLat(a.coords.longitude,a.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=a.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=a=>{if(this._map){if(this.options.trackUserLocation)if(a.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(a.code===3&&Rl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.Event("error",a)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=a=>{if(this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=_.create("button","maplibregl-ctrl-geolocate",this._container),_.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",a===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=_.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new $a({element:this._dotElement}),this._circleElement=_.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new $a({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}},this.options=l.extend({},wr,v)}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(a,d=!1){zr===void 0||d?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(p=>{zr=p.state!=="denied",a(zr)}).catch(()=>{zr=!!window.navigator.geolocation,a(zr)}):(zr=!!window.navigator.geolocation,a(zr)):a(zr)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),_.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,yr=0,Rl=!1}_isOutOfMapMaxBounds(v){const a=this._map.getMaxBounds(),d=v.coords;return a&&(d.longitude<a.getWest()||d.longitude>a.getEast()||d.latitude<a.getSouth()||d.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const v=this._map.getBounds(),a=v.getSouthEast(),d=v.getNorthEast(),p=a.distanceTo(d),y=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${y}px`,this._circleElement.style.height=`${y}px`}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":yr--,Rl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),yr++,yr>1?(v={maximumAge:6e5,timeout:0},Rl=!0):(v=this.options.positionOptions,Rl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Gn.AttributionControl=fs,Gn.LogoControl=sr,Gn.ScaleControl=class{constructor(v){this._onMove=()=>{Wc(this._map,this._container,this.options)},this.setUnit=a=>{this.options.unit=a,Wc(this._map,this._container,this.options)},this.options=l.extend({},Gc,v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){_.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Gn.FullscreenControl=class extends l.Evented{constructor(v={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){_.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=_.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);_.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new l.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Gn.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=v}onAdd(v){return this._map=v,this._container=_.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=_.create("button","maplibregl-ctrl-terrain",this._container),_.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){_.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Gn.Popup=class extends l.Evented{constructor(v){super(),this.remove=()=>(this._content&&_.remove(this._content),this._container&&(_.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this),this._onMouseUp=a=>{this._update(a.point)},this._onMouseMove=a=>{this._update(a.point)},this._onDrag=a=>{this._update(a.point)},this._update=a=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=_.create("div","maplibregl-popup",this._map.getContainer()),this._tip=_.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const P of this.options.className.split(" "))this._container.classList.add(P);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ef(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!a)return;const d=this._pos=this._trackPointer&&a?a:this._map.project(this._lngLat);let p=this.options.anchor;const y=Ol(this.options.offset);if(!p){const P=this._container.offsetWidth,C=this._container.offsetHeight;let M;M=d.y+y.bottom.y<C?["top"]:d.y>this._map.transform.height-C?["bottom"]:[],d.x<P/2?M.push("left"):d.x>this._map.transform.width-P/2&&M.push("right"),p=M.length===0?"bottom":M.join("-")}const b=d.add(y[p]).round();_.setTransform(this._container,`${Is[p]} translate(${b.x}px,${b.y}px)`),Mg(this._container,p,"popup")},this._onClose=()=>{this.remove()},this.options=l.extend(Object.create(Tf),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=l.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const a=document.createDocumentFragment(),d=document.createElement("body");let p;for(d.innerHTML=v;p=d.firstChild,p;)a.appendChild(p);return this.setDOMContent(a)}getMaxWidth(){var v;return(v=this._container)===null||v===void 0?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=_.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){this._container&&this._container.classList.add(v)}removeClassName(v){this._container&&this._container.classList.remove(v)}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}_createCloseButton(){this.options.closeButton&&(this._closeButton=_.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(Sf);v&&v.focus()}},Gn.Marker=$a,Gn.Style=Zn,Gn.LngLat=l.LngLat,Gn.LngLatBounds=ot,Gn.Point=l.Point,Gn.MercatorCoordinate=l.MercatorCoordinate,Gn.Evented=l.Evented,Gn.AJAXError=l.AJAXError,Gn.config=l.config,Gn.CanvasSource=hn,Gn.GeoJSONSource=Je,Gn.ImageSource=sn,Gn.RasterDEMTileSource=Jt,Gn.RasterTileSource=bt,Gn.VectorTileSource=xt,Gn.VideoSource=Qt,Gn.setRTLTextPlugin=l.setRTLTextPlugin,Gn.getRTLTextPluginStatus=l.getRTLTextPluginStatus,Gn.prewarm=function(){Rt().acquire(It)},Gn.clearPrewarmedResources=function(){const v=Mt;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(It),Mt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Pf.extend(Gn,{isSafari:l.isSafari,getPerformanceMetrics:l.PerformanceUtils.getPerformanceMetrics}),Gn});var h=i;return h})})(mO);var jH=mO.exports;const $H=Am(jH),GH=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,WH=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,vI=[0,0,0,255],HH={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:vI},getLineColor:{type:"accessor",value:vI},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class OT extends Ou{getShaders(){return super.getShaders({vs:GH,fs:WH,modules:[PT,CT]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o,stroked:h,filled:l,billboard:m,antialiasing:_,lineWidthUnits:E,lineWidthScale:T,lineWidthMinPixels:A,lineWidthMaxPixels:L}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:h?1:0,filled:l,billboard:m,antialiasing:_,radiusUnits:cm[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o,lineWidthUnits:cm[E],lineWidthScale:T,lineWidthMinPixels:A,lineWidthMaxPixels:L}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new mm(e,{...this.getShaders(),id:this.props.id,geometry:new xT({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}J(OT,"defaultProps",HH);J(OT,"layerName","ScatterplotLayer");const yO={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function _O(t,e,n={}){return qH(t,n)!==e?(XH(t,n),!0):!1}function qH(t,e={}){return Math.sign(ZH(t,e))}function ZH(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let o=0;for(let h=n,l=r-i;h<r;h+=i)o+=(t[h]-t[l])*(t[h+1]+t[l+1]),l=h;return o/2}function XH(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,o=(r-n)/i,h=Math.floor(o/2);for(let l=0;l<h;++l){const m=n+l*i,_=n+(o-1-l)*i;for(let E=0;E<i;++E){const T=t[m+E];t[m+E]=t[_+E],t[_+E]=T}}}function na(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function Fw(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function gm(t,e,n,r,i=[]){const o=r+e*n;for(let h=0;h<n;h++)i[h]=t[o+h];return i}function Nw(t,e,n,r,i=[]){let o,h;if(n&8)o=(r[3]-t[1])/(e[1]-t[1]),h=3;else if(n&4)o=(r[1]-t[1])/(e[1]-t[1]),h=1;else if(n&2)o=(r[2]-t[0])/(e[0]-t[0]),h=2;else if(n&1)o=(r[0]-t[0])/(e[0]-t[0]),h=0;else return null;for(let l=0;l<t.length;l++)i[l]=(h&1)===l?r[h]:o*(e[l]-t[l])+t[l];return i}function p0(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function vO(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:h=0,endIndex:l=t.length}=e||{},m=(l-h)/n;let _=[];const E=[_],T=gm(t,0,n,h);let A,L;const R=bO(T,i,o,[]),D=[];na(_,T);for(let W=1;W<m;W++){for(A=gm(t,W,n,h,A),L=p0(A,R);L;){Nw(T,A,L,R,D);const z=p0(D,R);z&&(Nw(T,D,z,R,D),L=z),na(_,D),Fw(T,D),KH(R,i,L),r&&_.length>n&&(_=[],E.push(_),na(_,T)),L=p0(A,R)}na(_,A),Fw(T,A)}return r?E:E[0]}const xI=0,YH=1;function My(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function xO(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:h=!1}=n||{},l=[],m=[{pos:t,types:h?new Array(t.length/r).fill(YH):null,holes:e||[]}],_=[[],[]];let E=[];for(;m.length;){const{pos:T,types:A,holes:L}=m.shift();JH(T,r,L[0]||T.length,_),E=bO(_[0],i,o,E);const R=p0(_[1],E);if(R){let D=bI(T,A,r,0,L[0]||T.length,E,R);const W={pos:D[0].pos,types:D[0].types,holes:[]},z={pos:D[1].pos,types:D[1].types,holes:[]};m.push(W,z);for(let N=0;N<L.length;N++)D=bI(T,A,r,L[N],L[N+1]||T.length,E,R),D[0]&&(W.holes.push(W.pos.length),W.pos=My(W.pos,D[0].pos),h&&(W.types=My(W.types,D[0].types))),D[1]&&(z.holes.push(z.pos.length),z.pos=My(z.pos,D[1].pos),h&&(z.types=My(z.types,D[1].types)))}else{const D={positions:T};h&&(D.edgeTypes=A),L.length&&(D.holeIndices=L),l.push(D)}}return l}function bI(t,e,n,r,i,o,h){const l=(i-r)/n,m=[],_=[],E=[],T=[],A=[];let L,R,D;const W=gm(t,l-1,n,r);let z=Math.sign(h&8?W[1]-o[3]:W[0]-o[2]),N=e&&e[l-1],F=0,$=0;for(let K=0;K<l;K++)L=gm(t,K,n,r,L),R=Math.sign(h&8?L[1]-o[3]:L[0]-o[2]),D=e&&e[r/n+K],R&&z&&z!==R&&(Nw(W,L,h,o,A),na(m,A)&&E.push(N),na(_,A)&&T.push(N)),R<=0?(na(m,L)&&E.push(D),F-=R):E.length&&(E[E.length-1]=xI),R>=0?(na(_,L)&&T.push(D),$+=R):T.length&&(T[T.length-1]=xI),Fw(W,L),z=R,N=D;return[F?{pos:m,types:e&&E}:null,$?{pos:_,types:e&&T}:null]}function bO(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function KH(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function JH(t,e,n,r){let i=1/0,o=-1/0,h=1/0,l=-1/0;for(let m=0;m<n;m+=e){const _=t[m],E=t[m+1];i=_<i?_:i,o=_>o?_:o,h=E<h?E:h,l=E>l?E:l}return r[0][0]=i,r[0][1]=h,r[1][0]=o,r[1][1]=l,r}const QH=85.051129;function eq(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:o=!0}=e||{},h=t.slice(r,i);wO(h,n,0,i-r);const l=vO(h,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const m of l)EO(m,n);return l}function tq(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:o=!1}=n||{};e=e||[];const h=[],l=[];let m=0,_=0;for(let T=0;T<=e.length;T++){const A=e[T]||t.length,L=_,R=nq(t,r,m,A);for(let D=R;D<A;D++)h[_++]=t[D];for(let D=m;D<R;D++)h[_++]=t[D];wO(h,r,L,_),rq(h,r,L,_,n==null?void 0:n.maxLatitude),m=A,l[T]=_}l.pop();const E=xO(h,l,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(const T of E)EO(T.positions,r);return E}function nq(t,e,n,r){let i=-1,o=-1;for(let h=n+1;h<r;h+=e){const l=Math.abs(t[h]);l>i&&(i=l,o=h-1)}return o}function rq(t,e,n,r,i=QH){const o=t[n],h=t[r-e];if(Math.abs(o-h)>180){const l=gm(t,0,e,n);l[0]+=Math.round((h-o)/360)*360,na(t,l),l[1]=Math.sign(l[1])*i,na(t,l),l[0]=o,na(t,l)}}function wO(t,e,n,r){let i=t[0],o;for(let h=n;h<r;h+=e){o=t[h];const l=o-i;(l>180||l<-180)&&(o-=Math.round(l/360)*360),t[h]=i=o}}function EO(t,e){let n;const r=t.length/e;for(let o=0;o<r&&(n=t[o*e],(n+180)%360===0);o++);const i=-Math.round(n/360)*360;if(i!==0)for(let o=0;o<r;o++)t[o*e]+=i}function iq(t,e,n,r){let i;if(Array.isArray(t[0])){const o=t.length*e;i=new Array(o);for(let h=0;h<t.length;h++)for(let l=0;l<e;l++)i[h*e+l]=t[h][l]||0}else i=t;return n?vO(i,{size:e,gridResolution:n}):r?eq(i,{size:e}):i}const sq=1,oq=2,W1=4;class aq extends hO{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?iq(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(wI(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&wI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:o,geometrySize:h}=n;r.fill(0,o,o+h),i?(r[o]=W1,r[o+h-2]=W1):(r[o]+=sq,r[o+h-2]+=oq),r[o+h-1]=W1}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:o}=n,h=new Array(3);for(let l=i,m=0;m<o;l++,m++)this.getPointOnPath(e,m,h),r[l*3]=h[0],r[l*3+1]=h[1],r[l*3+2]=h[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const o=n*i;return r[0]=e[o],r[1]=e[o+1],r[2]=i===3&&e[o+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function wI(t){return Array.isArray(t[0])}const lq=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,cq=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,TO=[0,0,0,255],uq={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:TO},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},H1={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class j_ extends Ou{constructor(...e){super(...e),J(this,"state",void 0)}getShaders(){return super.getShaders({vs:lq,fs:cq,modules:[PT,CT]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:H1,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:H1,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:H1,defaultValue:TO},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:o})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,o)}}),this.setState({pathTesselator:new aq({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:l}=this.state,m=n.data.attributes||{};l.updateGeometry({data:n.data,geometryBuffer:m.getPath,buffers:m,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:l.instanceCount,startIndices:l.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var h;const{gl:l}=this.context;(h=this.state.model)===null||h===void 0||h.delete(),this.state.model=this._getModel(l),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(o=>o.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:o,widthUnits:h,widthScale:l,widthMinPixels:m,widthMaxPixels:_}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:cm[h],widthScale:l,miterLimit:o,widthMinPixels:m,widthMaxPixels:_}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new mm(e,{...this.getShaders(),id:this.props.id,geometry:new xT({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}J(j_,"defaultProps",uq);J(j_,"layerName","PathLayer");var zT={exports:{}};zT.exports=$_;zT.exports.default=$_;function $_(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,o=SO(t,0,i,n,!0),h=[];if(!o||o.next===o.prev)return h;var l,m,_,E,T,A,L;if(r&&(o=mq(t,e,o,n)),t.length>80*n){l=_=t[0],m=E=t[1];for(var R=n;R<i;R+=n)T=t[R],A=t[R+1],T<l&&(l=T),A<m&&(m=A),T>_&&(_=T),A>E&&(E=A);L=Math.max(_-l,E-m),L=L!==0?32767/L:0}return ym(o,h,n,l,m,L,0),h}function SO(t,e,n,r,i){var o,h;if(i===Vw(t,e,n,r)>0)for(o=e;o<n;o+=r)h=EI(o,t[o],t[o+1],h);else for(o=n-r;o>=e;o-=r)h=EI(o,t[o],t[o+1],h);return h&&G_(h,h.next)&&(vm(h),h=h.next),h}function Su(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(G_(n,n.next)||Br(n.prev,n,n.next)===0)){if(vm(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function ym(t,e,n,r,i,o,h){if(t){!h&&o&&xq(t,r,i,o);for(var l=t,m,_;t.prev!==t.next;){if(m=t.prev,_=t.next,o?dq(t,r,i,o):hq(t)){e.push(m.i/n|0),e.push(t.i/n|0),e.push(_.i/n|0),vm(t),t=_.next,l=_.next;continue}if(t=_,t===l){h?h===1?(t=fq(Su(t),e,n),ym(t,e,n,r,i,o,2)):h===2&&pq(t,e,n,r,i,o):ym(Su(t),e,n,r,i,o,1);break}}}}function hq(t){var e=t.prev,n=t,r=t.next;if(Br(e,n,r)>=0)return!1;for(var i=e.x,o=n.x,h=r.x,l=e.y,m=n.y,_=r.y,E=i<o?i<h?i:h:o<h?o:h,T=l<m?l<_?l:_:m<_?m:_,A=i>o?i>h?i:h:o>h?o:h,L=l>m?l>_?l:_:m>_?m:_,R=r.next;R!==e;){if(R.x>=E&&R.x<=A&&R.y>=T&&R.y<=L&&Qh(i,l,o,m,h,_,R.x,R.y)&&Br(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function dq(t,e,n,r){var i=t.prev,o=t,h=t.next;if(Br(i,o,h)>=0)return!1;for(var l=i.x,m=o.x,_=h.x,E=i.y,T=o.y,A=h.y,L=l<m?l<_?l:_:m<_?m:_,R=E<T?E<A?E:A:T<A?T:A,D=l>m?l>_?l:_:m>_?m:_,W=E>T?E>A?E:A:T>A?T:A,z=Bw(L,R,e,n,r),N=Bw(D,W,e,n,r),F=t.prevZ,$=t.nextZ;F&&F.z>=z&&$&&$.z<=N;){if(F.x>=L&&F.x<=D&&F.y>=R&&F.y<=W&&F!==i&&F!==h&&Qh(l,E,m,T,_,A,F.x,F.y)&&Br(F.prev,F,F.next)>=0||(F=F.prevZ,$.x>=L&&$.x<=D&&$.y>=R&&$.y<=W&&$!==i&&$!==h&&Qh(l,E,m,T,_,A,$.x,$.y)&&Br($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;F&&F.z>=z;){if(F.x>=L&&F.x<=D&&F.y>=R&&F.y<=W&&F!==i&&F!==h&&Qh(l,E,m,T,_,A,F.x,F.y)&&Br(F.prev,F,F.next)>=0)return!1;F=F.prevZ}for(;$&&$.z<=N;){if($.x>=L&&$.x<=D&&$.y>=R&&$.y<=W&&$!==i&&$!==h&&Qh(l,E,m,T,_,A,$.x,$.y)&&Br($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function fq(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!G_(i,o)&&PO(i,r,r.next,o)&&_m(i,o)&&_m(o,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),vm(r),vm(r.next),r=t=o),r=r.next}while(r!==t);return Su(r)}function pq(t,e,n,r,i,o){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&Eq(h,l)){var m=CO(h,l);h=Su(h,h.next),m=Su(m,m.next),ym(h,e,n,r,i,o,0),ym(m,e,n,r,i,o,0);return}l=l.next}h=h.next}while(h!==t)}function mq(t,e,n,r){var i=[],o,h,l,m,_;for(o=0,h=e.length;o<h;o++)l=e[o]*r,m=o<h-1?e[o+1]*r:t.length,_=SO(t,l,m,r,!1),_===_.next&&(_.steiner=!0),i.push(wq(_));for(i.sort(gq),o=0;o<i.length;o++)n=yq(i[o],n);return n}function gq(t,e){return t.x-e.x}function yq(t,e){var n=_q(t,e);if(!n)return e;var r=CO(n,t);return Su(r,r.next),Su(n,n.next)}function _q(t,e){var n=e,r=t.x,i=t.y,o=-1/0,h;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var l=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(l<=r&&l>o&&(o=l,h=n.x<n.next.x?n:n.next,l===r))return h}n=n.next}while(n!==e);if(!h)return null;var m=h,_=h.x,E=h.y,T=1/0,A;n=h;do r>=n.x&&n.x>=_&&r!==n.x&&Qh(i<E?r:o,i,_,E,i<E?o:r,i,n.x,n.y)&&(A=Math.abs(i-n.y)/(r-n.x),_m(n,t)&&(A<T||A===T&&(n.x>h.x||n.x===h.x&&vq(h,n)))&&(h=n,T=A)),n=n.next;while(n!==m);return h}function vq(t,e){return Br(t.prev,t,e.prev)<0&&Br(e.next,t,t.next)<0}function xq(t,e,n,r){var i=t;do i.z===0&&(i.z=Bw(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,bq(i)}function bq(t){var e,n,r,i,o,h,l,m,_=1;do{for(n=t,t=null,o=null,h=0;n;){for(h++,r=n,l=0,e=0;e<_&&(l++,r=r.nextZ,!!r);e++);for(m=_;l>0||m>0&&r;)l!==0&&(m===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,l--):(i=r,r=r.nextZ,m--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,_*=2}while(h>1);return t}function Bw(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function wq(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Qh(t,e,n,r,i,o,h,l){return(i-h)*(e-l)>=(t-h)*(o-l)&&(t-h)*(r-l)>=(n-h)*(e-l)&&(n-h)*(o-l)>=(i-h)*(r-l)}function Eq(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Tq(t,e)&&(_m(t,e)&&_m(e,t)&&Sq(t,e)&&(Br(t.prev,t,e.prev)||Br(t,e.prev,e))||G_(t,e)&&Br(t.prev,t,t.next)>0&&Br(e.prev,e,e.next)>0)}function Br(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function G_(t,e){return t.x===e.x&&t.y===e.y}function PO(t,e,n,r){var i=Ly(Br(t,e,n)),o=Ly(Br(t,e,r)),h=Ly(Br(n,r,t)),l=Ly(Br(n,r,e));return!!(i!==o&&h!==l||i===0&&ky(t,n,e)||o===0&&ky(t,r,e)||h===0&&ky(n,t,r)||l===0&&ky(n,e,r))}function ky(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ly(t){return t>0?1:t<0?-1:0}function Tq(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&PO(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function _m(t,e){return Br(t.prev,t,t.next)<0?Br(t,e,t.next)>=0&&Br(t,t.prev,e)>=0:Br(t,e,t.prev)<0||Br(t,t.next,e)<0}function Sq(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function CO(t,e){var n=new Uw(t.i,t.x,t.y),r=new Uw(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function EI(t,e,n,r){var i=new Uw(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function vm(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Uw(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}$_.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,h=Math.abs(Vw(t,0,o,n));if(i)for(var l=0,m=e.length;l<m;l++){var _=e[l]*n,E=l<m-1?e[l+1]*n:t.length;h-=Math.abs(Vw(t,_,E,n))}var T=0;for(l=0;l<r.length;l+=3){var A=r[l]*n,L=r[l+1]*n,R=r[l+2]*n;T+=Math.abs((t[A]-t[R])*(t[L+1]-t[A+1])-(t[A]-t[L])*(t[R+1]-t[A+1]))}return h===0&&T===0?0:Math.abs((T-h)/h)};function Vw(t,e,n,r){for(var i=0,o=e,h=n-r;o<n;o+=r)i+=(t[h]-t[o])*(t[o+1]+t[h+1]),h=o;return i}$_.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var h=0;h<e;h++)n.vertices.push(t[i][o][h]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var Pq=zT.exports;const Cq=Am(Pq),Ry=yO.CLOCKWISE,TI=yO.COUNTER_CLOCKWISE,sc={isClosed:!0};function Aq(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function Tp(t){return"positions"in t?t.positions:t}function m0(t){return"holeIndices"in t?t.holeIndices:null}function Iq(t){return Array.isArray(t[0])}function Mq(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function kq(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function Lq(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function SI(t,e,n,r,i){let o=e;const h=n.length;for(let l=0;l<h;l++)for(let m=0;m<r;m++)t[o++]=n[l][m]||0;if(!kq(n))for(let l=0;l<r;l++)t[o++]=n[0][l]||0;return sc.start=e,sc.end=o,sc.size=r,_O(t,i,sc),o}function PI(t,e,n,r,i=0,o,h){o=o||n.length;const l=o-i;if(l<=0)return e;let m=e;for(let _=0;_<l;_++)t[m++]=n[i+_];if(!Lq(n,r,i,o))for(let _=0;_<r;_++)t[m++]=n[i+_];return sc.start=e,sc.end=m,sc.size=r,_O(t,h,sc),m}function AO(t,e){Aq(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:o}=t;if(o){let h=0;for(let l=0;l<=o.length;l++)h=PI(n,h,i,e,o[l-1],o[l],l===0?Ry:TI),r.push(h);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!Iq(t))return PI(n,0,t,e,0,n.length,Ry),n;if(!Mq(t)){let i=0;for(const[o,h]of t.entries())i=SI(n,i,h,e,o===0?Ry:TI),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return SI(n,0,t,e,Ry),n}function q1(t,e,n){const r=t.length/3;let i=0;for(let o=0;o<r;o++){const h=(o+1)%r;i+=t[o*3+e]*t[h*3+n],i-=t[h*3+e]*t[o*3+n]}return Math.abs(i/2)}function CI(t,e,n,r){const i=t.length/3;for(let o=0;o<i;o++){const h=o*3,l=t[h+0],m=t[h+1],_=t[h+2];t[h+e]=l,t[h+n]=m,t[h+r]=_}}function Rq(t,e,n,r){let i=m0(t);i&&(i=i.map(l=>l/e));let o=Tp(t);const h=r&&e===3;if(n){const l=o.length;o=o.slice();const m=[];for(let _=0;_<l;_+=e){m[0]=o[_],m[1]=o[_+1],h&&(m[2]=o[_+2]);const E=n(m);o[_]=E[0],o[_+1]=E[1],h&&(o[_+2]=E[2])}}if(h){const l=q1(o,0,1),m=q1(o,0,2),_=q1(o,1,2);if(!l&&!m&&!_)return[];l>m&&l>_||(m>_?(n||(o=o.slice()),CI(o,0,2,1)):(n||(o=o.slice()),CI(o,2,0,1)))}return Cq(o,i,e)}class Oq extends hO{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=AO(e,this.positionSize);return this.opts.resolution?xO(Tp(n),m0(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?tq(Tp(n),m0(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(AI(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return Tp(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&AI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:o,indexStarts:h,typedArrayManager:l}=this;let m=o.indices;if(!m||!e)return;let _=i;const E=Rq(e,this.positionSize,this.opts.preproject,this.opts.full3d);m=l.allocate(m,i+E.length,{copy:!0});for(let T=0;T<E.length;T++)m[_++]=E[T]+r;h[n+1]=i+E.length,o.indices=m}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:o}=this;if(!i||!e)return;const h=Tp(e);for(let l=n,m=0;m<r;l++,m++){const _=h[m*o],E=h[m*o+1],T=o>2?h[m*o+2]:0;i[l*3]=_,i[l*3+1]=E,i[l*3+2]=T}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,o=this.attributes.vertexValid,h=e&&m0(e);if(e&&e.edgeTypes?o.set(e.edgeTypes,n):o.fill(1,n,n+r),h)for(let l=0;l<h.length;l++)o[n+h[l]/i-1]=0;o[n+r-1]=0}}function AI(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const IO=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,zq=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(IO,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),Dq=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(IO,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),Fq=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,o_=[0,0,0,255],Nq={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:o_},getLineColor:{type:"accessor",value:o_},material:!0},Oy={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class DT extends Ou{constructor(...e){super(...e),J(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?zq:Dq,fs:Fq,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[PT,N$,CT]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===qn.DEFAULT&&(r=qn.LNGLAT);let o;r===qn.LNGLAT&&(i?o=n.projectPosition.bind(n):o=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new Oq({preproject:o,fp64:this.use64bitPositions(),IndexType:!e||pT(e,Sr.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const h=this.getAttributeManager(),l=!0;h.remove(["instancePickingColors"]),h.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:l},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:Oy,accessor:"getPolygon",update:this.calculatePositions,noAlloc:l,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:l},elevations:{size:1,transition:Oy,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Oy,accessor:"getFillColor",defaultValue:o_,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Oy,accessor:"getLineColor",defaultValue:o_,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(m,{index:_,target:E})=>this.encodePickingColor(m&&m.__source?m.__source.index:_,E),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(o=>o.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:o}=this.props,{topModel:h,sideModel:l,polygonTesselator:m}=this.state,_={...e,extruded:!!n,elevationScale:o};l&&(l.setInstanceCount(m.instanceCount-1),l.setUniforms(_),i&&(l.setDrawMode(3),l.setUniforms({isWireframe:!0}).draw()),r&&(l.setDrawMode(6),l.setUniforms({isWireframe:!1}).draw())),h&&(h.setVertexCount(m.vertexCount),h.setUniforms(_).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,o=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var l;(l=this.state.models)===null||l===void 0||l.forEach(m=>m.delete()),this.setState(this._getModels(this.context.gl)),o.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:o}=this.state,h=e.data.attributes||{};o.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:h.getPolygon,buffers:h,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let o,h;if(r){const l=this.getShaders("top");l.defines.NON_INSTANCED_MODEL=1,o=new mm(e,{...l,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(h=new mm(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new xT({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),h.userData.excludeAttributes={indices:!0}),{models:[h,o].filter(Boolean),topModel:o,sideModel:h}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}J(DT,"defaultProps",Nq);J(DT,"layerName","SolidPolygonLayer");function Bq({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:o=1/0}=n,h=t.length;let l=h,m=h;for(let A=0;A<h;A++){const L=e(t[A]);if(l>A&&L>=i&&(l=A),L>=o){m=A;break}}let _=l;const T=m-l!==r.length?t.slice(m):void 0;for(let A=0;A<r.length;A++)t[_++]=r[A];if(T){for(let A=0;A<T.length;A++)t[_++]=T[A];t.length=_}return{startRow:l,endRow:l+r.length}}const MO=[0,0,0,255],Uq=[0,0,0,255],Vq={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:Uq},getLineColor:{type:"accessor",value:MO},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class FT extends uO{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&hr.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(o=>Bq({data:r,getIndex:h=>h.__source.index,dataRange:o,replace:this._getPaths(o)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:o}=this.props,h=[],l=i==="XY"?2:3,{startRow:m,endRow:_}=e,{iterable:E,objectInfo:T}=IT(n,m,_);for(const A of E){T.index++;let L=r(A,T);o&&(L=AO(L,l));const{holeIndices:R}=L,D=L.positions||L;if(R)for(let W=0;W<=R.length;W++){const z=D.slice(R[W-1]||0,R[W]||D.length);h.push(this.getSubLayerRow({path:z},A,T.index))}else h.push(this.getSubLayerRow({path:D},A,T.index))}return h}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:o,wireframe:h,_normalize:l,_windingOrder:m,elevationScale:_,transitions:E,positionFormat:T}=this.props,{lineWidthUnits:A,lineWidthScale:L,lineWidthMinPixels:R,lineWidthMaxPixels:D,lineJointRounded:W,lineMiterLimit:z,lineDashJustified:N}=this.props,{getFillColor:F,getLineColor:$,getLineWidth:K,getLineDashArray:ne,getElevation:re,getPolygon:be,updateTriggers:xe,material:fe}=this.props,{paths:Re,pathsDiff:Ve}=this.state,Fe=this.getSubLayerClass("fill",DT),ze=this.getSubLayerClass("stroke",j_),Ye=this.shouldRenderSubLayer("fill",Re)&&new Fe({_dataDiff:n,extruded:o,elevationScale:_,filled:i,wireframe:h,_normalize:l,_windingOrder:m,getElevation:re,getFillColor:F,getLineColor:o&&h?$:MO,material:fe,transitions:E},this.getSubLayerProps({id:"fill",updateTriggers:xe&&{getPolygon:xe.getPolygon,getElevation:xe.getElevation,getFillColor:xe.getFillColor,lineColors:o&&h,getLineColor:xe.getLineColor}}),{data:e,positionFormat:T,getPolygon:be}),je=!o&&r&&this.shouldRenderSubLayer("stroke",Re)&&new ze({_dataDiff:Ve&&(()=>Ve),widthUnits:A,widthScale:L,widthMinPixels:R,widthMaxPixels:D,jointRounded:W,miterLimit:z,dashJustified:N,_pathType:"loop",transitions:E&&{getWidth:E.getLineWidth,getColor:E.getLineColor,getPath:E.getPolygon},getColor:this.getSubLayerAccessor($),getWidth:this.getSubLayerAccessor(K),getDashArray:this.getSubLayerAccessor(ne)},this.getSubLayerProps({id:"stroke",updateTriggers:xe&&{getWidth:xe.getLineWidth,getColor:xe.getLineColor,getDashArray:xe.getLineDashArray}}),{data:Re,positionFormat:T,getPath:tt=>tt.path});return[!o&&Ye,je,o&&Ye]}}J(FT,"layerName","PolygonLayer");J(FT,"defaultProps",Vq);const jq={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:t=>t.timestamps}};class NT extends j_{getShaders(){const e=super.getShaders();return e.inject={"vs:#decl":`uniform float trailLength;
attribute float instanceTimestamps;
attribute float instanceNextTimestamps;
varying float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`uniform bool fadeTrail;
uniform float trailLength;
uniform float currentTime;
varying float vTime;
`,"fs:#main-start":`if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(fadeTrail) {
  color.a *= 1.0 - (currentTime - vTime) / trailLength;
}
`},e}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){const{fadeTrail:n,trailLength:r,currentTime:i}=this.props;e.uniforms={...e.uniforms,fadeTrail:n,trailLength:r,currentTime:i},super.draw(e)}}J(NT,"layerName","TripsLayer");J(NT,"defaultProps",jq);function kO(t,e,n=64){const r={latitude:t[1],longitude:t[0]},i=e,o=[],h=i/(111.32*Math.cos(r.latitude*Math.PI/180)),l=i/110.574;let m,_,E;for(var T=0;T<n;T++)m=T/n*(2*Math.PI),_=h*Math.cos(m),E=l*Math.sin(m),o.push([r.longitude+_,r.latitude+E]);return o.push(o[0]),o}function Ch(t){const e=t.match(/\d+(\.\d)?/g).map(Number);return e[3]&&(e[3]*=255),e}function Ah(t){if(!t)return"rgb(0, 0, 0)";const e=[...t];return e[3]&&(e[3]/=255),`rgb${t.length>=4?"a":""}(${e.join(", ")})`}const $q=["footway","street_lamp","steps","pedestrian","track","path"];function LO(t){const n=`
    [out:json];(
        way[highway]${$q.map(r=>`[highway!="${r}"]`).join("")}[footway!="*"]
        (${t[0].latitude},${t[0].longitude},${t[1].latitude},${t[1].longitude});
        node(w);
    );
    out skel;`;return fetch("https://overpass-api.de/api/interpreter",{method:"POST",body:n})}class Gq{constructor(e,n){this.node1=e,this.node2=n,this.visited=!1}getOtherNode(e){return e===this.node1?this.node2:this.node1}get weight(){return Math.hypot(this.node1.latitude-this.node2.latitude,this.node1.longitude-this.node2.longitude)}}class Wq{constructor(e,n,r){this.edges=[],this.reset(),this.id=e,this.latitude=n,this.longitude=r,this.visited=!1}get totalDistance(){return this.distanceFromStart+this.distanceToEnd}get neighbors(){return this.edges.map(e=>({edge:e,node:e.getOtherNode(this)}))}connectTo(e){const n=new Gq(this,e);this.edges.push(n),e.edges.push(n)}reset(){this.visited=!1,this.distanceFromStart=0,this.distanceToEnd=0,this.parent=null,this.referer=null;for(const e of this.neighbors)e.edge.visited=!1}}class Hq{constructor(){this.startNode=null,this.nodes=new Map}getNode(e){return this.nodes.get(e)}addNode(e,n,r){const i=new Wq(e,n,r);return this.nodes.set(i.id,i),i}}async function II(t,e){const n=kO([e,t],.15),r=RO(n),o=await(await LO(r)).json();let h;for(const l of o.elements){if(l.type!=="node")continue;if(!h){h=l;continue}const m=Math.sqrt(Math.pow(l.lat-t,2)+Math.pow(l.lon-e,2)),_=Math.sqrt(Math.pow(h.lat-t,2)+Math.pow(h.lon-e,2));m<_&&(h=l)}return h}async function qq(t,e){const i=(await(await LO(t)).json()).elements,o=new Hq;for(const h of i)if(h.type==="node"){const l=o.addNode(h.id,h.lat,h.lon);l.id===e&&(o.startNode=l)}else if(h.type==="way"){if(!h.nodes||h.nodes.length<2)continue;for(let l=0;l<h.nodes.length-1;l++){const m=o.getNode(h.nodes[l]),_=o.getNode(h.nodes[l+1]);!m||!_||m.connectTo(_)}}if(!o.startNode)throw new Error("Start node was not found.");return o}function RO(t){const e={minLat:Number.MAX_VALUE,maxLat:-Number.MAX_VALUE,minLon:Number.MAX_VALUE,maxLon:-Number.MAX_VALUE};for(const r of t)r[0]<e.minLon&&(e.minLon=r[0]),r[0]>e.maxLon&&(e.maxLon=r[0]),r[1]<e.minLat&&(e.minLat=r[1]),r[1]>e.maxLat&&(e.maxLat=r[1]);return[{latitude:e.minLat,longitude:e.minLon},{latitude:e.maxLat,longitude:e.maxLon}]}class Wm{constructor(){this.finished=!1}start(e,n){this.finished=!1,this.startNode=e,this.endNode=n}nextStep(){return[]}}class MI extends Wm{constructor(){super(),this.openList=[],this.closedList=[]}start(e,n){super.start(e,n),this.openList=[this.startNode],this.closedList=[],this.startNode.distanceFromStart=0,this.startNode.distanceToEnd=0}nextStep(){if(this.openList.length===0)return this.finished=!0,[];const e=[],n=this.openList.reduce((i,o)=>o.totalDistance<i.totalDistance?o:i,this.openList[0]);this.openList.splice(this.openList.indexOf(n),1),n.visited=!0;const r=n.edges.find(i=>i.getOtherNode(n)===n.referer);if(r&&(r.visited=!0),n.id===this.endNode.id)return this.openList=[],this.finished=!0,[n];for(const i of n.neighbors){const o=i.node,h=i.edge,l=n.distanceFromStart+Math.hypot(o.longitude-n.longitude,o.latitude-n.latitude);if(o.visited&&!h.visited&&(h.visited=!0,o.referer=n,e.push(o)),this.openList.includes(o)){if(o.distanceFromStart<=l)continue}else if(this.closedList.includes(o)){if(o.distanceFromStart<=l)continue;this.closedList.splice(this.closedList.indexOf(o),1),this.openList.push(o)}else this.openList.push(o),o.distanceToEnd=Math.hypot(o.longitude-this.endNode.longitude,o.latitude-this.endNode.latitude);o.distanceFromStart=l,o.referer=n,o.parent=n}return this.closedList.push(n),[...e,n]}}class Zq extends Wm{constructor(){super(),this.openSetStart=new Set,this.openSetEnd=new Set,this.openSetStart.add(this.startNode),this.openSetEnd.add(this.endNode),this.closedSetStart=new Set,this.closedSetEnd=new Set}start(e,n){super.start(e,n),this.openSetStart=new Set,this.openSetEnd=new Set,this.openSetStart.add(e),this.openSetEnd.add(n),this.closedSetStart=new Set,this.closedSetEnd=new Set}nextStep(){if(this.finished)return[];const e=[],n=this.getNextFromOpenSet(this.openSetStart,this.closedSetStart);if(n){n.visited=!0,this.closedSetStart.add(n);const i=n.edges.find(o=>o.getOtherNode(n)===n.referer);if(i&&(i.visited=!0),this.openSetEnd.has(n))return this.finished=!0,console.log("found from start"),[n];e.push(n),e.push(...this.updateNeighbors(n,this.openSetStart,this.closedSetStart))}const r=this.getNextFromOpenSet(this.openSetEnd,this.closedSetEnd);if(r){r.visited=!0,this.closedSetEnd.add(r);const i=r.edges.find(o=>o.getOtherNode(r)===r.referer);if(i&&(i.visited=!0),this.openSetStart.has(r))return console.log("found from end"),this.finished=!0,[r];e.push(r),e.push(...this.updateNeighbors(r,this.openSetEnd,this.closedSetEnd))}return e}updateNeighbors(e,n,r){const i=[];for(const o of e.neighbors){const h=o.node,l=o.edge;h.visited&&!l.visited&&(l.visited=!0,h.referer=e,i.push(h)),!r.has(h)&&!h.visited&&(n.add(h),h.prevParent=h.parent,h.parent=e,h.referer=e)}return i}getNextFromOpenSet(e,n){let r=null;for(const i of e)(!r||i.totalDistance<r.totalDistance)&&(n.has(i)||(r=i));return r&&e.delete(r),r}}class Xq extends Wm{constructor(){super(),this.openList=[]}start(e,n){super.start(e,n),this.openList=[e]}nextStep(){if(this.openList.length===0)return this.finished=!0,[];const e=[],n=this.openList.shift();n.visited=!0;const r=n.edges.find(i=>i.getOtherNode(n)===n.referer);if(r&&(r.visited=!0),n.id===this.endNode.id)return this.openList=[],this.finished=!0,[n];for(const i of n.neighbors){const o=i.node,h=i.edge;if(o.visited&&!h.visited&&(h.visited=!0,o.referer=n,e.push(o)),o.visited)continue;const l=n.distanceFromStart+h.weight;if(this.openList.includes(o)){if(l>=o.distanceFromStart)continue}else this.openList.push(o);o.distanceFromStart=l,o.parent=n,o.referer=n}return[...e,n]}}class Yq extends Wm{constructor(){super(),this.openList=[]}start(e,n){super.start(e,n),this.openList=[this.startNode],this.startNode.distanceFromStart=0,this.startNode.distanceToEnd=0}nextStep(){if(this.openList.length===0)return this.finished=!0,[];const e=[],n=this.openList.reduce((i,o)=>o.distanceToEnd<i.distanceToEnd?o:i,this.openList[0]);this.openList.splice(this.openList.indexOf(n),1),n.visited=!0;const r=n.edges.find(i=>i.getOtherNode(n)===n.referer);if(r&&(r.visited=!0),n.id===this.endNode.id)return this.openList=[],this.finished=!0,[n];for(const i of n.neighbors){const o=i.node,h=i.edge;o.visited&&!h.visited&&(h.visited=!0,o.referer=n,e.push(o)),!o.visited&&(o.distanceToEnd=Math.hypot(o.longitude-this.endNode.longitude,o.latitude-this.endNode.latitude),this.openList.includes(o)||this.openList.push(o),o.referer=n,o.parent=n)}return[...e,n]}}var dd;const ed=class ed{constructor(){return Ux(ed,dd)||(this.endNode=null,this.graph=null,this.finished=!1,this.algorithm=new Wm,oP(ed,dd,this)),Ux(ed,dd)}get startNode(){return this.graph.startNode}getNode(e){var n;return(n=this.graph)==null?void 0:n.getNode(e)}reset(){if(this.finished=!1,!!this.graph)for(const e of this.graph.nodes.keys())this.graph.nodes.get(e).reset()}start(e){switch(this.reset(),e){case"astar":this.algorithm=new MI;break;case"greedy":this.algorithm=new Yq;break;case"dijkstra":this.algorithm=new Xq;break;case"bidirectional":this.algorithm=new Zq;break;default:this.algorithm=new MI;break}this.algorithm.start(this.startNode,this.endNode)}nextStep(){const e=this.algorithm.nextStep();return(this.algorithm.finished||e.length===0)&&(this.finished=!0),e}};dd=new WeakMap,sP(ed,dd,void 0);let jw=ed;const Kq={black:"#000",white:"#fff"},xm=Kq,Jq={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Ih=Jq,Qq={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Mh=Qq,eZ={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},kh=eZ,tZ={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Lh=tZ,nZ={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Rh=nZ,rZ={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},lp=rZ,iZ={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},sZ=iZ;function ie(){return ie=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ie.apply(this,arguments)}function sl(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function OO(t){if(!sl(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=OO(t[n])}),e}function Fs(t,e,n={clone:!0}){const r=n.clone?ie({},t):t;return sl(t)&&sl(e)&&Object.keys(e).forEach(i=>{i!=="__proto__"&&(sl(e[i])&&i in t&&sl(t[i])?r[i]=Fs(t[i],e[i],n):n.clone?r[i]=sl(e[i])?OO(e[i]):e[i]:r[i]=e[i])}),r}function Ec(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function qt(t){if(typeof t!="string")throw new Error(Ec(7));return t.charAt(0).toUpperCase()+t.slice(1)}function kI(...t){return t.reduce((e,n)=>n==null?e:function(...i){e.apply(this,i),n.apply(this,i)},()=>{})}function BT(t,e=166){let n;function r(...i){const o=()=>{t.apply(this,i)};clearTimeout(n),n=setTimeout(o,e)}return r.clear=()=>{clearTimeout(n)},r}function Z1(t,e){var n,r;return q.isValidElement(t)&&e.indexOf((n=t.type.muiName)!=null?n:(r=t.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function Xr(t){return t&&t.ownerDocument||document}function gl(t){return Xr(t).defaultView||window}function $w(t,e){typeof t=="function"?t(e):t&&(t.current=e)}const oZ=typeof window<"u"?q.useLayoutEffect:q.useEffect,ca=oZ;let LI=0;function aZ(t){const[e,n]=q.useState(t),r=t||e;return q.useEffect(()=>{e==null&&(LI+=1,n(`mui-${LI}`))},[e]),r}const RI=fb["useId".toString()];function UT(t){if(RI!==void 0){const e=RI();return t??e}return aZ(t)}function a_({controlled:t,default:e,name:n,state:r="value"}){const{current:i}=q.useRef(t!==void 0),[o,h]=q.useState(e),l=i?t:o,m=q.useCallback(_=>{i||h(_)},[]);return[l,m]}function ro(t){const e=q.useRef(t);return ca(()=>{e.current=t}),q.useCallback((...n)=>(0,e.current)(...n),[])}function Yr(...t){return q.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{$w(n,e)})},t)}let W_=!0,Gw=!1,OI;const lZ={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function cZ(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&lZ[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function uZ(t){t.metaKey||t.altKey||t.ctrlKey||(W_=!0)}function X1(){W_=!1}function hZ(){this.visibilityState==="hidden"&&Gw&&(W_=!0)}function dZ(t){t.addEventListener("keydown",uZ,!0),t.addEventListener("mousedown",X1,!0),t.addEventListener("pointerdown",X1,!0),t.addEventListener("touchstart",X1,!0),t.addEventListener("visibilitychange",hZ,!0)}function fZ(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return W_||cZ(e)}function VT(){const t=q.useCallback(i=>{i!=null&&dZ(i.ownerDocument)},[]),e=q.useRef(!1);function n(){return e.current?(Gw=!0,window.clearTimeout(OI),OI=window.setTimeout(()=>{Gw=!1},100),e.current=!1,!0):!1}function r(i){return fZ(i)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}function zO(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}const pZ={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:-1,overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},mZ=pZ;function jT(t,e){const n=ie({},e);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=ie({},t[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const i=t[r]||{},o=e[r];n[r]={},!o||!Object.keys(o)?n[r]=i:!i||!Object.keys(i)?n[r]=o:(n[r]=ie({},o),Object.keys(i).forEach(h=>{n[r][h]=jT(i[h],o[h])}))}else n[r]===void 0&&(n[r]=t[r])}),n}function Un(t,e,n=void 0){const r={};return Object.keys(t).forEach(i=>{r[i]=t[i].reduce((o,h)=>{if(h){const l=e(h);l!==""&&o.push(l),n&&n[h]&&o.push(n[h])}return o},[]).join(" ")}),r}const zI=t=>t,gZ=()=>{let t=zI;return{configure(e){t=e},generate(e){return t(e)},reset(){t=zI}}},yZ=gZ(),DO=yZ,_Z={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Nn(t,e,n="Mui"){const r=_Z[e];return r?`${n}-${r}`:`${DO.generate(t)}-${e}`}function kn(t,e,n="Mui"){const r={};return e.forEach(i=>{r[i]=Nn(t,i,n)}),r}const Pu="$$material";function Yt(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function FO(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var vZ=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,xZ=FO(function(t){return vZ.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91});function bZ(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function wZ(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var EZ=function(){function t(n){var r=this;this._insertTag=function(i){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,o),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(wZ(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var o=bZ(i);try{o.insertRule(r,o.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},t}(),rs="-ms-",l_="-moz-",Yn="-webkit-",NO="comm",$T="rule",GT="decl",TZ="@import",BO="@keyframes",SZ="@layer",PZ=Math.abs,H_=String.fromCharCode,CZ=Object.assign;function AZ(t,e){return Ui(t,0)^45?(((e<<2^Ui(t,0))<<2^Ui(t,1))<<2^Ui(t,2))<<2^Ui(t,3):0}function UO(t){return t.trim()}function IZ(t,e){return(t=e.exec(t))?t[0]:t}function Kn(t,e,n){return t.replace(e,n)}function Ww(t,e){return t.indexOf(e)}function Ui(t,e){return t.charCodeAt(e)|0}function bm(t,e,n){return t.slice(e,n)}function Ta(t){return t.length}function WT(t){return t.length}function zy(t,e){return e.push(t),t}function MZ(t,e){return t.map(e).join("")}var q_=1,Ld=1,VO=0,Us=0,ci=0,Gd="";function Z_(t,e,n,r,i,o,h){return{value:t,root:e,parent:n,type:r,props:i,children:o,line:q_,column:Ld,length:h,return:""}}function cp(t,e){return CZ(Z_("",null,null,"",null,null,0),t,{length:-t.length},e)}function kZ(){return ci}function LZ(){return ci=Us>0?Ui(Gd,--Us):0,Ld--,ci===10&&(Ld=1,q_--),ci}function oo(){return ci=Us<VO?Ui(Gd,Us++):0,Ld++,ci===10&&(Ld=1,q_++),ci}function Ra(){return Ui(Gd,Us)}function g0(){return Us}function Hm(t,e){return bm(Gd,t,e)}function wm(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function jO(t){return q_=Ld=1,VO=Ta(Gd=t),Us=0,[]}function $O(t){return Gd="",t}function y0(t){return UO(Hm(Us-1,Hw(t===91?t+2:t===40?t+1:t)))}function RZ(t){for(;(ci=Ra())&&ci<33;)oo();return wm(t)>2||wm(ci)>3?"":" "}function OZ(t,e){for(;--e&&oo()&&!(ci<48||ci>102||ci>57&&ci<65||ci>70&&ci<97););return Hm(t,g0()+(e<6&&Ra()==32&&oo()==32))}function Hw(t){for(;oo();)switch(ci){case t:return Us;case 34:case 39:t!==34&&t!==39&&Hw(ci);break;case 40:t===41&&Hw(t);break;case 92:oo();break}return Us}function zZ(t,e){for(;oo()&&t+ci!==47+10;)if(t+ci===42+42&&Ra()===47)break;return"/*"+Hm(e,Us-1)+"*"+H_(t===47?t:oo())}function DZ(t){for(;!wm(Ra());)oo();return Hm(t,Us)}function FZ(t){return $O(_0("",null,null,null,[""],t=jO(t),0,[0],t))}function _0(t,e,n,r,i,o,h,l,m){for(var _=0,E=0,T=h,A=0,L=0,R=0,D=1,W=1,z=1,N=0,F="",$=i,K=o,ne=r,re=F;W;)switch(R=N,N=oo()){case 40:if(R!=108&&Ui(re,T-1)==58){Ww(re+=Kn(y0(N),"&","&\f"),"&\f")!=-1&&(z=-1);break}case 34:case 39:case 91:re+=y0(N);break;case 9:case 10:case 13:case 32:re+=RZ(R);break;case 92:re+=OZ(g0()-1,7);continue;case 47:switch(Ra()){case 42:case 47:zy(NZ(zZ(oo(),g0()),e,n),m);break;default:re+="/"}break;case 123*D:l[_++]=Ta(re)*z;case 125*D:case 59:case 0:switch(N){case 0:case 125:W=0;case 59+E:z==-1&&(re=Kn(re,/\f/g,"")),L>0&&Ta(re)-T&&zy(L>32?FI(re+";",r,n,T-1):FI(Kn(re," ","")+";",r,n,T-2),m);break;case 59:re+=";";default:if(zy(ne=DI(re,e,n,_,E,i,l,F,$=[],K=[],T),o),N===123)if(E===0)_0(re,e,ne,ne,$,o,T,l,K);else switch(A===99&&Ui(re,3)===110?100:A){case 100:case 108:case 109:case 115:_0(t,ne,ne,r&&zy(DI(t,ne,ne,0,0,i,l,F,i,$=[],T),K),i,K,T,l,r?$:K);break;default:_0(re,ne,ne,ne,[""],K,0,l,K)}}_=E=L=0,D=z=1,F=re="",T=h;break;case 58:T=1+Ta(re),L=R;default:if(D<1){if(N==123)--D;else if(N==125&&D++==0&&LZ()==125)continue}switch(re+=H_(N),N*D){case 38:z=E>0?1:(re+="\f",-1);break;case 44:l[_++]=(Ta(re)-1)*z,z=1;break;case 64:Ra()===45&&(re+=y0(oo())),A=Ra(),E=T=Ta(F=re+=DZ(g0())),N++;break;case 45:R===45&&Ta(re)==2&&(D=0)}}return o}function DI(t,e,n,r,i,o,h,l,m,_,E){for(var T=i-1,A=i===0?o:[""],L=WT(A),R=0,D=0,W=0;R<r;++R)for(var z=0,N=bm(t,T+1,T=PZ(D=h[R])),F=t;z<L;++z)(F=UO(D>0?A[z]+" "+N:Kn(N,/&\f/g,A[z])))&&(m[W++]=F);return Z_(t,e,n,i===0?$T:l,m,_,E)}function NZ(t,e,n){return Z_(t,e,n,NO,H_(kZ()),bm(t,2,-2),0)}function FI(t,e,n,r){return Z_(t,e,n,GT,bm(t,0,r),bm(t,r+1,-1),r)}function cd(t,e){for(var n="",r=WT(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function BZ(t,e,n,r){switch(t.type){case SZ:if(t.children.length)break;case TZ:case GT:return t.return=t.return||t.value;case NO:return"";case BO:return t.return=t.value+"{"+cd(t.children,r)+"}";case $T:t.value=t.props.join(",")}return Ta(n=cd(t.children,r))?t.return=t.value+"{"+n+"}":""}function UZ(t){var e=WT(t);return function(n,r,i,o){for(var h="",l=0;l<e;l++)h+=t[l](n,r,i,o)||"";return h}}function VZ(t){return function(e){e.root||(e=e.return)&&t(e)}}var jZ=function(e,n,r){for(var i=0,o=0;i=o,o=Ra(),i===38&&o===12&&(n[r]=1),!wm(o);)oo();return Hm(e,Us)},$Z=function(e,n){var r=-1,i=44;do switch(wm(i)){case 0:i===38&&Ra()===12&&(n[r]=1),e[r]+=jZ(Us-1,n,r);break;case 2:e[r]+=y0(i);break;case 4:if(i===44){e[++r]=Ra()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=H_(i)}while(i=oo());return e},GZ=function(e,n){return $O($Z(jO(e),n))},NI=new WeakMap,WZ=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,i=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!NI.get(r))&&!i){NI.set(e,!0);for(var o=[],h=GZ(n,o),l=r.props,m=0,_=0;m<h.length;m++)for(var E=0;E<l.length;E++,_++)e.props[_]=o[m]?h[m].replace(/&\f/g,l[E]):l[E]+" "+h[m]}}},HZ=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function GO(t,e){switch(AZ(t,e)){case 5103:return Yn+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Yn+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Yn+t+l_+t+rs+t+t;case 6828:case 4268:return Yn+t+rs+t+t;case 6165:return Yn+t+rs+"flex-"+t+t;case 5187:return Yn+t+Kn(t,/(\w+).+(:[^]+)/,Yn+"box-$1$2"+rs+"flex-$1$2")+t;case 5443:return Yn+t+rs+"flex-item-"+Kn(t,/flex-|-self/,"")+t;case 4675:return Yn+t+rs+"flex-line-pack"+Kn(t,/align-content|flex-|-self/,"")+t;case 5548:return Yn+t+rs+Kn(t,"shrink","negative")+t;case 5292:return Yn+t+rs+Kn(t,"basis","preferred-size")+t;case 6060:return Yn+"box-"+Kn(t,"-grow","")+Yn+t+rs+Kn(t,"grow","positive")+t;case 4554:return Yn+Kn(t,/([^-])(transform)/g,"$1"+Yn+"$2")+t;case 6187:return Kn(Kn(Kn(t,/(zoom-|grab)/,Yn+"$1"),/(image-set)/,Yn+"$1"),t,"")+t;case 5495:case 3959:return Kn(t,/(image-set\([^]*)/,Yn+"$1$`$1");case 4968:return Kn(Kn(t,/(.+:)(flex-)?(.*)/,Yn+"box-pack:$3"+rs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Yn+t+t;case 4095:case 3583:case 4068:case 2532:return Kn(t,/(.+)-inline(.+)/,Yn+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ta(t)-1-e>6)switch(Ui(t,e+1)){case 109:if(Ui(t,e+4)!==45)break;case 102:return Kn(t,/(.+:)(.+)-([^]+)/,"$1"+Yn+"$2-$3$1"+l_+(Ui(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~Ww(t,"stretch")?GO(Kn(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Ui(t,e+1)!==115)break;case 6444:switch(Ui(t,Ta(t)-3-(~Ww(t,"!important")&&10))){case 107:return Kn(t,":",":"+Yn)+t;case 101:return Kn(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Yn+(Ui(t,14)===45?"inline-":"")+"box$3$1"+Yn+"$2$3$1"+rs+"$2box$3")+t}break;case 5936:switch(Ui(t,e+11)){case 114:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Yn+t+rs+Kn(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Yn+t+rs+t+t}return t}var qZ=function(e,n,r,i){if(e.length>-1&&!e.return)switch(e.type){case GT:e.return=GO(e.value,e.length);break;case BO:return cd([cp(e,{value:Kn(e.value,"@","@"+Yn)})],i);case $T:if(e.length)return MZ(e.props,function(o){switch(IZ(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return cd([cp(e,{props:[Kn(o,/:(read-\w+)/,":"+l_+"$1")]})],i);case"::placeholder":return cd([cp(e,{props:[Kn(o,/:(plac\w+)/,":"+Yn+"input-$1")]}),cp(e,{props:[Kn(o,/:(plac\w+)/,":"+l_+"$1")]}),cp(e,{props:[Kn(o,/:(plac\w+)/,rs+"input-$1")]})],i)}return""})}},ZZ=[qZ],XZ=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(D){var W=D.getAttribute("data-emotion");W.indexOf(" ")!==-1&&(document.head.appendChild(D),D.setAttribute("data-s",""))})}var i=e.stylisPlugins||ZZ,o={},h,l=[];h=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(D){for(var W=D.getAttribute("data-emotion").split(" "),z=1;z<W.length;z++)o[W[z]]=!0;l.push(D)});var m,_=[WZ,HZ];{var E,T=[BZ,VZ(function(D){E.insert(D)})],A=UZ(_.concat(i,T)),L=function(W){return cd(FZ(W),A)};m=function(W,z,N,F){E=N,L(W?W+"{"+z.styles+"}":z.styles),F&&(R.inserted[z.name]=!0)}}var R={key:n,sheet:new EZ({key:n,container:h,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:m};return R.sheet.hydrate(l),R},WO={exports:{}},rr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mi=typeof Symbol=="function"&&Symbol.for,HT=Mi?Symbol.for("react.element"):60103,qT=Mi?Symbol.for("react.portal"):60106,X_=Mi?Symbol.for("react.fragment"):60107,Y_=Mi?Symbol.for("react.strict_mode"):60108,K_=Mi?Symbol.for("react.profiler"):60114,J_=Mi?Symbol.for("react.provider"):60109,Q_=Mi?Symbol.for("react.context"):60110,ZT=Mi?Symbol.for("react.async_mode"):60111,ev=Mi?Symbol.for("react.concurrent_mode"):60111,tv=Mi?Symbol.for("react.forward_ref"):60112,nv=Mi?Symbol.for("react.suspense"):60113,YZ=Mi?Symbol.for("react.suspense_list"):60120,rv=Mi?Symbol.for("react.memo"):60115,iv=Mi?Symbol.for("react.lazy"):60116,KZ=Mi?Symbol.for("react.block"):60121,JZ=Mi?Symbol.for("react.fundamental"):60117,QZ=Mi?Symbol.for("react.responder"):60118,eX=Mi?Symbol.for("react.scope"):60119;function ho(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case HT:switch(t=t.type,t){case ZT:case ev:case X_:case K_:case Y_:case nv:return t;default:switch(t=t&&t.$$typeof,t){case Q_:case tv:case iv:case rv:case J_:return t;default:return e}}case qT:return e}}}function HO(t){return ho(t)===ev}rr.AsyncMode=ZT;rr.ConcurrentMode=ev;rr.ContextConsumer=Q_;rr.ContextProvider=J_;rr.Element=HT;rr.ForwardRef=tv;rr.Fragment=X_;rr.Lazy=iv;rr.Memo=rv;rr.Portal=qT;rr.Profiler=K_;rr.StrictMode=Y_;rr.Suspense=nv;rr.isAsyncMode=function(t){return HO(t)||ho(t)===ZT};rr.isConcurrentMode=HO;rr.isContextConsumer=function(t){return ho(t)===Q_};rr.isContextProvider=function(t){return ho(t)===J_};rr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===HT};rr.isForwardRef=function(t){return ho(t)===tv};rr.isFragment=function(t){return ho(t)===X_};rr.isLazy=function(t){return ho(t)===iv};rr.isMemo=function(t){return ho(t)===rv};rr.isPortal=function(t){return ho(t)===qT};rr.isProfiler=function(t){return ho(t)===K_};rr.isStrictMode=function(t){return ho(t)===Y_};rr.isSuspense=function(t){return ho(t)===nv};rr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===X_||t===ev||t===K_||t===Y_||t===nv||t===YZ||typeof t=="object"&&t!==null&&(t.$$typeof===iv||t.$$typeof===rv||t.$$typeof===J_||t.$$typeof===Q_||t.$$typeof===tv||t.$$typeof===JZ||t.$$typeof===QZ||t.$$typeof===eX||t.$$typeof===KZ)};rr.typeOf=ho;WO.exports=rr;var tX=WO.exports,qO=tX,nX={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},rX={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},ZO={};ZO[qO.ForwardRef]=nX;ZO[qO.Memo]=rX;var iX=!0;function sX(t,e,n){var r="";return n.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):r+=i+" "}),r}var XO=function(e,n,r){var i=e.key+"-"+n.name;(r===!1||iX===!1)&&e.registered[i]===void 0&&(e.registered[i]=n.styles)},YO=function(e,n,r){XO(e,n,r);var i=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var o=n;do e.insert(n===o?"."+i:"",o,e.sheet,!0),o=o.next;while(o!==void 0)}};function oX(t){for(var e=0,n,r=0,i=t.length;i>=4;++r,i-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var aX={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},lX=/[A-Z]|^ms/g,cX=/_EMO_([^_]+?)_([^]*?)_EMO_/g,KO=function(e){return e.charCodeAt(1)===45},BI=function(e){return e!=null&&typeof e!="boolean"},Y1=FO(function(t){return KO(t)?t:t.replace(lX,"-$&").toLowerCase()}),UI=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(cX,function(r,i,o){return Sa={name:i,styles:o,next:Sa},i})}return aX[e]!==1&&!KO(e)&&typeof n=="number"&&n!==0?n+"px":n};function Em(t,e,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Sa={name:n.name,styles:n.styles,next:Sa},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)Sa={name:r.name,styles:r.styles,next:Sa},r=r.next;var i=n.styles+";";return i}return uX(t,e,n)}case"function":{if(t!==void 0){var o=Sa,h=n(t);return Sa=o,Em(t,e,h)}break}}if(e==null)return n;var l=e[n];return l!==void 0?l:n}function uX(t,e,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=Em(t,e,n[i])+";";else for(var o in n){var h=n[o];if(typeof h!="object")e!=null&&e[h]!==void 0?r+=o+"{"+e[h]+"}":BI(h)&&(r+=Y1(o)+":"+UI(o,h)+";");else if(Array.isArray(h)&&typeof h[0]=="string"&&(e==null||e[h[0]]===void 0))for(var l=0;l<h.length;l++)BI(h[l])&&(r+=Y1(o)+":"+UI(o,h[l])+";");else{var m=Em(t,e,h);switch(o){case"animation":case"animationName":{r+=Y1(o)+":"+m+";";break}default:r+=o+"{"+m+"}"}}}return r}var VI=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Sa,XT=function(e,n,r){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var i=!0,o="";Sa=void 0;var h=e[0];h==null||h.raw===void 0?(i=!1,o+=Em(r,n,h)):o+=h[0];for(var l=1;l<e.length;l++)o+=Em(r,n,e[l]),i&&(o+=h[l]);VI.lastIndex=0;for(var m="",_;(_=VI.exec(o))!==null;)m+="-"+_[1];var E=oX(o)+m;return{name:E,styles:o,next:Sa}},hX=function(e){return e()},JO=fb["useInsertionEffect"]?fb["useInsertionEffect"]:!1,dX=JO||hX,jI=JO||q.useLayoutEffect,QO=q.createContext(typeof HTMLElement<"u"?XZ({key:"css"}):null);QO.Provider;var ez=function(e){return q.forwardRef(function(n,r){var i=q.useContext(QO);return e(n,i,r)})},sv=q.createContext({}),fX=ez(function(t,e){var n=t.styles,r=XT([n],void 0,q.useContext(sv)),i=q.useRef();return jI(function(){var o=e.key+"-global",h=new e.sheet.constructor({key:o,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),l=!1,m=document.querySelector('style[data-emotion="'+o+" "+r.name+'"]');return e.sheet.tags.length&&(h.before=e.sheet.tags[0]),m!==null&&(l=!0,m.setAttribute("data-emotion",o),h.hydrate([m])),i.current=[h,l],function(){h.flush()}},[e]),jI(function(){var o=i.current,h=o[0],l=o[1];if(l){o[1]=!1;return}if(r.next!==void 0&&YO(e,r.next,!0),h.tags.length){var m=h.tags[h.tags.length-1].nextElementSibling;h.before=m,h.flush()}e.insert("",r,h,!1)},[e,r.name]),null});function YT(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return XT(e)}var qm=function(){var e=YT.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},pX=xZ,mX=function(e){return e!=="theme"},$I=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?pX:mX},GI=function(e,n,r){var i;if(n){var o=n.shouldForwardProp;i=e.__emotion_forwardProp&&o?function(h){return e.__emotion_forwardProp(h)&&o(h)}:o}return typeof i!="function"&&r&&(i=e.__emotion_forwardProp),i},gX=function(e){var n=e.cache,r=e.serialized,i=e.isStringTag;return XO(n,r,i),dX(function(){return YO(n,r,i)}),null},yX=function t(e,n){var r=e.__emotion_real===e,i=r&&e.__emotion_base||e,o,h;n!==void 0&&(o=n.label,h=n.target);var l=GI(e,n,r),m=l||$I(i),_=!m("as");return function(){var E=arguments,T=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(o!==void 0&&T.push("label:"+o+";"),E[0]==null||E[0].raw===void 0)T.push.apply(T,E);else{T.push(E[0][0]);for(var A=E.length,L=1;L<A;L++)T.push(E[L],E[0][L])}var R=ez(function(D,W,z){var N=_&&D.as||i,F="",$=[],K=D;if(D.theme==null){K={};for(var ne in D)K[ne]=D[ne];K.theme=q.useContext(sv)}typeof D.className=="string"?F=sX(W.registered,$,D.className):D.className!=null&&(F=D.className+" ");var re=XT(T.concat($),W.registered,K);F+=W.key+"-"+re.name,h!==void 0&&(F+=" "+h);var be=_&&l===void 0?$I(N):m,xe={};for(var fe in D)_&&fe==="as"||be(fe)&&(xe[fe]=D[fe]);return xe.className=F,xe.ref=z,q.createElement(q.Fragment,null,q.createElement(gX,{cache:W,serialized:re,isStringTag:typeof N=="string"}),q.createElement(N,xe))});return R.displayName=o!==void 0?o:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",R.defaultProps=e.defaultProps,R.__emotion_real=R,R.__emotion_base=i,R.__emotion_styles=T,R.__emotion_forwardProp=l,Object.defineProperty(R,"toString",{value:function(){return"."+h}}),R.withComponent=function(D,W){return t(D,ie({},n,W,{shouldForwardProp:GI(R,W,!0)})).apply(void 0,T)},R}},_X=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],qw=yX.bind();_X.forEach(function(t){qw[t]=qw(t)});function vX(t){return t==null||Object.keys(t).length===0}function xX(t){const{styles:e,defaultTheme:n={}}=t,r=typeof e=="function"?i=>e(vX(i)?n:i):e;return Q.jsx(fX,{styles:r})}/**
 * @mui/styled-engine v5.14.14
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function tz(t,e){return qw(t,e)}const bX=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))},wX=["values","unit","step"],EX=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>ie({},n,{[r.key]:r.val}),{})};function TX(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,i=Yt(t,wX),o=EX(e),h=Object.keys(o);function l(A){return`@media (min-width:${typeof e[A]=="number"?e[A]:A}${n})`}function m(A){return`@media (max-width:${(typeof e[A]=="number"?e[A]:A)-r/100}${n})`}function _(A,L){const R=h.indexOf(L);return`@media (min-width:${typeof e[A]=="number"?e[A]:A}${n}) and (max-width:${(R!==-1&&typeof e[h[R]]=="number"?e[h[R]]:L)-r/100}${n})`}function E(A){return h.indexOf(A)+1<h.length?_(A,h[h.indexOf(A)+1]):l(A)}function T(A){const L=h.indexOf(A);return L===0?l(h[1]):L===h.length-1?m(h[L]):_(A,h[h.indexOf(A)+1]).replace("@media","@media not all and")}return ie({keys:h,values:o,up:l,down:m,between:_,only:E,not:T,unit:n},i)}const SX={borderRadius:4},PX=SX;function Bp(t,e){return e?Fs(t,e,{clone:!1}):t}const KT={xs:0,sm:600,md:900,lg:1200,xl:1536},WI={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${KT[t]}px)`};function yl(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const o=r.breakpoints||WI;return e.reduce((h,l,m)=>(h[o.up(o.keys[m])]=n(e[m]),h),{})}if(typeof e=="object"){const o=r.breakpoints||WI;return Object.keys(e).reduce((h,l)=>{if(Object.keys(o.values||KT).indexOf(l)!==-1){const m=o.up(l);h[m]=n(e[l],l)}else{const m=l;h[m]=e[m]}return h},{})}return n(e)}function CX(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,i)=>{const o=t.up(i);return r[o]={},r},{}))||{}}function AX(t,e){return t.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},e)}function ov(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((i,o)=>i&&i[o]?i[o]:null,t);if(r!=null)return r}return e.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,t)}function c_(t,e,n,r=n){let i;return typeof t=="function"?i=t(n):Array.isArray(t)?i=t[n]||r:i=ov(t,n)||r,e&&(i=e(i,r,t)),i}function er(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:i}=t,o=h=>{if(h[e]==null)return null;const l=h[e],m=h.theme,_=ov(m,r)||{};return yl(h,l,T=>{let A=c_(_,i,T);return T===A&&typeof T=="string"&&(A=c_(_,i,`${e}${T==="default"?"":qt(T)}`,T)),n===!1?A:{[n]:A}})};return o.propTypes={},o.filterProps=[e],o}function IX(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const MX={m:"margin",p:"padding"},kX={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},HI={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},LX=IX(t=>{if(t.length>2)if(HI[t])t=HI[t];else return[t];const[e,n]=t.split(""),r=MX[e],i=kX[n]||"";return Array.isArray(i)?i.map(o=>r+o):[r+i]}),JT=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],QT=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...JT,...QT];function Zm(t,e,n,r){var i;const o=(i=ov(t,e,!1))!=null?i:n;return typeof o=="number"?h=>typeof h=="string"?h:o*h:Array.isArray(o)?h=>typeof h=="string"?h:o[h]:typeof o=="function"?o:()=>{}}function nz(t){return Zm(t,"spacing",8)}function Xm(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function RX(t,e){return n=>t.reduce((r,i)=>(r[i]=Xm(e,n),r),{})}function OX(t,e,n,r){if(e.indexOf(n)===-1)return null;const i=LX(n),o=RX(i,r),h=t[n];return yl(t,h,o)}function rz(t,e){const n=nz(t.theme);return Object.keys(t).map(r=>OX(t,e,r,n)).reduce(Bp,{})}function Hr(t){return rz(t,JT)}Hr.propTypes={};Hr.filterProps=JT;function qr(t){return rz(t,QT)}qr.propTypes={};qr.filterProps=QT;function zX(t=8){if(t.mui)return t;const e=nz({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(o=>{const h=e(o);return typeof h=="number"?`${h}px`:h}).join(" ");return n.mui=!0,n}function av(...t){const e=t.reduce((r,i)=>(i.filterProps.forEach(o=>{r[o]=i}),r),{}),n=r=>Object.keys(r).reduce((i,o)=>e[o]?Bp(i,e[o](r)):i,{});return n.propTypes={},n.filterProps=t.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Aa(t){return typeof t!="number"?t:`${t}px solid`}const DX=er({prop:"border",themeKey:"borders",transform:Aa}),FX=er({prop:"borderTop",themeKey:"borders",transform:Aa}),NX=er({prop:"borderRight",themeKey:"borders",transform:Aa}),BX=er({prop:"borderBottom",themeKey:"borders",transform:Aa}),UX=er({prop:"borderLeft",themeKey:"borders",transform:Aa}),VX=er({prop:"borderColor",themeKey:"palette"}),jX=er({prop:"borderTopColor",themeKey:"palette"}),$X=er({prop:"borderRightColor",themeKey:"palette"}),GX=er({prop:"borderBottomColor",themeKey:"palette"}),WX=er({prop:"borderLeftColor",themeKey:"palette"}),lv=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Zm(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Xm(e,r)});return yl(t,t.borderRadius,n)}return null};lv.propTypes={};lv.filterProps=["borderRadius"];av(DX,FX,NX,BX,UX,VX,jX,$X,GX,WX,lv);const cv=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Zm(t.theme,"spacing",8),n=r=>({gap:Xm(e,r)});return yl(t,t.gap,n)}return null};cv.propTypes={};cv.filterProps=["gap"];const uv=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Zm(t.theme,"spacing",8),n=r=>({columnGap:Xm(e,r)});return yl(t,t.columnGap,n)}return null};uv.propTypes={};uv.filterProps=["columnGap"];const hv=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Zm(t.theme,"spacing",8),n=r=>({rowGap:Xm(e,r)});return yl(t,t.rowGap,n)}return null};hv.propTypes={};hv.filterProps=["rowGap"];const HX=er({prop:"gridColumn"}),qX=er({prop:"gridRow"}),ZX=er({prop:"gridAutoFlow"}),XX=er({prop:"gridAutoColumns"}),YX=er({prop:"gridAutoRows"}),KX=er({prop:"gridTemplateColumns"}),JX=er({prop:"gridTemplateRows"}),QX=er({prop:"gridTemplateAreas"}),eY=er({prop:"gridArea"});av(cv,uv,hv,HX,qX,ZX,XX,YX,KX,JX,QX,eY);function ud(t,e){return e==="grey"?e:t}const tY=er({prop:"color",themeKey:"palette",transform:ud}),nY=er({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:ud}),rY=er({prop:"backgroundColor",themeKey:"palette",transform:ud});av(tY,nY,rY);function eo(t){return t<=1&&t!==0?`${t*100}%`:t}const iY=er({prop:"width",transform:eo}),eS=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,i;const o=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||KT[n];return o?((i=t.theme)==null||(i=i.breakpoints)==null?void 0:i.unit)!=="px"?{maxWidth:`${o}${t.theme.breakpoints.unit}`}:{maxWidth:o}:{maxWidth:eo(n)}};return yl(t,t.maxWidth,e)}return null};eS.filterProps=["maxWidth"];const sY=er({prop:"minWidth",transform:eo}),oY=er({prop:"height",transform:eo}),aY=er({prop:"maxHeight",transform:eo}),lY=er({prop:"minHeight",transform:eo});er({prop:"size",cssProperty:"width",transform:eo});er({prop:"size",cssProperty:"height",transform:eo});const cY=er({prop:"boxSizing"});av(iY,eS,sY,oY,aY,lY,cY);const uY={border:{themeKey:"borders",transform:Aa},borderTop:{themeKey:"borders",transform:Aa},borderRight:{themeKey:"borders",transform:Aa},borderBottom:{themeKey:"borders",transform:Aa},borderLeft:{themeKey:"borders",transform:Aa},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:lv},color:{themeKey:"palette",transform:ud},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:ud},backgroundColor:{themeKey:"palette",transform:ud},p:{style:qr},pt:{style:qr},pr:{style:qr},pb:{style:qr},pl:{style:qr},px:{style:qr},py:{style:qr},padding:{style:qr},paddingTop:{style:qr},paddingRight:{style:qr},paddingBottom:{style:qr},paddingLeft:{style:qr},paddingX:{style:qr},paddingY:{style:qr},paddingInline:{style:qr},paddingInlineStart:{style:qr},paddingInlineEnd:{style:qr},paddingBlock:{style:qr},paddingBlockStart:{style:qr},paddingBlockEnd:{style:qr},m:{style:Hr},mt:{style:Hr},mr:{style:Hr},mb:{style:Hr},ml:{style:Hr},mx:{style:Hr},my:{style:Hr},margin:{style:Hr},marginTop:{style:Hr},marginRight:{style:Hr},marginBottom:{style:Hr},marginLeft:{style:Hr},marginX:{style:Hr},marginY:{style:Hr},marginInline:{style:Hr},marginInlineStart:{style:Hr},marginInlineEnd:{style:Hr},marginBlock:{style:Hr},marginBlockStart:{style:Hr},marginBlockEnd:{style:Hr},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:cv},rowGap:{style:hv},columnGap:{style:uv},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:eo},maxWidth:{style:eS},minWidth:{transform:eo},height:{transform:eo},maxHeight:{transform:eo},minHeight:{transform:eo},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},dv=uY;function hY(...t){const e=t.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function dY(t,e){return typeof t=="function"?t(e):t}function fY(){function t(n,r,i,o){const h={[n]:r,theme:i},l=o[n];if(!l)return{[n]:r};const{cssProperty:m=n,themeKey:_,transform:E,style:T}=l;if(r==null)return null;if(_==="typography"&&r==="inherit")return{[n]:r};const A=ov(i,_)||{};return T?T(h):yl(h,r,R=>{let D=c_(A,E,R);return R===D&&typeof R=="string"&&(D=c_(A,E,`${n}${R==="default"?"":qt(R)}`,R)),m===!1?D:{[m]:D}})}function e(n){var r;const{sx:i,theme:o={}}=n||{};if(!i)return null;const h=(r=o.unstable_sxConfig)!=null?r:dv;function l(m){let _=m;if(typeof m=="function")_=m(o);else if(typeof m!="object")return m;if(!_)return null;const E=CX(o.breakpoints),T=Object.keys(E);let A=E;return Object.keys(_).forEach(L=>{const R=dY(_[L],o);if(R!=null)if(typeof R=="object")if(h[L])A=Bp(A,t(L,R,o,h));else{const D=yl({theme:o},R,W=>({[L]:W}));hY(D,R)?A[L]=e({sx:R,theme:o}):A=Bp(A,D)}else A=Bp(A,t(L,R,o,h))}),AX(T,A)}return Array.isArray(i)?i.map(l):l(i)}return e}const iz=fY();iz.filterProps=["sx"];const fv=iz,pY=["breakpoints","palette","spacing","shape"];function tS(t={},...e){const{breakpoints:n={},palette:r={},spacing:i,shape:o={}}=t,h=Yt(t,pY),l=TX(n),m=zX(i);let _=Fs({breakpoints:l,direction:"ltr",components:{},palette:ie({mode:"light"},r),spacing:m,shape:ie({},PX,o)},h);return _=e.reduce((E,T)=>Fs(E,T),_),_.unstable_sxConfig=ie({},dv,h==null?void 0:h.unstable_sxConfig),_.unstable_sx=function(T){return fv({sx:T,theme:this})},_}function mY(t){return Object.keys(t).length===0}function nS(t=null){const e=q.useContext(sv);return!e||mY(e)?t:e}const gY=tS();function pv(t=gY){return nS(t)}function yY({styles:t,themeId:e,defaultTheme:n={}}){const r=pv(n),i=typeof t=="function"?t(e&&r[e]||r):t;return Q.jsx(xX,{styles:i})}const _Y=["sx"],vY=t=>{var e,n;const r={systemProps:{},otherProps:{}},i=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:dv;return Object.keys(t).forEach(o=>{i[o]?r.systemProps[o]=t[o]:r.otherProps[o]=t[o]}),r};function sz(t){const{sx:e}=t,n=Yt(t,_Y),{systemProps:r,otherProps:i}=vY(n);let o;return Array.isArray(e)?o=[r,...e]:typeof e=="function"?o=(...h)=>{const l=e(...h);return sl(l)?ie({},r,l):r}:o=ie({},r,e),ie({},i,{sx:o})}function oz(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=oz(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function rn(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=oz(t))&&(r&&(r+=" "),r+=e);return r}const xY=["className","component"];function bY(t={}){const{themeId:e,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:i}=t,o=tz("div",{shouldForwardProp:l=>l!=="theme"&&l!=="sx"&&l!=="as"})(fv);return q.forwardRef(function(m,_){const E=pv(n),T=sz(m),{className:A,component:L="div"}=T,R=Yt(T,xY);return Q.jsx(o,ie({as:L,ref:_,className:rn(A,i?i(r):r),theme:e&&E[e]||E},R))})}const wY=["variant"];function qI(t){return t.length===0}function az(t){const{variant:e}=t,n=Yt(t,wY);let r=e||"";return Object.keys(n).sort().forEach(i=>{i==="color"?r+=qI(r)?t[i]:qt(t[i]):r+=`${qI(r)?i:qt(i)}${qt(t[i].toString())}`}),r}const EY=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function TY(t){return Object.keys(t).length===0}function SY(t){return typeof t=="string"&&t.charCodeAt(0)>96}const PY=(t,e)=>e.components&&e.components[t]&&e.components[t].styleOverrides?e.components[t].styleOverrides:null,u_=t=>{const e={};return t&&t.forEach(n=>{const r=az(n.props);e[r]=n.style}),e},CY=(t,e)=>{let n=[];return e&&e.components&&e.components[t]&&e.components[t].variants&&(n=e.components[t].variants),u_(n)},h_=(t,e,n)=>{const{ownerState:r={}}=t,i=[];return n&&n.forEach(o=>{let h=!0;Object.keys(o.props).forEach(l=>{r[l]!==o.props[l]&&t[l]!==o.props[l]&&(h=!1)}),h&&i.push(e[az(o.props)])}),i},AY=(t,e,n,r)=>{var i;const o=n==null||(i=n.components)==null||(i=i[r])==null?void 0:i.variants;return h_(t,e,o)};function Up(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const IY=tS(),MY=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function v0({defaultTheme:t,theme:e,themeId:n}){return TY(e)?t:e[n]||e}function kY(t){return t?(e,n)=>n[t]:null}const ZI=({styledArg:t,props:e,defaultTheme:n,themeId:r})=>{const i=t(ie({},e,{theme:v0(ie({},e,{defaultTheme:n,themeId:r}))}));let o;if(i&&i.variants&&(o=i.variants,delete i.variants),o){const h=h_(e,u_(o),o);return[i,...h]}return i};function LY(t={}){const{themeId:e,defaultTheme:n=IY,rootShouldForwardProp:r=Up,slotShouldForwardProp:i=Up}=t,o=h=>fv(ie({},h,{theme:v0(ie({},h,{defaultTheme:n,themeId:e}))}));return o.__mui_systemSx=!0,(h,l={})=>{bX(h,$=>$.filter(K=>!(K!=null&&K.__mui_systemSx)));const{name:m,slot:_,skipVariantsResolver:E,skipSx:T,overridesResolver:A=kY(MY(_))}=l,L=Yt(l,EY),R=E!==void 0?E:_&&_!=="Root"&&_!=="root"||!1,D=T||!1;let W,z=Up;_==="Root"||_==="root"?z=r:_?z=i:SY(h)&&(z=void 0);const N=tz(h,ie({shouldForwardProp:z,label:W},L)),F=($,...K)=>{const ne=K?K.map(fe=>{if(typeof fe=="function"&&fe.__emotion_real!==fe)return Re=>ZI({styledArg:fe,props:Re,defaultTheme:n,themeId:e});if(sl(fe)){let Re=fe,Ve;return fe&&fe.variants&&(Ve=fe.variants,delete Re.variants,Re=Fe=>{let ze=fe;return h_(Fe,u_(Ve),Ve).forEach(je=>{ze=Fs(ze,je)}),ze}),Re}return fe}):[];let re=$;if(sl($)){let fe;$&&$.variants&&(fe=$.variants,delete re.variants,re=Re=>{let Ve=$;return h_(Re,u_(fe),fe).forEach(ze=>{Ve=Fs(Ve,ze)}),Ve})}else typeof $=="function"&&$.__emotion_real!==$&&(re=fe=>ZI({styledArg:$,props:fe,defaultTheme:n,themeId:e}));m&&A&&ne.push(fe=>{const Re=v0(ie({},fe,{defaultTheme:n,themeId:e})),Ve=PY(m,Re);if(Ve){const Fe={};return Object.entries(Ve).forEach(([ze,Ye])=>{Fe[ze]=typeof Ye=="function"?Ye(ie({},fe,{theme:Re})):Ye}),A(fe,Fe)}return null}),m&&!R&&ne.push(fe=>{const Re=v0(ie({},fe,{defaultTheme:n,themeId:e}));return AY(fe,CY(m,Re),Re,m)}),D||ne.push(o);const be=ne.length-K.length;if(Array.isArray($)&&be>0){const fe=new Array(be).fill("");re=[...$,...fe],re.raw=[...$.raw,...fe]}const xe=N(re,...ne);return h.muiName&&(xe.muiName=h.muiName),xe};return N.withConfig&&(F.withConfig=N.withConfig),F}}function RY(t){const{theme:e,name:n,props:r}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:jT(e.components[n].defaultProps,r)}function OY({props:t,name:e,defaultTheme:n,themeId:r}){let i=pv(n);return r&&(i=i[r]||i),RY({theme:i,name:e,props:t})}function rS(t,e=0,n=1){return Math.min(Math.max(e,t),n)}function zY(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function Cu(t){if(t.type)return t;if(t.charAt(0)==="#")return Cu(zY(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(Ec(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error(Ec(10,i))}else r=r.split(",");return r=r.map(o=>parseFloat(o)),{type:n,values:r,colorSpace:i}}function mv(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((i,o)=>o<3?parseInt(i,10):i):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function DY(t){t=Cu(t);const{values:e}=t,n=e[0],r=e[1]/100,i=e[2]/100,o=r*Math.min(i,1-i),h=(_,E=(_+n/30)%12)=>i-o*Math.max(Math.min(E-3,9-E,1),-1);let l="rgb";const m=[Math.round(h(0)*255),Math.round(h(8)*255),Math.round(h(4)*255)];return t.type==="hsla"&&(l+="a",m.push(e[3])),mv({type:l,values:m})}function Zw(t){t=Cu(t);let e=t.type==="hsl"||t.type==="hsla"?Cu(DY(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function FY(t,e){const n=Zw(t),r=Zw(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function Ai(t,e){return t=Cu(t),e=rS(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,mv(t)}function Tm(t,e){if(t=Cu(t),e=rS(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return mv(t)}function Sm(t,e){if(t=Cu(t),e=rS(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return mv(t)}function NY(t,e=.15){return Zw(t)>.5?Tm(t,e):Sm(t,e)}const BY=q.createContext(null),lz=BY;function cz(){return q.useContext(lz)}const UY=typeof Symbol=="function"&&Symbol.for,VY=UY?Symbol.for("mui.nested"):"__THEME_NESTED__";function jY(t,e){return typeof e=="function"?e(t):ie({},t,e)}function $Y(t){const{children:e,theme:n}=t,r=cz(),i=q.useMemo(()=>{const o=r===null?n:jY(r,n);return o!=null&&(o[VY]=r!==null),o},[n,r]);return Q.jsx(lz.Provider,{value:i,children:e})}const XI={};function YI(t,e,n,r=!1){return q.useMemo(()=>{const i=t&&e[t]||e;if(typeof n=="function"){const o=n(i),h=t?ie({},e,{[t]:o}):o;return r?()=>h:h}return t?ie({},e,{[t]:n}):ie({},e,n)},[t,e,n,r])}function GY(t){const{children:e,theme:n,themeId:r}=t,i=nS(XI),o=cz()||XI,h=YI(r,i,n),l=YI(r,o,n,!0);return Q.jsx($Y,{theme:l,children:Q.jsx(sv.Provider,{value:h,children:e})})}function WY(t,e){return ie({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}const HY=["mode","contrastThreshold","tonalOffset"],KI={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:xm.white,default:xm.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},K1={text:{primary:xm.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:xm.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function JI(t,e,n,r){const i=r.light||r,o=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=Sm(t.main,i):e==="dark"&&(t.dark=Tm(t.main,o)))}function qY(t="light"){return t==="dark"?{main:kh[200],light:kh[50],dark:kh[400]}:{main:kh[700],light:kh[400],dark:kh[800]}}function ZY(t="light"){return t==="dark"?{main:Mh[200],light:Mh[50],dark:Mh[400]}:{main:Mh[500],light:Mh[300],dark:Mh[700]}}function XY(t="light"){return t==="dark"?{main:Ih[500],light:Ih[300],dark:Ih[700]}:{main:Ih[700],light:Ih[400],dark:Ih[800]}}function YY(t="light"){return t==="dark"?{main:Lh[400],light:Lh[300],dark:Lh[700]}:{main:Lh[700],light:Lh[500],dark:Lh[900]}}function KY(t="light"){return t==="dark"?{main:Rh[400],light:Rh[300],dark:Rh[700]}:{main:Rh[800],light:Rh[500],dark:Rh[900]}}function JY(t="light"){return t==="dark"?{main:lp[400],light:lp[300],dark:lp[700]}:{main:"#ed6c02",light:lp[500],dark:lp[900]}}function QY(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,i=Yt(t,HY),o=t.primary||qY(e),h=t.secondary||ZY(e),l=t.error||XY(e),m=t.info||YY(e),_=t.success||KY(e),E=t.warning||JY(e);function T(D){return FY(D,K1.text.primary)>=n?K1.text.primary:KI.text.primary}const A=({color:D,name:W,mainShade:z=500,lightShade:N=300,darkShade:F=700})=>{if(D=ie({},D),!D.main&&D[z]&&(D.main=D[z]),!D.hasOwnProperty("main"))throw new Error(Ec(11,W?` (${W})`:"",z));if(typeof D.main!="string")throw new Error(Ec(12,W?` (${W})`:"",JSON.stringify(D.main)));return JI(D,"light",N,r),JI(D,"dark",F,r),D.contrastText||(D.contrastText=T(D.main)),D},L={dark:K1,light:KI};return Fs(ie({common:ie({},xm),mode:e,primary:A({color:o,name:"primary"}),secondary:A({color:h,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:A({color:l,name:"error"}),warning:A({color:E,name:"warning"}),info:A({color:m,name:"info"}),success:A({color:_,name:"success"}),grey:sZ,contrastThreshold:n,getContrastText:T,augmentColor:A,tonalOffset:r},L[e]),i)}const eK=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function tK(t){return Math.round(t*1e5)/1e5}const QI={textTransform:"uppercase"},eM='"Roboto", "Helvetica", "Arial", sans-serif';function nK(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:r=eM,fontSize:i=14,fontWeightLight:o=300,fontWeightRegular:h=400,fontWeightMedium:l=500,fontWeightBold:m=700,htmlFontSize:_=16,allVariants:E,pxToRem:T}=n,A=Yt(n,eK),L=i/14,R=T||(z=>`${z/_*L}rem`),D=(z,N,F,$,K)=>ie({fontFamily:r,fontWeight:z,fontSize:R(N),lineHeight:F},r===eM?{letterSpacing:`${tK($/N)}em`}:{},K,E),W={h1:D(o,96,1.167,-1.5),h2:D(o,60,1.2,-.5),h3:D(h,48,1.167,0),h4:D(h,34,1.235,.25),h5:D(h,24,1.334,0),h6:D(l,20,1.6,.15),subtitle1:D(h,16,1.75,.15),subtitle2:D(l,14,1.57,.1),body1:D(h,16,1.5,.15),body2:D(h,14,1.43,.15),button:D(l,14,1.75,.4,QI),caption:D(h,12,1.66,.4),overline:D(h,12,2.66,1,QI),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Fs(ie({htmlFontSize:_,pxToRem:R,fontFamily:r,fontSize:i,fontWeightLight:o,fontWeightRegular:h,fontWeightMedium:l,fontWeightBold:m},W),A,{clone:!1})}const rK=.2,iK=.14,sK=.12;function Rr(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${rK})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${iK})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${sK})`].join(",")}const oK=["none",Rr(0,2,1,-1,0,1,1,0,0,1,3,0),Rr(0,3,1,-2,0,2,2,0,0,1,5,0),Rr(0,3,3,-2,0,3,4,0,0,1,8,0),Rr(0,2,4,-1,0,4,5,0,0,1,10,0),Rr(0,3,5,-1,0,5,8,0,0,1,14,0),Rr(0,3,5,-1,0,6,10,0,0,1,18,0),Rr(0,4,5,-2,0,7,10,1,0,2,16,1),Rr(0,5,5,-3,0,8,10,1,0,3,14,2),Rr(0,5,6,-3,0,9,12,1,0,3,16,2),Rr(0,6,6,-3,0,10,14,1,0,4,18,3),Rr(0,6,7,-4,0,11,15,1,0,4,20,3),Rr(0,7,8,-4,0,12,17,2,0,5,22,4),Rr(0,7,8,-4,0,13,19,2,0,5,24,4),Rr(0,7,9,-4,0,14,21,2,0,5,26,4),Rr(0,8,9,-5,0,15,22,2,0,6,28,5),Rr(0,8,10,-5,0,16,24,2,0,6,30,5),Rr(0,8,11,-5,0,17,26,2,0,6,32,5),Rr(0,9,11,-5,0,18,28,2,0,7,34,6),Rr(0,9,12,-6,0,19,29,2,0,7,36,6),Rr(0,10,13,-6,0,20,31,3,0,8,38,7),Rr(0,10,13,-6,0,21,33,3,0,8,40,7),Rr(0,10,14,-6,0,22,35,3,0,8,42,7),Rr(0,11,14,-7,0,23,36,3,0,9,44,8),Rr(0,11,15,-7,0,24,38,3,0,9,46,8)],aK=oK,lK=["duration","easing","delay"],cK={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},uK={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function tM(t){return`${Math.round(t)}ms`}function hK(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function dK(t){const e=ie({},cK,t.easing),n=ie({},uK,t.duration);return ie({getAutoHeightDuration:hK,create:(i=["all"],o={})=>{const{duration:h=n.standard,easing:l=e.easeInOut,delay:m=0}=o;return Yt(o,lK),(Array.isArray(i)?i:[i]).map(_=>`${_} ${typeof h=="string"?h:tM(h)} ${l} ${typeof m=="string"?m:tM(m)}`).join(",")}},t,{easing:e,duration:n})}const fK={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},pK=fK,mK=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function iS(t={},...e){const{mixins:n={},palette:r={},transitions:i={},typography:o={}}=t,h=Yt(t,mK);if(t.vars)throw new Error(Ec(18));const l=QY(r),m=tS(t);let _=Fs(m,{mixins:WY(m.breakpoints,n),palette:l,shadows:aK.slice(),typography:nK(l,o),transitions:dK(i),zIndex:ie({},pK)});return _=Fs(_,h),_=e.reduce((E,T)=>Fs(E,T),_),_.unstable_sxConfig=ie({},dv,h==null?void 0:h.unstable_sxConfig),_.unstable_sx=function(T){return fv({sx:T,theme:this})},_}const gK=iS(),gv=gK;function Cc(){const t=pv(gv);return t[Pu]||t}function Bn({props:t,name:e}){return OY({props:t,name:e,defaultTheme:gv,themeId:Pu})}const ua=t=>Up(t)&&t!=="classes",sS=Up,yK=LY({themeId:Pu,defaultTheme:gv,rootShouldForwardProp:ua}),vt=yK,_K=["theme"];function vK(t){let{theme:e}=t,n=Yt(t,_K);const r=e[Pu];return Q.jsx(GY,ie({},n,{themeId:r?Pu:void 0,theme:r||e}))}const xK=t=>{let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,(e/100).toFixed(2)},nM=xK;function bK(t){return Nn("MuiSvgIcon",t)}kn("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const wK=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],EK=t=>{const{color:e,fontSize:n,classes:r}=t,i={root:["root",e!=="inherit"&&`color${qt(e)}`,`fontSize${qt(n)}`]};return Un(i,bK,r)},TK=vt("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${qt(n.color)}`],e[`fontSize${qt(n.fontSize)}`]]}})(({theme:t,ownerState:e})=>{var n,r,i,o,h,l,m,_,E,T,A,L,R;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(n=t.transitions)==null||(r=n.create)==null?void 0:r.call(n,"fill",{duration:(i=t.transitions)==null||(i=i.duration)==null?void 0:i.shorter}),fontSize:{inherit:"inherit",small:((o=t.typography)==null||(h=o.pxToRem)==null?void 0:h.call(o,20))||"1.25rem",medium:((l=t.typography)==null||(m=l.pxToRem)==null?void 0:m.call(l,24))||"1.5rem",large:((_=t.typography)==null||(E=_.pxToRem)==null?void 0:E.call(_,35))||"2.1875rem"}[e.fontSize],color:(T=(A=(t.vars||t).palette)==null||(A=A[e.color])==null?void 0:A.main)!=null?T:{action:(L=(t.vars||t).palette)==null||(L=L.action)==null?void 0:L.active,disabled:(R=(t.vars||t).palette)==null||(R=R.action)==null?void 0:R.disabled,inherit:void 0}[e.color]}}),uz=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiSvgIcon"}),{children:i,className:o,color:h="inherit",component:l="svg",fontSize:m="medium",htmlColor:_,inheritViewBox:E=!1,titleAccess:T,viewBox:A="0 0 24 24"}=r,L=Yt(r,wK),R=q.isValidElement(i)&&i.type==="svg",D=ie({},r,{color:h,component:l,fontSize:m,instanceFontSize:e.fontSize,inheritViewBox:E,viewBox:A,hasSvgAsChild:R}),W={};E||(W.viewBox=A);const z=EK(D);return Q.jsxs(TK,ie({as:l,className:rn(z.root,o),focusable:"false",color:_,"aria-hidden":T?void 0:!0,role:T?"img":void 0,ref:n},W,L,R&&i.props,{ownerState:D,children:[R?i.props.children:i,T?Q.jsx("title",{children:T}):null]}))});uz.muiName="SvgIcon";const Xw=uz;function fo(t,e){function n(r,i){return Q.jsx(Xw,ie({"data-testid":`${e}Icon`,ref:i},r,{children:t}))}return n.muiName=Xw.muiName,q.memo(q.forwardRef(n))}var dr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oS=Symbol.for("react.element"),aS=Symbol.for("react.portal"),yv=Symbol.for("react.fragment"),_v=Symbol.for("react.strict_mode"),vv=Symbol.for("react.profiler"),xv=Symbol.for("react.provider"),bv=Symbol.for("react.context"),SK=Symbol.for("react.server_context"),wv=Symbol.for("react.forward_ref"),Ev=Symbol.for("react.suspense"),Tv=Symbol.for("react.suspense_list"),Sv=Symbol.for("react.memo"),Pv=Symbol.for("react.lazy"),PK=Symbol.for("react.offscreen"),hz;hz=Symbol.for("react.module.reference");function Fo(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case oS:switch(t=t.type,t){case yv:case vv:case _v:case Ev:case Tv:return t;default:switch(t=t&&t.$$typeof,t){case SK:case bv:case wv:case Pv:case Sv:case xv:return t;default:return e}}case aS:return e}}}dr.ContextConsumer=bv;dr.ContextProvider=xv;dr.Element=oS;dr.ForwardRef=wv;dr.Fragment=yv;dr.Lazy=Pv;dr.Memo=Sv;dr.Portal=aS;dr.Profiler=vv;dr.StrictMode=_v;dr.Suspense=Ev;dr.SuspenseList=Tv;dr.isAsyncMode=function(){return!1};dr.isConcurrentMode=function(){return!1};dr.isContextConsumer=function(t){return Fo(t)===bv};dr.isContextProvider=function(t){return Fo(t)===xv};dr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===oS};dr.isForwardRef=function(t){return Fo(t)===wv};dr.isFragment=function(t){return Fo(t)===yv};dr.isLazy=function(t){return Fo(t)===Pv};dr.isMemo=function(t){return Fo(t)===Sv};dr.isPortal=function(t){return Fo(t)===aS};dr.isProfiler=function(t){return Fo(t)===vv};dr.isStrictMode=function(t){return Fo(t)===_v};dr.isSuspense=function(t){return Fo(t)===Ev};dr.isSuspenseList=function(t){return Fo(t)===Tv};dr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===yv||t===vv||t===_v||t===Ev||t===Tv||t===PK||typeof t=="object"&&t!==null&&(t.$$typeof===Pv||t.$$typeof===Sv||t.$$typeof===xv||t.$$typeof===bv||t.$$typeof===wv||t.$$typeof===hz||t.getModuleId!==void 0)};dr.typeOf=Fo;function Yw(t,e){return Yw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Yw(t,e)}function dz(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Yw(t,e)}const rM={disabled:!1},d_=cr.createContext(null);var CK=function(e){return e.scrollTop},Sp="unmounted",iu="exited",su="entering",Nh="entered",Kw="exiting",wl=function(t){dz(e,t);function e(r,i){var o;o=t.call(this,r,i)||this;var h=i,l=h&&!h.isMounting?r.enter:r.appear,m;return o.appearStatus=null,r.in?l?(m=iu,o.appearStatus=su):m=Nh:r.unmountOnExit||r.mountOnEnter?m=Sp:m=iu,o.state={status:m},o.nextCallback=null,o}e.getDerivedStateFromProps=function(i,o){var h=i.in;return h&&o.status===Sp?{status:iu}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(i){var o=null;if(i!==this.props){var h=this.state.status;this.props.in?h!==su&&h!==Nh&&(o=su):(h===su||h===Nh)&&(o=Kw)}this.updateStatus(!1,o)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var i=this.props.timeout,o,h,l;return o=h=l=i,i!=null&&typeof i!="number"&&(o=i.exit,h=i.enter,l=i.appear!==void 0?i.appear:h),{exit:o,enter:h,appear:l}},n.updateStatus=function(i,o){if(i===void 0&&(i=!1),o!==null)if(this.cancelNextCallback(),o===su){if(this.props.unmountOnExit||this.props.mountOnEnter){var h=this.props.nodeRef?this.props.nodeRef.current:yy.findDOMNode(this);h&&CK(h)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===iu&&this.setState({status:Sp})},n.performEnter=function(i){var o=this,h=this.props.enter,l=this.context?this.context.isMounting:i,m=this.props.nodeRef?[l]:[yy.findDOMNode(this),l],_=m[0],E=m[1],T=this.getTimeouts(),A=l?T.appear:T.enter;if(!i&&!h||rM.disabled){this.safeSetState({status:Nh},function(){o.props.onEntered(_)});return}this.props.onEnter(_,E),this.safeSetState({status:su},function(){o.props.onEntering(_,E),o.onTransitionEnd(A,function(){o.safeSetState({status:Nh},function(){o.props.onEntered(_,E)})})})},n.performExit=function(){var i=this,o=this.props.exit,h=this.getTimeouts(),l=this.props.nodeRef?void 0:yy.findDOMNode(this);if(!o||rM.disabled){this.safeSetState({status:iu},function(){i.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:Kw},function(){i.props.onExiting(l),i.onTransitionEnd(h.exit,function(){i.safeSetState({status:iu},function(){i.props.onExited(l)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(i,o){o=this.setNextCallback(o),this.setState(i,o)},n.setNextCallback=function(i){var o=this,h=!0;return this.nextCallback=function(l){h&&(h=!1,o.nextCallback=null,i(l))},this.nextCallback.cancel=function(){h=!1},this.nextCallback},n.onTransitionEnd=function(i,o){this.setNextCallback(o);var h=this.props.nodeRef?this.props.nodeRef.current:yy.findDOMNode(this),l=i==null&&!this.props.addEndListener;if(!h||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var m=this.props.nodeRef?[this.nextCallback]:[h,this.nextCallback],_=m[0],E=m[1];this.props.addEndListener(_,E)}i!=null&&setTimeout(this.nextCallback,i)},n.render=function(){var i=this.state.status;if(i===Sp)return null;var o=this.props,h=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var l=Yt(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return cr.createElement(d_.Provider,{value:null},typeof h=="function"?h(i,l):cr.cloneElement(cr.Children.only(h),l))},e}(cr.Component);wl.contextType=d_;wl.propTypes={};function Oh(){}wl.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Oh,onEntering:Oh,onEntered:Oh,onExit:Oh,onExiting:Oh,onExited:Oh};wl.UNMOUNTED=Sp;wl.EXITED=iu;wl.ENTERING=su;wl.ENTERED=Nh;wl.EXITING=Kw;const lS=wl;function AK(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cS(t,e){var n=function(o){return e&&q.isValidElement(o)?e(o):o},r=Object.create(null);return t&&q.Children.map(t,function(i){return i}).forEach(function(i){r[i.key]=n(i)}),r}function IK(t,e){t=t||{},e=e||{};function n(E){return E in e?e[E]:t[E]}var r=Object.create(null),i=[];for(var o in t)o in e?i.length&&(r[o]=i,i=[]):i.push(o);var h,l={};for(var m in e){if(r[m])for(h=0;h<r[m].length;h++){var _=r[m][h];l[r[m][h]]=n(_)}l[m]=n(m)}for(h=0;h<i.length;h++)l[i[h]]=n(i[h]);return l}function hu(t,e,n){return n[e]!=null?n[e]:t.props[e]}function MK(t,e){return cS(t.children,function(n){return q.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:hu(n,"appear",t),enter:hu(n,"enter",t),exit:hu(n,"exit",t)})})}function kK(t,e,n){var r=cS(t.children),i=IK(e,r);return Object.keys(i).forEach(function(o){var h=i[o];if(q.isValidElement(h)){var l=o in e,m=o in r,_=e[o],E=q.isValidElement(_)&&!_.props.in;m&&(!l||E)?i[o]=q.cloneElement(h,{onExited:n.bind(null,h),in:!0,exit:hu(h,"exit",t),enter:hu(h,"enter",t)}):!m&&l&&!E?i[o]=q.cloneElement(h,{in:!1}):m&&l&&q.isValidElement(_)&&(i[o]=q.cloneElement(h,{onExited:n.bind(null,h),in:_.props.in,exit:hu(h,"exit",t),enter:hu(h,"enter",t)}))}}),i}var LK=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},RK={component:"div",childFactory:function(e){return e}},uS=function(t){dz(e,t);function e(r,i){var o;o=t.call(this,r,i)||this;var h=o.handleExited.bind(AK(o));return o.state={contextValue:{isMounting:!0},handleExited:h,firstRender:!0},o}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,o){var h=o.children,l=o.handleExited,m=o.firstRender;return{children:m?MK(i,l):kK(i,h,l),firstRender:!1}},n.handleExited=function(i,o){var h=cS(this.props.children);i.key in h||(i.props.onExited&&i.props.onExited(o),this.mounted&&this.setState(function(l){var m=ie({},l.children);return delete m[i.key],{children:m}}))},n.render=function(){var i=this.props,o=i.component,h=i.childFactory,l=Yt(i,["component","childFactory"]),m=this.state.contextValue,_=LK(this.state.children).map(h);return delete l.appear,delete l.enter,delete l.exit,o===null?cr.createElement(d_.Provider,{value:m},_):cr.createElement(d_.Provider,{value:m},cr.createElement(o,l,_))},e}(cr.Component);uS.propTypes={};uS.defaultProps=RK;const OK=uS,hS=t=>t.scrollTop;function Rd(t,e){var n,r;const{timeout:i,easing:o,style:h={}}=t;return{duration:(n=h.transitionDuration)!=null?n:typeof i=="number"?i:i[e.mode]||0,easing:(r=h.transitionTimingFunction)!=null?r:typeof o=="object"?o[e.mode]:o,delay:h.transitionDelay}}function zK(t){return Nn("MuiPaper",t)}kn("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const DK=["className","component","elevation","square","variant"],FK=t=>{const{square:e,elevation:n,variant:r,classes:i}=t,o={root:["root",r,!e&&"rounded",r==="elevation"&&`elevation${n}`]};return Un(o,zK,i)},NK=vt("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(({theme:t,ownerState:e})=>{var n;return ie({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!e.square&&{borderRadius:t.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},e.variant==="elevation"&&ie({boxShadow:(t.vars||t).shadows[e.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${Ai("#fff",nM(e.elevation))}, ${Ai("#fff",nM(e.elevation))})`},t.vars&&{backgroundImage:(n=t.vars.overlays)==null?void 0:n[e.elevation]}))}),BK=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiPaper"}),{className:i,component:o="div",elevation:h=1,square:l=!1,variant:m="elevation"}=r,_=Yt(r,DK),E=ie({},r,{component:o,elevation:h,square:l,variant:m}),T=FK(E);return Q.jsx(NK,ie({as:o,ownerState:E,className:rn(T.root,i),ref:n},_))}),Cv=BK;function UK(t){const{className:e,classes:n,pulsate:r=!1,rippleX:i,rippleY:o,rippleSize:h,in:l,onExited:m,timeout:_}=t,[E,T]=q.useState(!1),A=rn(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),L={width:h,height:h,top:-(h/2)+o,left:-(h/2)+i},R=rn(n.child,E&&n.childLeaving,r&&n.childPulsate);return!l&&!E&&T(!0),q.useEffect(()=>{if(!l&&m!=null){const D=setTimeout(m,_);return()=>{clearTimeout(D)}}},[m,l,_]),Q.jsx("span",{className:A,style:L,children:Q.jsx("span",{className:R})})}const VK=kn("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Po=VK,jK=["center","classes","className"];let Av=t=>t,iM,sM,oM,aM;const Jw=550,$K=80,GK=qm(iM||(iM=Av`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),WK=qm(sM||(sM=Av`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),HK=qm(oM||(oM=Av`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),qK=vt("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),ZK=vt(UK,{name:"MuiTouchRipple",slot:"Ripple"})(aM||(aM=Av`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),Po.rippleVisible,GK,Jw,({theme:t})=>t.transitions.easing.easeInOut,Po.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,Po.child,Po.childLeaving,WK,Jw,({theme:t})=>t.transitions.easing.easeInOut,Po.childPulsate,HK,({theme:t})=>t.transitions.easing.easeInOut),XK=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:o={},className:h}=r,l=Yt(r,jK),[m,_]=q.useState([]),E=q.useRef(0),T=q.useRef(null);q.useEffect(()=>{T.current&&(T.current(),T.current=null)},[m]);const A=q.useRef(!1),L=q.useRef(0),R=q.useRef(null),D=q.useRef(null);q.useEffect(()=>()=>{L.current&&clearTimeout(L.current)},[]);const W=q.useCallback($=>{const{pulsate:K,rippleX:ne,rippleY:re,rippleSize:be,cb:xe}=$;_(fe=>[...fe,Q.jsx(ZK,{classes:{ripple:rn(o.ripple,Po.ripple),rippleVisible:rn(o.rippleVisible,Po.rippleVisible),ripplePulsate:rn(o.ripplePulsate,Po.ripplePulsate),child:rn(o.child,Po.child),childLeaving:rn(o.childLeaving,Po.childLeaving),childPulsate:rn(o.childPulsate,Po.childPulsate)},timeout:Jw,pulsate:K,rippleX:ne,rippleY:re,rippleSize:be},E.current)]),E.current+=1,T.current=xe},[o]),z=q.useCallback(($={},K={},ne=()=>{})=>{const{pulsate:re=!1,center:be=i||K.pulsate,fakeElement:xe=!1}=K;if(($==null?void 0:$.type)==="mousedown"&&A.current){A.current=!1;return}($==null?void 0:$.type)==="touchstart"&&(A.current=!0);const fe=xe?null:D.current,Re=fe?fe.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Ve,Fe,ze;if(be||$===void 0||$.clientX===0&&$.clientY===0||!$.clientX&&!$.touches)Ve=Math.round(Re.width/2),Fe=Math.round(Re.height/2);else{const{clientX:Ye,clientY:je}=$.touches&&$.touches.length>0?$.touches[0]:$;Ve=Math.round(Ye-Re.left),Fe=Math.round(je-Re.top)}if(be)ze=Math.sqrt((2*Re.width**2+Re.height**2)/3),ze%2===0&&(ze+=1);else{const Ye=Math.max(Math.abs((fe?fe.clientWidth:0)-Ve),Ve)*2+2,je=Math.max(Math.abs((fe?fe.clientHeight:0)-Fe),Fe)*2+2;ze=Math.sqrt(Ye**2+je**2)}$!=null&&$.touches?R.current===null&&(R.current=()=>{W({pulsate:re,rippleX:Ve,rippleY:Fe,rippleSize:ze,cb:ne})},L.current=setTimeout(()=>{R.current&&(R.current(),R.current=null)},$K)):W({pulsate:re,rippleX:Ve,rippleY:Fe,rippleSize:ze,cb:ne})},[i,W]),N=q.useCallback(()=>{z({},{pulsate:!0})},[z]),F=q.useCallback(($,K)=>{if(clearTimeout(L.current),($==null?void 0:$.type)==="touchend"&&R.current){R.current(),R.current=null,L.current=setTimeout(()=>{F($,K)});return}R.current=null,_(ne=>ne.length>0?ne.slice(1):ne),T.current=K},[]);return q.useImperativeHandle(n,()=>({pulsate:N,start:z,stop:F}),[N,z,F]),Q.jsx(qK,ie({className:rn(Po.root,o.root,h),ref:D},l,{children:Q.jsx(OK,{component:null,exit:!0,children:m})}))}),YK=XK;function KK(t){return Nn("MuiButtonBase",t)}const JK=kn("MuiButtonBase",["root","disabled","focusVisible"]),QK=JK,eJ=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],tJ=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:i}=t,h=Un({root:["root",e&&"disabled",n&&"focusVisible"]},KK,i);return n&&r&&(h.root+=` ${r}`),h},nJ=vt("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${QK.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),rJ=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:o=!1,children:h,className:l,component:m="button",disabled:_=!1,disableRipple:E=!1,disableTouchRipple:T=!1,focusRipple:A=!1,LinkComponent:L="a",onBlur:R,onClick:D,onContextMenu:W,onDragLeave:z,onFocus:N,onFocusVisible:F,onKeyDown:$,onKeyUp:K,onMouseDown:ne,onMouseLeave:re,onMouseUp:be,onTouchEnd:xe,onTouchMove:fe,onTouchStart:Re,tabIndex:Ve=0,TouchRippleProps:Fe,touchRippleRef:ze,type:Ye}=r,je=Yt(r,eJ),tt=q.useRef(null),ke=q.useRef(null),Ge=Yr(ke,ze),{isFocusVisibleRef:nt,onFocus:Dt,onBlur:ht,ref:ot}=VT(),[ct,xt]=q.useState(!1);_&&ct&&xt(!1),q.useImperativeHandle(i,()=>({focusVisible:()=>{xt(!0),tt.current.focus()}}),[]);const[bt,Jt]=q.useState(!1);q.useEffect(()=>{Jt(!0)},[]);const Je=bt&&!E&&!_;q.useEffect(()=>{ct&&A&&!E&&bt&&ke.current.pulsate()},[E,A,ct,bt]);function Et(Pt,gn,mn=T){return ro(He=>(gn&&gn(He),!mn&&ke.current&&ke.current[Pt](He),!0))}const sn=Et("start",ne),Qt=Et("stop",W),hn=Et("stop",z),$t=Et("stop",be),Lt=Et("stop",Pt=>{ct&&Pt.preventDefault(),re&&re(Pt)}),Ft=Et("start",Re),wn=Et("stop",xe),vn=Et("stop",fe),pt=Et("stop",Pt=>{ht(Pt),nt.current===!1&&xt(!1),R&&R(Pt)},!1),dn=ro(Pt=>{tt.current||(tt.current=Pt.currentTarget),Dt(Pt),nt.current===!0&&(xt(!0),F&&F(Pt)),N&&N(Pt)}),Ae=()=>{const Pt=tt.current;return m&&m!=="button"&&!(Pt.tagName==="A"&&Pt.href)},Ct=q.useRef(!1),En=ro(Pt=>{A&&!Ct.current&&ct&&ke.current&&Pt.key===" "&&(Ct.current=!0,ke.current.stop(Pt,()=>{ke.current.start(Pt)})),Pt.target===Pt.currentTarget&&Ae()&&Pt.key===" "&&Pt.preventDefault(),$&&$(Pt),Pt.target===Pt.currentTarget&&Ae()&&Pt.key==="Enter"&&!_&&(Pt.preventDefault(),D&&D(Pt))}),en=ro(Pt=>{A&&Pt.key===" "&&ke.current&&ct&&!Pt.defaultPrevented&&(Ct.current=!1,ke.current.stop(Pt,()=>{ke.current.pulsate(Pt)})),K&&K(Pt),D&&Pt.target===Pt.currentTarget&&Ae()&&Pt.key===" "&&!Pt.defaultPrevented&&D(Pt)});let It=m;It==="button"&&(je.href||je.to)&&(It=L);const Qe={};It==="button"?(Qe.type=Ye===void 0?"button":Ye,Qe.disabled=_):(!je.href&&!je.to&&(Qe.role="button"),_&&(Qe["aria-disabled"]=_));const gt=Yr(n,ot,tt),Mt=ie({},r,{centerRipple:o,component:m,disabled:_,disableRipple:E,disableTouchRipple:T,focusRipple:A,tabIndex:Ve,focusVisible:ct}),Rt=tJ(Mt);return Q.jsxs(nJ,ie({as:It,className:rn(Rt.root,l),ownerState:Mt,onBlur:pt,onClick:D,onContextMenu:Qt,onFocus:dn,onKeyDown:En,onKeyUp:en,onMouseDown:sn,onMouseLeave:Lt,onMouseUp:$t,onDragLeave:hn,onTouchEnd:wn,onTouchMove:vn,onTouchStart:Ft,ref:gt,tabIndex:_?-1:Ve,type:Ye},Qe,je,{children:[h,Je?Q.jsx(YK,ie({ref:Ge,center:o},Fe)):null]}))}),dS=rJ;function iJ(t){return Nn("MuiAlert",t)}const sJ=kn("MuiAlert",["root","action","icon","message","filled","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),lM=sJ;function oJ(t){return Nn("MuiIconButton",t)}const aJ=kn("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),lJ=aJ,cJ=["edge","children","className","color","disabled","disableFocusRipple","size"],uJ=t=>{const{classes:e,disabled:n,color:r,edge:i,size:o}=t,h={root:["root",n&&"disabled",r!=="default"&&`color${qt(r)}`,i&&`edge${qt(i)}`,`size${qt(o)}`]};return Un(h,oJ,e)},hJ=vt(dS,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="default"&&e[`color${qt(n.color)}`],n.edge&&e[`edge${qt(n.edge)}`],e[`size${qt(n.size)}`]]}})(({theme:t,ownerState:e})=>ie({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!e.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:Ai(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.edge==="start"&&{marginLeft:e.size==="small"?-3:-12},e.edge==="end"&&{marginRight:e.size==="small"?-3:-12}),({theme:t,ownerState:e})=>{var n;const r=(n=(t.vars||t).palette)==null?void 0:n[e.color];return ie({},e.color==="inherit"&&{color:"inherit"},e.color!=="inherit"&&e.color!=="default"&&ie({color:r==null?void 0:r.main},!e.disableRipple&&{"&:hover":ie({},r&&{backgroundColor:t.vars?`rgba(${r.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Ai(r.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),e.size==="small"&&{padding:5,fontSize:t.typography.pxToRem(18)},e.size==="large"&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${lJ.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})}),dJ=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiIconButton"}),{edge:i=!1,children:o,className:h,color:l="default",disabled:m=!1,disableFocusRipple:_=!1,size:E="medium"}=r,T=Yt(r,cJ),A=ie({},r,{edge:i,color:l,disabled:m,disableFocusRipple:_,size:E}),L=uJ(A);return Q.jsx(hJ,ie({className:rn(L.root,h),centerRipple:!0,focusRipple:!_,disabled:m,ref:n,ownerState:A},T,{children:o}))}),wa=dJ,fJ=fo(Q.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),pJ=fo(Q.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),mJ=fo(Q.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),gJ=fo(Q.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),yJ=fo(Q.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),_J=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],vJ=t=>{const{variant:e,color:n,severity:r,classes:i}=t,o={root:["root",`${e}${qt(n||r)}`,`${e}`],icon:["icon"],message:["message"],action:["action"]};return Un(o,iJ,i)},xJ=vt(Cv,{name:"MuiAlert",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${qt(n.color||n.severity)}`]]}})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?Tm:Sm,r=t.palette.mode==="light"?Sm:Tm,i=e.color||e.severity;return ie({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px"},i&&e.variant==="standard"&&{color:t.vars?t.vars.palette.Alert[`${i}Color`]:n(t.palette[i].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${i}StandardBg`]:r(t.palette[i].light,.9),[`& .${lM.icon}`]:t.vars?{color:t.vars.palette.Alert[`${i}IconColor`]}:{color:t.palette[i].main}},i&&e.variant==="outlined"&&{color:t.vars?t.vars.palette.Alert[`${i}Color`]:n(t.palette[i].light,.6),border:`1px solid ${(t.vars||t).palette[i].light}`,[`& .${lM.icon}`]:t.vars?{color:t.vars.palette.Alert[`${i}IconColor`]}:{color:t.palette[i].main}},i&&e.variant==="filled"&&ie({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${i}FilledColor`],backgroundColor:t.vars.palette.Alert[`${i}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[i].dark:t.palette[i].main,color:t.palette.getContrastText(t.palette[i].main)}))}),bJ=vt("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(t,e)=>e.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),wJ=vt("div",{name:"MuiAlert",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),cM=vt("div",{name:"MuiAlert",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),uM={success:Q.jsx(fJ,{fontSize:"inherit"}),warning:Q.jsx(pJ,{fontSize:"inherit"}),error:Q.jsx(mJ,{fontSize:"inherit"}),info:Q.jsx(gJ,{fontSize:"inherit"})},EJ=q.forwardRef(function(e,n){var r,i,o,h,l,m;const _=Bn({props:e,name:"MuiAlert"}),{action:E,children:T,className:A,closeText:L="Close",color:R,components:D={},componentsProps:W={},icon:z,iconMapping:N=uM,onClose:F,role:$="alert",severity:K="success",slotProps:ne={},slots:re={},variant:be="standard"}=_,xe=Yt(_,_J),fe=ie({},_,{color:R,severity:K,variant:be}),Re=vJ(fe),Ve=(r=(i=re.closeButton)!=null?i:D.CloseButton)!=null?r:wa,Fe=(o=(h=re.closeIcon)!=null?h:D.CloseIcon)!=null?o:yJ,ze=(l=ne.closeButton)!=null?l:W.closeButton,Ye=(m=ne.closeIcon)!=null?m:W.closeIcon;return Q.jsxs(xJ,ie({role:$,elevation:0,ownerState:fe,className:rn(Re.root,A),ref:n},xe,{children:[z!==!1?Q.jsx(bJ,{ownerState:fe,className:Re.icon,children:z||N[K]||uM[K]}):null,Q.jsx(wJ,{ownerState:fe,className:Re.message,children:T}),E!=null?Q.jsx(cM,{ownerState:fe,className:Re.action,children:E}):null,E==null&&F?Q.jsx(cM,{ownerState:fe,className:Re.action,children:Q.jsx(Ve,ie({size:"small","aria-label":L,title:L,color:"inherit",onClick:F},ze,{children:Q.jsx(Fe,ie({fontSize:"small"},Ye))}))}):null]}))}),TJ=EJ;function SJ(t){return Nn("MuiTypography",t)}kn("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const PJ=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],CJ=t=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:i,variant:o,classes:h}=t,l={root:["root",o,t.align!=="inherit"&&`align${qt(e)}`,n&&"gutterBottom",r&&"noWrap",i&&"paragraph"]};return Un(l,SJ,h)},AJ=vt("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${qt(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(({theme:t,ownerState:e})=>ie({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&t.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),hM={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},IJ={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},MJ=t=>IJ[t]||t,kJ=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiTypography"}),i=MJ(r.color),o=sz(ie({},r,{color:i})),{align:h="inherit",className:l,component:m,gutterBottom:_=!1,noWrap:E=!1,paragraph:T=!1,variant:A="body1",variantMapping:L=hM}=o,R=Yt(o,PJ),D=ie({},o,{align:h,color:i,className:l,component:m,gutterBottom:_,noWrap:E,paragraph:T,variant:A,variantMapping:L}),W=m||(T?"p":L[A]||hM[A])||"span",z=CJ(D);return Q.jsx(AJ,ie({as:W,ref:n,ownerState:D,className:rn(z.root,l)},R))}),vs=kJ;function vc(t){return typeof t=="string"}function Pp(t,e,n){return t===void 0||vc(t)?e:ie({},e,{ownerState:ie({},e.ownerState,n)})}function LJ(t,e,n=(r,i)=>r===i){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}const RJ={disableDefaultClasses:!1},OJ=q.createContext(RJ);function zJ(t){const{disableDefaultClasses:e}=q.useContext(OJ);return n=>e?"":t(n)}function gu(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function DJ(t,e,n){return typeof t=="function"?t(e,n):t}function dM(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function FJ(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:o}=t;if(!e){const L=rn(i==null?void 0:i.className,r==null?void 0:r.className,o,n==null?void 0:n.className),R=ie({},n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),D=ie({},n,i,r);return L.length>0&&(D.className=L),Object.keys(R).length>0&&(D.style=R),{props:D,internalRef:void 0}}const h=gu(ie({},i,r)),l=dM(r),m=dM(i),_=e(h),E=rn(_==null?void 0:_.className,n==null?void 0:n.className,o,i==null?void 0:i.className,r==null?void 0:r.className),T=ie({},_==null?void 0:_.style,n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),A=ie({},_,n,m,l);return E.length>0&&(A.className=E),Object.keys(T).length>0&&(A.style=T),{props:A,internalRef:_.ref}}const NJ=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function is(t){var e;const{elementType:n,externalSlotProps:r,ownerState:i,skipResolvingSlotProps:o=!1}=t,h=Yt(t,NJ),l=o?{}:DJ(r,i),{props:m,internalRef:_}=FJ(ie({},h,{externalSlotProps:l})),E=Yr(_,l==null?void 0:l.ref,(e=t.additionalProps)==null?void 0:e.ref);return Pp(n,ie({},m,{ref:E}),i)}function fM(t){return t.substring(2).toLowerCase()}function BJ(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function UJ(t){const{children:e,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:i,touchEvent:o="onTouchEnd"}=t,h=q.useRef(!1),l=q.useRef(null),m=q.useRef(!1),_=q.useRef(!1);q.useEffect(()=>(setTimeout(()=>{m.current=!0},0),()=>{m.current=!1}),[]);const E=Yr(e.ref,l),T=ro(R=>{const D=_.current;_.current=!1;const W=Xr(l.current);if(!m.current||!l.current||"clientX"in R&&BJ(R,W))return;if(h.current){h.current=!1;return}let z;R.composedPath?z=R.composedPath().indexOf(l.current)>-1:z=!W.documentElement.contains(R.target)||l.current.contains(R.target),!z&&(n||!D)&&i(R)}),A=R=>D=>{_.current=!0;const W=e.props[R];W&&W(D)},L={ref:E};return o!==!1&&(L[o]=A(o)),q.useEffect(()=>{if(o!==!1){const R=fM(o),D=Xr(l.current),W=()=>{h.current=!0};return D.addEventListener(R,T),D.addEventListener("touchmove",W),()=>{D.removeEventListener(R,T),D.removeEventListener("touchmove",W)}}},[T,o]),r!==!1&&(L[r]=A(r)),q.useEffect(()=>{if(r!==!1){const R=fM(r),D=Xr(l.current);return D.addEventListener(R,T),()=>{D.removeEventListener(R,T)}}},[T,r]),Q.jsx(q.Fragment,{children:q.cloneElement(e,L)})}const VJ=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function jJ(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function $J(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=r=>t.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function GJ(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||$J(t))}function WJ(t){const e=[],n=[];return Array.from(t.querySelectorAll(VJ)).forEach((r,i)=>{const o=jJ(r);o===-1||!GJ(r)||(o===0?e.push(r):n.push({documentOrder:i,tabIndex:o,node:r}))}),n.sort((r,i)=>r.tabIndex===i.tabIndex?r.documentOrder-i.documentOrder:r.tabIndex-i.tabIndex).map(r=>r.node).concat(e)}function HJ(){return!0}function qJ(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:i=!1,getTabbable:o=WJ,isEnabled:h=HJ,open:l}=t,m=q.useRef(!1),_=q.useRef(null),E=q.useRef(null),T=q.useRef(null),A=q.useRef(null),L=q.useRef(!1),R=q.useRef(null),D=Yr(e.ref,R),W=q.useRef(null);q.useEffect(()=>{!l||!R.current||(L.current=!n)},[n,l]),q.useEffect(()=>{if(!l||!R.current)return;const F=Xr(R.current);return R.current.contains(F.activeElement)||(R.current.hasAttribute("tabIndex")||R.current.setAttribute("tabIndex","-1"),L.current&&R.current.focus()),()=>{i||(T.current&&T.current.focus&&(m.current=!0,T.current.focus()),T.current=null)}},[l]),q.useEffect(()=>{if(!l||!R.current)return;const F=Xr(R.current),$=re=>{W.current=re,!(r||!h()||re.key!=="Tab")&&F.activeElement===R.current&&re.shiftKey&&(m.current=!0,E.current&&E.current.focus())},K=()=>{const re=R.current;if(re===null)return;if(!F.hasFocus()||!h()||m.current){m.current=!1;return}if(re.contains(F.activeElement)||r&&F.activeElement!==_.current&&F.activeElement!==E.current)return;if(F.activeElement!==A.current)A.current=null;else if(A.current!==null)return;if(!L.current)return;let be=[];if((F.activeElement===_.current||F.activeElement===E.current)&&(be=o(R.current)),be.length>0){var xe,fe;const Re=!!((xe=W.current)!=null&&xe.shiftKey&&((fe=W.current)==null?void 0:fe.key)==="Tab"),Ve=be[0],Fe=be[be.length-1];typeof Ve!="string"&&typeof Fe!="string"&&(Re?Fe.focus():Ve.focus())}else re.focus()};F.addEventListener("focusin",K),F.addEventListener("keydown",$,!0);const ne=setInterval(()=>{F.activeElement&&F.activeElement.tagName==="BODY"&&K()},50);return()=>{clearInterval(ne),F.removeEventListener("focusin",K),F.removeEventListener("keydown",$,!0)}},[n,r,i,h,l,o]);const z=F=>{T.current===null&&(T.current=F.relatedTarget),L.current=!0,A.current=F.target;const $=e.props.onFocus;$&&$(F)},N=F=>{T.current===null&&(T.current=F.relatedTarget),L.current=!0};return Q.jsxs(q.Fragment,{children:[Q.jsx("div",{tabIndex:l?0:-1,onFocus:N,ref:_,"data-testid":"sentinelStart"}),q.cloneElement(e,{ref:D,onFocus:z}),Q.jsx("div",{tabIndex:l?0:-1,onFocus:N,ref:E,"data-testid":"sentinelEnd"})]})}var Ns="top",zo="bottom",Do="right",Bs="left",fS="auto",Ym=[Ns,zo,Do,Bs],Od="start",Pm="end",ZJ="clippingParents",fz="viewport",up="popper",XJ="reference",pM=Ym.reduce(function(t,e){return t.concat([e+"-"+Od,e+"-"+Pm])},[]),pz=[].concat(Ym,[fS]).reduce(function(t,e){return t.concat([e,e+"-"+Od,e+"-"+Pm])},[]),YJ="beforeRead",KJ="read",JJ="afterRead",QJ="beforeMain",eQ="main",tQ="afterMain",nQ="beforeWrite",rQ="write",iQ="afterWrite",sQ=[YJ,KJ,JJ,QJ,eQ,tQ,nQ,rQ,iQ];function Fa(t){return t?(t.nodeName||"").toLowerCase():null}function lo(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Au(t){var e=lo(t).Element;return t instanceof e||t instanceof Element}function Lo(t){var e=lo(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function pS(t){if(typeof ShadowRoot>"u")return!1;var e=lo(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function oQ(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},o=e.elements[n];!Lo(o)||!Fa(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(h){var l=i[h];l===!1?o.removeAttribute(h):o.setAttribute(h,l===!0?"":l)}))})}function aQ(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],o=e.attributes[r]||{},h=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),l=h.reduce(function(m,_){return m[_]="",m},{});!Lo(i)||!Fa(i)||(Object.assign(i.style,l),Object.keys(o).forEach(function(m){i.removeAttribute(m)}))})}}const lQ={name:"applyStyles",enabled:!0,phase:"write",fn:oQ,effect:aQ,requires:["computeStyles"]};function Oa(t){return t.split("-")[0]}var yu=Math.max,f_=Math.min,zd=Math.round;function Qw(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function mz(){return!/^((?!chrome|android).)*safari/i.test(Qw())}function Dd(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,o=1;e&&Lo(t)&&(i=t.offsetWidth>0&&zd(r.width)/t.offsetWidth||1,o=t.offsetHeight>0&&zd(r.height)/t.offsetHeight||1);var h=Au(t)?lo(t):window,l=h.visualViewport,m=!mz()&&n,_=(r.left+(m&&l?l.offsetLeft:0))/i,E=(r.top+(m&&l?l.offsetTop:0))/o,T=r.width/i,A=r.height/o;return{width:T,height:A,top:E,right:_+T,bottom:E+A,left:_,x:_,y:E}}function mS(t){var e=Dd(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function gz(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&pS(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function _l(t){return lo(t).getComputedStyle(t)}function cQ(t){return["table","td","th"].indexOf(Fa(t))>=0}function Ac(t){return((Au(t)?t.ownerDocument:t.document)||window.document).documentElement}function Iv(t){return Fa(t)==="html"?t:t.assignedSlot||t.parentNode||(pS(t)?t.host:null)||Ac(t)}function mM(t){return!Lo(t)||_l(t).position==="fixed"?null:t.offsetParent}function uQ(t){var e=/firefox/i.test(Qw()),n=/Trident/i.test(Qw());if(n&&Lo(t)){var r=_l(t);if(r.position==="fixed")return null}var i=Iv(t);for(pS(i)&&(i=i.host);Lo(i)&&["html","body"].indexOf(Fa(i))<0;){var o=_l(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function Km(t){for(var e=lo(t),n=mM(t);n&&cQ(n)&&_l(n).position==="static";)n=mM(n);return n&&(Fa(n)==="html"||Fa(n)==="body"&&_l(n).position==="static")?e:n||uQ(t)||e}function gS(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Vp(t,e,n){return yu(t,f_(e,n))}function hQ(t,e,n){var r=Vp(t,e,n);return r>n?n:r}function yz(){return{top:0,right:0,bottom:0,left:0}}function _z(t){return Object.assign({},yz(),t)}function vz(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var dQ=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,_z(typeof e!="number"?e:vz(e,Ym))};function fQ(t){var e,n=t.state,r=t.name,i=t.options,o=n.elements.arrow,h=n.modifiersData.popperOffsets,l=Oa(n.placement),m=gS(l),_=[Bs,Do].indexOf(l)>=0,E=_?"height":"width";if(!(!o||!h)){var T=dQ(i.padding,n),A=mS(o),L=m==="y"?Ns:Bs,R=m==="y"?zo:Do,D=n.rects.reference[E]+n.rects.reference[m]-h[m]-n.rects.popper[E],W=h[m]-n.rects.reference[m],z=Km(o),N=z?m==="y"?z.clientHeight||0:z.clientWidth||0:0,F=D/2-W/2,$=T[L],K=N-A[E]-T[R],ne=N/2-A[E]/2+F,re=Vp($,ne,K),be=m;n.modifiersData[r]=(e={},e[be]=re,e.centerOffset=re-ne,e)}}function pQ(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||gz(e.elements.popper,i)&&(e.elements.arrow=i))}const mQ={name:"arrow",enabled:!0,phase:"main",fn:fQ,effect:pQ,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Fd(t){return t.split("-")[1]}var gQ={top:"auto",right:"auto",bottom:"auto",left:"auto"};function yQ(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:zd(n*i)/i||0,y:zd(r*i)/i||0}}function gM(t){var e,n=t.popper,r=t.popperRect,i=t.placement,o=t.variation,h=t.offsets,l=t.position,m=t.gpuAcceleration,_=t.adaptive,E=t.roundOffsets,T=t.isFixed,A=h.x,L=A===void 0?0:A,R=h.y,D=R===void 0?0:R,W=typeof E=="function"?E({x:L,y:D}):{x:L,y:D};L=W.x,D=W.y;var z=h.hasOwnProperty("x"),N=h.hasOwnProperty("y"),F=Bs,$=Ns,K=window;if(_){var ne=Km(n),re="clientHeight",be="clientWidth";if(ne===lo(n)&&(ne=Ac(n),_l(ne).position!=="static"&&l==="absolute"&&(re="scrollHeight",be="scrollWidth")),ne=ne,i===Ns||(i===Bs||i===Do)&&o===Pm){$=zo;var xe=T&&ne===K&&K.visualViewport?K.visualViewport.height:ne[re];D-=xe-r.height,D*=m?1:-1}if(i===Bs||(i===Ns||i===zo)&&o===Pm){F=Do;var fe=T&&ne===K&&K.visualViewport?K.visualViewport.width:ne[be];L-=fe-r.width,L*=m?1:-1}}var Re=Object.assign({position:l},_&&gQ),Ve=E===!0?yQ({x:L,y:D},lo(n)):{x:L,y:D};if(L=Ve.x,D=Ve.y,m){var Fe;return Object.assign({},Re,(Fe={},Fe[$]=N?"0":"",Fe[F]=z?"0":"",Fe.transform=(K.devicePixelRatio||1)<=1?"translate("+L+"px, "+D+"px)":"translate3d("+L+"px, "+D+"px, 0)",Fe))}return Object.assign({},Re,(e={},e[$]=N?D+"px":"",e[F]=z?L+"px":"",e.transform="",e))}function _Q(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,o=n.adaptive,h=o===void 0?!0:o,l=n.roundOffsets,m=l===void 0?!0:l,_={placement:Oa(e.placement),variation:Fd(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,gM(Object.assign({},_,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:h,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,gM(Object.assign({},_,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const vQ={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:_Q,data:{}};var Dy={passive:!0};function xQ(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,o=i===void 0?!0:i,h=r.resize,l=h===void 0?!0:h,m=lo(e.elements.popper),_=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&_.forEach(function(E){E.addEventListener("scroll",n.update,Dy)}),l&&m.addEventListener("resize",n.update,Dy),function(){o&&_.forEach(function(E){E.removeEventListener("scroll",n.update,Dy)}),l&&m.removeEventListener("resize",n.update,Dy)}}const bQ={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:xQ,data:{}};var wQ={left:"right",right:"left",bottom:"top",top:"bottom"};function x0(t){return t.replace(/left|right|bottom|top/g,function(e){return wQ[e]})}var EQ={start:"end",end:"start"};function yM(t){return t.replace(/start|end/g,function(e){return EQ[e]})}function yS(t){var e=lo(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function _S(t){return Dd(Ac(t)).left+yS(t).scrollLeft}function TQ(t,e){var n=lo(t),r=Ac(t),i=n.visualViewport,o=r.clientWidth,h=r.clientHeight,l=0,m=0;if(i){o=i.width,h=i.height;var _=mz();(_||!_&&e==="fixed")&&(l=i.offsetLeft,m=i.offsetTop)}return{width:o,height:h,x:l+_S(t),y:m}}function SQ(t){var e,n=Ac(t),r=yS(t),i=(e=t.ownerDocument)==null?void 0:e.body,o=yu(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),h=yu(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-r.scrollLeft+_S(t),m=-r.scrollTop;return _l(i||n).direction==="rtl"&&(l+=yu(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:h,x:l,y:m}}function vS(t){var e=_l(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function xz(t){return["html","body","#document"].indexOf(Fa(t))>=0?t.ownerDocument.body:Lo(t)&&vS(t)?t:xz(Iv(t))}function jp(t,e){var n;e===void 0&&(e=[]);var r=xz(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),o=lo(r),h=i?[o].concat(o.visualViewport||[],vS(r)?r:[]):r,l=e.concat(h);return i?l:l.concat(jp(Iv(h)))}function eE(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function PQ(t,e){var n=Dd(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function _M(t,e,n){return e===fz?eE(TQ(t,n)):Au(e)?PQ(e,n):eE(SQ(Ac(t)))}function CQ(t){var e=jp(Iv(t)),n=["absolute","fixed"].indexOf(_l(t).position)>=0,r=n&&Lo(t)?Km(t):t;return Au(r)?e.filter(function(i){return Au(i)&&gz(i,r)&&Fa(i)!=="body"}):[]}function AQ(t,e,n,r){var i=e==="clippingParents"?CQ(t):[].concat(e),o=[].concat(i,[n]),h=o[0],l=o.reduce(function(m,_){var E=_M(t,_,r);return m.top=yu(E.top,m.top),m.right=f_(E.right,m.right),m.bottom=f_(E.bottom,m.bottom),m.left=yu(E.left,m.left),m},_M(t,h,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function bz(t){var e=t.reference,n=t.element,r=t.placement,i=r?Oa(r):null,o=r?Fd(r):null,h=e.x+e.width/2-n.width/2,l=e.y+e.height/2-n.height/2,m;switch(i){case Ns:m={x:h,y:e.y-n.height};break;case zo:m={x:h,y:e.y+e.height};break;case Do:m={x:e.x+e.width,y:l};break;case Bs:m={x:e.x-n.width,y:l};break;default:m={x:e.x,y:e.y}}var _=i?gS(i):null;if(_!=null){var E=_==="y"?"height":"width";switch(o){case Od:m[_]=m[_]-(e[E]/2-n[E]/2);break;case Pm:m[_]=m[_]+(e[E]/2-n[E]/2);break}}return m}function Cm(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,o=n.strategy,h=o===void 0?t.strategy:o,l=n.boundary,m=l===void 0?ZJ:l,_=n.rootBoundary,E=_===void 0?fz:_,T=n.elementContext,A=T===void 0?up:T,L=n.altBoundary,R=L===void 0?!1:L,D=n.padding,W=D===void 0?0:D,z=_z(typeof W!="number"?W:vz(W,Ym)),N=A===up?XJ:up,F=t.rects.popper,$=t.elements[R?N:A],K=AQ(Au($)?$:$.contextElement||Ac(t.elements.popper),m,E,h),ne=Dd(t.elements.reference),re=bz({reference:ne,element:F,strategy:"absolute",placement:i}),be=eE(Object.assign({},F,re)),xe=A===up?be:ne,fe={top:K.top-xe.top+z.top,bottom:xe.bottom-K.bottom+z.bottom,left:K.left-xe.left+z.left,right:xe.right-K.right+z.right},Re=t.modifiersData.offset;if(A===up&&Re){var Ve=Re[i];Object.keys(fe).forEach(function(Fe){var ze=[Do,zo].indexOf(Fe)>=0?1:-1,Ye=[Ns,zo].indexOf(Fe)>=0?"y":"x";fe[Fe]+=Ve[Ye]*ze})}return fe}function IQ(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,o=n.rootBoundary,h=n.padding,l=n.flipVariations,m=n.allowedAutoPlacements,_=m===void 0?pz:m,E=Fd(r),T=E?l?pM:pM.filter(function(R){return Fd(R)===E}):Ym,A=T.filter(function(R){return _.indexOf(R)>=0});A.length===0&&(A=T);var L=A.reduce(function(R,D){return R[D]=Cm(t,{placement:D,boundary:i,rootBoundary:o,padding:h})[Oa(D)],R},{});return Object.keys(L).sort(function(R,D){return L[R]-L[D]})}function MQ(t){if(Oa(t)===fS)return[];var e=x0(t);return[yM(t),e,yM(e)]}function kQ(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,o=i===void 0?!0:i,h=n.altAxis,l=h===void 0?!0:h,m=n.fallbackPlacements,_=n.padding,E=n.boundary,T=n.rootBoundary,A=n.altBoundary,L=n.flipVariations,R=L===void 0?!0:L,D=n.allowedAutoPlacements,W=e.options.placement,z=Oa(W),N=z===W,F=m||(N||!R?[x0(W)]:MQ(W)),$=[W].concat(F).reduce(function(ct,xt){return ct.concat(Oa(xt)===fS?IQ(e,{placement:xt,boundary:E,rootBoundary:T,padding:_,flipVariations:R,allowedAutoPlacements:D}):xt)},[]),K=e.rects.reference,ne=e.rects.popper,re=new Map,be=!0,xe=$[0],fe=0;fe<$.length;fe++){var Re=$[fe],Ve=Oa(Re),Fe=Fd(Re)===Od,ze=[Ns,zo].indexOf(Ve)>=0,Ye=ze?"width":"height",je=Cm(e,{placement:Re,boundary:E,rootBoundary:T,altBoundary:A,padding:_}),tt=ze?Fe?Do:Bs:Fe?zo:Ns;K[Ye]>ne[Ye]&&(tt=x0(tt));var ke=x0(tt),Ge=[];if(o&&Ge.push(je[Ve]<=0),l&&Ge.push(je[tt]<=0,je[ke]<=0),Ge.every(function(ct){return ct})){xe=Re,be=!1;break}re.set(Re,Ge)}if(be)for(var nt=R?3:1,Dt=function(xt){var bt=$.find(function(Jt){var Je=re.get(Jt);if(Je)return Je.slice(0,xt).every(function(Et){return Et})});if(bt)return xe=bt,"break"},ht=nt;ht>0;ht--){var ot=Dt(ht);if(ot==="break")break}e.placement!==xe&&(e.modifiersData[r]._skip=!0,e.placement=xe,e.reset=!0)}}const LQ={name:"flip",enabled:!0,phase:"main",fn:kQ,requiresIfExists:["offset"],data:{_skip:!1}};function vM(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function xM(t){return[Ns,Do,zo,Bs].some(function(e){return t[e]>=0})}function RQ(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,o=e.modifiersData.preventOverflow,h=Cm(e,{elementContext:"reference"}),l=Cm(e,{altBoundary:!0}),m=vM(h,r),_=vM(l,i,o),E=xM(m),T=xM(_);e.modifiersData[n]={referenceClippingOffsets:m,popperEscapeOffsets:_,isReferenceHidden:E,hasPopperEscaped:T},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":E,"data-popper-escaped":T})}const OQ={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:RQ};function zQ(t,e,n){var r=Oa(t),i=[Bs,Ns].indexOf(r)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,h=o[0],l=o[1];return h=h||0,l=(l||0)*i,[Bs,Do].indexOf(r)>=0?{x:l,y:h}:{x:h,y:l}}function DQ(t){var e=t.state,n=t.options,r=t.name,i=n.offset,o=i===void 0?[0,0]:i,h=pz.reduce(function(E,T){return E[T]=zQ(T,e.rects,o),E},{}),l=h[e.placement],m=l.x,_=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=_),e.modifiersData[r]=h}const FQ={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:DQ};function NQ(t){var e=t.state,n=t.name;e.modifiersData[n]=bz({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const BQ={name:"popperOffsets",enabled:!0,phase:"read",fn:NQ,data:{}};function UQ(t){return t==="x"?"y":"x"}function VQ(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,o=i===void 0?!0:i,h=n.altAxis,l=h===void 0?!1:h,m=n.boundary,_=n.rootBoundary,E=n.altBoundary,T=n.padding,A=n.tether,L=A===void 0?!0:A,R=n.tetherOffset,D=R===void 0?0:R,W=Cm(e,{boundary:m,rootBoundary:_,padding:T,altBoundary:E}),z=Oa(e.placement),N=Fd(e.placement),F=!N,$=gS(z),K=UQ($),ne=e.modifiersData.popperOffsets,re=e.rects.reference,be=e.rects.popper,xe=typeof D=="function"?D(Object.assign({},e.rects,{placement:e.placement})):D,fe=typeof xe=="number"?{mainAxis:xe,altAxis:xe}:Object.assign({mainAxis:0,altAxis:0},xe),Re=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Ve={x:0,y:0};if(ne){if(o){var Fe,ze=$==="y"?Ns:Bs,Ye=$==="y"?zo:Do,je=$==="y"?"height":"width",tt=ne[$],ke=tt+W[ze],Ge=tt-W[Ye],nt=L?-be[je]/2:0,Dt=N===Od?re[je]:be[je],ht=N===Od?-be[je]:-re[je],ot=e.elements.arrow,ct=L&&ot?mS(ot):{width:0,height:0},xt=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:yz(),bt=xt[ze],Jt=xt[Ye],Je=Vp(0,re[je],ct[je]),Et=F?re[je]/2-nt-Je-bt-fe.mainAxis:Dt-Je-bt-fe.mainAxis,sn=F?-re[je]/2+nt+Je+Jt+fe.mainAxis:ht+Je+Jt+fe.mainAxis,Qt=e.elements.arrow&&Km(e.elements.arrow),hn=Qt?$==="y"?Qt.clientTop||0:Qt.clientLeft||0:0,$t=(Fe=Re==null?void 0:Re[$])!=null?Fe:0,Lt=tt+Et-$t-hn,Ft=tt+sn-$t,wn=Vp(L?f_(ke,Lt):ke,tt,L?yu(Ge,Ft):Ge);ne[$]=wn,Ve[$]=wn-tt}if(l){var vn,pt=$==="x"?Ns:Bs,dn=$==="x"?zo:Do,Ae=ne[K],Ct=K==="y"?"height":"width",En=Ae+W[pt],en=Ae-W[dn],It=[Ns,Bs].indexOf(z)!==-1,Qe=(vn=Re==null?void 0:Re[K])!=null?vn:0,gt=It?En:Ae-re[Ct]-be[Ct]-Qe+fe.altAxis,Mt=It?Ae+re[Ct]+be[Ct]-Qe-fe.altAxis:en,Rt=L&&It?hQ(gt,Ae,Mt):Vp(L?gt:En,Ae,L?Mt:en);ne[K]=Rt,Ve[K]=Rt-Ae}e.modifiersData[r]=Ve}}const jQ={name:"preventOverflow",enabled:!0,phase:"main",fn:VQ,requiresIfExists:["offset"]};function $Q(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function GQ(t){return t===lo(t)||!Lo(t)?yS(t):$Q(t)}function WQ(t){var e=t.getBoundingClientRect(),n=zd(e.width)/t.offsetWidth||1,r=zd(e.height)/t.offsetHeight||1;return n!==1||r!==1}function HQ(t,e,n){n===void 0&&(n=!1);var r=Lo(e),i=Lo(e)&&WQ(e),o=Ac(e),h=Dd(t,i,n),l={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(r||!r&&!n)&&((Fa(e)!=="body"||vS(o))&&(l=GQ(e)),Lo(e)?(m=Dd(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):o&&(m.x=_S(o))),{x:h.left+l.scrollLeft-m.x,y:h.top+l.scrollTop-m.y,width:h.width,height:h.height}}function qQ(t){var e=new Map,n=new Set,r=[];t.forEach(function(o){e.set(o.name,o)});function i(o){n.add(o.name);var h=[].concat(o.requires||[],o.requiresIfExists||[]);h.forEach(function(l){if(!n.has(l)){var m=e.get(l);m&&i(m)}}),r.push(o)}return t.forEach(function(o){n.has(o.name)||i(o)}),r}function ZQ(t){var e=qQ(t);return sQ.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function XQ(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function YQ(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var bM={placement:"bottom",modifiers:[],strategy:"absolute"};function wM(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function KQ(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,o=i===void 0?bM:i;return function(l,m,_){_===void 0&&(_=o);var E={placement:"bottom",orderedModifiers:[],options:Object.assign({},bM,o),modifiersData:{},elements:{reference:l,popper:m},attributes:{},styles:{}},T=[],A=!1,L={state:E,setOptions:function(z){var N=typeof z=="function"?z(E.options):z;D(),E.options=Object.assign({},o,E.options,N),E.scrollParents={reference:Au(l)?jp(l):l.contextElement?jp(l.contextElement):[],popper:jp(m)};var F=ZQ(YQ([].concat(r,E.options.modifiers)));return E.orderedModifiers=F.filter(function($){return $.enabled}),R(),L.update()},forceUpdate:function(){if(!A){var z=E.elements,N=z.reference,F=z.popper;if(wM(N,F)){E.rects={reference:HQ(N,Km(F),E.options.strategy==="fixed"),popper:mS(F)},E.reset=!1,E.placement=E.options.placement,E.orderedModifiers.forEach(function(fe){return E.modifiersData[fe.name]=Object.assign({},fe.data)});for(var $=0;$<E.orderedModifiers.length;$++){if(E.reset===!0){E.reset=!1,$=-1;continue}var K=E.orderedModifiers[$],ne=K.fn,re=K.options,be=re===void 0?{}:re,xe=K.name;typeof ne=="function"&&(E=ne({state:E,options:be,name:xe,instance:L})||E)}}}},update:XQ(function(){return new Promise(function(W){L.forceUpdate(),W(E)})}),destroy:function(){D(),A=!0}};if(!wM(l,m))return L;L.setOptions(_).then(function(W){!A&&_.onFirstUpdate&&_.onFirstUpdate(W)});function R(){E.orderedModifiers.forEach(function(W){var z=W.name,N=W.options,F=N===void 0?{}:N,$=W.effect;if(typeof $=="function"){var K=$({state:E,name:z,instance:L,options:F}),ne=function(){};T.push(K||ne)}})}function D(){T.forEach(function(W){return W()}),T=[]}return L}}var JQ=[bQ,BQ,vQ,lQ,FQ,LQ,jQ,mQ,OQ],QQ=KQ({defaultModifiers:JQ});function eee(t){return typeof t=="function"?t():t}const wz=q.forwardRef(function(e,n){const{children:r,container:i,disablePortal:o=!1}=e,[h,l]=q.useState(null),m=Yr(q.isValidElement(r)?r.ref:null,n);if(ca(()=>{o||l(eee(i)||document.body)},[i,o]),ca(()=>{if(h&&!o)return $w(n,h),()=>{$w(n,null)}},[n,h,o]),o){if(q.isValidElement(r)){const _={ref:m};return q.cloneElement(r,_)}return Q.jsx(q.Fragment,{children:r})}return Q.jsx(q.Fragment,{children:h&&jd.createPortal(r,h)})});function tee(t){return Nn("MuiPopper",t)}kn("MuiPopper",["root"]);const nee=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],ree=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function iee(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function tE(t){return typeof t=="function"?t():t}function see(t){return t.nodeType!==void 0}const oee=()=>Un({root:["root"]},zJ(tee)),aee={},lee=q.forwardRef(function(e,n){var r;const{anchorEl:i,children:o,direction:h,disablePortal:l,modifiers:m,open:_,placement:E,popperOptions:T,popperRef:A,slotProps:L={},slots:R={},TransitionProps:D}=e,W=Yt(e,nee),z=q.useRef(null),N=Yr(z,n),F=q.useRef(null),$=Yr(F,A),K=q.useRef($);ca(()=>{K.current=$},[$]),q.useImperativeHandle(A,()=>F.current,[]);const ne=iee(E,h),[re,be]=q.useState(ne),[xe,fe]=q.useState(tE(i));q.useEffect(()=>{F.current&&F.current.forceUpdate()}),q.useEffect(()=>{i&&fe(tE(i))},[i]),ca(()=>{if(!xe||!_)return;const Ye=ke=>{be(ke.placement)};let je=[{name:"preventOverflow",options:{altBoundary:l}},{name:"flip",options:{altBoundary:l}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:ke})=>{Ye(ke)}}];m!=null&&(je=je.concat(m)),T&&T.modifiers!=null&&(je=je.concat(T.modifiers));const tt=QQ(xe,z.current,ie({placement:ne},T,{modifiers:je}));return K.current(tt),()=>{tt.destroy(),K.current(null)}},[xe,l,m,_,T,ne]);const Re={placement:re};D!==null&&(Re.TransitionProps=D);const Ve=oee(),Fe=(r=R.root)!=null?r:"div",ze=is({elementType:Fe,externalSlotProps:L.root,externalForwardedProps:W,additionalProps:{role:"tooltip",ref:N},ownerState:e,className:Ve.root});return Q.jsx(Fe,ie({},ze,{children:typeof o=="function"?o(Re):o}))}),cee=q.forwardRef(function(e,n){const{anchorEl:r,children:i,container:o,direction:h="ltr",disablePortal:l=!1,keepMounted:m=!1,modifiers:_,open:E,placement:T="bottom",popperOptions:A=aee,popperRef:L,style:R,transition:D=!1,slotProps:W={},slots:z={}}=e,N=Yt(e,ree),[F,$]=q.useState(!0),K=()=>{$(!1)},ne=()=>{$(!0)};if(!m&&!E&&(!D||F))return null;let re;if(o)re=o;else if(r){const fe=tE(r);re=fe&&see(fe)?Xr(fe).body:Xr(null).body}const be=!E&&m&&(!D||F)?"none":void 0,xe=D?{in:E,onEnter:K,onExited:ne}:void 0;return Q.jsx(wz,{disablePortal:l,container:re,children:Q.jsx(lee,ie({anchorEl:r,direction:h,disablePortal:l,modifiers:_,ref:n,open:D?!F:E,placement:T,popperOptions:A,popperRef:L,slotProps:W,slots:z},N,{style:ie({position:"fixed",top:0,left:0,display:be},R),TransitionProps:xe,children:i}))})});function uee(t){const e=Xr(t);return e.body===t?gl(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function $p(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function EM(t){return parseInt(gl(t).getComputedStyle(t).paddingRight,10)||0}function hee(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,r=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||r}function TM(t,e,n,r,i){const o=[e,n,...r];[].forEach.call(t.children,h=>{const l=o.indexOf(h)===-1,m=!hee(h);l&&m&&$p(h,i)})}function J1(t,e){let n=-1;return t.some((r,i)=>e(r)?(n=i,!0):!1),n}function dee(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(uee(r)){const h=zO(Xr(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${EM(r)+h}px`;const l=Xr(r).querySelectorAll(".mui-fixed");[].forEach.call(l,m=>{n.push({value:m.style.paddingRight,property:"padding-right",el:m}),m.style.paddingRight=`${EM(m)+h}px`})}let o;if(r.parentNode instanceof DocumentFragment)o=Xr(r).body;else{const h=r.parentElement,l=gl(r);o=(h==null?void 0:h.nodeName)==="HTML"&&l.getComputedStyle(h).overflowY==="scroll"?h:r}n.push({value:o.style.overflow,property:"overflow",el:o},{value:o.style.overflowX,property:"overflow-x",el:o},{value:o.style.overflowY,property:"overflow-y",el:o}),o.style.overflow="hidden"}return()=>{n.forEach(({value:o,el:h,property:l})=>{o?h.style.setProperty(l,o):h.style.removeProperty(l)})}}function fee(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class pee{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&$p(e.modalRef,!1);const i=fee(n);TM(n,e.mount,e.modalRef,i,!0);const o=J1(this.containers,h=>h.container===n);return o!==-1?(this.containers[o].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:i}),r)}mount(e,n){const r=J1(this.containers,o=>o.modals.indexOf(e)!==-1),i=this.containers[r];i.restore||(i.restore=dee(i,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const i=J1(this.containers,h=>h.modals.indexOf(e)!==-1),o=this.containers[i];if(o.modals.splice(o.modals.indexOf(e),1),this.modals.splice(r,1),o.modals.length===0)o.restore&&o.restore(),e.modalRef&&$p(e.modalRef,n),TM(o.container,e.mount,e.modalRef,o.hiddenSiblings,!1),this.containers.splice(i,1);else{const h=o.modals[o.modals.length-1];h.modalRef&&$p(h.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function mee(t){return typeof t=="function"?t():t}function gee(t){return t?t.props.hasOwnProperty("in"):!1}const yee=new pee;function _ee(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:i=yee,closeAfterTransition:o=!1,onTransitionEnter:h,onTransitionExited:l,children:m,onClose:_,open:E,rootRef:T}=t,A=q.useRef({}),L=q.useRef(null),R=q.useRef(null),D=Yr(R,T),[W,z]=q.useState(!E),N=gee(m);let F=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(F=!1);const $=()=>Xr(L.current),K=()=>(A.current.modalRef=R.current,A.current.mount=L.current,A.current),ne=()=>{i.mount(K(),{disableScrollLock:r}),R.current&&(R.current.scrollTop=0)},re=ro(()=>{const je=mee(e)||$().body;i.add(K(),je),R.current&&ne()}),be=q.useCallback(()=>i.isTopModal(K()),[i]),xe=ro(je=>{L.current=je,je&&(E&&be()?ne():R.current&&$p(R.current,F))}),fe=q.useCallback(()=>{i.remove(K(),F)},[F,i]);q.useEffect(()=>()=>{fe()},[fe]),q.useEffect(()=>{E?re():(!N||!o)&&fe()},[E,fe,N,o,re]);const Re=je=>tt=>{var ke;(ke=je.onKeyDown)==null||ke.call(je,tt),!(tt.key!=="Escape"||!be())&&(n||(tt.stopPropagation(),_&&_(tt,"escapeKeyDown")))},Ve=je=>tt=>{var ke;(ke=je.onClick)==null||ke.call(je,tt),tt.target===tt.currentTarget&&_&&_(tt,"backdropClick")};return{getRootProps:(je={})=>{const tt=gu(t);delete tt.onTransitionEnter,delete tt.onTransitionExited;const ke=ie({},tt,je);return ie({role:"presentation"},ke,{onKeyDown:Re(ke),ref:D})},getBackdropProps:(je={})=>{const tt=je;return ie({"aria-hidden":!0},tt,{onClick:Ve(tt),open:E})},getTransitionProps:()=>{const je=()=>{z(!1),h&&h()},tt=()=>{z(!0),l&&l(),o&&fe()};return{onEnter:kI(je,m==null?void 0:m.props.onEnter),onExited:kI(tt,m==null?void 0:m.props.onExited)}},rootRef:D,portalRef:xe,isTopModal:be,exited:W,hasTransition:N}}const vee=2;function Ez(t,e){return t-e}function hp(t,e,n){return t==null?e:Math.min(Math.max(e,t),n)}function SM(t,e){var n;const{index:r}=(n=t.reduce((i,o,h)=>{const l=Math.abs(e-o);return i===null||l<i.distance||l===i.distance?{distance:l,index:h}:i},null))!=null?n:{};return r}function Fy(t,e){if(e.current!==void 0&&t.changedTouches){const n=t;for(let r=0;r<n.changedTouches.length;r+=1){const i=n.changedTouches[r];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function p_(t,e,n){return(t-e)*100/(n-e)}function xee(t,e,n){return(n-e)*t+e}function bee(t){if(Math.abs(t)<1){const n=t.toExponential().split("e-"),r=n[0].split(".")[1];return(r?r.length:0)+parseInt(n[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function wee(t,e,n){const r=Math.round((t-n)/e)*e+n;return Number(r.toFixed(bee(e)))}function PM({values:t,newValue:e,index:n}){const r=t.slice();return r[n]=e,r.sort(Ez)}function Ny({sliderRef:t,activeIndex:e,setActive:n}){var r,i;const o=Xr(t.current);if(!((r=t.current)!=null&&r.contains(o.activeElement))||Number(o==null||(i=o.activeElement)==null?void 0:i.getAttribute("data-index"))!==e){var h;(h=t.current)==null||h.querySelector(`[type="range"][data-index="${e}"]`).focus()}n&&n(e)}function By(t,e){return typeof t=="number"&&typeof e=="number"?t===e:typeof t=="object"&&typeof e=="object"?LJ(t,e):!1}const Eee={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},Tee=t=>t;let Uy;function Q1(){return Uy===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?Uy=CSS.supports("touch-action","none"):Uy=!0),Uy}function See(t){const{"aria-labelledby":e,defaultValue:n,disabled:r=!1,disableSwap:i=!1,isRtl:o=!1,marks:h=!1,max:l=100,min:m=0,name:_,onChange:E,onChangeCommitted:T,orientation:A="horizontal",rootRef:L,scale:R=Tee,step:D=1,tabIndex:W,value:z}=t,N=q.useRef(),[F,$]=q.useState(-1),[K,ne]=q.useState(-1),[re,be]=q.useState(!1),xe=q.useRef(0),[fe,Re]=a_({controlled:z,default:n??m,name:"Slider"}),Ve=E&&((Qe,gt,Mt)=>{const Rt=Qe.nativeEvent||Qe,Pt=new Rt.constructor(Rt.type,Rt);Object.defineProperty(Pt,"target",{writable:!0,value:{value:gt,name:_}}),E(Pt,gt,Mt)}),Fe=Array.isArray(fe);let ze=Fe?fe.slice().sort(Ez):[fe];ze=ze.map(Qe=>hp(Qe,m,l));const Ye=h===!0&&D!==null?[...Array(Math.floor((l-m)/D)+1)].map((Qe,gt)=>({value:m+D*gt})):h||[],je=Ye.map(Qe=>Qe.value),{isFocusVisibleRef:tt,onBlur:ke,onFocus:Ge,ref:nt}=VT(),[Dt,ht]=q.useState(-1),ot=q.useRef(),ct=Yr(nt,ot),xt=Yr(L,ct),bt=Qe=>gt=>{var Mt;const Rt=Number(gt.currentTarget.getAttribute("data-index"));Ge(gt),tt.current===!0&&ht(Rt),ne(Rt),Qe==null||(Mt=Qe.onFocus)==null||Mt.call(Qe,gt)},Jt=Qe=>gt=>{var Mt;ke(gt),tt.current===!1&&ht(-1),ne(-1),Qe==null||(Mt=Qe.onBlur)==null||Mt.call(Qe,gt)};ca(()=>{if(r&&ot.current.contains(document.activeElement)){var Qe;(Qe=document.activeElement)==null||Qe.blur()}},[r]),r&&F!==-1&&$(-1),r&&Dt!==-1&&ht(-1);const Je=Qe=>gt=>{var Mt;(Mt=Qe.onChange)==null||Mt.call(Qe,gt);const Rt=Number(gt.currentTarget.getAttribute("data-index")),Pt=ze[Rt],gn=je.indexOf(Pt);let mn=gt.target.valueAsNumber;if(Ye&&D==null){const He=je[je.length-1];mn>He?mn=He:mn<je[0]?mn=je[0]:mn=mn<Pt?je[gn-1]:je[gn+1]}if(mn=hp(mn,m,l),Fe){i&&(mn=hp(mn,ze[Rt-1]||-1/0,ze[Rt+1]||1/0));const He=mn;mn=PM({values:ze,newValue:mn,index:Rt});let mt=Rt;i||(mt=mn.indexOf(He)),Ny({sliderRef:ot,activeIndex:mt})}Re(mn),ht(Rt),Ve&&!By(mn,fe)&&Ve(gt,mn,Rt),T&&T(gt,mn)},Et=q.useRef();let sn=A;o&&A==="horizontal"&&(sn+="-reverse");const Qt=({finger:Qe,move:gt=!1})=>{const{current:Mt}=ot,{width:Rt,height:Pt,bottom:gn,left:mn}=Mt.getBoundingClientRect();let He;sn.indexOf("vertical")===0?He=(gn-Qe.y)/Pt:He=(Qe.x-mn)/Rt,sn.indexOf("-reverse")!==-1&&(He=1-He);let mt;if(mt=xee(He,m,l),D)mt=wee(mt,D,m);else{const Ln=SM(je,mt);mt=je[Ln]}mt=hp(mt,m,l);let Zt=0;if(Fe){gt?Zt=Et.current:Zt=SM(ze,mt),i&&(mt=hp(mt,ze[Zt-1]||-1/0,ze[Zt+1]||1/0));const Ln=mt;mt=PM({values:ze,newValue:mt,index:Zt}),i&&gt||(Zt=mt.indexOf(Ln),Et.current=Zt)}return{newValue:mt,activeIndex:Zt}},hn=ro(Qe=>{const gt=Fy(Qe,N);if(!gt)return;if(xe.current+=1,Qe.type==="mousemove"&&Qe.buttons===0){$t(Qe);return}const{newValue:Mt,activeIndex:Rt}=Qt({finger:gt,move:!0});Ny({sliderRef:ot,activeIndex:Rt,setActive:$}),Re(Mt),!re&&xe.current>vee&&be(!0),Ve&&!By(Mt,fe)&&Ve(Qe,Mt,Rt)}),$t=ro(Qe=>{const gt=Fy(Qe,N);if(be(!1),!gt)return;const{newValue:Mt}=Qt({finger:gt,move:!0});$(-1),Qe.type==="touchend"&&ne(-1),T&&T(Qe,Mt),N.current=void 0,Ft()}),Lt=ro(Qe=>{if(r)return;Q1()||Qe.preventDefault();const gt=Qe.changedTouches[0];gt!=null&&(N.current=gt.identifier);const Mt=Fy(Qe,N);if(Mt!==!1){const{newValue:Pt,activeIndex:gn}=Qt({finger:Mt});Ny({sliderRef:ot,activeIndex:gn,setActive:$}),Re(Pt),Ve&&!By(Pt,fe)&&Ve(Qe,Pt,gn)}xe.current=0;const Rt=Xr(ot.current);Rt.addEventListener("touchmove",hn),Rt.addEventListener("touchend",$t)}),Ft=q.useCallback(()=>{const Qe=Xr(ot.current);Qe.removeEventListener("mousemove",hn),Qe.removeEventListener("mouseup",$t),Qe.removeEventListener("touchmove",hn),Qe.removeEventListener("touchend",$t)},[$t,hn]);q.useEffect(()=>{const{current:Qe}=ot;return Qe.addEventListener("touchstart",Lt,{passive:Q1()}),()=>{Qe.removeEventListener("touchstart",Lt,{passive:Q1()}),Ft()}},[Ft,Lt]),q.useEffect(()=>{r&&Ft()},[r,Ft]);const wn=Qe=>gt=>{var Mt;if((Mt=Qe.onMouseDown)==null||Mt.call(Qe,gt),r||gt.defaultPrevented||gt.button!==0)return;gt.preventDefault();const Rt=Fy(gt,N);if(Rt!==!1){const{newValue:gn,activeIndex:mn}=Qt({finger:Rt});Ny({sliderRef:ot,activeIndex:mn,setActive:$}),Re(gn),Ve&&!By(gn,fe)&&Ve(gt,gn,mn)}xe.current=0;const Pt=Xr(ot.current);Pt.addEventListener("mousemove",hn),Pt.addEventListener("mouseup",$t)},vn=p_(Fe?ze[0]:m,m,l),pt=p_(ze[ze.length-1],m,l)-vn,dn=(Qe={})=>{const gt=gu(Qe),Mt={onMouseDown:wn(gt||{})},Rt=ie({},gt,Mt);return ie({},Qe,{ref:xt},Rt)},Ae=Qe=>gt=>{var Mt;(Mt=Qe.onMouseOver)==null||Mt.call(Qe,gt);const Rt=Number(gt.currentTarget.getAttribute("data-index"));ne(Rt)},Ct=Qe=>gt=>{var Mt;(Mt=Qe.onMouseLeave)==null||Mt.call(Qe,gt),ne(-1)};return{active:F,axis:sn,axisProps:Eee,dragging:re,focusedThumbIndex:Dt,getHiddenInputProps:(Qe={})=>{var gt;const Mt=gu(Qe),Rt={onChange:Je(Mt||{}),onFocus:bt(Mt||{}),onBlur:Jt(Mt||{})},Pt=ie({},Mt,Rt);return ie({tabIndex:W,"aria-labelledby":e,"aria-orientation":A,"aria-valuemax":R(l),"aria-valuemin":R(m),name:_,type:"range",min:t.min,max:t.max,step:t.step===null&&t.marks?"any":(gt=t.step)!=null?gt:void 0,disabled:r},Qe,Pt,{style:ie({},mZ,{direction:o?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:dn,getThumbProps:(Qe={})=>{const gt=gu(Qe),Mt={onMouseOver:Ae(gt||{}),onMouseLeave:Ct(gt||{})};return ie({},Qe,gt,Mt)},marks:Ye,open:K,range:Fe,rootRef:xt,trackLeap:pt,trackOffset:vn,values:ze,getThumbStyle:Qe=>({pointerEvents:F!==-1&&F!==Qe?"none":void 0})}}function Pee(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:n=!1,onClose:r,open:i,resumeHideDuration:o}=t,h=q.useRef();q.useEffect(()=>{if(!i)return;function z(N){N.defaultPrevented||(N.key==="Escape"||N.key==="Esc")&&(r==null||r(N,"escapeKeyDown"))}return document.addEventListener("keydown",z),()=>{document.removeEventListener("keydown",z)}},[i,r]);const l=ro((z,N)=>{r==null||r(z,N)}),m=ro(z=>{!r||z==null||(clearTimeout(h.current),h.current=setTimeout(()=>{l(null,"timeout")},z))});q.useEffect(()=>(i&&m(e),()=>{clearTimeout(h.current)}),[i,e,m]);const _=z=>{r==null||r(z,"clickaway")},E=()=>{clearTimeout(h.current)},T=q.useCallback(()=>{e!=null&&m(o??e*.5)},[e,o,m]),A=z=>N=>{const F=z.onBlur;F==null||F(N),T()},L=z=>N=>{const F=z.onFocus;F==null||F(N),E()},R=z=>N=>{const F=z.onMouseEnter;F==null||F(N),E()},D=z=>N=>{const F=z.onMouseLeave;F==null||F(N),T()};return q.useEffect(()=>{if(!n&&i)return window.addEventListener("focus",T),window.addEventListener("blur",E),()=>{window.removeEventListener("focus",T),window.removeEventListener("blur",E)}},[n,T,i]),{getRootProps:(z={})=>{const N=ie({},gu(t),gu(z));return ie({role:"presentation"},z,N,{onBlur:A(N),onFocus:L(N),onMouseEnter:R(N),onMouseLeave:D(N)})},onClickAway:_}}const Cee=["onChange","maxRows","minRows","style","value"];function Vy(t){return parseInt(t,10)||0}const Aee={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function CM(t){return t==null||Object.keys(t).length===0||t.outerHeightStyle===0&&!t.overflow}const Iee=q.forwardRef(function(e,n){const{onChange:r,maxRows:i,minRows:o=1,style:h,value:l}=e,m=Yt(e,Cee),{current:_}=q.useRef(l!=null),E=q.useRef(null),T=Yr(n,E),A=q.useRef(null),L=q.useRef(0),[R,D]=q.useState({outerHeightStyle:0}),W=q.useCallback(()=>{const $=E.current,ne=gl($).getComputedStyle($);if(ne.width==="0px")return{outerHeightStyle:0};const re=A.current;re.style.width=ne.width,re.value=$.value||e.placeholder||"x",re.value.slice(-1)===`
`&&(re.value+=" ");const be=ne.boxSizing,xe=Vy(ne.paddingBottom)+Vy(ne.paddingTop),fe=Vy(ne.borderBottomWidth)+Vy(ne.borderTopWidth),Re=re.scrollHeight;re.value="x";const Ve=re.scrollHeight;let Fe=Re;o&&(Fe=Math.max(Number(o)*Ve,Fe)),i&&(Fe=Math.min(Number(i)*Ve,Fe)),Fe=Math.max(Fe,Ve);const ze=Fe+(be==="border-box"?xe+fe:0),Ye=Math.abs(Fe-Re)<=1;return{outerHeightStyle:ze,overflow:Ye}},[i,o,e.placeholder]),z=($,K)=>{const{outerHeightStyle:ne,overflow:re}=K;return L.current<20&&(ne>0&&Math.abs(($.outerHeightStyle||0)-ne)>1||$.overflow!==re)?(L.current+=1,{overflow:re,outerHeightStyle:ne}):$},N=q.useCallback(()=>{const $=W();CM($)||D(K=>z(K,$))},[W]);ca(()=>{const $=()=>{const Re=W();CM(Re)||jd.flushSync(()=>{D(Ve=>z(Ve,Re))})},K=()=>{L.current=0,$()};let ne;const re=BT(K),be=E.current,xe=gl(be);xe.addEventListener("resize",re);let fe;return typeof ResizeObserver<"u"&&(fe=new ResizeObserver(K),fe.observe(be)),()=>{re.clear(),cancelAnimationFrame(ne),xe.removeEventListener("resize",re),fe&&fe.disconnect()}},[W]),ca(()=>{N()}),q.useEffect(()=>{L.current=0},[l]);const F=$=>{L.current=0,_||N(),r&&r($)};return Q.jsxs(q.Fragment,{children:[Q.jsx("textarea",ie({value:l,onChange:F,ref:T,rows:o,style:ie({height:R.outerHeightStyle,overflow:R.overflow?"hidden":void 0},h)},m)),Q.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:A,tabIndex:-1,style:ie({},Aee.shadow,h,{paddingTop:0,paddingBottom:0})})]})}),Mee=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],kee=vt(cee,{name:"MuiPopper",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Lee=q.forwardRef(function(e,n){var r;const i=nS(),o=Bn({props:e,name:"MuiPopper"}),{anchorEl:h,component:l,components:m,componentsProps:_,container:E,disablePortal:T,keepMounted:A,modifiers:L,open:R,placement:D,popperOptions:W,popperRef:z,transition:N,slots:F,slotProps:$}=o,K=Yt(o,Mee),ne=(r=F==null?void 0:F.root)!=null?r:m==null?void 0:m.Root,re=ie({anchorEl:h,container:E,disablePortal:T,keepMounted:A,modifiers:L,open:R,placement:D,popperOptions:W,popperRef:z,transition:N},K);return Q.jsx(kee,ie({as:l,direction:i==null?void 0:i.direction,slots:{root:ne},slotProps:$??_},re,{ref:n}))}),Tz=Lee;function Wd({props:t,states:e,muiFormControl:n}){return e.reduce((r,i)=>(r[i]=t[i],n&&typeof t[i]>"u"&&(r[i]=n[i]),r),{})}const Ree=q.createContext(void 0),Mv=Ree;function Du(){return q.useContext(Mv)}function Sz(t){return Q.jsx(yY,ie({},t,{defaultTheme:gv,themeId:Pu}))}function AM(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function m_(t,e=!1){return t&&(AM(t.value)&&t.value!==""||e&&AM(t.defaultValue)&&t.defaultValue!=="")}function Oee(t){return t.startAdornment}function zee(t){return Nn("MuiInputBase",t)}const Dee=kn("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),Nd=Dee,Fee=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],kv=(t,e)=>{const{ownerState:n}=t;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,n.size==="small"&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e[`color${qt(n.color)}`],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},Lv=(t,e)=>{const{ownerState:n}=t;return[e.input,n.size==="small"&&e.inputSizeSmall,n.multiline&&e.inputMultiline,n.type==="search"&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},Nee=t=>{const{classes:e,color:n,disabled:r,error:i,endAdornment:o,focused:h,formControl:l,fullWidth:m,hiddenLabel:_,multiline:E,readOnly:T,size:A,startAdornment:L,type:R}=t,D={root:["root",`color${qt(n)}`,r&&"disabled",i&&"error",m&&"fullWidth",h&&"focused",l&&"formControl",A&&A!=="medium"&&`size${qt(A)}`,E&&"multiline",L&&"adornedStart",o&&"adornedEnd",_&&"hiddenLabel",T&&"readOnly"],input:["input",r&&"disabled",R==="search"&&"inputTypeSearch",E&&"inputMultiline",A==="small"&&"inputSizeSmall",_&&"inputHiddenLabel",L&&"inputAdornedStart",o&&"inputAdornedEnd",T&&"readOnly"]};return Un(D,zee,e)},Rv=vt("div",{name:"MuiInputBase",slot:"Root",overridesResolver:kv})(({theme:t,ownerState:e})=>ie({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Nd.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},e.multiline&&ie({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),Ov=vt("input",{name:"MuiInputBase",slot:"Input",overridesResolver:Lv})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light",r=ie({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),i={opacity:"0 !important"},o=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5};return ie({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Nd.formControl} &`]:{"&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&:-ms-input-placeholder":i,"&::-ms-input-placeholder":i,"&:focus::-webkit-input-placeholder":o,"&:focus::-moz-placeholder":o,"&:focus:-ms-input-placeholder":o,"&:focus::-ms-input-placeholder":o},[`&.${Nd.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),Bee=Q.jsx(Sz,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),Uee=q.forwardRef(function(e,n){var r;const i=Bn({props:e,name:"MuiInputBase"}),{"aria-describedby":o,autoComplete:h,autoFocus:l,className:m,components:_={},componentsProps:E={},defaultValue:T,disabled:A,disableInjectingGlobalStyles:L,endAdornment:R,fullWidth:D=!1,id:W,inputComponent:z="input",inputProps:N={},inputRef:F,maxRows:$,minRows:K,multiline:ne=!1,name:re,onBlur:be,onChange:xe,onClick:fe,onFocus:Re,onKeyDown:Ve,onKeyUp:Fe,placeholder:ze,readOnly:Ye,renderSuffix:je,rows:tt,slotProps:ke={},slots:Ge={},startAdornment:nt,type:Dt="text",value:ht}=i,ot=Yt(i,Fee),ct=N.value!=null?N.value:ht,{current:xt}=q.useRef(ct!=null),bt=q.useRef(),Jt=q.useCallback(Rt=>{},[]),Je=Yr(bt,F,N.ref,Jt),[Et,sn]=q.useState(!1),Qt=Du(),hn=Wd({props:i,muiFormControl:Qt,states:["color","disabled","error","hiddenLabel","size","required","filled"]});hn.focused=Qt?Qt.focused:Et,q.useEffect(()=>{!Qt&&A&&Et&&(sn(!1),be&&be())},[Qt,A,Et,be]);const $t=Qt&&Qt.onFilled,Lt=Qt&&Qt.onEmpty,Ft=q.useCallback(Rt=>{m_(Rt)?$t&&$t():Lt&&Lt()},[$t,Lt]);ca(()=>{xt&&Ft({value:ct})},[ct,Ft,xt]);const wn=Rt=>{if(hn.disabled){Rt.stopPropagation();return}Re&&Re(Rt),N.onFocus&&N.onFocus(Rt),Qt&&Qt.onFocus?Qt.onFocus(Rt):sn(!0)},vn=Rt=>{be&&be(Rt),N.onBlur&&N.onBlur(Rt),Qt&&Qt.onBlur?Qt.onBlur(Rt):sn(!1)},pt=(Rt,...Pt)=>{if(!xt){const gn=Rt.target||bt.current;if(gn==null)throw new Error(Ec(1));Ft({value:gn.value})}N.onChange&&N.onChange(Rt,...Pt),xe&&xe(Rt,...Pt)};q.useEffect(()=>{Ft(bt.current)},[]);const dn=Rt=>{bt.current&&Rt.currentTarget===Rt.target&&bt.current.focus(),fe&&fe(Rt)};let Ae=z,Ct=N;ne&&Ae==="input"&&(tt?Ct=ie({type:void 0,minRows:tt,maxRows:tt},Ct):Ct=ie({type:void 0,maxRows:$,minRows:K},Ct),Ae=Iee);const En=Rt=>{Ft(Rt.animationName==="mui-auto-fill-cancel"?bt.current:{value:"x"})};q.useEffect(()=>{Qt&&Qt.setAdornedStart(!!nt)},[Qt,nt]);const en=ie({},i,{color:hn.color||"primary",disabled:hn.disabled,endAdornment:R,error:hn.error,focused:hn.focused,formControl:Qt,fullWidth:D,hiddenLabel:hn.hiddenLabel,multiline:ne,size:hn.size,startAdornment:nt,type:Dt}),It=Nee(en),Qe=Ge.root||_.Root||Rv,gt=ke.root||E.root||{},Mt=Ge.input||_.Input||Ov;return Ct=ie({},Ct,(r=ke.input)!=null?r:E.input),Q.jsxs(q.Fragment,{children:[!L&&Bee,Q.jsxs(Qe,ie({},gt,!vc(Qe)&&{ownerState:ie({},en,gt.ownerState)},{ref:n,onClick:dn},ot,{className:rn(It.root,gt.className,m,Ye&&"MuiInputBase-readOnly"),children:[nt,Q.jsx(Mv.Provider,{value:null,children:Q.jsx(Mt,ie({ownerState:en,"aria-invalid":hn.error,"aria-describedby":o,autoComplete:h,autoFocus:l,defaultValue:T,disabled:hn.disabled,id:W,onAnimationStart:En,name:re,placeholder:ze,readOnly:Ye,required:hn.required,rows:tt,value:ct,onKeyDown:Ve,onKeyUp:Fe,type:Dt},Ct,!vc(Mt)&&{as:Ae,ownerState:ie({},en,Ct.ownerState)},{ref:Je,className:rn(It.input,Ct.className,Ye&&"MuiInputBase-readOnly"),onBlur:vn,onChange:pt,onFocus:wn}))}),R,je?je(ie({},hn,{startAdornment:nt})):null]}))]})}),xS=Uee;function Vee(t){return Nn("MuiInput",t)}const jee=ie({},Nd,kn("MuiInput",["root","underline","input"])),dp=jee;function $ee(t){return Nn("MuiOutlinedInput",t)}const Gee=ie({},Nd,kn("MuiOutlinedInput",["root","notchedOutline","input"])),Zl=Gee;function Wee(t){return Nn("MuiFilledInput",t)}const Hee=ie({},Nd,kn("MuiFilledInput",["root","underline","input"])),eu=Hee,qee=fo(Q.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Zee=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],Xee={entering:{opacity:1},entered:{opacity:1}},Yee=q.forwardRef(function(e,n){const r=Cc(),i={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:o,appear:h=!0,children:l,easing:m,in:_,onEnter:E,onEntered:T,onEntering:A,onExit:L,onExited:R,onExiting:D,style:W,timeout:z=i,TransitionComponent:N=lS}=e,F=Yt(e,Zee),$=q.useRef(null),K=Yr($,l.ref,n),ne=ze=>Ye=>{if(ze){const je=$.current;Ye===void 0?ze(je):ze(je,Ye)}},re=ne(A),be=ne((ze,Ye)=>{hS(ze);const je=Rd({style:W,timeout:z,easing:m},{mode:"enter"});ze.style.webkitTransition=r.transitions.create("opacity",je),ze.style.transition=r.transitions.create("opacity",je),E&&E(ze,Ye)}),xe=ne(T),fe=ne(D),Re=ne(ze=>{const Ye=Rd({style:W,timeout:z,easing:m},{mode:"exit"});ze.style.webkitTransition=r.transitions.create("opacity",Ye),ze.style.transition=r.transitions.create("opacity",Ye),L&&L(ze)}),Ve=ne(R),Fe=ze=>{o&&o($.current,ze)};return Q.jsx(N,ie({appear:h,in:_,nodeRef:$,onEnter:be,onEntered:xe,onEntering:re,onExit:Re,onExited:Ve,onExiting:fe,addEndListener:Fe,timeout:z},F,{children:(ze,Ye)=>q.cloneElement(l,ie({style:ie({opacity:0,visibility:ze==="exited"&&!_?"hidden":void 0},Xee[ze],W,l.props.style),ref:K},Ye))}))}),Pz=Yee;function Kee(t){return Nn("MuiBackdrop",t)}kn("MuiBackdrop",["root","invisible"]);const Jee=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Qee=t=>{const{classes:e,invisible:n}=t;return Un({root:["root",n&&"invisible"]},Kee,e)},ete=vt("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})(({ownerState:t})=>ie({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})),tte=q.forwardRef(function(e,n){var r,i,o;const h=Bn({props:e,name:"MuiBackdrop"}),{children:l,className:m,component:_="div",components:E={},componentsProps:T={},invisible:A=!1,open:L,slotProps:R={},slots:D={},TransitionComponent:W=Pz,transitionDuration:z}=h,N=Yt(h,Jee),F=ie({},h,{component:_,invisible:A}),$=Qee(F),K=(r=R.root)!=null?r:T.root;return Q.jsx(W,ie({in:L,timeout:z},N,{children:Q.jsx(ete,ie({"aria-hidden":!0},K,{as:(i=(o=D.root)!=null?o:E.Root)!=null?i:_,className:rn($.root,m,K==null?void 0:K.className),ownerState:ie({},F,K==null?void 0:K.ownerState),classes:$,ref:n,children:l}))}))}),Cz=tte,nte=iS(),rte=bY({themeId:Pu,defaultTheme:nte,defaultClassName:"MuiBox-root",generateClassName:DO.generate}),eb=rte;function ite(t){return Nn("MuiButton",t)}const ste=kn("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),jy=ste,ote=q.createContext({}),ate=ote,lte=q.createContext(void 0),cte=lte,ute=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],hte=t=>{const{color:e,disableElevation:n,fullWidth:r,size:i,variant:o,classes:h}=t,l={root:["root",o,`${o}${qt(e)}`,`size${qt(i)}`,`${o}Size${qt(i)}`,e==="inherit"&&"colorInherit",n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${qt(i)}`],endIcon:["endIcon",`iconSize${qt(i)}`]},m=Un(l,ite,h);return ie({},h,m)},Az=t=>ie({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),dte=vt(dS,{shouldForwardProp:t=>ua(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${qt(n.color)}`],e[`size${qt(n.size)}`],e[`${n.variant}Size${qt(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})(({theme:t,ownerState:e})=>{var n,r;const i=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],o=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return ie({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":ie({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:Ai(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Ai(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[e.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Ai(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:o,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e.color].main}}),"&:active":ie({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${jy.focusVisible}`]:ie({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${jy.disabled}`]:ie({color:(t.vars||t).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${Ai(t.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(n=(r=t.palette).getContrastText)==null?void 0:n.call(r,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:i,boxShadow:(t.vars||t).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${jy.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${jy.disabled}`]:{boxShadow:"none"}}),fte=vt("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,e[`iconSize${qt(n.size)}`]]}})(({ownerState:t})=>ie({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},Az(t))),pte=vt("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,e[`iconSize${qt(n.size)}`]]}})(({ownerState:t})=>ie({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},Az(t))),mte=q.forwardRef(function(e,n){const r=q.useContext(ate),i=q.useContext(cte),o=jT(r,e),h=Bn({props:o,name:"MuiButton"}),{children:l,color:m="primary",component:_="button",className:E,disabled:T=!1,disableElevation:A=!1,disableFocusRipple:L=!1,endIcon:R,focusVisibleClassName:D,fullWidth:W=!1,size:z="medium",startIcon:N,type:F,variant:$="text"}=h,K=Yt(h,ute),ne=ie({},h,{color:m,component:_,disabled:T,disableElevation:A,disableFocusRipple:L,fullWidth:W,size:z,type:F,variant:$}),re=hte(ne),be=N&&Q.jsx(fte,{className:re.startIcon,ownerState:ne,children:N}),xe=R&&Q.jsx(pte,{className:re.endIcon,ownerState:ne,children:R}),fe=i||"";return Q.jsxs(dte,ie({ownerState:ne,className:rn(r.className,re.root,E,fe),component:_,disabled:T,focusRipple:!L,focusVisibleClassName:rn(re.focusVisible,D),ref:n,type:F},K,{classes:re,children:[be,l,xe]}))}),Yl=mte;function gte(t){return Nn("MuiCircularProgress",t)}kn("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const yte=["className","color","disableShrink","size","style","thickness","value","variant"];let zv=t=>t,IM,MM,kM,LM;const Xl=44,_te=qm(IM||(IM=zv`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),vte=qm(MM||(MM=zv`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),xte=t=>{const{classes:e,variant:n,color:r,disableShrink:i}=t,o={root:["root",n,`color${qt(r)}`],svg:["svg"],circle:["circle",`circle${qt(n)}`,i&&"circleDisableShrink"]};return Un(o,gte,e)},bte=vt("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`color${qt(n.color)}`]]}})(({ownerState:t,theme:e})=>ie({display:"inline-block"},t.variant==="determinate"&&{transition:e.transitions.create("transform")},t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main}),({ownerState:t})=>t.variant==="indeterminate"&&YT(kM||(kM=zv`
      animation: ${0} 1.4s linear infinite;
    `),_te)),wte=vt("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(t,e)=>e.svg})({display:"block"}),Ete=vt("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.circle,e[`circle${qt(n.variant)}`],n.disableShrink&&e.circleDisableShrink]}})(({ownerState:t,theme:e})=>ie({stroke:"currentColor"},t.variant==="determinate"&&{transition:e.transitions.create("stroke-dashoffset")},t.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink&&YT(LM||(LM=zv`
      animation: ${0} 1.4s ease-in-out infinite;
    `),vte)),Tte=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiCircularProgress"}),{className:i,color:o="primary",disableShrink:h=!1,size:l=40,style:m,thickness:_=3.6,value:E=0,variant:T="indeterminate"}=r,A=Yt(r,yte),L=ie({},r,{color:o,disableShrink:h,size:l,thickness:_,value:E,variant:T}),R=xte(L),D={},W={},z={};if(T==="determinate"){const N=2*Math.PI*((Xl-_)/2);D.strokeDasharray=N.toFixed(3),z["aria-valuenow"]=Math.round(E),D.strokeDashoffset=`${((100-E)/100*N).toFixed(3)}px`,W.transform="rotate(-90deg)"}return Q.jsx(bte,ie({className:rn(R.root,i),style:ie({width:l,height:l},W,m),ownerState:L,ref:n,role:"progressbar"},z,A,{children:Q.jsx(wte,{className:R.svg,ownerState:L,viewBox:`${Xl/2} ${Xl/2} ${Xl} ${Xl}`,children:Q.jsx(Ete,{className:R.circle,style:D,ownerState:L,cx:Xl,cy:Xl,r:(Xl-_)/2,fill:"none",strokeWidth:_})})}))}),Ste=Tte,Pte=(t,e)=>ie({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},e&&!t.vars&&{colorScheme:t.palette.mode}),Cte=t=>ie({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),Ate=(t,e=!1)=>{var n;const r={};e&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([h,l])=>{var m;r[t.getColorSchemeSelector(h).replace(/\s*&/,"")]={colorScheme:(m=l.palette)==null?void 0:m.mode}});let i=ie({html:Pte(t,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:ie({margin:0},Cte(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},r);const o=(n=t.components)==null||(n=n.MuiCssBaseline)==null?void 0:n.styleOverrides;return o&&(i=[i,o]),i};function Ite(t){const e=Bn({props:t,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=e;return Q.jsxs(q.Fragment,{children:[Q.jsx(Sz,{styles:i=>Ate(i,r)}),n]})}function Mte(t){return Nn("MuiModal",t)}kn("MuiModal",["root","hidden","backdrop"]);const kte=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],Lte=t=>{const{open:e,exited:n,classes:r}=t;return Un({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},Mte,r)},Rte=vt("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})(({theme:t,ownerState:e})=>ie({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),Ote=vt(Cz,{name:"MuiModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({zIndex:-1}),zte=q.forwardRef(function(e,n){var r,i,o,h,l,m;const _=Bn({name:"MuiModal",props:e}),{BackdropComponent:E=Ote,BackdropProps:T,className:A,closeAfterTransition:L=!1,children:R,container:D,component:W,components:z={},componentsProps:N={},disableAutoFocus:F=!1,disableEnforceFocus:$=!1,disableEscapeKeyDown:K=!1,disablePortal:ne=!1,disableRestoreFocus:re=!1,disableScrollLock:be=!1,hideBackdrop:xe=!1,keepMounted:fe=!1,onBackdropClick:Re,open:Ve,slotProps:Fe,slots:ze}=_,Ye=Yt(_,kte),je=ie({},_,{closeAfterTransition:L,disableAutoFocus:F,disableEnforceFocus:$,disableEscapeKeyDown:K,disablePortal:ne,disableRestoreFocus:re,disableScrollLock:be,hideBackdrop:xe,keepMounted:fe}),{getRootProps:tt,getBackdropProps:ke,getTransitionProps:Ge,portalRef:nt,isTopModal:Dt,exited:ht,hasTransition:ot}=_ee(ie({},je,{rootRef:n})),ct=ie({},je,{exited:ht}),xt=Lte(ct),bt={};if(R.props.tabIndex===void 0&&(bt.tabIndex="-1"),ot){const{onEnter:$t,onExited:Lt}=Ge();bt.onEnter=$t,bt.onExited=Lt}const Jt=(r=(i=ze==null?void 0:ze.root)!=null?i:z.Root)!=null?r:Rte,Je=(o=(h=ze==null?void 0:ze.backdrop)!=null?h:z.Backdrop)!=null?o:E,Et=(l=Fe==null?void 0:Fe.root)!=null?l:N.root,sn=(m=Fe==null?void 0:Fe.backdrop)!=null?m:N.backdrop,Qt=is({elementType:Jt,externalSlotProps:Et,externalForwardedProps:Ye,getSlotProps:tt,additionalProps:{ref:n,as:W},ownerState:ct,className:rn(A,Et==null?void 0:Et.className,xt==null?void 0:xt.root,!ct.open&&ct.exited&&(xt==null?void 0:xt.hidden))}),hn=is({elementType:Je,externalSlotProps:sn,additionalProps:T,getSlotProps:$t=>ke(ie({},$t,{onClick:Lt=>{Re&&Re(Lt),$t!=null&&$t.onClick&&$t.onClick(Lt)}})),className:rn(sn==null?void 0:sn.className,T==null?void 0:T.className,xt==null?void 0:xt.backdrop),ownerState:ct});return!fe&&!Ve&&(!ot||ht)?null:Q.jsx(wz,{ref:nt,container:D,disablePortal:ne,children:Q.jsxs(Jt,ie({},Qt,{children:[!xe&&E?Q.jsx(Je,ie({},hn)):null,Q.jsx(qJ,{disableEnforceFocus:$,disableAutoFocus:F,disableRestoreFocus:re,isEnabled:Dt,open:Ve,children:q.cloneElement(R,bt)})]}))})}),Iz=zte,Dte=kn("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),RM=Dte,Fte=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function Nte(t,e,n){const r=e.getBoundingClientRect(),i=n&&n.getBoundingClientRect(),o=gl(e);let h;if(e.fakeTransform)h=e.fakeTransform;else{const _=o.getComputedStyle(e);h=_.getPropertyValue("-webkit-transform")||_.getPropertyValue("transform")}let l=0,m=0;if(h&&h!=="none"&&typeof h=="string"){const _=h.split("(")[1].split(")")[0].split(",");l=parseInt(_[4],10),m=parseInt(_[5],10)}return t==="left"?i?`translateX(${i.right+l-r.left}px)`:`translateX(${o.innerWidth+l-r.left}px)`:t==="right"?i?`translateX(-${r.right-i.left-l}px)`:`translateX(-${r.left+r.width-l}px)`:t==="up"?i?`translateY(${i.bottom+m-r.top}px)`:`translateY(${o.innerHeight+m-r.top}px)`:i?`translateY(-${r.top-i.top+r.height-m}px)`:`translateY(-${r.top+r.height-m}px)`}function Bte(t){return typeof t=="function"?t():t}function $y(t,e,n){const r=Bte(n),i=Nte(t,e,r);i&&(e.style.webkitTransform=i,e.style.transform=i)}const Ute=q.forwardRef(function(e,n){const r=Cc(),i={enter:r.transitions.easing.easeOut,exit:r.transitions.easing.sharp},o={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:h,appear:l=!0,children:m,container:_,direction:E="down",easing:T=i,in:A,onEnter:L,onEntered:R,onEntering:D,onExit:W,onExited:z,onExiting:N,style:F,timeout:$=o,TransitionComponent:K=lS}=e,ne=Yt(e,Fte),re=q.useRef(null),be=Yr(m.ref,re,n),xe=ke=>Ge=>{ke&&(Ge===void 0?ke(re.current):ke(re.current,Ge))},fe=xe((ke,Ge)=>{$y(E,ke,_),hS(ke),L&&L(ke,Ge)}),Re=xe((ke,Ge)=>{const nt=Rd({timeout:$,style:F,easing:T},{mode:"enter"});ke.style.webkitTransition=r.transitions.create("-webkit-transform",ie({},nt)),ke.style.transition=r.transitions.create("transform",ie({},nt)),ke.style.webkitTransform="none",ke.style.transform="none",D&&D(ke,Ge)}),Ve=xe(R),Fe=xe(N),ze=xe(ke=>{const Ge=Rd({timeout:$,style:F,easing:T},{mode:"exit"});ke.style.webkitTransition=r.transitions.create("-webkit-transform",Ge),ke.style.transition=r.transitions.create("transform",Ge),$y(E,ke,_),W&&W(ke)}),Ye=xe(ke=>{ke.style.webkitTransition="",ke.style.transition="",z&&z(ke)}),je=ke=>{h&&h(re.current,ke)},tt=q.useCallback(()=>{re.current&&$y(E,re.current,_)},[E,_]);return q.useEffect(()=>{if(A||E==="down"||E==="right")return;const ke=BT(()=>{re.current&&$y(E,re.current,_)}),Ge=gl(re.current);return Ge.addEventListener("resize",ke),()=>{ke.clear(),Ge.removeEventListener("resize",ke)}},[E,A,_]),q.useEffect(()=>{A||tt()},[A,tt]),Q.jsx(K,ie({nodeRef:re,onEnter:fe,onEntered:Ve,onEntering:Re,onExit:ze,onExited:Ye,onExiting:Fe,addEndListener:je,appear:l,in:A,timeout:$},ne,{children:(ke,Ge)=>q.cloneElement(m,ie({ref:be,style:ie({visibility:ke==="exited"&&!A?"hidden":void 0},F,m.props.style)},Ge))}))}),Vte=Ute;function jte(t){return Nn("MuiDrawer",t)}kn("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const $te=["BackdropProps"],Gte=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],Mz=(t,e)=>{const{ownerState:n}=t;return[e.root,(n.variant==="permanent"||n.variant==="persistent")&&e.docked,e.modal]},Wte=t=>{const{classes:e,anchor:n,variant:r}=t,i={root:["root"],docked:[(r==="permanent"||r==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${qt(n)}`,r!=="temporary"&&`paperAnchorDocked${qt(n)}`]};return Un(i,jte,e)},Hte=vt(Iz,{name:"MuiDrawer",slot:"Root",overridesResolver:Mz})(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer})),OM=vt("div",{shouldForwardProp:ua,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:Mz})({flex:"0 0 auto"}),qte=vt(Cv,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.paper,e[`paperAnchor${qt(n.anchor)}`],n.variant!=="temporary"&&e[`paperAnchorDocked${qt(n.anchor)}`]]}})(({theme:t,ownerState:e})=>ie({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},e.anchor==="left"&&{left:0},e.anchor==="top"&&{top:0,left:0,right:0,height:"auto",maxHeight:"100%"},e.anchor==="right"&&{right:0},e.anchor==="bottom"&&{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},e.anchor==="left"&&e.variant!=="temporary"&&{borderRight:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="top"&&e.variant!=="temporary"&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="right"&&e.variant!=="temporary"&&{borderLeft:`1px solid ${(t.vars||t).palette.divider}`},e.anchor==="bottom"&&e.variant!=="temporary"&&{borderTop:`1px solid ${(t.vars||t).palette.divider}`})),kz={left:"right",right:"left",top:"down",bottom:"up"};function Zte(t){return["left","right"].indexOf(t)!==-1}function Xte(t,e){return t.direction==="rtl"&&Zte(e)?kz[e]:e}const Yte=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiDrawer"}),i=Cc(),o={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{anchor:h="left",BackdropProps:l,children:m,className:_,elevation:E=16,hideBackdrop:T=!1,ModalProps:{BackdropProps:A}={},onClose:L,open:R=!1,PaperProps:D={},SlideProps:W,TransitionComponent:z=Vte,transitionDuration:N=o,variant:F="temporary"}=r,$=Yt(r.ModalProps,$te),K=Yt(r,Gte),ne=q.useRef(!1);q.useEffect(()=>{ne.current=!0},[]);const re=Xte(i,h),xe=ie({},r,{anchor:h,elevation:E,open:R,variant:F},K),fe=Wte(xe),Re=Q.jsx(qte,ie({elevation:F==="temporary"?E:0,square:!0},D,{className:rn(fe.paper,D.className),ownerState:xe,children:m}));if(F==="permanent")return Q.jsx(OM,ie({className:rn(fe.root,fe.docked,_),ownerState:xe,ref:n},K,{children:Re}));const Ve=Q.jsx(z,ie({in:R,direction:kz[re],timeout:N,appear:ne.current},W,{children:Re}));return F==="persistent"?Q.jsx(OM,ie({className:rn(fe.root,fe.docked,_),ownerState:xe,ref:n},K,{children:Ve})):Q.jsx(Hte,ie({BackdropProps:ie({},l,A,{transitionDuration:N}),className:rn(fe.root,fe.modal,_),open:R,ownerState:xe,onClose:L,hideBackdrop:T,ref:n},K,$,{children:Ve}))}),Kte=Yte,Jte=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],Qte=t=>{const{classes:e,disableUnderline:n}=t,i=Un({root:["root",!n&&"underline"],input:["input"]},Wee,e);return ie({},e,i)},ene=vt(Rv,{shouldForwardProp:t=>ua(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...kv(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{var n;const r=t.palette.mode==="light",i=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",o=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",h=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",l=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return ie({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:h,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o}},[`&.${eu.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o},[`&.${eu.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:l}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(n=(t.vars||t).palette[e.color||"primary"])==null?void 0:n.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${eu.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${eu.error}`]:{"&:before, &:after":{borderBottomColor:(t.vars||t).palette.error.main}},"&:before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:i}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${eu.disabled}, .${eu.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${eu.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&ie({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17}))}),tne=vt(Ov,{name:"MuiFilledInput",slot:"Input",overridesResolver:Lv})(({theme:t,ownerState:e})=>ie({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9})),Lz=q.forwardRef(function(e,n){var r,i,o,h;const l=Bn({props:e,name:"MuiFilledInput"}),{components:m={},componentsProps:_,fullWidth:E=!1,inputComponent:T="input",multiline:A=!1,slotProps:L,slots:R={},type:D="text"}=l,W=Yt(l,Jte),z=ie({},l,{fullWidth:E,inputComponent:T,multiline:A,type:D}),N=Qte(l),F={root:{ownerState:z},input:{ownerState:z}},$=L??_?Fs(L??_,F):F,K=(r=(i=R.root)!=null?i:m.Root)!=null?r:ene,ne=(o=(h=R.input)!=null?h:m.Input)!=null?o:tne;return Q.jsx(xS,ie({slots:{root:K,input:ne},componentsProps:$,fullWidth:E,inputComponent:T,multiline:A,ref:n,type:D},W,{classes:N}))});Lz.muiName="Input";const Rz=Lz;function nne(t){return Nn("MuiFormControl",t)}kn("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const rne=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],ine=t=>{const{classes:e,margin:n,fullWidth:r}=t,i={root:["root",n!=="none"&&`margin${qt(n)}`,r&&"fullWidth"]};return Un(i,nne,e)},sne=vt("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:t},e)=>ie({},e.root,e[`margin${qt(t.margin)}`],t.fullWidth&&e.fullWidth)})(({ownerState:t})=>ie({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},t.margin==="normal"&&{marginTop:16,marginBottom:8},t.margin==="dense"&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})),one=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiFormControl"}),{children:i,className:o,color:h="primary",component:l="div",disabled:m=!1,error:_=!1,focused:E,fullWidth:T=!1,hiddenLabel:A=!1,margin:L="none",required:R=!1,size:D="medium",variant:W="outlined"}=r,z=Yt(r,rne),N=ie({},r,{color:h,component:l,disabled:m,error:_,fullWidth:T,hiddenLabel:A,margin:L,required:R,size:D,variant:W}),F=ine(N),[$,K]=q.useState(()=>{let Fe=!1;return i&&q.Children.forEach(i,ze=>{if(!Z1(ze,["Input","Select"]))return;const Ye=Z1(ze,["Select"])?ze.props.input:ze;Ye&&Oee(Ye.props)&&(Fe=!0)}),Fe}),[ne,re]=q.useState(()=>{let Fe=!1;return i&&q.Children.forEach(i,ze=>{Z1(ze,["Input","Select"])&&(m_(ze.props,!0)||m_(ze.props.inputProps,!0))&&(Fe=!0)}),Fe}),[be,xe]=q.useState(!1);m&&be&&xe(!1);const fe=E!==void 0&&!m?E:be;let Re;const Ve=q.useMemo(()=>({adornedStart:$,setAdornedStart:K,color:h,disabled:m,error:_,filled:ne,focused:fe,fullWidth:T,hiddenLabel:A,size:D,onBlur:()=>{xe(!1)},onEmpty:()=>{re(!1)},onFilled:()=>{re(!0)},onFocus:()=>{xe(!0)},registerEffect:Re,required:R,variant:W}),[$,h,m,_,ne,fe,T,A,Re,R,D,W]);return Q.jsx(Mv.Provider,{value:Ve,children:Q.jsx(sne,ie({as:l,ownerState:N,className:rn(F.root,o),ref:n},z,{children:i}))})}),Oz=one;function ane(t){return Nn("MuiFormHelperText",t)}const lne=kn("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),zM=lne;var DM;const cne=["children","className","component","disabled","error","filled","focused","margin","required","variant"],une=t=>{const{classes:e,contained:n,size:r,disabled:i,error:o,filled:h,focused:l,required:m}=t,_={root:["root",i&&"disabled",o&&"error",r&&`size${qt(r)}`,n&&"contained",l&&"focused",h&&"filled",m&&"required"]};return Un(_,ane,e)},hne=vt("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.size&&e[`size${qt(n.size)}`],n.contained&&e.contained,n.filled&&e.filled]}})(({theme:t,ownerState:e})=>ie({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${zM.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${zM.error}`]:{color:(t.vars||t).palette.error.main}},e.size==="small"&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14})),dne=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiFormHelperText"}),{children:i,className:o,component:h="p"}=r,l=Yt(r,cne),m=Du(),_=Wd({props:r,muiFormControl:m,states:["variant","size","disabled","error","filled","focused","required"]}),E=ie({},r,{component:h,contained:_.variant==="filled"||_.variant==="outlined",variant:_.variant,size:_.size,disabled:_.disabled,error:_.error,filled:_.filled,focused:_.focused,required:_.required}),T=une(E);return Q.jsx(hne,ie({as:h,ownerState:E,className:rn(T.root,o),ref:n},l,{children:i===" "?DM||(DM=Q.jsx("span",{className:"notranslate",children:"​"})):i}))}),fne=dne;function pne(t){return Nn("MuiFormLabel",t)}const mne=kn("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Gp=mne,gne=["children","className","color","component","disabled","error","filled","focused","required"],yne=t=>{const{classes:e,color:n,focused:r,disabled:i,error:o,filled:h,required:l}=t,m={root:["root",`color${qt(n)}`,i&&"disabled",o&&"error",h&&"filled",r&&"focused",l&&"required"],asterisk:["asterisk",o&&"error"]};return Un(m,pne,e)},_ne=vt("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:t},e)=>ie({},e.root,t.color==="secondary"&&e.colorSecondary,t.filled&&e.filled)})(({theme:t,ownerState:e})=>ie({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${Gp.focused}`]:{color:(t.vars||t).palette[e.color].main},[`&.${Gp.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${Gp.error}`]:{color:(t.vars||t).palette.error.main}})),vne=vt("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(t,e)=>e.asterisk})(({theme:t})=>({[`&.${Gp.error}`]:{color:(t.vars||t).palette.error.main}})),xne=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiFormLabel"}),{children:i,className:o,component:h="label"}=r,l=Yt(r,gne),m=Du(),_=Wd({props:r,muiFormControl:m,states:["color","required","focused","disabled","error","filled"]}),E=ie({},r,{color:_.color||"primary",component:h,disabled:_.disabled,error:_.error,filled:_.filled,focused:_.focused,required:_.required}),T=yne(E);return Q.jsxs(_ne,ie({as:h,ownerState:E,className:rn(T.root,o),ref:n},l,{children:[i,_.required&&Q.jsxs(vne,{ownerState:E,"aria-hidden":!0,className:T.asterisk,children:[" ","*"]})]}))}),bne=xne,wne=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function nE(t){return`scale(${t}, ${t**2})`}const Ene={entering:{opacity:1,transform:nE(1)},entered:{opacity:1,transform:"none"}},tb=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),zz=q.forwardRef(function(e,n){const{addEndListener:r,appear:i=!0,children:o,easing:h,in:l,onEnter:m,onEntered:_,onEntering:E,onExit:T,onExited:A,onExiting:L,style:R,timeout:D="auto",TransitionComponent:W=lS}=e,z=Yt(e,wne),N=q.useRef(),F=q.useRef(),$=Cc(),K=q.useRef(null),ne=Yr(K,o.ref,n),re=Ye=>je=>{if(Ye){const tt=K.current;je===void 0?Ye(tt):Ye(tt,je)}},be=re(E),xe=re((Ye,je)=>{hS(Ye);const{duration:tt,delay:ke,easing:Ge}=Rd({style:R,timeout:D,easing:h},{mode:"enter"});let nt;D==="auto"?(nt=$.transitions.getAutoHeightDuration(Ye.clientHeight),F.current=nt):nt=tt,Ye.style.transition=[$.transitions.create("opacity",{duration:nt,delay:ke}),$.transitions.create("transform",{duration:tb?nt:nt*.666,delay:ke,easing:Ge})].join(","),m&&m(Ye,je)}),fe=re(_),Re=re(L),Ve=re(Ye=>{const{duration:je,delay:tt,easing:ke}=Rd({style:R,timeout:D,easing:h},{mode:"exit"});let Ge;D==="auto"?(Ge=$.transitions.getAutoHeightDuration(Ye.clientHeight),F.current=Ge):Ge=je,Ye.style.transition=[$.transitions.create("opacity",{duration:Ge,delay:tt}),$.transitions.create("transform",{duration:tb?Ge:Ge*.666,delay:tb?tt:tt||Ge*.333,easing:ke})].join(","),Ye.style.opacity=0,Ye.style.transform=nE(.75),T&&T(Ye)}),Fe=re(A),ze=Ye=>{D==="auto"&&(N.current=setTimeout(Ye,F.current||0)),r&&r(K.current,Ye)};return q.useEffect(()=>()=>{clearTimeout(N.current)},[]),Q.jsx(W,ie({appear:i,in:l,nodeRef:K,onEnter:xe,onEntered:fe,onEntering:be,onExit:Ve,onExited:Fe,onExiting:Re,addEndListener:ze,timeout:D==="auto"?null:D},z,{children:(Ye,je)=>q.cloneElement(o,ie({style:ie({opacity:0,transform:nE(.75),visibility:Ye==="exited"&&!l?"hidden":void 0},Ene[Ye],R,o.props.style),ref:ne},je))}))});zz.muiSupportAuto=!0;const g_=zz,Tne=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],Sne=t=>{const{classes:e,disableUnderline:n}=t,i=Un({root:["root",!n&&"underline"],input:["input"]},Vee,e);return ie({},e,i)},Pne=vt(Rv,{shouldForwardProp:t=>ua(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...kv(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{let r=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(r=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),ie({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(t.vars||t).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${dp.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${dp.error}`]:{"&:before, &:after":{borderBottomColor:(t.vars||t).palette.error.main}},"&:before":{borderBottom:`1px solid ${r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${dp.disabled}, .${dp.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${r}`}},[`&.${dp.disabled}:before`]:{borderBottomStyle:"dotted"}})}),Cne=vt(Ov,{name:"MuiInput",slot:"Input",overridesResolver:Lv})({}),Dz=q.forwardRef(function(e,n){var r,i,o,h;const l=Bn({props:e,name:"MuiInput"}),{disableUnderline:m,components:_={},componentsProps:E,fullWidth:T=!1,inputComponent:A="input",multiline:L=!1,slotProps:R,slots:D={},type:W="text"}=l,z=Yt(l,Tne),N=Sne(l),$={root:{ownerState:{disableUnderline:m}}},K=R??E?Fs(R??E,$):$,ne=(r=(i=D.root)!=null?i:_.Root)!=null?r:Pne,re=(o=(h=D.input)!=null?h:_.Input)!=null?o:Cne;return Q.jsx(xS,ie({slots:{root:ne,input:re},slotProps:K,fullWidth:T,inputComponent:A,multiline:L,ref:n,type:W},z,{classes:N}))});Dz.muiName="Input";const Fz=Dz;function Ane(t){return Nn("MuiInputAdornment",t)}const Ine=kn("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]),FM=Ine;var NM;const Mne=["children","className","component","disablePointerEvents","disableTypography","position","variant"],kne=(t,e)=>{const{ownerState:n}=t;return[e.root,e[`position${qt(n.position)}`],n.disablePointerEvents===!0&&e.disablePointerEvents,e[n.variant]]},Lne=t=>{const{classes:e,disablePointerEvents:n,hiddenLabel:r,position:i,size:o,variant:h}=t,l={root:["root",n&&"disablePointerEvents",i&&`position${qt(i)}`,h,r&&"hiddenLabel",o&&`size${qt(o)}`]};return Un(l,Ane,e)},Rne=vt("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:kne})(({theme:t,ownerState:e})=>ie({display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(t.vars||t).palette.action.active},e.variant==="filled"&&{[`&.${FM.positionStart}&:not(.${FM.hiddenLabel})`]:{marginTop:16}},e.position==="start"&&{marginRight:8},e.position==="end"&&{marginLeft:8},e.disablePointerEvents===!0&&{pointerEvents:"none"})),One=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiInputAdornment"}),{children:i,className:o,component:h="div",disablePointerEvents:l=!1,disableTypography:m=!1,position:_,variant:E}=r,T=Yt(r,Mne),A=Du()||{};let L=E;E&&A.variant,A&&!L&&(L=A.variant);const R=ie({},r,{hiddenLabel:A.hiddenLabel,size:A.size,disablePointerEvents:l,position:_,variant:L}),D=Lne(R);return Q.jsx(Mv.Provider,{value:null,children:Q.jsx(Rne,ie({as:h,ownerState:R,className:rn(D.root,o),ref:n},T,{children:typeof i=="string"&&!m?Q.jsx(vs,{color:"text.secondary",children:i}):Q.jsxs(q.Fragment,{children:[_==="start"?NM||(NM=Q.jsx("span",{className:"notranslate",children:"​"})):null,i]})}))})}),zne=One;function Dne(t){return Nn("MuiInputLabel",t)}kn("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Fne=["disableAnimation","margin","shrink","variant","className"],Nne=t=>{const{classes:e,formControl:n,size:r,shrink:i,disableAnimation:o,variant:h,required:l}=t,m={root:["root",n&&"formControl",!o&&"animated",i&&"shrink",r&&r!=="normal"&&`size${qt(r)}`,h],asterisk:[l&&"asterisk"]},_=Un(m,Dne,e);return ie({},e,_)},Bne=vt(bne,{shouldForwardProp:t=>ua(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${Gp.asterisk}`]:e.asterisk},e.root,n.formControl&&e.formControl,n.size==="small"&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,e[n.variant]]}})(({theme:t,ownerState:e})=>ie({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},e.variant==="filled"&&ie({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&ie({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&ie({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),Une=q.forwardRef(function(e,n){const r=Bn({name:"MuiInputLabel",props:e}),{disableAnimation:i=!1,shrink:o,className:h}=r,l=Yt(r,Fne),m=Du();let _=o;typeof _>"u"&&m&&(_=m.filled||m.focused||m.adornedStart);const E=Wd({props:r,muiFormControl:m,states:["size","variant","required"]}),T=ie({},r,{disableAnimation:i,formControl:m,shrink:_,size:E.size,variant:E.variant,required:E.required}),A=Nne(T);return Q.jsx(Bne,ie({"data-shrink":_,ownerState:T,ref:n,className:rn(A.root,h)},l,{classes:A}))}),Nz=Une,Vne=q.createContext({}),rE=Vne;function jne(t){return Nn("MuiList",t)}kn("MuiList",["root","padding","dense","subheader"]);const $ne=["children","className","component","dense","disablePadding","subheader"],Gne=t=>{const{classes:e,disablePadding:n,dense:r,subheader:i}=t;return Un({root:["root",!n&&"padding",r&&"dense",i&&"subheader"]},jne,e)},Wne=vt("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})(({ownerState:t})=>ie({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})),Hne=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiList"}),{children:i,className:o,component:h="ul",dense:l=!1,disablePadding:m=!1,subheader:_}=r,E=Yt(r,$ne),T=q.useMemo(()=>({dense:l}),[l]),A=ie({},r,{component:h,dense:l,disablePadding:m}),L=Gne(A);return Q.jsx(rE.Provider,{value:T,children:Q.jsxs(Wne,ie({as:h,className:rn(L.root,o),ref:n,ownerState:A},E,{children:[_,i]}))})}),qne=Hne,Zne=kn("MuiListItemIcon",["root","alignItemsFlexStart"]),BM=Zne,Xne=kn("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),UM=Xne,Yne=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function nb(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function VM(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function Bz(t,e){if(e===void 0)return!0;let n=t.innerText;return n===void 0&&(n=t.textContent),n=n.trim().toLowerCase(),n.length===0?!1:e.repeating?n[0]===e.keys[0]:n.indexOf(e.keys.join(""))===0}function fp(t,e,n,r,i,o){let h=!1,l=i(t,e,e?n:!1);for(;l;){if(l===t.firstChild){if(h)return!1;h=!0}const m=r?!1:l.disabled||l.getAttribute("aria-disabled")==="true";if(!l.hasAttribute("tabindex")||!Bz(l,o)||m)l=i(t,l,n);else return l.focus(),!0}return!1}const Kne=q.forwardRef(function(e,n){const{actions:r,autoFocus:i=!1,autoFocusItem:o=!1,children:h,className:l,disabledItemsFocusable:m=!1,disableListWrap:_=!1,onKeyDown:E,variant:T="selectedMenu"}=e,A=Yt(e,Yne),L=q.useRef(null),R=q.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});ca(()=>{i&&L.current.focus()},[i]),q.useImperativeHandle(r,()=>({adjustStyleForScrollbar:(F,$)=>{const K=!L.current.style.width;if(F.clientHeight<L.current.clientHeight&&K){const ne=`${zO(Xr(F))}px`;L.current.style[$.direction==="rtl"?"paddingLeft":"paddingRight"]=ne,L.current.style.width=`calc(100% + ${ne})`}return L.current}}),[]);const D=F=>{const $=L.current,K=F.key,ne=Xr($).activeElement;if(K==="ArrowDown")F.preventDefault(),fp($,ne,_,m,nb);else if(K==="ArrowUp")F.preventDefault(),fp($,ne,_,m,VM);else if(K==="Home")F.preventDefault(),fp($,null,_,m,nb);else if(K==="End")F.preventDefault(),fp($,null,_,m,VM);else if(K.length===1){const re=R.current,be=K.toLowerCase(),xe=performance.now();re.keys.length>0&&(xe-re.lastTime>500?(re.keys=[],re.repeating=!0,re.previousKeyMatched=!0):re.repeating&&be!==re.keys[0]&&(re.repeating=!1)),re.lastTime=xe,re.keys.push(be);const fe=ne&&!re.repeating&&Bz(ne,re);re.previousKeyMatched&&(fe||fp($,ne,!1,m,nb,re))?F.preventDefault():re.previousKeyMatched=!1}E&&E(F)},W=Yr(L,n);let z=-1;q.Children.forEach(h,(F,$)=>{if(!q.isValidElement(F)){z===$&&(z+=1,z>=h.length&&(z=-1));return}F.props.disabled||(T==="selectedMenu"&&F.props.selected||z===-1)&&(z=$),z===$&&(F.props.disabled||F.props.muiSkipListHighlight||F.type.muiSkipListHighlight)&&(z+=1,z>=h.length&&(z=-1))});const N=q.Children.map(h,(F,$)=>{if($===z){const K={};return o&&(K.autoFocus=!0),F.props.tabIndex===void 0&&T==="selectedMenu"&&(K.tabIndex=0),q.cloneElement(F,K)}return F});return Q.jsx(qne,ie({role:"menu",ref:W,className:l,onKeyDown:D,tabIndex:i?0:-1},A,{children:N}))}),Jne=Kne;function Qne(t){return Nn("MuiPopover",t)}kn("MuiPopover",["root","paper"]);const ere=["onEntering"],tre=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],nre=["slotProps"];function jM(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.height/2:e==="bottom"&&(n=t.height),n}function $M(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.width/2:e==="right"&&(n=t.width),n}function GM(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function rb(t){return typeof t=="function"?t():t}const rre=t=>{const{classes:e}=t;return Un({root:["root"],paper:["paper"]},Qne,e)},ire=vt(Iz,{name:"MuiPopover",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Uz=vt(Cv,{name:"MuiPopover",slot:"Paper",overridesResolver:(t,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),sre=q.forwardRef(function(e,n){var r,i,o;const h=Bn({props:e,name:"MuiPopover"}),{action:l,anchorEl:m,anchorOrigin:_={vertical:"top",horizontal:"left"},anchorPosition:E,anchorReference:T="anchorEl",children:A,className:L,container:R,elevation:D=8,marginThreshold:W=16,open:z,PaperProps:N={},slots:F,slotProps:$,transformOrigin:K={vertical:"top",horizontal:"left"},TransitionComponent:ne=g_,transitionDuration:re="auto",TransitionProps:{onEntering:be}={},disableScrollLock:xe=!1}=h,fe=Yt(h.TransitionProps,ere),Re=Yt(h,tre),Ve=(r=$==null?void 0:$.paper)!=null?r:N,Fe=q.useRef(),ze=Yr(Fe,Ve.ref),Ye=ie({},h,{anchorOrigin:_,anchorReference:T,elevation:D,marginThreshold:W,externalPaperSlotProps:Ve,transformOrigin:K,TransitionComponent:ne,transitionDuration:re,TransitionProps:fe}),je=rre(Ye),tt=q.useCallback(()=>{if(T==="anchorPosition")return E;const $t=rb(m),Ft=($t&&$t.nodeType===1?$t:Xr(Fe.current).body).getBoundingClientRect();return{top:Ft.top+jM(Ft,_.vertical),left:Ft.left+$M(Ft,_.horizontal)}},[m,_.horizontal,_.vertical,E,T]),ke=q.useCallback($t=>({vertical:jM($t,K.vertical),horizontal:$M($t,K.horizontal)}),[K.horizontal,K.vertical]),Ge=q.useCallback($t=>{const Lt={width:$t.offsetWidth,height:$t.offsetHeight},Ft=ke(Lt);if(T==="none")return{top:null,left:null,transformOrigin:GM(Ft)};const wn=tt();let vn=wn.top-Ft.vertical,pt=wn.left-Ft.horizontal;const dn=vn+Lt.height,Ae=pt+Lt.width,Ct=gl(rb(m)),En=Ct.innerHeight-W,en=Ct.innerWidth-W;if(W!==null&&vn<W){const It=vn-W;vn-=It,Ft.vertical+=It}else if(W!==null&&dn>En){const It=dn-En;vn-=It,Ft.vertical+=It}if(W!==null&&pt<W){const It=pt-W;pt-=It,Ft.horizontal+=It}else if(Ae>en){const It=Ae-en;pt-=It,Ft.horizontal+=It}return{top:`${Math.round(vn)}px`,left:`${Math.round(pt)}px`,transformOrigin:GM(Ft)}},[m,T,tt,ke,W]),[nt,Dt]=q.useState(z),ht=q.useCallback(()=>{const $t=Fe.current;if(!$t)return;const Lt=Ge($t);Lt.top!==null&&($t.style.top=Lt.top),Lt.left!==null&&($t.style.left=Lt.left),$t.style.transformOrigin=Lt.transformOrigin,Dt(!0)},[Ge]);q.useEffect(()=>(xe&&window.addEventListener("scroll",ht),()=>window.removeEventListener("scroll",ht)),[m,xe,ht]);const ot=($t,Lt)=>{be&&be($t,Lt),ht()},ct=()=>{Dt(!1)};q.useEffect(()=>{z&&ht()}),q.useImperativeHandle(l,()=>z?{updatePosition:()=>{ht()}}:null,[z,ht]),q.useEffect(()=>{if(!z)return;const $t=BT(()=>{ht()}),Lt=gl(m);return Lt.addEventListener("resize",$t),()=>{$t.clear(),Lt.removeEventListener("resize",$t)}},[m,z,ht]);let xt=re;re==="auto"&&!ne.muiSupportAuto&&(xt=void 0);const bt=R||(m?Xr(rb(m)).body:void 0),Jt=(i=F==null?void 0:F.root)!=null?i:ire,Je=(o=F==null?void 0:F.paper)!=null?o:Uz,Et=is({elementType:Je,externalSlotProps:ie({},Ve,{style:nt?Ve.style:ie({},Ve.style,{opacity:0})}),additionalProps:{elevation:D,ref:ze},ownerState:Ye,className:rn(je.paper,Ve==null?void 0:Ve.className)}),sn=is({elementType:Jt,externalSlotProps:($==null?void 0:$.root)||{},externalForwardedProps:Re,additionalProps:{ref:n,slotProps:{backdrop:{invisible:!0}},container:bt,open:z},ownerState:Ye,className:rn(je.root,L)}),{slotProps:Qt}=sn,hn=Yt(sn,nre);return Q.jsx(Jt,ie({},hn,!vc(Jt)&&{slotProps:Qt,disableScrollLock:xe},{children:Q.jsx(ne,ie({appear:!0,in:z,onEntering:ot,onExited:ct,timeout:xt},fe,{children:Q.jsx(Je,ie({},Et,{children:A}))}))}))}),Vz=sre;function ore(t){return Nn("MuiMenu",t)}kn("MuiMenu",["root","paper","list"]);const are=["onEntering"],lre=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],cre={vertical:"top",horizontal:"right"},ure={vertical:"top",horizontal:"left"},hre=t=>{const{classes:e}=t;return Un({root:["root"],paper:["paper"],list:["list"]},ore,e)},dre=vt(Vz,{shouldForwardProp:t=>ua(t)||t==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(t,e)=>e.root})({}),fre=vt(Uz,{name:"MuiMenu",slot:"Paper",overridesResolver:(t,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),pre=vt(Jne,{name:"MuiMenu",slot:"List",overridesResolver:(t,e)=>e.list})({outline:0}),mre=q.forwardRef(function(e,n){var r,i;const o=Bn({props:e,name:"MuiMenu"}),{autoFocus:h=!0,children:l,className:m,disableAutoFocusItem:_=!1,MenuListProps:E={},onClose:T,open:A,PaperProps:L={},PopoverClasses:R,transitionDuration:D="auto",TransitionProps:{onEntering:W}={},variant:z="selectedMenu",slots:N={},slotProps:F={}}=o,$=Yt(o.TransitionProps,are),K=Yt(o,lre),ne=Cc(),re=ne.direction==="rtl",be=ie({},o,{autoFocus:h,disableAutoFocusItem:_,MenuListProps:E,onEntering:W,PaperProps:L,transitionDuration:D,TransitionProps:$,variant:z}),xe=hre(be),fe=h&&!_&&A,Re=q.useRef(null),Ve=(Ge,nt)=>{Re.current&&Re.current.adjustStyleForScrollbar(Ge,ne),W&&W(Ge,nt)},Fe=Ge=>{Ge.key==="Tab"&&(Ge.preventDefault(),T&&T(Ge,"tabKeyDown"))};let ze=-1;q.Children.map(l,(Ge,nt)=>{q.isValidElement(Ge)&&(Ge.props.disabled||(z==="selectedMenu"&&Ge.props.selected||ze===-1)&&(ze=nt))});const Ye=(r=N.paper)!=null?r:fre,je=(i=F.paper)!=null?i:L,tt=is({elementType:N.root,externalSlotProps:F.root,ownerState:be,className:[xe.root,m]}),ke=is({elementType:Ye,externalSlotProps:je,ownerState:be,className:xe.paper});return Q.jsx(dre,ie({onClose:T,anchorOrigin:{vertical:"bottom",horizontal:re?"right":"left"},transformOrigin:re?cre:ure,slots:{paper:Ye,root:N.root},slotProps:{root:tt,paper:ke},open:A,ref:n,transitionDuration:D,TransitionProps:ie({onEntering:Ve},$),ownerState:be},K,{classes:R,children:Q.jsx(pre,ie({onKeyDown:Fe,actions:Re,autoFocus:h&&(ze===-1||_),autoFocusItem:fe,variant:z},E,{className:rn(xe.list,E.className),children:l}))}))}),jz=mre;function gre(t){return Nn("MuiMenuItem",t)}const yre=kn("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),pp=yre,_re=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],vre=(t,e)=>{const{ownerState:n}=t;return[e.root,n.dense&&e.dense,n.divider&&e.divider,!n.disableGutters&&e.gutters]},xre=t=>{const{disabled:e,dense:n,divider:r,disableGutters:i,selected:o,classes:h}=t,m=Un({root:["root",n&&"dense",e&&"disabled",!i&&"gutters",r&&"divider",o&&"selected"]},gre,h);return ie({},h,m)},bre=vt(dS,{shouldForwardProp:t=>ua(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:vre})(({theme:t,ownerState:e})=>ie({},t.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!e.disableGutters&&{paddingLeft:16,paddingRight:16},e.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${pp.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:Ai(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${pp.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Ai(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${pp.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:Ai(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:Ai(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${pp.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${pp.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${RM.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${RM.inset}`]:{marginLeft:52},[`& .${UM.root}`]:{marginTop:0,marginBottom:0},[`& .${UM.inset}`]:{paddingLeft:36},[`& .${BM.root}`]:{minWidth:36}},!e.dense&&{[t.breakpoints.up("sm")]:{minHeight:"auto"}},e.dense&&ie({minHeight:32,paddingTop:4,paddingBottom:4},t.typography.body2,{[`& .${BM.root} svg`]:{fontSize:"1.25rem"}}))),wre=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiMenuItem"}),{autoFocus:i=!1,component:o="li",dense:h=!1,divider:l=!1,disableGutters:m=!1,focusVisibleClassName:_,role:E="menuitem",tabIndex:T,className:A}=r,L=Yt(r,_re),R=q.useContext(rE),D=q.useMemo(()=>({dense:h||R.dense||!1,disableGutters:m}),[R.dense,h,m]),W=q.useRef(null);ca(()=>{i&&W.current&&W.current.focus()},[i]);const z=ie({},r,{dense:D.dense,divider:l,disableGutters:m}),N=xre(r),F=Yr(W,n);let $;return r.disabled||($=T!==void 0?T:-1),Q.jsx(rE.Provider,{value:D,children:Q.jsx(bre,ie({ref:F,role:E,tabIndex:$,component:o,focusVisibleClassName:rn(N.focusVisible,_),className:rn(N.root,A)},L,{ownerState:z,classes:N}))})}),mp=wre;function Ere(t){return Nn("MuiNativeSelect",t)}const Tre=kn("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),bS=Tre,Sre=["className","disabled","error","IconComponent","inputRef","variant"],Pre=t=>{const{classes:e,variant:n,disabled:r,multiple:i,open:o,error:h}=t,l={select:["select",n,r&&"disabled",i&&"multiple",h&&"error"],icon:["icon",`icon${qt(n)}`,o&&"iconOpen",r&&"disabled"]};return Un(l,Ere,e)},$z=({ownerState:t,theme:e})=>ie({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":ie({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${bS.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},t.variant==="filled"&&{"&&&":{paddingRight:32}},t.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),Cre=vt("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:ua,overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.select,e[n.variant],n.error&&e.error,{[`&.${bS.multiple}`]:e.multiple}]}})($z),Gz=({ownerState:t,theme:e})=>ie({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${bS.disabled}`]:{color:(e.vars||e).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},t.variant==="filled"&&{right:7},t.variant==="outlined"&&{right:7}),Are=vt("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${qt(n.variant)}`],n.open&&e.iconOpen]}})(Gz),Ire=q.forwardRef(function(e,n){const{className:r,disabled:i,error:o,IconComponent:h,inputRef:l,variant:m="standard"}=e,_=Yt(e,Sre),E=ie({},e,{disabled:i,variant:m,error:o}),T=Pre(E);return Q.jsxs(q.Fragment,{children:[Q.jsx(Cre,ie({ownerState:E,className:rn(T.select,r),disabled:i,ref:l||n},_)),e.multiple?null:Q.jsx(Are,{as:h,ownerState:E,className:T.icon})]})}),Mre=Ire;var WM;const kre=["children","classes","className","label","notched"],Lre=vt("fieldset")({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),Rre=vt("legend")(({ownerState:t,theme:e})=>ie({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},t.withLabel&&ie({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function Ore(t){const{className:e,label:n,notched:r}=t,i=Yt(t,kre),o=n!=null&&n!=="",h=ie({},t,{notched:r,withLabel:o});return Q.jsx(Lre,ie({"aria-hidden":!0,className:e,ownerState:h},i,{children:Q.jsx(Rre,{ownerState:h,children:o?Q.jsx("span",{children:n}):WM||(WM=Q.jsx("span",{className:"notranslate",children:"​"}))})}))}const zre=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],Dre=t=>{const{classes:e}=t,r=Un({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},$ee,e);return ie({},e,r)},Fre=vt(Rv,{shouldForwardProp:t=>ua(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:kv})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return ie({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${Zl.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${Zl.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}},[`&.${Zl.focused} .${Zl.notchedOutline}`]:{borderColor:(t.vars||t).palette[e.color].main,borderWidth:2},[`&.${Zl.error} .${Zl.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${Zl.disabled} .${Zl.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&ie({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),Nre=vt(Ore,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(t,e)=>e.notchedOutline})(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),Bre=vt(Ov,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:Lv})(({theme:t,ownerState:e})=>ie({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),Wz=q.forwardRef(function(e,n){var r,i,o,h,l;const m=Bn({props:e,name:"MuiOutlinedInput"}),{components:_={},fullWidth:E=!1,inputComponent:T="input",label:A,multiline:L=!1,notched:R,slots:D={},type:W="text"}=m,z=Yt(m,zre),N=Dre(m),F=Du(),$=Wd({props:m,muiFormControl:F,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),K=ie({},m,{color:$.color||"primary",disabled:$.disabled,error:$.error,focused:$.focused,formControl:F,fullWidth:E,hiddenLabel:$.hiddenLabel,multiline:L,size:$.size,type:W}),ne=(r=(i=D.root)!=null?i:_.Root)!=null?r:Fre,re=(o=(h=D.input)!=null?h:_.Input)!=null?o:Bre;return Q.jsx(xS,ie({slots:{root:ne,input:re},renderSuffix:be=>Q.jsx(Nre,{ownerState:K,className:N.notchedOutline,label:A!=null&&A!==""&&$.required?l||(l=Q.jsxs(q.Fragment,{children:[A," ","*"]})):A,notched:typeof R<"u"?R:!!(be.startAdornment||be.filled||be.focused)}),fullWidth:E,inputComponent:T,multiline:L,ref:n,type:W},z,{classes:ie({},N,{notchedOutline:null})}))});Wz.muiName="Input";const Hz=Wz;function Ure(t){return Nn("MuiSelect",t)}const Vre=kn("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),gp=Vre;var HM;const jre=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],$re=vt("div",{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`&.${gp.select}`]:e.select},{[`&.${gp.select}`]:e[n.variant]},{[`&.${gp.error}`]:e.error},{[`&.${gp.multiple}`]:e.multiple}]}})($z,{[`&.${gp.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Gre=vt("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${qt(n.variant)}`],n.open&&e.iconOpen]}})(Gz),Wre=vt("input",{shouldForwardProp:t=>sS(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(t,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function qM(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function Hre(t){return t==null||typeof t=="string"&&!t.trim()}const qre=t=>{const{classes:e,variant:n,disabled:r,multiple:i,open:o,error:h}=t,l={select:["select",n,r&&"disabled",i&&"multiple",h&&"error"],icon:["icon",`icon${qt(n)}`,o&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]};return Un(l,Ure,e)},Zre=q.forwardRef(function(e,n){var r;const{"aria-describedby":i,"aria-label":o,autoFocus:h,autoWidth:l,children:m,className:_,defaultOpen:E,defaultValue:T,disabled:A,displayEmpty:L,error:R=!1,IconComponent:D,inputRef:W,labelId:z,MenuProps:N={},multiple:F,name:$,onBlur:K,onChange:ne,onClose:re,onFocus:be,onOpen:xe,open:fe,readOnly:Re,renderValue:Ve,SelectDisplayProps:Fe={},tabIndex:ze,value:Ye,variant:je="standard"}=e,tt=Yt(e,jre),[ke,Ge]=a_({controlled:Ye,default:T,name:"Select"}),[nt,Dt]=a_({controlled:fe,default:E,name:"Select"}),ht=q.useRef(null),ot=q.useRef(null),[ct,xt]=q.useState(null),{current:bt}=q.useRef(fe!=null),[Jt,Je]=q.useState(),Et=Yr(n,W),sn=q.useCallback(mt=>{ot.current=mt,mt&&xt(mt)},[]),Qt=ct==null?void 0:ct.parentNode;q.useImperativeHandle(Et,()=>({focus:()=>{ot.current.focus()},node:ht.current,value:ke}),[ke]),q.useEffect(()=>{E&&nt&&ct&&!bt&&(Je(l?null:Qt.clientWidth),ot.current.focus())},[ct,l]),q.useEffect(()=>{h&&ot.current.focus()},[h]),q.useEffect(()=>{if(!z)return;const mt=Xr(ot.current).getElementById(z);if(mt){const Zt=()=>{getSelection().isCollapsed&&ot.current.focus()};return mt.addEventListener("click",Zt),()=>{mt.removeEventListener("click",Zt)}}},[z]);const hn=(mt,Zt)=>{mt?xe&&xe(Zt):re&&re(Zt),bt||(Je(l?null:Qt.clientWidth),Dt(mt))},$t=mt=>{mt.button===0&&(mt.preventDefault(),ot.current.focus(),hn(!0,mt))},Lt=mt=>{hn(!1,mt)},Ft=q.Children.toArray(m),wn=mt=>{const Zt=Ft.find(Ln=>Ln.props.value===mt.target.value);Zt!==void 0&&(Ge(Zt.props.value),ne&&ne(mt,Zt))},vn=mt=>Zt=>{let Ln;if(Zt.currentTarget.hasAttribute("tabindex")){if(F){Ln=Array.isArray(ke)?ke.slice():[];const Fn=ke.indexOf(mt.props.value);Fn===-1?Ln.push(mt.props.value):Ln.splice(Fn,1)}else Ln=mt.props.value;if(mt.props.onClick&&mt.props.onClick(Zt),ke!==Ln&&(Ge(Ln),ne)){const Fn=Zt.nativeEvent||Zt,it=new Fn.constructor(Fn.type,Fn);Object.defineProperty(it,"target",{writable:!0,value:{value:Ln,name:$}}),ne(it,mt)}F||hn(!1,Zt)}},pt=mt=>{Re||[" ","ArrowUp","ArrowDown","Enter"].indexOf(mt.key)!==-1&&(mt.preventDefault(),hn(!0,mt))},dn=ct!==null&&nt,Ae=mt=>{!dn&&K&&(Object.defineProperty(mt,"target",{writable:!0,value:{value:ke,name:$}}),K(mt))};delete tt["aria-invalid"];let Ct,En;const en=[];let It=!1;(m_({value:ke})||L)&&(Ve?Ct=Ve(ke):It=!0);const Qe=Ft.map(mt=>{if(!q.isValidElement(mt))return null;let Zt;if(F){if(!Array.isArray(ke))throw new Error(Ec(2));Zt=ke.some(Ln=>qM(Ln,mt.props.value)),Zt&&It&&en.push(mt.props.children)}else Zt=qM(ke,mt.props.value),Zt&&It&&(En=mt.props.children);return q.cloneElement(mt,{"aria-selected":Zt?"true":"false",onClick:vn(mt),onKeyUp:Ln=>{Ln.key===" "&&Ln.preventDefault(),mt.props.onKeyUp&&mt.props.onKeyUp(Ln)},role:"option",selected:Zt,value:void 0,"data-value":mt.props.value})});It&&(F?en.length===0?Ct=null:Ct=en.reduce((mt,Zt,Ln)=>(mt.push(Zt),Ln<en.length-1&&mt.push(", "),mt),[]):Ct=En);let gt=Jt;!l&&bt&&ct&&(gt=Qt.clientWidth);let Mt;typeof ze<"u"?Mt=ze:Mt=A?null:0;const Rt=Fe.id||($?`mui-component-select-${$}`:void 0),Pt=ie({},e,{variant:je,value:ke,open:dn,error:R}),gn=qre(Pt),mn=ie({},N.PaperProps,(r=N.slotProps)==null?void 0:r.paper),He=UT();return Q.jsxs(q.Fragment,{children:[Q.jsx($re,ie({ref:sn,tabIndex:Mt,role:"combobox","aria-controls":He,"aria-disabled":A?"true":void 0,"aria-expanded":dn?"true":"false","aria-haspopup":"listbox","aria-label":o,"aria-labelledby":[z,Rt].filter(Boolean).join(" ")||void 0,"aria-describedby":i,onKeyDown:pt,onMouseDown:A||Re?null:$t,onBlur:Ae,onFocus:be},Fe,{ownerState:Pt,className:rn(Fe.className,gn.select,_),id:Rt,children:Hre(Ct)?HM||(HM=Q.jsx("span",{className:"notranslate",children:"​"})):Ct})),Q.jsx(Wre,ie({"aria-invalid":R,value:Array.isArray(ke)?ke.join(","):ke,name:$,ref:ht,"aria-hidden":!0,onChange:wn,tabIndex:-1,disabled:A,className:gn.nativeInput,autoFocus:h,ownerState:Pt},tt)),Q.jsx(Gre,{as:D,className:gn.icon,ownerState:Pt}),Q.jsx(jz,ie({id:`menu-${$||""}`,anchorEl:Qt,open:dn,onClose:Lt,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},N,{MenuListProps:ie({"aria-labelledby":z,role:"listbox","aria-multiselectable":F?"true":void 0,disableListWrap:!0,id:He},N.MenuListProps),slotProps:ie({},N.slotProps,{paper:ie({},mn,{style:ie({minWidth:gt},mn!=null?mn.style:null)})}),children:Qe}))]})}),Xre=Zre,Yre=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],Kre=["root"],Jre=t=>{const{classes:e}=t;return e},wS={name:"MuiSelect",overridesResolver:(t,e)=>e.root,shouldForwardProp:t=>ua(t)&&t!=="variant",slot:"Root"},Qre=vt(Fz,wS)(""),eie=vt(Hz,wS)(""),tie=vt(Rz,wS)(""),qz=q.forwardRef(function(e,n){const r=Bn({name:"MuiSelect",props:e}),{autoWidth:i=!1,children:o,classes:h={},className:l,defaultOpen:m=!1,displayEmpty:_=!1,IconComponent:E=qee,id:T,input:A,inputProps:L,label:R,labelId:D,MenuProps:W,multiple:z=!1,native:N=!1,onClose:F,onOpen:$,open:K,renderValue:ne,SelectDisplayProps:re,variant:be="outlined"}=r,xe=Yt(r,Yre),fe=N?Mre:Xre,Re=Du(),Ve=Wd({props:r,muiFormControl:Re,states:["variant","error"]}),Fe=Ve.variant||be,ze=ie({},r,{variant:Fe,classes:h}),Ye=Jre(ze),je=Yt(Ye,Kre),tt=A||{standard:Q.jsx(Qre,{ownerState:ze}),outlined:Q.jsx(eie,{label:R,ownerState:ze}),filled:Q.jsx(tie,{ownerState:ze})}[Fe],ke=Yr(n,tt.ref);return Q.jsx(q.Fragment,{children:q.cloneElement(tt,ie({inputComponent:fe,inputProps:ie({children:o,error:Ve.error,IconComponent:E,variant:Fe,type:void 0,multiple:z},N?{id:T}:{autoWidth:i,defaultOpen:m,displayEmpty:_,labelId:D,MenuProps:W,onClose:F,onOpen:$,open:K,renderValue:ne,SelectDisplayProps:ie({id:T},re)},L,{classes:L?Fs(je,L.classes):je},A?A.props.inputProps:{})},z&&N&&Fe==="outlined"?{notched:!0}:{},{ref:ke,className:rn(tt.props.className,l,Ye.root)},!A&&{variant:Fe},xe))})});qz.muiName="Select";const Zz=qz,nie=t=>!t||!vc(t),rie=nie;function iie(t){return Nn("MuiSlider",t)}const sie=kn("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),ra=sie,oie=t=>{const{open:e}=t;return{offset:rn(e&&ra.valueLabelOpen),circle:ra.valueLabelCircle,label:ra.valueLabelLabel}};function aie(t){const{children:e,className:n,value:r}=t,i=oie(t);return e?q.cloneElement(e,{className:rn(e.props.className)},Q.jsxs(q.Fragment,{children:[e.props.children,Q.jsx("span",{className:rn(i.offset,n),"aria-hidden":!0,children:Q.jsx("span",{className:i.circle,children:Q.jsx("span",{className:i.label,children:r})})})]})):null}const lie=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"];function ZM(t){return t}const cie=vt("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`color${qt(n.color)}`],n.size!=="medium"&&e[`size${qt(n.size)}`],n.marked&&e.marked,n.orientation==="vertical"&&e.vertical,n.track==="inverted"&&e.trackInverted,n.track===!1&&e.trackFalse]}})(({theme:t,ownerState:e})=>ie({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",color:(t.vars||t).palette[e.color].main,WebkitTapHighlightColor:"transparent"},e.orientation==="horizontal"&&ie({height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}},e.size==="small"&&{height:2},e.marked&&{marginBottom:20}),e.orientation==="vertical"&&ie({height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}},e.size==="small"&&{width:2},e.marked&&{marginRight:44}),{"@media print":{colorAdjust:"exact"},[`&.${ra.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${ra.dragging}`]:{[`& .${ra.thumb}, & .${ra.track}`]:{transition:"none"}}})),uie=vt("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(t,e)=>e.rail})(({ownerState:t})=>ie({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38},t.orientation==="horizontal"&&{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"},t.orientation==="vertical"&&{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"},t.track==="inverted"&&{opacity:1})),hie=vt("span",{name:"MuiSlider",slot:"Track",overridesResolver:(t,e)=>e.track})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?Sm(t.palette[e.color].main,.62):Tm(t.palette[e.color].main,.5);return ie({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest})},e.size==="small"&&{border:"none"},e.orientation==="horizontal"&&{height:"inherit",top:"50%",transform:"translateY(-50%)"},e.orientation==="vertical"&&{width:"inherit",left:"50%",transform:"translateX(-50%)"},e.track===!1&&{display:"none"},e.track==="inverted"&&{backgroundColor:t.vars?t.vars.palette.Slider[`${e.color}Track`]:n,borderColor:t.vars?t.vars.palette.Slider[`${e.color}Track`]:n})}),die=vt("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.thumb,e[`thumbColor${qt(n.color)}`],n.size!=="medium"&&e[`thumbSize${qt(n.size)}`]]}})(({theme:t,ownerState:e})=>ie({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest})},e.size==="small"&&{width:12,height:12},e.orientation==="horizontal"&&{top:"50%",transform:"translate(-50%, -50%)"},e.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 50%)"},{"&:before":ie({position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},e.size==="small"&&{boxShadow:"none"}),"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&:hover, &.${ra.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.16)`:Ai(t.palette[e.color].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${ra.active}`]:{boxShadow:`0px 0px 0px 14px ${t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.16)`:Ai(t.palette[e.color].main,.16)}`},[`&.${ra.disabled}`]:{"&:hover":{boxShadow:"none"}}})),fie=vt(aie,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(t,e)=>e.valueLabel})(({theme:t,ownerState:e})=>ie({[`&.${ra.valueLabelOpen}`]:{transform:`${e.orientation==="vertical"?"translateY(-50%)":"translateY(-100%)"} scale(1)`},zIndex:1,whiteSpace:"nowrap"},t.typography.body2,{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),transform:`${e.orientation==="vertical"?"translateY(-50%)":"translateY(-100%)"} scale(0)`,position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem"},e.orientation==="horizontal"&&{top:"-10px",transformOrigin:"bottom center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"}},e.orientation==="vertical"&&{right:e.size==="small"?"20px":"30px",top:"50%",transformOrigin:"right center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"}},e.size==="small"&&{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"})),pie=vt("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>sS(t)&&t!=="markActive",overridesResolver:(t,e)=>{const{markActive:n}=t;return[e.mark,n&&e.markActive]}})(({theme:t,ownerState:e,markActive:n})=>ie({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor"},e.orientation==="horizontal"&&{top:"50%",transform:"translate(-1px, -50%)"},e.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 1px)"},n&&{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8})),mie=vt("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>sS(t)&&t!=="markLabelActive",overridesResolver:(t,e)=>e.markLabel})(({theme:t,ownerState:e,markLabelActive:n})=>ie({},t.typography.body2,{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap"},e.orientation==="horizontal"&&{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}},e.orientation==="vertical"&&{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}},n&&{color:(t.vars||t).palette.text.primary})),gie=t=>{const{disabled:e,dragging:n,marked:r,orientation:i,track:o,classes:h,color:l,size:m}=t,_={root:["root",e&&"disabled",n&&"dragging",r&&"marked",i==="vertical"&&"vertical",o==="inverted"&&"trackInverted",o===!1&&"trackFalse",l&&`color${qt(l)}`,m&&`size${qt(m)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled",m&&`thumbSize${qt(m)}`,l&&`thumbColor${qt(l)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return Un(_,iie,h)},yie=({children:t})=>t,_ie=q.forwardRef(function(e,n){var r,i,o,h,l,m,_,E,T,A,L,R,D,W,z,N,F,$,K,ne,re,be,xe,fe;const Re=Bn({props:e,name:"MuiSlider"}),Fe=Cc().direction==="rtl",{"aria-label":ze,"aria-valuetext":Ye,"aria-labelledby":je,component:tt="span",components:ke={},componentsProps:Ge={},color:nt="primary",classes:Dt,className:ht,disableSwap:ot=!1,disabled:ct=!1,getAriaLabel:xt,getAriaValueText:bt,marks:Jt=!1,max:Je=100,min:Et=0,orientation:sn="horizontal",size:Qt="medium",step:hn=1,scale:$t=ZM,slotProps:Lt,slots:Ft,track:wn="normal",valueLabelDisplay:vn="off",valueLabelFormat:pt=ZM}=Re,dn=Yt(Re,lie),Ae=ie({},Re,{isRtl:Fe,max:Je,min:Et,classes:Dt,disabled:ct,disableSwap:ot,orientation:sn,marks:Jt,color:nt,size:Qt,step:hn,scale:$t,track:wn,valueLabelDisplay:vn,valueLabelFormat:pt}),{axisProps:Ct,getRootProps:En,getHiddenInputProps:en,getThumbProps:It,open:Qe,active:gt,axis:Mt,focusedThumbIndex:Rt,range:Pt,dragging:gn,marks:mn,values:He,trackOffset:mt,trackLeap:Zt,getThumbStyle:Ln}=See(ie({},Ae,{rootRef:n}));Ae.marked=mn.length>0&&mn.some(dt=>dt.label),Ae.dragging=gn,Ae.focusedThumbIndex=Rt;const Fn=gie(Ae),it=(r=(i=Ft==null?void 0:Ft.root)!=null?i:ke.Root)!=null?r:cie,fn=(o=(h=Ft==null?void 0:Ft.rail)!=null?h:ke.Rail)!=null?o:uie,ln=(l=(m=Ft==null?void 0:Ft.track)!=null?m:ke.Track)!=null?l:hie,Cr=(_=(E=Ft==null?void 0:Ft.thumb)!=null?E:ke.Thumb)!=null?_:die,li=(T=(A=Ft==null?void 0:Ft.valueLabel)!=null?A:ke.ValueLabel)!=null?T:fie,cn=(L=(R=Ft==null?void 0:Ft.mark)!=null?R:ke.Mark)!=null?L:pie,Kr=(D=(W=Ft==null?void 0:Ft.markLabel)!=null?W:ke.MarkLabel)!=null?D:mie,xi=(z=(N=Ft==null?void 0:Ft.input)!=null?N:ke.Input)!=null?z:"input",de=(F=Lt==null?void 0:Lt.root)!=null?F:Ge.root,G=($=Lt==null?void 0:Lt.rail)!=null?$:Ge.rail,Z=(K=Lt==null?void 0:Lt.track)!=null?K:Ge.track,se=(ne=Lt==null?void 0:Lt.thumb)!=null?ne:Ge.thumb,ue=(re=Lt==null?void 0:Lt.valueLabel)!=null?re:Ge.valueLabel,ve=(be=Lt==null?void 0:Lt.mark)!=null?be:Ge.mark,Se=(xe=Lt==null?void 0:Lt.markLabel)!=null?xe:Ge.markLabel,Te=(fe=Lt==null?void 0:Lt.input)!=null?fe:Ge.input,ye=is({elementType:it,getSlotProps:En,externalSlotProps:de,externalForwardedProps:dn,additionalProps:ie({},rie(it)&&{as:tt}),ownerState:ie({},Ae,de==null?void 0:de.ownerState),className:[Fn.root,ht]}),Ce=is({elementType:fn,externalSlotProps:G,ownerState:Ae,className:Fn.rail}),$e=is({elementType:ln,externalSlotProps:Z,additionalProps:{style:ie({},Ct[Mt].offset(mt),Ct[Mt].leap(Zt))},ownerState:ie({},Ae,Z==null?void 0:Z.ownerState),className:Fn.track}),We=is({elementType:Cr,getSlotProps:It,externalSlotProps:se,ownerState:ie({},Ae,se==null?void 0:se.ownerState),className:Fn.thumb}),qe=is({elementType:li,externalSlotProps:ue,ownerState:ie({},Ae,ue==null?void 0:ue.ownerState),className:Fn.valueLabel}),At=is({elementType:cn,externalSlotProps:ve,ownerState:Ae,className:Fn.mark}),nn=is({elementType:Kr,externalSlotProps:Se,ownerState:Ae,className:Fn.markLabel}),Ot=is({elementType:xi,getSlotProps:en,externalSlotProps:Te,ownerState:Ae});return Q.jsxs(it,ie({},ye,{children:[Q.jsx(fn,ie({},Ce)),Q.jsx(ln,ie({},$e)),mn.filter(dt=>dt.value>=Et&&dt.value<=Je).map((dt,Nt)=>{const xn=p_(dt.value,Et,Je),bn=Ct[Mt].offset(xn);let pn;return wn===!1?pn=He.indexOf(dt.value)!==-1:pn=wn==="normal"&&(Pt?dt.value>=He[0]&&dt.value<=He[He.length-1]:dt.value<=He[0])||wn==="inverted"&&(Pt?dt.value<=He[0]||dt.value>=He[He.length-1]:dt.value>=He[0]),Q.jsxs(q.Fragment,{children:[Q.jsx(cn,ie({"data-index":Nt},At,!vc(cn)&&{markActive:pn},{style:ie({},bn,At.style),className:rn(At.className,pn&&Fn.markActive)})),dt.label!=null?Q.jsx(Kr,ie({"aria-hidden":!0,"data-index":Nt},nn,!vc(Kr)&&{markLabelActive:pn},{style:ie({},bn,nn.style),className:rn(Fn.markLabel,nn.className,pn&&Fn.markLabelActive),children:dt.label})):null]},Nt)}),He.map((dt,Nt)=>{const xn=p_(dt,Et,Je),bn=Ct[Mt].offset(xn),pn=vn==="off"?yie:li;return Q.jsx(pn,ie({},!vc(pn)&&{valueLabelFormat:pt,valueLabelDisplay:vn,value:typeof pt=="function"?pt($t(dt),Nt):pt,index:Nt,open:Qe===Nt||gt===Nt||vn==="on",disabled:ct},qe,{children:Q.jsx(Cr,ie({"data-index":Nt},We,{className:rn(Fn.thumb,We.className,gt===Nt&&Fn.active,Rt===Nt&&Fn.focusVisible),style:ie({},bn,Ln(Nt),We.style),children:Q.jsx(xi,ie({"data-index":Nt,"aria-label":xt?xt(Nt):ze,"aria-valuenow":$t(dt),"aria-labelledby":je,"aria-valuetext":bt?bt($t(dt),Nt):Ye,value:He[Nt]},Ot))}))}),Nt)})]}))}),ES=_ie;function vie(t){return Nn("MuiSnackbarContent",t)}kn("MuiSnackbarContent",["root","message","action"]);const xie=["action","className","message","role"],bie=t=>{const{classes:e}=t;return Un({root:["root"],action:["action"],message:["message"]},vie,e)},wie=vt(Cv,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98,n=NY(t.palette.background.default,e);return ie({},t.typography.body2,{color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(n),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:n,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}})}),Eie=vt("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0"}),Tie=vt("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Sie=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiSnackbarContent"}),{action:i,className:o,message:h,role:l="alert"}=r,m=Yt(r,xie),_=r,E=bie(_);return Q.jsxs(wie,ie({role:l,square:!0,elevation:6,className:rn(E.root,o),ownerState:_,ref:n},m,{children:[Q.jsx(Eie,{className:E.message,ownerState:_,children:h}),i?Q.jsx(Tie,{className:E.action,ownerState:_,children:i}):null]}))}),Pie=Sie;function Cie(t){return Nn("MuiSnackbar",t)}kn("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const Aie=["onEnter","onExited"],Iie=["action","anchorOrigin","autoHideDuration","children","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"],Mie=t=>{const{classes:e,anchorOrigin:n}=t,r={root:["root",`anchorOrigin${qt(n.vertical)}${qt(n.horizontal)}`]};return Un(r,Cie,e)},XM=vt("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`anchorOrigin${qt(n.anchorOrigin.vertical)}${qt(n.anchorOrigin.horizontal)}`]]}})(({theme:t,ownerState:e})=>{const n={left:"50%",right:"auto",transform:"translateX(-50%)"};return ie({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},e.anchorOrigin.vertical==="top"?{top:8}:{bottom:8},e.anchorOrigin.horizontal==="left"&&{justifyContent:"flex-start"},e.anchorOrigin.horizontal==="right"&&{justifyContent:"flex-end"},{[t.breakpoints.up("sm")]:ie({},e.anchorOrigin.vertical==="top"?{top:24}:{bottom:24},e.anchorOrigin.horizontal==="center"&&n,e.anchorOrigin.horizontal==="left"&&{left:24,right:"auto"},e.anchorOrigin.horizontal==="right"&&{right:24,left:"auto"})})}),kie=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiSnackbar"}),i=Cc(),o={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{action:h,anchorOrigin:{vertical:l,horizontal:m}={vertical:"bottom",horizontal:"left"},autoHideDuration:_=null,children:E,className:T,ClickAwayListenerProps:A,ContentProps:L,disableWindowBlurListener:R=!1,message:D,open:W,TransitionComponent:z=g_,transitionDuration:N=o,TransitionProps:{onEnter:F,onExited:$}={}}=r,K=Yt(r.TransitionProps,Aie),ne=Yt(r,Iie),re=ie({},r,{anchorOrigin:{vertical:l,horizontal:m},autoHideDuration:_,disableWindowBlurListener:R,TransitionComponent:z,transitionDuration:N}),be=Mie(re),{getRootProps:xe,onClickAway:fe}=Pee(ie({},re)),[Re,Ve]=q.useState(!0),Fe=is({elementType:XM,getSlotProps:xe,externalForwardedProps:ne,ownerState:re,additionalProps:{ref:n},className:[be.root,T]}),ze=je=>{Ve(!0),$&&$(je)},Ye=(je,tt)=>{Ve(!1),F&&F(je,tt)};return!W&&Re?null:Q.jsx(UJ,ie({onClickAway:fe},A,{children:Q.jsx(XM,ie({},Fe,{children:Q.jsx(z,ie({appear:!0,in:W,timeout:N,direction:l==="top"?"down":"up",onEnter:Ye,onExited:ze},K,{children:E||Q.jsx(Pie,ie({message:D,action:h},L))}))}))}))}),YM=kie;function Lie(t){return Nn("MuiTooltip",t)}const Rie=kn("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),oc=Rie,Oie=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];function zie(t){return Math.round(t*1e5)/1e5}const Die=t=>{const{classes:e,disableInteractive:n,arrow:r,touch:i,placement:o}=t,h={popper:["popper",!n&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",i&&"touch",`tooltipPlacement${qt(o.split("-")[0])}`],arrow:["arrow"]};return Un(h,Lie,e)},Fie=vt(Tz,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.popper,!n.disableInteractive&&e.popperInteractive,n.arrow&&e.popperArrow,!n.open&&e.popperClose]}})(({theme:t,ownerState:e,open:n})=>ie({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none"},!e.disableInteractive&&{pointerEvents:"auto"},!n&&{pointerEvents:"none"},e.arrow&&{[`&[data-popper-placement*="bottom"] .${oc.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${oc.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${oc.arrow}`]:ie({},e.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${oc.arrow}`]:ie({},e.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})),Nie=vt("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.tooltip,n.touch&&e.touch,n.arrow&&e.tooltipArrow,e[`tooltipPlacement${qt(n.placement.split("-")[0])}`]]}})(({theme:t,ownerState:e})=>ie({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:Ai(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium},e.arrow&&{position:"relative",margin:0},e.touch&&{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${zie(16/14)}em`,fontWeight:t.typography.fontWeightRegular},{[`.${oc.popper}[data-popper-placement*="left"] &`]:ie({transformOrigin:"right center"},e.isRtl?ie({marginLeft:"14px"},e.touch&&{marginLeft:"24px"}):ie({marginRight:"14px"},e.touch&&{marginRight:"24px"})),[`.${oc.popper}[data-popper-placement*="right"] &`]:ie({transformOrigin:"left center"},e.isRtl?ie({marginRight:"14px"},e.touch&&{marginRight:"24px"}):ie({marginLeft:"14px"},e.touch&&{marginLeft:"24px"})),[`.${oc.popper}[data-popper-placement*="top"] &`]:ie({transformOrigin:"center bottom",marginBottom:"14px"},e.touch&&{marginBottom:"24px"}),[`.${oc.popper}[data-popper-placement*="bottom"] &`]:ie({transformOrigin:"center top",marginTop:"14px"},e.touch&&{marginTop:"24px"})})),Bie=vt("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(t,e)=>e.arrow})(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:Ai(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}));let Gy=!1,ib=null,yp={x:0,y:0};function Wy(t,e){return n=>{e&&e(n),t(n)}}const Uie=q.forwardRef(function(e,n){var r,i,o,h,l,m,_,E,T,A,L,R,D,W,z,N,F,$,K;const ne=Bn({props:e,name:"MuiTooltip"}),{arrow:re=!1,children:be,components:xe={},componentsProps:fe={},describeChild:Re=!1,disableFocusListener:Ve=!1,disableHoverListener:Fe=!1,disableInteractive:ze=!1,disableTouchListener:Ye=!1,enterDelay:je=100,enterNextDelay:tt=0,enterTouchDelay:ke=700,followCursor:Ge=!1,id:nt,leaveDelay:Dt=0,leaveTouchDelay:ht=1500,onClose:ot,onOpen:ct,open:xt,placement:bt="bottom",PopperComponent:Jt,PopperProps:Je={},slotProps:Et={},slots:sn={},title:Qt,TransitionComponent:hn=g_,TransitionProps:$t}=ne,Lt=Yt(ne,Oie),Ft=q.isValidElement(be)?be:Q.jsx("span",{children:be}),wn=Cc(),vn=wn.direction==="rtl",[pt,dn]=q.useState(),[Ae,Ct]=q.useState(null),En=q.useRef(!1),en=ze||Ge,It=q.useRef(),Qe=q.useRef(),gt=q.useRef(),Mt=q.useRef(),[Rt,Pt]=a_({controlled:xt,default:!1,name:"Tooltip",state:"open"});let gn=Rt;const mn=UT(nt),He=q.useRef(),mt=q.useCallback(()=>{He.current!==void 0&&(document.body.style.WebkitUserSelect=He.current,He.current=void 0),clearTimeout(Mt.current)},[]);q.useEffect(()=>()=>{clearTimeout(It.current),clearTimeout(Qe.current),clearTimeout(gt.current),mt()},[mt]);const Zt=Ut=>{clearTimeout(ib),Gy=!0,Pt(!0),ct&&!gn&&ct(Ut)},Ln=ro(Ut=>{clearTimeout(ib),ib=setTimeout(()=>{Gy=!1},800+Dt),Pt(!1),ot&&gn&&ot(Ut),clearTimeout(It.current),It.current=setTimeout(()=>{En.current=!1},wn.transitions.duration.shortest)}),Fn=Ut=>{En.current&&Ut.type!=="touchstart"||(pt&&pt.removeAttribute("title"),clearTimeout(Qe.current),clearTimeout(gt.current),je||Gy&&tt?Qe.current=setTimeout(()=>{Zt(Ut)},Gy?tt:je):Zt(Ut))},it=Ut=>{clearTimeout(Qe.current),clearTimeout(gt.current),gt.current=setTimeout(()=>{Ln(Ut)},Dt)},{isFocusVisibleRef:fn,onBlur:ln,onFocus:Cr,ref:li}=VT(),[,cn]=q.useState(!1),Kr=Ut=>{ln(Ut),fn.current===!1&&(cn(!1),it(Ut))},xi=Ut=>{pt||dn(Ut.currentTarget),Cr(Ut),fn.current===!0&&(cn(!0),Fn(Ut))},de=Ut=>{En.current=!0;const zn=Ft.props;zn.onTouchStart&&zn.onTouchStart(Ut)},G=Fn,Z=it,se=Ut=>{de(Ut),clearTimeout(gt.current),clearTimeout(It.current),mt(),He.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",Mt.current=setTimeout(()=>{document.body.style.WebkitUserSelect=He.current,Fn(Ut)},ke)},ue=Ut=>{Ft.props.onTouchEnd&&Ft.props.onTouchEnd(Ut),mt(),clearTimeout(gt.current),gt.current=setTimeout(()=>{Ln(Ut)},ht)};q.useEffect(()=>{if(!gn)return;function Ut(zn){(zn.key==="Escape"||zn.key==="Esc")&&Ln(zn)}return document.addEventListener("keydown",Ut),()=>{document.removeEventListener("keydown",Ut)}},[Ln,gn]);const ve=Yr(Ft.ref,li,dn,n);!Qt&&Qt!==0&&(gn=!1);const Se=q.useRef(),Te=Ut=>{const zn=Ft.props;zn.onMouseMove&&zn.onMouseMove(Ut),yp={x:Ut.clientX,y:Ut.clientY},Se.current&&Se.current.update()},ye={},Ce=typeof Qt=="string";Re?(ye.title=!gn&&Ce&&!Fe?Qt:null,ye["aria-describedby"]=gn?mn:null):(ye["aria-label"]=Ce?Qt:null,ye["aria-labelledby"]=gn&&!Ce?mn:null);const $e=ie({},ye,Lt,Ft.props,{className:rn(Lt.className,Ft.props.className),onTouchStart:de,ref:ve},Ge?{onMouseMove:Te}:{}),We={};Ye||($e.onTouchStart=se,$e.onTouchEnd=ue),Fe||($e.onMouseOver=Wy(G,$e.onMouseOver),$e.onMouseLeave=Wy(Z,$e.onMouseLeave),en||(We.onMouseOver=G,We.onMouseLeave=Z)),Ve||($e.onFocus=Wy(xi,$e.onFocus),$e.onBlur=Wy(Kr,$e.onBlur),en||(We.onFocus=xi,We.onBlur=Kr));const qe=q.useMemo(()=>{var Ut;let zn=[{name:"arrow",enabled:!!Ae,options:{element:Ae,padding:4}}];return(Ut=Je.popperOptions)!=null&&Ut.modifiers&&(zn=zn.concat(Je.popperOptions.modifiers)),ie({},Je.popperOptions,{modifiers:zn})},[Ae,Je]),At=ie({},ne,{isRtl:vn,arrow:re,disableInteractive:en,placement:bt,PopperComponentProp:Jt,touch:En.current}),nn=Die(At),Ot=(r=(i=sn.popper)!=null?i:xe.Popper)!=null?r:Fie,dt=(o=(h=(l=sn.transition)!=null?l:xe.Transition)!=null?h:hn)!=null?o:g_,Nt=(m=(_=sn.tooltip)!=null?_:xe.Tooltip)!=null?m:Nie,xn=(E=(T=sn.arrow)!=null?T:xe.Arrow)!=null?E:Bie,bn=Pp(Ot,ie({},Je,(A=Et.popper)!=null?A:fe.popper,{className:rn(nn.popper,Je==null?void 0:Je.className,(L=(R=Et.popper)!=null?R:fe.popper)==null?void 0:L.className)}),At),pn=Pp(dt,ie({},$t,(D=Et.transition)!=null?D:fe.transition),At),yn=Pp(Nt,ie({},(W=Et.tooltip)!=null?W:fe.tooltip,{className:rn(nn.tooltip,(z=(N=Et.tooltip)!=null?N:fe.tooltip)==null?void 0:z.className)}),At),Ar=Pp(xn,ie({},(F=Et.arrow)!=null?F:fe.arrow,{className:rn(nn.arrow,($=(K=Et.arrow)!=null?K:fe.arrow)==null?void 0:$.className)}),At);return Q.jsxs(q.Fragment,{children:[q.cloneElement(Ft,$e),Q.jsx(Ot,ie({as:Jt??Tz,placement:bt,anchorEl:Ge?{getBoundingClientRect:()=>({top:yp.y,left:yp.x,right:yp.x,bottom:yp.y,width:0,height:0})}:pt,popperRef:Se,open:pt?gn:!1,id:mn,transition:!0},We,bn,{popperOptions:qe,children:({TransitionProps:Ut})=>Q.jsx(dt,ie({timeout:wn.transitions.duration.shorter},Ut,pn,{children:Q.jsxs(Nt,ie({},yn,{children:[Qt,re?Q.jsx(xn,ie({},Ar,{ref:Ct})):null]}))}))}))]})}),KM=Uie,Vie=q.createContext({}),Dv=Vie,jie=q.createContext({}),TS=jie;function $ie(t){return Nn("MuiStep",t)}kn("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const Gie=["active","children","className","component","completed","disabled","expanded","index","last"],Wie=t=>{const{classes:e,orientation:n,alternativeLabel:r,completed:i}=t;return Un({root:["root",n,r&&"alternativeLabel",i&&"completed"]},$ie,e)},Hie=vt("div",{name:"MuiStep",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.orientation],n.alternativeLabel&&e.alternativeLabel,n.completed&&e.completed]}})(({ownerState:t})=>ie({},t.orientation==="horizontal"&&{paddingLeft:8,paddingRight:8},t.alternativeLabel&&{flex:1,position:"relative"})),qie=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiStep"}),{active:i,children:o,className:h,component:l="div",completed:m,disabled:_,expanded:E=!1,index:T,last:A}=r,L=Yt(r,Gie),{activeStep:R,connector:D,alternativeLabel:W,orientation:z,nonLinear:N}=q.useContext(Dv);let[F=!1,$=!1,K=!1]=[i,m,_];R===T?F=i!==void 0?i:!0:!N&&R>T?$=m!==void 0?m:!0:!N&&R<T&&(K=_!==void 0?_:!0);const ne=q.useMemo(()=>({index:T,last:A,expanded:E,icon:T+1,active:F,completed:$,disabled:K}),[T,A,E,F,$,K]),re=ie({},r,{active:F,orientation:z,alternativeLabel:W,completed:$,disabled:K,expanded:E,component:l}),be=Wie(re),xe=Q.jsxs(Hie,ie({as:l,className:rn(be.root,h),ref:n,ownerState:re},L,{children:[D&&W&&T!==0?D:null,o]}));return Q.jsx(TS.Provider,{value:ne,children:D&&!W&&T!==0?Q.jsxs(q.Fragment,{children:[D,xe]}):xe})}),sb=qie,Zie=fo(Q.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),Xie=fo(Q.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function Yie(t){return Nn("MuiStepIcon",t)}const Kie=kn("MuiStepIcon",["root","active","completed","error","text"]),ob=Kie;var JM;const Jie=["active","className","completed","error","icon"],Qie=t=>{const{classes:e,active:n,completed:r,error:i}=t;return Un({root:["root",n&&"active",r&&"completed",i&&"error"],text:["text"]},Yie,e)},ab=vt(Xw,{name:"MuiStepIcon",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>({display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),color:(t.vars||t).palette.text.disabled,[`&.${ob.completed}`]:{color:(t.vars||t).palette.primary.main},[`&.${ob.active}`]:{color:(t.vars||t).palette.primary.main},[`&.${ob.error}`]:{color:(t.vars||t).palette.error.main}})),ese=vt("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(t,e)=>e.text})(({theme:t})=>({fill:(t.vars||t).palette.primary.contrastText,fontSize:t.typography.caption.fontSize,fontFamily:t.typography.fontFamily})),tse=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiStepIcon"}),{active:i=!1,className:o,completed:h=!1,error:l=!1,icon:m}=r,_=Yt(r,Jie),E=ie({},r,{active:i,completed:h,error:l}),T=Qie(E);if(typeof m=="number"||typeof m=="string"){const A=rn(o,T.root);return l?Q.jsx(ab,ie({as:Xie,className:A,ref:n,ownerState:E},_)):h?Q.jsx(ab,ie({as:Zie,className:A,ref:n,ownerState:E},_)):Q.jsxs(ab,ie({className:A,ref:n,ownerState:E},_,{children:[JM||(JM=Q.jsx("circle",{cx:"12",cy:"12",r:"12"})),Q.jsx(ese,{className:T.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:E,children:m})]}))}return m}),nse=tse;function rse(t){return Nn("MuiStepLabel",t)}const ise=kn("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),ac=ise,sse=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],ose=t=>{const{classes:e,orientation:n,active:r,completed:i,error:o,disabled:h,alternativeLabel:l}=t;return Un({root:["root",n,o&&"error",h&&"disabled",l&&"alternativeLabel"],label:["label",r&&"active",i&&"completed",o&&"error",h&&"disabled",l&&"alternativeLabel"],iconContainer:["iconContainer",r&&"active",i&&"completed",o&&"error",h&&"disabled",l&&"alternativeLabel"],labelContainer:["labelContainer",l&&"alternativeLabel"]},rse,e)},ase=vt("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.orientation]]}})(({ownerState:t})=>ie({display:"flex",alignItems:"center",[`&.${ac.alternativeLabel}`]:{flexDirection:"column"},[`&.${ac.disabled}`]:{cursor:"default"}},t.orientation==="vertical"&&{textAlign:"left",padding:"8px 0"})),lse=vt("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(t,e)=>e.label})(({theme:t})=>ie({},t.typography.body2,{display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),[`&.${ac.active}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${ac.completed}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${ac.alternativeLabel}`]:{marginTop:16},[`&.${ac.error}`]:{color:(t.vars||t).palette.error.main}})),cse=vt("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(t,e)=>e.iconContainer})(()=>({flexShrink:0,display:"flex",paddingRight:8,[`&.${ac.alternativeLabel}`]:{paddingRight:0}})),use=vt("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(t,e)=>e.labelContainer})(({theme:t})=>({width:"100%",color:(t.vars||t).palette.text.secondary,[`&.${ac.alternativeLabel}`]:{textAlign:"center"}})),Xz=q.forwardRef(function(e,n){var r;const i=Bn({props:e,name:"MuiStepLabel"}),{children:o,className:h,componentsProps:l={},error:m=!1,icon:_,optional:E,slotProps:T={},StepIconComponent:A,StepIconProps:L}=i,R=Yt(i,sse),{alternativeLabel:D,orientation:W}=q.useContext(Dv),{active:z,disabled:N,completed:F,icon:$}=q.useContext(TS),K=_||$;let ne=A;K&&!ne&&(ne=nse);const re=ie({},i,{active:z,alternativeLabel:D,completed:F,disabled:N,error:m,orientation:W}),be=ose(re),xe=(r=T.label)!=null?r:l.label;return Q.jsxs(ase,ie({className:rn(be.root,h),ref:n,ownerState:re},R,{children:[K||ne?Q.jsx(cse,{className:be.iconContainer,ownerState:re,children:Q.jsx(ne,ie({completed:F,active:z,error:m,icon:K},L))}):null,Q.jsxs(use,{className:be.labelContainer,ownerState:re,children:[o?Q.jsx(lse,ie({ownerState:re},xe,{className:rn(be.label,xe==null?void 0:xe.className),children:o})):null,E]})]}))});Xz.muiName="StepLabel";const lb=Xz;function hse(t){return Nn("MuiStepConnector",t)}kn("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const dse=["className"],fse=t=>{const{classes:e,orientation:n,alternativeLabel:r,active:i,completed:o,disabled:h}=t,l={root:["root",n,r&&"alternativeLabel",i&&"active",o&&"completed",h&&"disabled"],line:["line",`line${qt(n)}`]};return Un(l,hse,e)},pse=vt("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.orientation],n.alternativeLabel&&e.alternativeLabel,n.completed&&e.completed]}})(({ownerState:t})=>ie({flex:"1 1 auto"},t.orientation==="vertical"&&{marginLeft:12},t.alternativeLabel&&{position:"absolute",top:8+4,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})),mse=vt("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.line,e[`line${qt(n.orientation)}`]]}})(({ownerState:t,theme:e})=>{const n=e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[600];return ie({display:"block",borderColor:e.vars?e.vars.palette.StepConnector.border:n},t.orientation==="horizontal"&&{borderTopStyle:"solid",borderTopWidth:1},t.orientation==="vertical"&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})}),gse=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiStepConnector"}),{className:i}=r,o=Yt(r,dse),{alternativeLabel:h,orientation:l="horizontal"}=q.useContext(Dv),{active:m,disabled:_,completed:E}=q.useContext(TS),T=ie({},r,{alternativeLabel:h,orientation:l,active:m,completed:E,disabled:_}),A=fse(T);return Q.jsx(pse,ie({className:rn(A.root,i),ref:n,ownerState:T},o,{children:Q.jsx(mse,{className:A.line,ownerState:T})}))}),yse=gse;function _se(t){return Nn("MuiStepper",t)}kn("MuiStepper",["root","horizontal","vertical","alternativeLabel"]);const vse=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],xse=t=>{const{orientation:e,alternativeLabel:n,classes:r}=t;return Un({root:["root",e,n&&"alternativeLabel"]},_se,r)},bse=vt("div",{name:"MuiStepper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.orientation],n.alternativeLabel&&e.alternativeLabel]}})(({ownerState:t})=>ie({display:"flex"},t.orientation==="horizontal"&&{flexDirection:"row",alignItems:"center"},t.orientation==="vertical"&&{flexDirection:"column"},t.alternativeLabel&&{alignItems:"flex-start"})),wse=Q.jsx(yse,{}),Ese=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiStepper"}),{activeStep:i=0,alternativeLabel:o=!1,children:h,className:l,component:m="div",connector:_=wse,nonLinear:E=!1,orientation:T="horizontal"}=r,A=Yt(r,vse),L=ie({},r,{alternativeLabel:o,orientation:T,component:m}),R=xse(L),D=q.Children.toArray(h).filter(Boolean),W=D.map((N,F)=>q.cloneElement(N,ie({index:F,last:F+1===D.length},N.props))),z=q.useMemo(()=>({activeStep:i,alternativeLabel:o,connector:_,nonLinear:E,orientation:T}),[i,o,_,E,T]);return Q.jsx(Dv.Provider,{value:z,children:Q.jsx(bse,ie({as:m,ownerState:L,className:rn(R.root,l),ref:n},A,{children:W}))})}),Tse=Ese;function Sse(t){return Nn("MuiTextField",t)}kn("MuiTextField",["root"]);const Pse=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],Cse={standard:Fz,filled:Rz,outlined:Hz},Ase=t=>{const{classes:e}=t;return Un({root:["root"]},Sse,e)},Ise=vt(Oz,{name:"MuiTextField",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Mse=q.forwardRef(function(e,n){const r=Bn({props:e,name:"MuiTextField"}),{autoComplete:i,autoFocus:o=!1,children:h,className:l,color:m="primary",defaultValue:_,disabled:E=!1,error:T=!1,FormHelperTextProps:A,fullWidth:L=!1,helperText:R,id:D,InputLabelProps:W,inputProps:z,InputProps:N,inputRef:F,label:$,maxRows:K,minRows:ne,multiline:re=!1,name:be,onBlur:xe,onChange:fe,onFocus:Re,placeholder:Ve,required:Fe=!1,rows:ze,select:Ye=!1,SelectProps:je,type:tt,value:ke,variant:Ge="outlined"}=r,nt=Yt(r,Pse),Dt=ie({},r,{autoFocus:o,color:m,disabled:E,error:T,fullWidth:L,multiline:re,required:Fe,select:Ye,variant:Ge}),ht=Ase(Dt),ot={};Ge==="outlined"&&(W&&typeof W.shrink<"u"&&(ot.notched=W.shrink),ot.label=$),Ye&&((!je||!je.native)&&(ot.id=void 0),ot["aria-describedby"]=void 0);const ct=UT(D),xt=R&&ct?`${ct}-helper-text`:void 0,bt=$&&ct?`${ct}-label`:void 0,Jt=Cse[Ge],Je=Q.jsx(Jt,ie({"aria-describedby":xt,autoComplete:i,autoFocus:o,defaultValue:_,fullWidth:L,multiline:re,name:be,rows:ze,maxRows:K,minRows:ne,type:tt,value:ke,id:ct,inputRef:F,onBlur:xe,onChange:fe,onFocus:Re,placeholder:Ve,inputProps:z},ot,N));return Q.jsxs(Ise,ie({className:rn(ht.root,l),disabled:E,error:T,fullWidth:L,ref:n,required:Fe,color:m,variant:Ge,ownerState:Dt},nt,{children:[$!=null&&$!==""&&Q.jsx(Nz,ie({htmlFor:ct,id:bt},W,{children:$})),Ye?Q.jsx(Zz,ie({"aria-describedby":xt,id:ct,labelId:bt,value:ke,input:Je},je,{children:h})):Je,R&&Q.jsx(fne,ie({id:xt},A,{children:R}))]}))}),kse=Mse,Lse="linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(135deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(135deg, transparent 75%, #ccc 75%) /*! @noflip */",Rse="linear-gradient(to top, #000000, transparent), linear-gradient(to right, #ffffff, transparent) /*! @noflip */",Ose={Button:vt(Yl)(()=>({backgroundSize:"8px 8px",backgroundPosition:"0 0, 4px 0, 4px -4px, 0px 4px",transition:"none",boxShadow:"0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08)",border:0,borderRadius:4,width:"24px",aspectRatio:"1 / 1",height:"24px",minWidth:0}))},zse=t=>{const{bgColor:e,className:n,disablePopover:r,isBgColorValid:i,...o}=t;return Q.jsx(Ose.Button,{disableTouchRipple:!0,style:{backgroundColor:i?e:void 0,backgroundImage:i?void 0:Lse,cursor:r?"default":void 0},className:`MuiColorInput-Button ${n||""}`,...o})},Dse={Container:vt("div")(()=>({width:300,padding:8}))},Fse=({children:t,className:e,position:n="start",...r})=>Q.jsx(Vz,{className:`MuiColorInput-Popover ${e||""}`,anchorOrigin:{vertical:"bottom",horizontal:n==="start"?"left":"right"},transformOrigin:{vertical:"top",horizontal:n==="start"?"left":"right"},...r,children:Q.jsx(Dse.Container,{children:t})}),Nse={Slider:vt(ES,{shouldForwardProp:t=>t!=="$rgbaFrom"&&t!=="$rgbaTo"})(()=>({height:8,"& .MuiSlider-rail":{opacity:1,background:"linear-gradient(to right, rgba(var(--rgb-r), var(--rgb-g), var(--rgb-b), 0) 0%, rgba(var(--rgb-r), var(--rgb-g), var(--rgb-b), 1) 100%)"},"& .MuiSlider-track":{color:"transparent",border:0},"& .MuiSlider-thumb":{backgroundColor:"#ffffff",border:"3px solid currentColor"}}))},Bse=t=>{const{rgbColor:e,style:n,className:r,...i}=t,o={"--rgb-r":e.r,"--rgb-g":e.g,"--rgb-b":e.b,...n};return Q.jsx(Nse.Slider,{className:`MuiColorInput-AlphaSlider ${r||""}`,style:o,...i})},Hy={up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"},Use={ArrowUp:{type:"hsvV",value:1},ArrowDown:{type:"hsvV",value:-1},ArrowLeft:{type:"hsvS",value:-1},ArrowRight:{type:"hsvS",value:1}};function Vse(t){return t===Hy.up||t===Hy.down||t===Hy.left||t===Hy.right}function y_(t,e,n){return Math.max(e,Math.min(t,n))}function QM(t){return typeof t=="number"}function ek(t,e,n){const r=t.toLocaleString("en",{useGrouping:!1,minimumFractionDigits:e,maximumFractionDigits:n});return Number(r)}function jse(t,e,n){const r=t.getBoundingClientRect(),i=e-r.left,o=n-r.top;return{x:y_(i/r.width,0,1),y:y_(1-o/r.height,0,1)}}function $se(t){const e=cr.useRef();return e.current=t,cr.useCallback((...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}const tk={Space:vt("div")(()=>({width:"100%",height:"180px",boxSizing:"border-box",outline:0,position:"relative",backgroundImage:Rse})),Thumb:vt("div")(()=>({position:"absolute",border:"3px solid #ffffff",borderRadius:"50%",width:"20px",height:"20px",marginLeft:"-10px /*! @noflip */",marginBottom:"-10px /*! @noflip */",outline:0,boxSizing:"border-box",willChange:"left, bottom",transition:"box-shadow 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms","&:hover":{boxShadow:"0px 0px 0px 4px rgba(255 255 255 / 0.16)"},"&.MuiColorInput-Thumb-active":{boxShadow:"0px 0px 0px 8px rgba(255 255 255 / 0.16)"},"@media (hover: none)":{boxShadow:"none"}}))},Gse=t=>{const{hsv:e,onChange:n,currentHue:r}=t,i=cr.useRef(!1),o=cr.useRef(null),[h,l]=cr.useState(!1),m=$se((D,W)=>{if(!o.current)return;const{x:z,y:N}=jse(o.current,D,W);n({s:z,v:N}),o.current&&document.activeElement!==o.current&&o.current.focus()}),_=cr.useCallback(()=>{i.current&&(i.current=!1,l(!1))},[]),E=cr.useCallback(D=>{i.current&&m(D.clientX,D.clientY)},[]);cr.useEffect(()=>(document.addEventListener("pointermove",E,!1),document.addEventListener("pointerup",_,!1),()=>{document.removeEventListener("pointermove",E,!1),document.removeEventListener("pointerup",_,!1)}),[_,E]);const T=D=>{D.preventDefault(),i.current=!0,m(D.clientX,D.clientY),l(!0)},A=D=>{if(Vse(D.key)){D.preventDefault();const{type:W,value:z}=Use[D.key],N=D.shiftKey?10:1,F=W==="hsvS"?e.s:e.v,$=y_(F+z*N*.01,0,1);l(!0),n({s:W==="hsvS"?$:e.s,v:W==="hsvV"?$:e.v})}},L=e.s*100,R=e.v*100;return Q.jsx(tk.Space,{onPointerDown:T,ref:o,className:"MuiColorInput-ColorSpace",style:{backgroundColor:`hsl(${r} 100% 50%)`,touchAction:"none"},role:"slider","aria-valuetext":`Saturation ${ek(L,0,0)}%, Brightness ${ek(R,0,0)}%`,onKeyDown:A,tabIndex:0,children:Q.jsx(tk.Thumb,{"aria-label":"Color space thumb",className:h?"MuiColorInput-Thumb-active":"",style:{left:`${L}%`,bottom:`${R}%`}})})},Wse={Slider:vt(ES)(()=>({height:8,"& .MuiSlider-rail":{opacity:1,background:"linear-gradient(to right, rgb(255, 0, 0) 0%, rgb(255, 255, 0) 17%, rgb(0, 255, 0) 33%, rgb(0, 255, 255) 50%, rgb(0, 0, 255) 67%, rgb(255, 0, 255) 83%, rgb(255, 0, 0) 100%) /*! @noflip */"},"& .MuiSlider-track":{color:"transparent",border:0},"& .MuiSlider-thumb":{backgroundColor:"#ffffff",border:"3px solid currentColor"}}))},Hse=t=>{const{className:e,...n}=t;return Q.jsx(Wse.Slider,{className:`MuiColorInput-HueSlider ${e||""}`,...n})};function qse(t){return typeof t=="string"}function ji(t,e){Zse(t)&&(t="100%");const n=Xse(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function qy(t){return Math.min(1,Math.max(0,t))}function Zse(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function Xse(t){return typeof t=="string"&&t.indexOf("%")!==-1}function Yz(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Zy(t){return Number(t)<=1?`${Number(t)*100}%`:t}function du(t){return t.length===1?"0"+t:String(t)}function Yse(t,e,n){return{r:ji(t,255)*255,g:ji(e,255)*255,b:ji(n,255)*255}}function nk(t,e,n){t=ji(t,255),e=ji(e,255),n=ji(n,255);const r=Math.max(t,e,n),i=Math.min(t,e,n);let o=0,h=0;const l=(r+i)/2;if(r===i)h=0,o=0;else{const m=r-i;switch(h=l>.5?m/(2-r-i):m/(r+i),r){case t:o=(e-n)/m+(e<n?6:0);break;case e:o=(n-t)/m+2;break;case n:o=(t-e)/m+4;break}o/=6}return{h:o,s:h,l}}function cb(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Kse(t,e,n){let r,i,o;if(t=ji(t,360),e=ji(e,100),n=ji(n,100),e===0)i=n,o=n,r=n;else{const h=n<.5?n*(1+e):n+e-n*e,l=2*n-h;r=cb(l,h,t+1/3),i=cb(l,h,t),o=cb(l,h,t-1/3)}return{r:r*255,g:i*255,b:o*255}}function rk(t,e,n){t=ji(t,255),e=ji(e,255),n=ji(n,255);const r=Math.max(t,e,n),i=Math.min(t,e,n);let o=0;const h=r,l=r-i,m=r===0?0:l/r;if(r===i)o=0;else{switch(r){case t:o=(e-n)/l+(e<n?6:0);break;case e:o=(n-t)/l+2;break;case n:o=(t-e)/l+4;break}o/=6}return{h:o,s:m,v:h}}function Jse(t,e,n){t=ji(t,360)*6,e=ji(e,100),n=ji(n,100);const r=Math.floor(t),i=t-r,o=n*(1-e),h=n*(1-i*e),l=n*(1-(1-i)*e),m=r%6,_=[n,h,o,o,l,n][m],E=[l,n,n,h,o,o][m],T=[o,o,l,n,n,h][m];return{r:_*255,g:E*255,b:T*255}}function ik(t,e,n,r){const i=[du(Math.round(t).toString(16)),du(Math.round(e).toString(16)),du(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function Qse(t,e,n,r,i){const o=[du(Math.round(t).toString(16)),du(Math.round(e).toString(16)),du(Math.round(n).toString(16)),du(eoe(r))];return i&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))&&o[3].startsWith(o[3].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function eoe(t){return Math.round(parseFloat(t)*255).toString(16)}function sk(t){return Xs(t)/255}function Xs(t){return parseInt(t,16)}function toe(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}const iE={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function noe(t){let e={r:0,g:0,b:0},n=1,r=null,i=null,o=null,h=!1,l=!1;return typeof t=="string"&&(t=soe(t)),typeof t=="object"&&(el(t.r)&&el(t.g)&&el(t.b)?(e=Yse(t.r,t.g,t.b),h=!0,l=String(t.r).substr(-1)==="%"?"prgb":"rgb"):el(t.h)&&el(t.s)&&el(t.v)?(r=Zy(t.s),i=Zy(t.v),e=Jse(t.h,r,i),h=!0,l="hsv"):el(t.h)&&el(t.s)&&el(t.l)&&(r=Zy(t.s),o=Zy(t.l),e=Kse(t.h,r,o),h=!0,l="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=Yz(n),{ok:h,format:t.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}const roe="[-\\+]?\\d+%?",ioe="[-\\+]?\\d*\\.\\d+%?",lc=`(?:${ioe})|(?:${roe})`,ub=`[\\s|\\(]+(${lc})[,|\\s]+(${lc})[,|\\s]+(${lc})\\s*\\)?`,hb=`[\\s|\\(]+(${lc})[,|\\s]+(${lc})[,|\\s]+(${lc})[,|\\s]+(${lc})\\s*\\)?`,Ko={CSS_UNIT:new RegExp(lc),rgb:new RegExp("rgb"+ub),rgba:new RegExp("rgba"+hb),hsl:new RegExp("hsl"+ub),hsla:new RegExp("hsla"+hb),hsv:new RegExp("hsv"+ub),hsva:new RegExp("hsva"+hb),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function soe(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;let e=!1;if(iE[t])t=iE[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};let n=Ko.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=Ko.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Ko.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=Ko.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Ko.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=Ko.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Ko.hex8.exec(t),n?{r:Xs(n[1]),g:Xs(n[2]),b:Xs(n[3]),a:sk(n[4]),format:e?"name":"hex8"}:(n=Ko.hex6.exec(t),n?{r:Xs(n[1]),g:Xs(n[2]),b:Xs(n[3]),format:e?"name":"hex"}:(n=Ko.hex4.exec(t),n?{r:Xs(n[1]+n[1]),g:Xs(n[2]+n[2]),b:Xs(n[3]+n[3]),a:sk(n[4]+n[4]),format:e?"name":"hex8"}:(n=Ko.hex3.exec(t),n?{r:Xs(n[1]+n[1]),g:Xs(n[2]+n[2]),b:Xs(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function el(t){return!!Ko.CSS_UNIT.exec(String(t))}class lr{constructor(e="",n={}){if(e instanceof lr)return e;typeof e=="number"&&(e=toe(e)),this.originalInput=e;const r=noe(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=n.format??r.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}getBrightness(){const e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3}getLuminance(){const e=this.toRgb();let n,r,i;const o=e.r/255,h=e.g/255,l=e.b/255;return o<=.03928?n=o/12.92:n=Math.pow((o+.055)/1.055,2.4),h<=.03928?r=h/12.92:r=Math.pow((h+.055)/1.055,2.4),l<=.03928?i=l/12.92:i=Math.pow((l+.055)/1.055,2.4),.2126*n+.7152*r+.0722*i}getAlpha(){return this.a}setAlpha(e){return this.a=Yz(e),this.roundA=Math.round(100*this.a)/100,this}isMonochrome(){const{s:e}=this.toHsl();return e===0}toHsv(){const e=rk(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}}toHsvString(){const e=rk(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this.a===1?`hsv(${n}, ${r}%, ${i}%)`:`hsva(${n}, ${r}%, ${i}%, ${this.roundA})`}toHsl(){const e=nk(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}}toHslString(){const e=nk(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this.a===1?`hsl(${n}, ${r}%, ${i}%)`:`hsla(${n}, ${r}%, ${i}%, ${this.roundA})`}toHex(e=!1){return ik(this.r,this.g,this.b,e)}toHexString(e=!1){return"#"+this.toHex(e)}toHex8(e=!1){return Qse(this.r,this.g,this.b,this.a,e)}toHex8String(e=!1){return"#"+this.toHex8(e)}toHexShortString(e=!1){return this.a===1?this.toHexString(e):this.toHex8String(e)}toRgb(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}}toRgbString(){const e=Math.round(this.r),n=Math.round(this.g),r=Math.round(this.b);return this.a===1?`rgb(${e}, ${n}, ${r})`:`rgba(${e}, ${n}, ${r}, ${this.roundA})`}toPercentageRgb(){const e=n=>`${Math.round(ji(n,255)*100)}%`;return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}}toPercentageRgbString(){const e=n=>Math.round(ji(n,255)*100);return this.a===1?`rgb(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%)`:`rgba(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%, ${this.roundA})`}toName(){if(this.a===0)return"transparent";if(this.a<1)return!1;const e="#"+ik(this.r,this.g,this.b,!1);for(const[n,r]of Object.entries(iE))if(e===r)return n;return!1}toString(e){const n=!!e;e=e??this.format;let r=!1;const i=this.a<1&&this.a>=0;return!n&&i&&(e.startsWith("hex")||e==="name")?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())}toNumber(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)}clone(){return new lr(this.toString())}lighten(e=10){const n=this.toHsl();return n.l+=e/100,n.l=qy(n.l),new lr(n)}brighten(e=10){const n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new lr(n)}darken(e=10){const n=this.toHsl();return n.l-=e/100,n.l=qy(n.l),new lr(n)}tint(e=10){return this.mix("white",e)}shade(e=10){return this.mix("black",e)}desaturate(e=10){const n=this.toHsl();return n.s-=e/100,n.s=qy(n.s),new lr(n)}saturate(e=10){const n=this.toHsl();return n.s+=e/100,n.s=qy(n.s),new lr(n)}greyscale(){return this.desaturate(100)}spin(e){const n=this.toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,new lr(n)}mix(e,n=50){const r=this.toRgb(),i=new lr(e).toRgb(),o=n/100,h={r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a};return new lr(h)}analogous(e=6,n=30){const r=this.toHsl(),i=360/n,o=[this];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,o.push(new lr(r));return o}complement(){const e=this.toHsl();return e.h=(e.h+180)%360,new lr(e)}monochromatic(e=6){const n=this.toHsv(),{h:r}=n,{s:i}=n;let{v:o}=n;const h=[],l=1/e;for(;e--;)h.push(new lr({h:r,s:i,v:o})),o=(o+l)%1;return h}splitcomplement(){const e=this.toHsl(),{h:n}=e;return[this,new lr({h:(n+72)%360,s:e.s,l:e.l}),new lr({h:(n+216)%360,s:e.s,l:e.l})]}onBackground(e){const n=this.toRgb(),r=new lr(e).toRgb(),i=n.a+r.a*(1-n.a);return new lr({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})}triad(){return this.polyad(3)}tetrad(){return this.polyad(4)}polyad(e){const n=this.toHsl(),{h:r}=n,i=[this],o=360/e;for(let h=1;h<e;h++)i.push(new lr({h:(r+h*o)%360,s:n.s,l:n.l}));return i}equals(e){return this.toRgbString()===new lr(e).toRgbString()}}function hd(t,e){return t.toString(e)}function ok(t,e,n){return new lr(t,n)}function ooe(t){return qse(t)?t:new lr(t).toString()}const aoe=t=>{const{currentColor:e,format:n,onChange:r,isAlphaHidden:i}=t,[o,h]=cr.useState(e.toHsv()),l=(E,T)=>{if(!QM(T))return;const A=y_(360*T/100,0,359);h(R=>({...R,h:A}));const L=new lr({...o,a:e.toHsv().a,h:A});r==null||r(hd(L,n))},m=(E,T)=>{if(!QM(T))return;const A=e.clone().setAlpha(T);r==null||r(hd(A,n))},_=({s:E,v:T})=>{const A=new lr({h:o.h,a:e.toHsv().a,s:E,v:T});h(L=>({...L,s:E,v:T})),r==null||r(hd(A,n))};return Q.jsxs(eb,{className:"MuiColorInput-PopoverBody",children:[Q.jsx(Gse,{currentHue:o.h,hsv:o,onChange:_}),Q.jsx(eb,{mt:"10px",px:"3px",children:Q.jsx(Hse,{min:0,max:100,step:1,onChange:l,"aria-label":"hue",value:o.h*100/360})}),i?null:Q.jsx(eb,{mt:"10px",px:"3px",children:Q.jsx(Bse,{min:0,max:1,step:.01,"aria-label":"alpha",rgbColor:e.toRgb(),onChange:m,value:e.getAlpha()})})]})},loe=cr.forwardRef((t,e)=>{const{className:n,...r}=t;return Q.jsx(kse,{className:`MuiColorInput-TextField ${n||""}`,ref:e,...r})}),coe="black",uoe="rgb";function hoe(t){return typeof t=="object"&&!Array.isArray(t)&&t!==null}function ak(t,e){typeof e=="function"?e(t):e&&hoe(e)&&"current"in e&&(e.current=t)}const zh=cr.forwardRef((t,e)=>{const{value:n,format:r,onChange:i,adornmentPosition:o="start",PopoverProps:h,Adornment:l=zse,fallbackValue:m,isAlphaHidden:_,disablePopover:E,...T}=t,{onBlur:A,InputProps:L,...R}=T,{onClose:D,...W}=h||{},z=m||coe,N=R.disabled||(L==null?void 0:L.disabled)||!1,F=cr.useRef(null),$=cr.useRef(null),[K,ne]=cr.useState(null),re=r||uoe,be=ok(n,z,{format:re}),[xe,fe]=cr.useState(n),[Re,Ve]=cr.useState(n),Fe=xt=>{xt.preventDefault(),xt.stopPropagation(),!N&&!E&&ne(F.current)},ze=xt=>{const bt=new lr(xt);i==null||i(xt,{hex:bt.isValid?bt.toHexString():"",hsv:bt.isValid?bt.toHsvString():"",hsl:bt.isValid?bt.toHslString():"",rgb:bt.isValid?bt.toRgbString():"",hex8:bt.isValid?bt.toHex8String():""})},Ye=xt=>{const bt=xt.target.value;if(fe(bt),bt==="")Ve(""),ze("");else{const Jt=new lr(bt),Je=hd(Jt,re);Ve(Je),ze(Je)}},je=(...xt)=>{D==null||D(...xt),ne(null),queueMicrotask(()=>{var bt;(bt=$.current)==null||bt.focus()})},tt=xt=>{A==null||A(xt);const bt=new lr(xe);if(bt.isValid)bt.format!==re&&fe(hd(bt,re));else{if(xe==="")return;const Jt=new lr(z),Je=hd(Jt,re);fe(Je),Ve(Je),ze(Je)}};cr.useEffect(()=>{if(n!==Re){const xt=ok(n).originalInput;Ve(xt),fe(xt)}},[n,Re,z]);const ke=xt=>{fe(xt),Ve(xt),ze(xt)},Ge=xt=>{F.current=xt,e&&ak(xt,e)},nt=xt=>{$.current=xt,$&&ak(xt,$)},Dt=!!K,ht=Dt?"color-popover":void 0,ot=Q.jsx(zne,{position:o,children:Q.jsx(l,{disabled:N,"aria-describedby":ht,disablePopover:E||!1,component:E?"span":void 0,bgColor:be.toString(),isBgColorValid:!!(xe!==""&&be.isValid),onClick:E?void 0:Fe})}),ct=o==="start"?{startAdornment:ot}:{endAdornment:ot};return Q.jsxs(Q.Fragment,{children:[Q.jsx(loe,{ref:Ge,spellCheck:"false",type:"text",autoComplete:"off",onChange:Ye,value:ooe(xe),onBlur:tt,inputRef:nt,disabled:N,InputProps:{...ct,...L},...R}),E?null:Q.jsx(Fse,{id:ht,open:Dt,position:o,anchorEl:K,onClose:je,...W,children:Q.jsx(aoe,{onChange:ke,currentColor:be,format:re,isAlphaHidden:_})})]})}),doe=fo(Q.jsx("path",{d:"m18 4 2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z"}),"Movie"),foe=fo(Q.jsx("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"}),"Pause"),poe=fo(Q.jsx("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),Dh=fo(Q.jsx("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay"),moe=fo(Q.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"}),"Settings"),goe=vt(ES)(()=>({color:"#46B780","& .MuiSlider-thumb":{"&:hover, &.Mui-focusVisible":{boxShadow:`0px 0px 0px 8px ${Ai("#46B780",.16)}`},"&.Mui-active":{boxShadow:`0px 0px 0px 14px ${Ai("#46B780",.16)}`}},"& .MuiSlider-rail":{color:"#A8AFB3",opacity:1}}));function db({disabled:t,value:e,min:n,max:r,step:i,onInput:o,onChange:h,onChangeCommited:l,defaultValue:m,marks:_,style:E}){return Q.jsx(goe,{disabled:t,value:e,min:n,max:r,step:i,onInput:o,onChangeCommitted:l,onChange:h,defaultValue:m,marks:_,style:E})}const yoe="./map_style.json",_oe={longitude:106.66,latitude:10.762,zoom:14,pitch:0,bearing:0},ou={startNodeFill:[70,183,128],startNodeBorder:[255,255,255],endNodeFill:[246,79,89],endNodeBorder:[0,0,0],path:[18,194,233],route:[246,79,89]},voe=[{name:"Ho Chi Minh City",latitude:10.762,longitude:106.66},{name:"New York",latitude:40.712,longitude:-74.006},{name:"Tokyo",latitude:35.682,longitude:139.759},{name:"Paris",latitude:48.856,longitude:2.352},{name:"Rome",latitude:41.902,longitude:12.496},{name:"Prague",latitude:50.086,longitude:14.42},{name:"London",latitude:51.507,longitude:-.127},{name:"Dubai",latitude:25.276,longitude:55.296},{name:"Singapore",latitude:1.352,longitude:103.82},{name:"San Francisco",latitude:37.774,longitude:-122.419},{name:"Berlin",latitude:52.52,longitude:13.405},{name:"Sydney",latitude:-33.868,longitude:151.209},{name:"Amsterdam",latitude:52.367,longitude:4.9},{name:"Stockholm",latitude:59.329,longitude:18.068},{name:"Hong Kong",latitude:22.319,longitude:114.169},{name:"Rio de Janeiro",latitude:-22.906,longitude:-43.172},{name:"Shanghai",latitude:31.23,longitude:121.473},{name:"Barcelona",latitude:41.385,longitude:2.173}],Kz=q.forwardRef(({canStart:t,started:e,animationEnded:n,playbackOn:r,time:i,maxTime:o,settings:h,colors:l,loading:m,timeChanged:_,cinematic:E,placeEnd:T,changeRadius:A,changeAlgorithm:L,setPlaceEnd:R,setCinematic:D,setSettings:W,setColors:z,startPathFinding:N,toggleAnimation:F,clearPath:$,changeLocation:K},ne)=>{const[re,be]=q.useState(!1),[xe,fe]=q.useState({open:!1,message:"",type:"error"}),[Re,Ve]=q.useState(!1),[Fe,ze]=q.useState(0),[Ye,je]=q.useState(!1),[tt,ke]=q.useState(null),Ge=!!tt,nt=q.useRef(4800),Dt=q.useRef(!1),ht=q.useRef(!1);q.useImperativeHandle(ne,()=>({showSnack(Je,Et="error"){fe({open:!0,message:Je,type:Et})}}));function ot(){fe({...xe,open:!1})}function ct(){je(!1)}function xt(Je){if(Fe>=2&&Je>0){Ve(!1);return}ze(Math.max(Fe+Je,0))}function bt(){if(t){if(!e&&i===0){N();return}F()}}function Jt(){ke(null)}return window.onkeydown=Je=>{Je.code==="ArrowRight"&&!Dt.current&&!ht.current&&(!e||n)?(Dt.current=!0,F(!1,1)):Je.code==="ArrowLeft"&&!ht.current&&!Dt.current&&n&&(ht.current=!0,F(!1,-1))},window.onkeyup=Je=>{Je.code==="Escape"?D(!1):Je.code==="Space"?(Je.preventDefault(),bt()):Je.code==="ArrowRight"&&Dt.current?(Dt.current=!1,F(!1,1)):Je.code==="ArrowLeft"&&n&&ht.current?(ht.current=!1,F(!1,1)):Je.code==="KeyR"&&(n||!e)&&$()},q.useEffect(()=>{E&&(je(!0),setTimeout(()=>{nt.current=2500},200))},[E]),q.useEffect(()=>{localStorage.getItem("path_sawtutorial")||(Ve(!0),localStorage.setItem("path_sawtutorial",!0))},[]),Q.jsxs(Q.Fragment,{children:[Q.jsxs("div",{className:`nav-top ${E?"cinematic":""}`,children:[Q.jsxs("div",{className:"side slider-container",children:[Q.jsx(vs,{id:"playback-slider",gutterBottom:!0,children:"Animation playback"}),Q.jsx(db,{disabled:!n,value:n?i:o,min:n?0:-1,max:o,onChange:Je=>{_(Number(Je.target.value))},className:"slider","aria-labelledby":"playback-slider"})]}),Q.jsx(wa,{disabled:!t,onClick:bt,style:{backgroundColor:"#46B780",width:60,height:60},size:"large",children:!e||n&&!r?Q.jsx(poe,{style:{color:"#fff",width:26,height:26},fontSize:"inherit"}):Q.jsx(foe,{style:{color:"#fff",width:26,height:26},fontSize:"inherit"})}),Q.jsx("div",{className:"side",children:Q.jsx(Yl,{disabled:!n&&e,onClick:$,style:{color:"#fff",backgroundColor:"#404156",paddingInline:30,paddingBlock:7},variant:"contained",children:"Clear path"})})]}),Q.jsxs("div",{className:`nav-right ${E?"cinematic":""}`,children:[Q.jsx(KM,{title:"Open settings",children:Q.jsx(wa,{onClick:()=>{be(!0)},style:{backgroundColor:"#2A2B37",width:36,height:36},size:"large",children:Q.jsx(moe,{style:{color:"#fff",width:24,height:24},fontSize:"inherit"})})}),Q.jsx(KM,{title:"Cinematic mode",children:Q.jsx(wa,{className:"btn-cinematic",onClick:()=>{D(!E)},style:{backgroundColor:"#2A2B37",width:36,height:36},size:"large",children:Q.jsx(doe,{style:{color:"#fff",width:24,height:24},fontSize:"inherit"})})})]}),Q.jsx("div",{className:"loader-container",children:Q.jsx(Pz,{in:m,style:{transitionDelay:m?"50ms":"0ms"},unmountOnExit:!0,children:Q.jsx(Ste,{color:"inherit"})})}),Q.jsx(YM,{anchorOrigin:{vertical:"bottom",horizontal:"right"},open:xe.open,autoHideDuration:4e3,onClose:ot,children:Q.jsx(TJ,{onClose:ot,severity:xe.type,style:{width:"100%",color:"#fff"},children:xe.message})}),Q.jsx(YM,{anchorOrigin:{vertical:"top",horizontal:"center"},open:Ye,autoHideDuration:nt.current,onClose:ct,children:Q.jsxs("div",{className:"cinematic-alert",children:[Q.jsx(vs,{fontSize:"18px",children:Q.jsx("b",{children:"Cinematic mode"})}),Q.jsx(vs,{children:"Use keyboard shortcuts to control animation"}),Q.jsxs(vs,{children:["Press ",Q.jsx("b",{children:"Escape"})," to exit"]})]})}),Q.jsx("div",{className:"mobile-controls",children:Q.jsx(Yl,{onClick:()=>{R(!T)},style:{color:"#fff",backgroundColor:"#404156",paddingInline:30,paddingBlock:7},variant:"contained",children:T?"placing end node":"placing start node"})}),Q.jsx(Cz,{open:Re,onClick:Je=>{Je.target.classList.contains("backdrop")&&Ve(!1)},className:"backdrop",children:Q.jsxs("div",{className:"tutorial-container",children:[Q.jsxs(Tse,{activeStep:Fe,children:[Q.jsx(sb,{children:Q.jsx(lb,{children:"Basic controls"})}),Q.jsx(sb,{children:Q.jsx(lb,{children:"Playback controls"})}),Q.jsx(sb,{children:Q.jsx(lb,{children:"Changing settings"})})]}),Q.jsxs("div",{className:"content",children:[Q.jsx("h1",{children:"Map Path Finding Visualizer"}),Fe===0&&Q.jsxs("div",{children:[Q.jsxs("p",{children:[Q.jsx("b",{children:"Controls:"})," ",Q.jsx("br",{}),Q.jsx("b",{children:"Left button:"})," Place start node ",Q.jsx("br",{}),Q.jsx("b",{children:"Right button:"})," Place end node ",Q.jsx("br",{})]}),Q.jsx("p",{children:"The end node must be placed within the shown radius."}),Q.jsx("video",{className:"video",autoPlay:!0,muted:!0,loop:!0,children:Q.jsx("source",{src:"./videos/tutorial1.mp4",type:"video/mp4"})})]}),Fe===1&&Q.jsxs("div",{children:[Q.jsxs("p",{children:["To start the visualization, press the ",Q.jsx("b",{children:"Start Button"})," or press ",Q.jsx("b",{children:"Space"}),".",Q.jsx("br",{}),"A playback feature is available after the algorithm ends."]}),Q.jsx("video",{className:"video",autoPlay:!0,muted:!0,loop:!0,children:Q.jsx("source",{src:"./videos/tutorial2.mp4",type:"video/mp4"})})]}),Fe===2&&Q.jsxs("div",{children:[Q.jsxs("p",{children:["You can customize the settings of the animation in the ",Q.jsx("b",{children:"Settings Sidebar"}),". ",Q.jsx("br",{}),"Try to keep the area radius only as large as you need it to be. ",Q.jsx("br",{}),"Anything above ",Q.jsx("b",{children:"10km"})," is considered experimental, if you run into performance issues, stop the animation and clear the path."]}),Q.jsx("video",{className:"video",autoPlay:!0,muted:!0,loop:!0,children:Q.jsx("source",{src:"./videos/tutorial3.mp4",type:"video/mp4"})})]})]}),Q.jsxs("div",{className:"controls",children:[Q.jsx(Yl,{onClick:()=>{Ve(!1)},className:"close",variant:"outlined",style:{borderColor:"#9f9f9f",color:"#9f9f9f",paddingInline:15},children:"Close"}),Q.jsx(Yl,{onClick:()=>{xt(-1)},variant:"outlined",style:{borderColor:"#9f9f9f",color:"#9f9f9f",paddingInline:18},children:"Back"}),Q.jsx(Yl,{onClick:()=>{xt(1)},variant:"contained",style:{backgroundColor:"#46B780",color:"#fff",paddingInline:30,fontWeight:"bold"},children:Fe>=2?"Finish":"Next"})]})]})}),Q.jsx(Kte,{className:`side-drawer ${E?"cinematic":""}`,anchor:"left",open:re,onClose:()=>{be(!1)},children:Q.jsxs("div",{className:"sidebar-container",children:[Q.jsxs(Oz,{variant:"filled",children:[Q.jsx(Nz,{style:{fontSize:14},id:"algo-select",children:"Algorithm"}),Q.jsxs(Zz,{labelId:"algo-select",value:h.algorithm,onChange:Je=>{L(Je.target.value)},required:!0,style:{backgroundColor:"#404156",color:"#fff",width:"100%",paddingLeft:1},inputProps:{MenuProps:{MenuListProps:{sx:{backgroundColor:"#404156"}}}},size:"small",disabled:!n&&e,children:[Q.jsx(mp,{value:"astar",children:"A* algorithm"}),Q.jsx(mp,{value:"greedy",children:"Greedy algorithm"}),Q.jsx(mp,{value:"dijkstra",children:"Dijkstra's algorithm"}),Q.jsx(mp,{value:"bidirectional",children:"Bidirectional Search algorithm"})]})]}),Q.jsxs("div",{children:[Q.jsx(Yl,{id:"locations-button","aria-controls":Ge?"locations-menu":void 0,"aria-haspopup":"true","aria-expanded":Ge?"true":void 0,onClick:Je=>{ke(Je.currentTarget)},variant:"contained",disableElevation:!0,style:{backgroundColor:"#404156",color:"#fff",textTransform:"none",fontSize:16,paddingBlock:8,justifyContent:"start"},children:"Locations"}),Q.jsx(jz,{id:"locations-menu",anchorEl:tt,open:Ge,onClose:()=>{ke(null)},MenuListProps:{"aria-labelledby":"locations-button",sx:{backgroundColor:"#404156"}},anchorOrigin:{vertical:"top",horizontal:"right"},children:voe.map(Je=>Q.jsx(mp,{onClick:()=>{Jt(),K(Je)},children:Je.name},Je.name))})]}),Q.jsxs("div",{className:"side slider-container",children:[Q.jsxs(vs,{id:"area-slider",children:["Area radius: ",h.radius,"km (",(h.radius/1.609).toFixed(1),"mi)"]}),Q.jsx(db,{disabled:e&&!n,min:2,max:20,step:1,value:h.radius,onChangeCommited:()=>{A(h.radius)},onChange:Je=>{W({...h,radius:Number(Je.target.value)})},className:"slider","aria-labelledby":"area-slider",style:{marginBottom:1},marks:[{value:2,label:"2km"},{value:20,label:"20km"}]})]}),Q.jsxs("div",{className:"side slider-container",children:[Q.jsx(vs,{id:"speed-slider",children:"Animation speed"}),Q.jsx(db,{min:1,max:30,value:h.speed,onChange:Je=>{W({...h,speed:Number(Je.target.value)})},className:"slider","aria-labelledby":"speed-slider",style:{marginBottom:1}})]}),Q.jsxs("div",{className:"styles-container",children:[Q.jsx(vs,{style:{color:"#A8AFB3",textTransform:"uppercase",fontSize:14},children:"Styles"}),Q.jsxs("div",{children:[Q.jsx(vs,{id:"start-fill-label",children:"Start node fill color"}),Q.jsxs("div",{className:"color-container",children:[Q.jsx(zh,{value:Ah(l.startNodeFill),onChange:Je=>{z({...l,startNodeFill:Ch(Je)})},"aria-labelledby":"start-fill-label",style:{backgroundColor:"#404156"}}),Q.jsx(wa,{onClick:()=>{z({...l,startNodeFill:ou.startNodeFill})},style:{backgroundColor:"transparent"},size:"small",children:Q.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),Q.jsxs("div",{children:[Q.jsx(vs,{id:"start-border-label",children:"Start node border color"}),Q.jsxs("div",{className:"color-container",children:[Q.jsx(zh,{value:Ah(l.startNodeBorder),onChange:Je=>{z({...l,startNodeBorder:Ch(Je)})},"aria-labelledby":"start-border-label",style:{backgroundColor:"#404156"}}),Q.jsx(wa,{onClick:()=>{z({...l,startNodeBorder:ou.startNodeBorder})},style:{backgroundColor:"transparent"},size:"small",children:Q.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),Q.jsxs("div",{children:[Q.jsx(vs,{id:"end-fill-label",children:"End node fill color"}),Q.jsxs("div",{className:"color-container",children:[Q.jsx(zh,{value:Ah(l.endNodeFill),onChange:Je=>{z({...l,endNodeFill:Ch(Je)})},"aria-labelledby":"end-fill-label",style:{backgroundColor:"#404156"}}),Q.jsx(wa,{onClick:()=>{z({...l,endNodeFill:ou.endNodeFill})},style:{backgroundColor:"transparent"},size:"small",children:Q.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),Q.jsxs("div",{children:[Q.jsx(vs,{id:"end-border-label",children:"End node border color"}),Q.jsxs("div",{className:"color-container",children:[Q.jsx(zh,{value:Ah(l.endNodeBorder),onChange:Je=>{z({...l,endNodeBorder:Ch(Je)})},"aria-labelledby":"end-border-label",style:{backgroundColor:"#404156"}}),Q.jsx(wa,{onClick:()=>{z({...l,endNodeBorder:ou.endNodeBorder})},style:{backgroundColor:"transparent"},size:"small",children:Q.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),Q.jsxs("div",{children:[Q.jsx(vs,{id:"path-label",children:"Path color"}),Q.jsxs("div",{className:"color-container",children:[Q.jsx(zh,{value:Ah(l.path),onChange:Je=>{z({...l,path:Ch(Je)})},"aria-labelledby":"path-label",style:{backgroundColor:"#404156"}}),Q.jsx(wa,{onClick:()=>{z({...l,path:ou.path})},style:{backgroundColor:"transparent"},size:"small",children:Q.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]}),Q.jsxs("div",{children:[Q.jsx(vs,{id:"route-label",children:"Shortest route color"}),Q.jsxs("div",{className:"color-container",children:[Q.jsx(zh,{value:Ah(l.route),onChange:Je=>{z({...l,route:Ch(Je)})},"aria-labelledby":"route-label",style:{backgroundColor:"#404156"}}),Q.jsx(wa,{onClick:()=>{z({...l,route:ou.route})},style:{backgroundColor:"transparent"},size:"small",children:Q.jsx(Dh,{style:{color:"#fff",width:20,height:20},fontSize:"inherit"})})]})]})]}),Q.jsxs("div",{className:"shortcuts-container",children:[Q.jsx(vs,{style:{color:"#A8AFB3",textTransform:"uppercase",fontSize:14},children:"Shortcuts"}),Q.jsxs("div",{className:"shortcut",children:[Q.jsx("p",{children:"SPACE"}),Q.jsx("p",{children:"Start/Stop animation"})]}),Q.jsxs("div",{className:"shortcut",children:[Q.jsx("p",{children:"R"}),Q.jsx("p",{children:"Clear path"})]}),Q.jsxs("div",{className:"shortcut",children:[Q.jsx("p",{children:"Arrows"}),Q.jsx("p",{children:"Animation playback"})]}),Q.jsx(Yl,{onClick:()=>{ze(0),Ve(!0)},variant:"contained",style:{backgroundColor:"#404156",color:"#fff"},children:"Show tutorial"})]})]})}),Q.jsx("a",{href:"https://github.com/trinhminhtriet/path-finding","aria-label":"GitHub repository",target:"_blank",className:`github-corner ${E?"cinematic":""}`,children:Q.jsxs("svg",{width:"60",height:"60",viewBox:"0 0 250 250",children:[Q.jsx("path",{fill:"#2A2B37",d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}),Q.jsx("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",className:"octo-arm"}),Q.jsx("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",className:"octo-body"})]})})]})});Kz.displayName="Interface";function xoe(t,e,n,r,i,o){const[h,l]=q.useState(t),m=Date.now(),_=q.useRef();return q.useEffect(()=>{function E(){const A=Date.now()-m;if(A<r){const L=A/r,R=o?n+L*(e-n):e+L*(n-e);l(R),_.current=requestAnimationFrame(E)}else l(o?e:n)}if(i)return _.current=requestAnimationFrame(E),()=>{cancelAnimationFrame(_.current)}},[e,n,r,i,o]),h}function boe(){const[t,e]=q.useState(null),[n,r]=q.useState(null),[i,o]=q.useState([]),[h,l]=q.useState([]),[m,_]=q.useState(),[E,T]=q.useState(0),[A,L]=q.useState(!1),[R,D]=q.useState(!1),[W,z]=q.useState(1),[N,F]=q.useState(!1),[$,K]=q.useState(!1),[ne,re]=q.useState(!1),[be,xe]=q.useState(!1),[fe,Re]=q.useState({algorithm:"astar",radius:10,speed:10}),[Ve,Fe]=q.useState(ou),[ze,Ye]=q.useState(_oe),je=q.useRef(),tt=q.useRef(),ke=q.useRef(),Ge=q.useRef(),nt=q.useRef(0),Dt=q.useRef([]),ht=q.useRef(new jw),ot=q.useRef(null),ct=q.useRef(null),xt=xoe(0,0,1,400,tt.current,N);async function bt(pt,dn,Ae=null){var It;if(m&&!A)return;if(F(!1),tt.current=!0,Et(),dn.rightButton||ne){if(((It=pt.layer)==null?void 0:It.id)!=="selection-radius"){je.current.showSnack("Please select a point inside the radius.","info");return}if(be){je.current.showSnack("Please wait for all data to load.","info");return}const Qe=setTimeout(()=>{xe(!0)},300),gt=await II(pt.coordinate[1],pt.coordinate[0]);if(!gt){je.current.showSnack("No path was found in the vicinity, please try another location."),clearTimeout(Qe),xe(!1);return}const Mt=ht.current.getNode(gt.id);if(r(gt),clearTimeout(Qe),xe(!1),!Mt){je.current.showSnack("An error occurred. Please try again.");return}ht.current.endNode=Mt;return}const Ct=setTimeout(()=>{xe(!0)},300),En=await II(pt.coordinate[1],pt.coordinate[0]);if(!En){je.current.showSnack("No path was found in the vicinity, please try another location."),clearTimeout(Ct),xe(!1);return}e(En),r(null);const en=kO([En.lon,En.lat],Ae??fe.radius);o([{contour:en}]),qq(RO(en),En.id).then(Qe=>{ht.current.graph=Qe,Et(),clearTimeout(Ct),xe(!1)})}function Jt(){F(!0),setTimeout(()=>{Et(),ht.current.start(fe.algorithm),_(!0)},400)}function Je(pt=!0,dn=1){if(!(E===0&&!A)){if(z(dn),A){pt&&E>=nt.current&&T(0),_(!0),D(!R);return}_(!m),m&&(Ge.current=null)}}function Et(){_(!1),l([]),T(0),ht.current.reset(),Dt.current=[],nt.current=0,Ge.current=null,ot.current=null,ct.current=null,L(!1)}function sn(pt){const dn=ht.current.nextStep();for(const Ae of dn)hn(Ae,Ae.referer);if(ht.current.finished&&!A)if(fe.algorithm==="bidirectional"){ot.current||(ot.current=dn[0]);const Ae=ot.current.parent;hn(Ae,ot.current,"route",Math.max(Math.log2(fe.speed),1)),ot.current=Ae??ot.current,ct.current||(ct.current=dn[0],ct.current.parent=ct.current.prevParent);const Ct=ct.current.parent;hn(Ct,ct.current,"route",Math.max(Math.log2(fe.speed),1)),ct.current=Ct??ct.current,L(E>=nt.current&&Ae==null&&Ct==null)}else{ot.current||(ot.current=ht.current.endNode);const Ae=ot.current.parent;hn(Ae,ot.current,"route",Math.max(Math.log2(fe.speed),1)),ot.current=Ae??ot.current,L(E>=nt.current&&Ae==null)}if(Ge.current!=null&&!A){const Ae=pt-Ge.current;T(Ct=>Ct+Ae*W)}if(Ge.current!=null&&A&&R){const Ae=pt-Ge.current;E>=nt.current&&W!==-1&&D(!1),T(Ct=>Math.max(Math.min(Ct+Ae*2*W,nt.current),0))}}function Qt(pt){for(let dn=0;dn<fe.speed;dn++)sn(pt);Ge.current=pt,ke.current=requestAnimationFrame(Qt)}function hn(pt,dn,Ae="path",Ct=1){if(!pt||!dn)return;const en=Math.hypot(pt.longitude-dn.longitude,pt.latitude-dn.latitude)*5e4*Ct;Dt.current=[...Dt.current,{path:[[dn.longitude,dn.latitude],[pt.longitude,pt.latitude]],timestamps:[nt.current,nt.current+en],color:Ae}],nt.current+=en,l(()=>Dt.current)}function $t(pt){Ye({...ze,longitude:pt.longitude,latitude:pt.latitude,zoom:13,transitionDuration:1,transitionInterpolator:new tH})}function Lt(pt){Re(pt);const dn={settings:pt,colors:Ve};localStorage.setItem("path_settings",JSON.stringify(dn))}function Ft(pt){Fe(pt);const dn={settings:fe,colors:pt};localStorage.setItem("path_settings",JSON.stringify(dn))}function wn(pt){Et(),Lt({...fe,algorithm:pt})}function vn(pt){Lt({...fe,radius:pt}),t&&bt({coordinate:[t.lon,t.lat]},{},pt)}return q.useEffect(()=>{if(m)return ke.current=requestAnimationFrame(Qt),()=>cancelAnimationFrame(ke.current)},[m,E,A,R]),q.useEffect(()=>{navigator.geolocation.getCurrentPosition(Ae=>{$t(Ae.coords)});const pt=localStorage.getItem("path_settings");if(!pt)return;const dn=JSON.parse(pt);Re(dn.settings),Fe(dn.colors)},[]),Q.jsxs(Q.Fragment,{children:[Q.jsx("div",{onContextMenu:pt=>{pt.preventDefault()},children:Q.jsxs(pH,{initialViewState:ze,controller:{doubleClickZoom:!1,keyboard:!1},onClick:bt,children:[Q.jsx(FT,{id:"selection-radius",data:i,pickable:!0,stroked:!0,getPolygon:pt=>pt.contour,getFillColor:[80,210,0,10],getLineColor:[9,142,46,175],getLineWidth:3,opacity:xt}),Q.jsx(NT,{id:"pathfinding-layer",data:h,opacity:1,widthMinPixels:3,widthMaxPixels:5,fadeTrail:!1,currentTime:E,getColor:pt=>Ve[pt.color],updateTriggers:{getColor:[Ve.path,Ve.route]}}),Q.jsx(OT,{id:"start-end-points",data:[...t?[{coordinates:[t.lon,t.lat],color:Ve.startNodeFill,lineColor:Ve.startNodeBorder}]:[],...n?[{coordinates:[n.lon,n.lat],color:Ve.endNodeFill,lineColor:Ve.endNodeBorder}]:[]],pickable:!0,opacity:1,stroked:!0,filled:!0,radiusScale:1,radiusMinPixels:7,radiusMaxPixels:20,lineWidthMinPixels:1,lineWidthMaxPixels:3,getPosition:pt=>pt.coordinates,getFillColor:pt=>pt.color,getLineColor:pt=>pt.lineColor}),Q.jsx(VH,{reuseMaps:!0,mapLib:$H,mapStyle:yoe,doubleClickZoom:!1})]})}),Q.jsx(Kz,{ref:je,canStart:t&&n,started:m,animationEnded:A,playbackOn:R,time:E,startPathFinding:Jt,toggleAnimation:Je,clearPath:Et,timeChanged:T,changeLocation:$t,maxTime:nt.current,settings:fe,setSettings:Lt,changeAlgorithm:wn,colors:Ve,setColors:Ft,loading:be,cinematic:$,setCinematic:K,placeEnd:ne,setPlaceEnd:re,changeRadius:vn}),Q.jsxs("div",{className:"attrib-container",children:[Q.jsx("summary",{className:"maplibregl-ctrl-attrib-button",title:"Toggle attribution","aria-label":"Toggle attribution"}),Q.jsxs("div",{className:"maplibregl-ctrl-attrib-inner",children:["© ",Q.jsx("a",{href:"https://carto.com/about-carto/",target:"_blank",rel:"noopener",children:"CARTO"}),", © ",Q.jsx("a",{href:"http://www.openstreetmap.org/about/",target:"_blank",children:"OpenStreetMap"})," contributors"]})]})]})}const woe=iS({palette:{mode:"dark"}});function Eoe(){return Q.jsxs(vK,{theme:woe,children:[Q.jsx(Ite,{}),Q.jsx(boe,{})]})}pb.createRoot(document.getElementById("root")).render(Q.jsx(cr.StrictMode,{children:Q.jsx(Eoe,{})}));export{HF as c,Am as g};
